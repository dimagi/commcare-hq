{% load hq_shared_tags %}
<label for="hsph_region_select" class="control-label">Region</label>
<div class="controls">
    <select id="hsph_region_select" name="{{ slugs.region }}" data-bind="options: regions, optionsValue: 'item_id', optionsText: 'name', optionsCaption: 'Select Region', value: selected_region, event: {change: updateRegion}"></select>
</div>
</div>
<div class="control-group" data-bind="visible: enable_district">
    <label for="hsph_district_select" class="control-label">District</label>
    <div class="controls">
        <select id="hsph_district_select" name="{{ slugs.district }}" data-bind="options: districts, optionsValue: 'item_id', optionsText: 'name', optionsCaption: 'Select Disctrict', value: selected_district, enable: enable_district, event: {change: updateDistrict}"></select>
    </div>
</div>
<div class="control-group" data-bind="visible: enable_site">
    <label for="hsph_site_select" class="control-label">Site</label>
    <div class="controls">
        <select id="hsph_site_select" name="{{ slugs.site }}" data-bind="options: sites, optionsValue: 'item_id', optionsText: 'name', optionsCaption: 'Select Site', value: selected_site, enable: enable_site"></select>
    </div>

<script type="text/javascript" src="{% static 'hsph/ko/hsph.field.sites.js' %}"></script>
<script type="text/javascript">
    $(function () {
        var siteMap = {{ sites|JSON }},
            currentSelection = {{ selected|JSON }};
        ko.applyBindings(new HSPHSitePicker(siteMap, currentSelection), $("#fieldset_{{ slug }}")[0] );
    });
</script>