{% extends "reports/report_base.html" %}
{% load case_tags %}
{% load hq_shared_tags %}

{% block js-inline %}{{ block.super }}
    <script>
    $(document).ready(function() {
        // this adds clickable links to our form and case elements
        var form_lookup_dict = {{ form_lookups|JSON }};
        var urlBase = "{% url render_form_data domain 'placeholder-formid' %}";
        var link_template = '<a href="placeholder-url">placeholder-text</a>'
        $(".xform_ref").each(function() {
            var formid = $(this).data("formid");
            if (formid) {
                var text = form_lookup_dict[formid];
                var url = urlBase.replace("placeholder-formid", formid);
                var body = link_template.replace("placeholder-url", url).replace("placeholder-text", text);
                $(this).html(body);
            }
        });
        
        var caseUrlBase = "{% url case_details domain 'placeholder-caseid' %}";
        $(".case_ref").each(function() {
            var caseid = $(this).data("caseid");
            if (caseid) {
                var url = caseUrlBase.replace("placeholder-caseid", caseid);
                var body = link_template.replace("placeholder-url", url).replace("placeholder-text", $(this).text());
                $(this).html(body);
            }
        });
    });
    </script>
{% endblock %}

{% block page-title %}
    <ul class="breadcrumb">
        <li>
            <a href="{% url default_report domain %}"><strong>Reports</strong></a> <span class="divider">&gt;</span>
        </li>
        <li>
            <a href="{% url project_report_dispatcher domain 'case_list' %}">Case List</a> <span class="divider">&gt;</span>
        </li>
        <li class="active">
            <a href="#">{{ report.name }}</a>
        </li>
    </ul>
{% endblock %}

{% block main_column %}
<div class="hq-generic-report">
    {% render_case case_id timezone %}
</div>
{% endblock %}