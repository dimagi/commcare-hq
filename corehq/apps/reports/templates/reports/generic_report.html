{% extends "reports/report_base.html" %}
{% load hq_shared_tags %}
{% load report_tags %}
{% load i18n %}

{% block js-inline %} {{ block.super }}
<script type="text/javascript">
    $(function() {
        {% if report_datatables %}
            var defaultNumRows = {{ report_datatables.defaultNumRows|default:10 }};
            var reportTables = new HQReportDataTables({
                defaultRows: defaultNumRows,
                startAtRowNum: {{ report_datatables.startAtRowNum|default:0 }},
                aoColumns: {{ report.headers.render_aoColumns|JSON }},
                autoWidth: {{ report.headers.auto_width|JSON }}
            });
            reportTables.render();
        {% endif %}
        $('.header-tooltip').tooltip();
    });
</script>
{% endblock %}

{% block reportcontent %}
<table class="table table-striped datatable" {% if ajax_source %}data-source="{{ ajax_source }}"{% endif %}{% if ajax_params and ajax_source %}{% for param in ajax_params %} data-{{ param.name }}="{{ param.value }}"{% endfor %}{% if filter %} data-filter="true"{% endif %}{% endif %}>
    <thead>
        {%  if report.headers.complex %}
            {{ report.headers.render_html|safe }}
        {% else %}
        <tr>
            {% for header in report.headers %}
<               <th {% if not ajax_source %}data-sort="{{ header.sort_type }}" data-sortdir="{{ header.sort_direction }}"{% endif %} {% if header.css_class %}class="{{ header.css_class }}"{% endif %}>
                    <i class="icon-hq-white icon-hq-doublechevron"></i>
                    {% if header.html %}{{ header.html }}{% else %}{{ header|linebreaksbr }}{% endif %}
                    {% if header.help_text %}
                        <i class="icon-white icon-question-sign header-tooltip" title="{{ header.help_text }}"></i>
                    {% endif %}
                </th>
            {% endfor %}
        </tr>
        {% endif %}
    </thead>
    <tbody>
        {% for row in report.rows %}
            <tr>
                {% for thing in row %}
                    <td class="{% if not thing or thing.html != None and not thing.html %}null-entry{% endif %}">
                        {% if thing.html != None %}{{ thing.html|safe }}{% else %}{{ thing|safe }}{% endif %}
                        <span title="{% if thing.sort_key != "" %}{{ thing.sort_key }}{% else %}{{ thing }}{% endif %}"></span>
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
    </tbody>
    {% if total_row and report.rows %}
    <tfoot>
        <tr>
            {% for col in total_row %}
                <td>{% if col.html != None %}{{ col.html|safe }}{% else %}{{ col|safe }}{% endif %}</td>
            {% endfor %}
        </tr>
    </tfoot>
    {% endif %}
</table>
{% endblock %}