{% load i18n %}
{% load hq_shared_tags %}

<script>
$(function () {
        function showReadable() {
        $('.form-data-raw').hide();
        $('.form-data-readable').show();
    }
    function showRaw() {
        $('.form-data-readable').hide();
        $('.form-data-raw').show();
    }
    $('.showReadable').click(showReadable);
    $('.showRaw').click(showRaw);
    $('.formDisplayToggle a').click(function () {
        $(this).tab('show');
        return false;
    });

    // On page load, initially set show readable
    showReadable();

    function showSkipped(show) {
        if (show) {
            $('.form-data-skipped').show();
            $('.form-data-skipped-spacer').hide();
            $('.form-data-hidden-values').each(function () {
                $(this).show();
            });
        } else {
            $('.form-data-skipped').hide();
            $('.form-data-skipped-spacer').show();
            $('.form-data-hidden-values').each(function () {
                var current = $(this).next();
                while (current.is('.form-data-question')) {
                    console.log(current);
                    if (!current.is('.form-data-skipped')) {
                        return;
                    }
                    current = current.next();
                }
                $(this).hide();
            });
        }
    }
    $('.showSkippedToggle').change(function () {
        showSkipped($(this).is(':checked'));
    }).each(function () {
        if ($('.form-data-skipped').length == 0) {
            $(this).parent('label').hide();
        }
    });
    showSkipped(false);
});
</script>

{% if question_list_not_found %}
<div class="row-fluid">
    <div class="alert alert-warning clear-fix span6">
        <strong>{{ question_list_not_found.message }}</strong>
        <br/>
        {% trans "All data is listed as Unrecognized Data." %}
    </div>
</div>
{% else %}
<ul class="nav nav-pills formDisplayToggle">
    <li class="active"><a href="#" class="showReadable">{% trans "Labels" %}</a></li>
    <li><a href="#" class="showRaw">{% trans "Question IDs" %}</a></li>
</ul>
<label class="checkbox">
    <input type="checkbox" class="showSkippedToggle"/>
    {% trans "Show questions in form that were not shown to the user" %}
    <span class="hq-help-template"
        data-title="{% trans "Questions not shown to the user" %}"
        data-content="{% trans "These questions were not shown to the user because their display conditions were not met." %}"
    ></span>
</label>
{% endif %}
<table class="table table-bordered form-data-table">
    <tr>
        <th class="span6">
            <span class="form-data-readable">{% trans "Question" %}</span>
            <span class="form-data-raw">{% trans "Question ID" %}</span>
        </th>
        <th class="span6">{% trans "Response" %}</th>
    </tr>
    {% include 'reports/form/partials/single_form_tree.html' %}
</table>
