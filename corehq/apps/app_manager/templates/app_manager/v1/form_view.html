{% extends "app_manager/v1/form_view_base.html" %}
{% load xforms_extras %}
{% load hq_shared_tags %}
{% load i18n %}

{% block js-inline %}{{ block.super }}

{% if request.guided_tour %}{% include request.guided_tour.template %}{% endif %}
{% if form.source %}
<script>
    /* form_requires needs to be a knockout observable so that
    its value can be read by another UI (form filtering) */
    var form_requires = ko.observable({{ form.requires|JSON }});
    var CaseConfig = hqImport('app_manager/js/case-config-ui.js').CaseConfig;
    var caseConfig = new CaseConfig({
        home: $('#case-config-ko'),
        actions: {{ form.actions|JSON }},
        questions: {{ xform_questions|JSON }},
        save_url: "{% url "edit_form_actions" app.domain app.id nav_form.unique_id %}",
        requires: form_requires,
        reserved_words: {{ case_reserved_words_json|JSON }},
        valid_index_names: {{ valid_index_names|JSON }},
        moduleCaseTypes: {{ module_case_types|JSON }},
        caseType: {{ form.get_case_type|JSON }},
        allowUsercase: {{ allow_usercase|JSON }},
        propertiesMap: {{ case_properties|JSON }},
        usercasePropertiesMap: {{ usercase_properties|JSON }},
        propertyDescriptions: {{ property_descriptions|JSON }},
    });
    caseConfig.init();
</script>
{% endif %}
{% endblock %}
