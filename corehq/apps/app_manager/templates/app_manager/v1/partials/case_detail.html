{% load i18n %}
{% load hq_shared_tags %}

{% include 'app_manager/v1/partials/case_list_missing_warning.html' %}

<div data-bind="saveButton: longScreen.saveButton"></div>


{% include 'app_manager/v1/partials/custom_detail_variables.html' with screen='longScreen'%}

<legend>
    {% trans "Display Properties" %}
    <span class="hq-help-template"
        data-title="{% trans "Case Detail" %}"
        data-content="{% trans "These properties will be displayed on a confirmation screen after a case has been selected. If no properties are listed here the confirmation screen will not be displayed at all." %}"
    ></span>
</legend>
<div data-bind="with: longScreen">
    {% include 'app_manager/v1/partials/case_list_properties.html' %}
</div>

{{ request|toggle_tag_info:"DETAIL_LIST_TAB_NODESETS" }}
<div class="btn-group">

    <button class="btn btn-default" data-bind="click: function() { longScreen.addTab(false); }">
        <i class="fa fa-plus"></i>
        {% trans "Add tab" %}
    </button>
 
    {% if request|toggle_enabled:'DETAIL_LIST_TAB_NODESETS' %}
        <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li data-bind="click: function() { longScreen.addTab(false); }"><a>{% trans "Add tab" %}</a></li>
            <li data-bind="click: function() { longScreen.addTab(true); }"><a>{% trans "Add data tab" %}</a></li>
        </ul>
    {% endif %}

</div>

<span class="hq-help-template"
      data-title="{% trans "Case Detail Tabs" %}"
      data-content="{% blocktrans %}Do you have a lot of case properties? Try splitting them into tabs, which will appear as separate screens that mobile users can swipe through. Read more on the <a href='https://help.commcarehq.org/display/commcarepublic/Tabs+on+Case+Detail+Screen' target='_blank'>Help Site</a>.{% endblocktrans %}">
</span>

{% if request|toggle_enabled:"CASE_DETAIL_PRINT" %}
    <br><br>
    <legend>{% trans "Printing" %}</legend>
    {% if app.enable_detail_print %}
        <div class="form-group" data-bind="with: printTemplateReference">
            <label class="col-sm-2 control-label">
                {% trans "Document Template" %}
            </label>
            <div class="col-sm-4">
                <a class="btn btn-default existing-media"
                   data-bind="visible: url(), attr: {href: url()}"
                   target="_blank"
                   data-toggle="tooltip"
                   data-title="{% trans "Opens file in new tab." %}">{% trans "Open HTML" %}</a>
                <button type="button" class="btn btn-default" data-toggle="modal"
                        data-target="#module_{{ module.unique_id }}_detail_print"
                        data-bind="
                            attr: { 'data-hqmediapath': path },
                            event: { mediaUploadComplete: uploadComplete },
                        ">
                    <i class="fa fa-cloud-upload"></i>
                    <span data-bind="{visible: !url()}">{% trans "Upload HTML" %}</span>
                    <span data-bind="{visible: url()}">{% trans "Replace HTML" %}</span>
                </button>
                <a class="btn btn-danger"
                   data-bind="
                        click: removePrintTemplate,
                        visible: url(),
                ">
                    <i class="fa fa-remove"></i>
                </a>
            </div>
        </div>
    {% else %}
        <div class="alert alert-warning">{% trans "Printing the case detail is not supported on this version of CommCare" %}</div>
    {% endif %}
{% endif %}
