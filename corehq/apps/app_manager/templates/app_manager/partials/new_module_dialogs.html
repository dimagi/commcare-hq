{% load i18n %}
{% load url from future %}
{% load xforms_extras %}
{% if show_care_plan %}
    <div id="careplan-module-dialog" class="modal hide fade">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h4>{% trans "New Careplan module" %}</h4>
        </div>
        <form name="new_careplan_module" action="{% url "corehq.apps.app_manager.views.new_module" domain app.id %}" method="post">
            <div class="modal-body">
                <input type="hidden" name="module_type" value="careplan" />
                <div class="control-group">
                    <label class="control-label" for="target_module_id">{% trans "Select the module to attach the careplan to" %}</label>
                    <div class="controls">
                        <select name="target_module_id" class="input">
                        {% for module in app.get_modules %}
                            {% if module.case_type %}
                                <option value="{{ module.id }}">
                                 {{ module.name|html_trans:langs }}
                                </option>
                            {% endif %}
                        {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" type="submit">{% trans "Create New Module" %}</button>
                <a href="#" class="btn" data-dismiss="modal">{% trans "Cancel" %}</a>
            </div>
        </form>
    </div>
{% endif %}
{% if show_commtrack %}
    <script type="text/javascript">
        $(function () {
            $("#include_requisition_module").change(function () {
                $('#requisition_settings').toggle($(this).is(':checked'));
            });
        });
    </script>
    <div id="commtrack-module-dialog" class="modal hide fade">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h4>{% trans "New CommTrack module" %}</h4>
        </div>
        <form class="form-horizontal" name="new_commtrack_module" action="{% url "corehq.apps.app_manager.views.new_module" domain app.id %}" method="post">
            <div class="modal-body">
                <input type="hidden" name="module_type" value="commtrack" />
                <div class="control-group">
                    <label class="control-label" for="name">{% trans "Module name" %}</label>
                    <div class="controls">
                        <input type="text" name="name" class="input-medium" value="Manage Supply Points"/>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="sp_case_type">{% trans "Supply point case type" %}</label>
                    <div class="controls">
                        <input type="text" name="sp_case_type" class="input-medium"  data-provide="typeahead" autocomplete="off"
                           data-source="[&quot;{{ app.get_case_types|join:"&quot;,&quot;" }}&quot;]"/>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="include_requisition_module">{% trans "Include requisitions module" %}</label>
                    <div class="controls">
                        <input id="include_requisition_module" type="checkbox" name="include_requisition_module" value="true">
                    </div>
                </div>
                <div id="requisition_settings" style="display: none;">
                    <hr/>
                    <div class="control-group">
                        <label class="control-label" for="requisition_name">{% trans "Requisition module name" %}</label>
                        <div class="controls">
                            <input type="text" name="requisition_name" class="input-medium" value="Requisitions"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="requisition_case_type">{% trans "Requisition case type" %}</label>
                        <div class="controls">
                            <input type="text" name="requisition_case_type" class="input-medium" value="commtrack_requisition"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">{% trans "Requisition mode" %}</label>
                        <div class="controls">
                            <label class="radio">
                                <input type="radio" name="requisition_mode" value="3" checked>
                                    {% trans "Three step" %}<br/>{% trans "(Requisition &rarr; Fulfillment &rarr; Receipt)" %}
                            </label>
                            <label class="radio">
                                <input type="radio" name="requisition_mode" value="4">
                                    {% trans "Four step" %}<br/>{% trans "(Requisition &rarr; Approval &rarr; Fulfillment &rarr; Receipt)" %}
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" type="submit">{% trans "Create New Module" %}</button>
                <a href="#" class="btn" data-dismiss="modal">{% trans "Cancel" %}</a>
            </div>
        </form>
    </div>
{% endif %}
