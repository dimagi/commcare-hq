"use strict";(self.webpackChunkvellum=self.webpackChunkvellum||[]).push([[828],{7828:(t,e,n)=>{var o=n(8324),r=n.n(o),a=n(561),l=n.n(a),s=n(4523),i=n(1134);const u='<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa">\n<h:head>\n\t<h:title>Reference Format Tests</h:title>\n\t<model>\n\t\t<instance>\n\t\t\t<data xmlns="http://www.commcarehq.org/a/corpora/tests/references" version="1">\n\t\t\t\t<group>\n\t\t\t\t\t<a/>\n\t\t\t\t</group>\n\t\t\t\t<text />\n\t\t\t</data>\n\t\t</instance>\n\t</model>\n</h:head>\t\t\t\n<h:body>\n\t<group ref="group">\n\t\t<label>The group</label>\n\t\t<select1 ref="a">\n\t\t\t<label>The label</label>\n\t\t\t<item><label>Yes</label><value>y</value></item>\n\t\t\t<item><label>No</label><value>n</value></item>\n\t\t</select1>\n\t</group>\n\t<group appearance="field-list">\n\t\t<trigger ref="/data/text">\n\t\t\t<label>The text</label>\n\t\t</trigger>\n\t</group>\n</h:body>\n</h:html>\n',d='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/5C09561F-A531-44F3-B6D1-EACE9F879D4B" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<text />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>text</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/text" ref="/data/text">\n\t\t\t<label ref="jr:itext(\'text-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',m='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/4D3DAB74-EEED-4487-90F4-3E06E66B367C" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2 />\n\t\t\t\t\t<question3 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="overriden" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="overriden" type="xsd:string" vellum:constraint="#form/question1" constraint="overridden" vellum:relevant="#form/question1" relevant="overridden" />\n\t\t\t<bind vellum:nodeset="#form/question3" nodeset="overriden" vellum:calculate="#form/question1" calculate="overridden" />\n\t\t\t<setvalue event="xforms-ready" vellum:ref="#form/question2" ref="overridden" vellum:value="#form/question1" value="overridden" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output vellum:value="#form/question1" value="overridden" /> question2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="overridden">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t\t<input vellum:ref="#form/question2" ref="overridden">\n\t\t\t<label ref="jr:itext(\'question2-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',h='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/4D3DAB74-EEED-4487-90F4-3E06E66B367C" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2 />\n\t\t\t\t\t<question3 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="/data/question2" type="xsd:string" vellum:constraint="#form/question1" constraint="/data/question1" vellum:relevant="#form/question1" relevant="/data/question1" />\n\t\t\t<bind vellum:nodeset="#form/question3" nodeset="/data/question3" vellum:calculate="#form/question1" calculate="/data/question1" />\n\t\t\t<setvalue event="xforms-ready" vellum:ref="#form/question2" ref="/data/question2" vellum:value="#form/question1" value="/data/question1" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output vellum:value="#form/question1" value="/data/question1" /> question2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t\t<input vellum:ref="#form/question2" ref="/data/question2">\n\t\t\t<label ref="jr:itext(\'question2-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n';var c=n(6276),f=n(7519),p=r().assert,x=i.A.call,g=i.A.options.options.plugins||[],v=s.Ay.union(g,["itemset"]),q=(0,s.Ay)(g).without("itemset");describe("The parser",(function(){it("can detect when the itemset plugin is enabled",(function(t){i.A.init({plugins:v,core:{onReady:function(){p(this.isPluginEnabled("itemset"),"itemset plugin should be enabled"),t()}}})})),it("can detect when the itemset plugin is disabled",(function(t){i.A.init({plugins:q,core:{onReady:function(){p(!this.isPluginEnabled("itemset"),"itemset plugin should be disabled"),t()}}})})),it("should gracefully handle itemset when the itemset plugin is disabled",(function(t){i.A.init({plugins:q,core:{form:'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Vellum testing</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n\t\t\t\t\t  xmlns="http://openrosa.org/formdesigner/FFD00941-A932-471A-AEC8-87F6EFEF767F"\n\t\t\t\t\t  uiVersion="1" version="1" name="Vellum testing">\n\t\t\t\t\t<state />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<instance id="states" src="jr://fixture/item-list:state"></instance>\n\t\t\t<bind vellum:nodeset="#form/state" nodeset="/data/state" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="state-label">\n\t\t\t\t\t\t<value>State</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 vellum:ref="#form/state" ref="/data/state">\n\t\t\t<label ref="jr:itext(\'state-label\')" />\n\t\t\t<itemset nodeset="instance(\'states\')/state_list/state">\n\t\t\t  <label ref="name"></label>\n\t\t\t  <value ref="id"></value>\n\t\t\t</itemset>\n\t\t</select1>\n\t</h:body>\n</h:html>\n',onReady:function(){var e=x("getMugByPath","/data/state");p.equal(e.__className,"Select");var n=x("createXML"),o=i.A.parseXML(n);p.equal(o.find("instance[id=states]").length,1,n),p.equal(o.find("itemset").attr("nodeset"),"instance('states')/state_list/state"),t()}}})})),it("should not drop newlines in calculate conditions",(function(){i.A.loadXML('<?xml version="1.0" encoding="UTF-8"?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/398C9010-61DC-42D3-8A85-B857AC3A9CA0" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" calculate="concat(&quot;Line 1&quot;,&quot;&#10;Line 2&quot;)" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default=""/>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body></h:body>\n</h:html>\n');var t=x("getMugByPath","/data/question1");p.equal(t.p.calculateAttr,'concat("Line 1", "\nLine 2")')}));var t=/Form (JRM namespace|does not have a (Name|(UI)?Version))/;it("should load select item without itext",(function(){i.A.loadXML('<?xml version="1.0" encoding="UTF-8"?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n  <h:head>\n    <h:title>Untitled Form</h:title>\n    <model>\n      <itext>\n        <translation lang="en" default="">\n          <text id="/ClassroomObservationV3/Q0003:label">\n            <value>Places</value>\n          </text>\n          <text id="/ClassroomObservationV3/Q0003/1:label">\n            <value>Central</value>\n          </text>\n        </translation>\n      </itext>\n      <instance>\n        <ClassroomObservationV3 xmlns="http://openrosa.org/formdesigner/a530b6d48dc56c027fdb579c0b0f251e9273c701" id="class_observationv3">\n          <Q0003/>\n        </ClassroomObservationV3>\n      </instance>\n      <bind nodeset="/ClassroomObservationV3/Q0003" required="true()" type="select1" />\n    </model>\n  </h:head>\n  <h:body>\n    <select1 ref="/ClassroomObservationV3/Q0003">\n      <label ref="jr:itext(\'/ClassroomObservationV3/Q0003:label\')" />\n      <item>\n        <label ref="jr:itext(\'/ClassroomObservationV3/Q0003/1:label\')"/>\n        <value>1</value>\n      </item>\n      <item>\n        <label>Other</label>\n        <value>other</value>\n      </item>\n    </select1>\n  </h:body>\n</h:html>\n',null,t);var e=x("getMugByPath","/ClassroomObservationV3/Q0003")._node_control.children[1].value;p.equal(e.p.nodeID,"other")})),it("should un-escape HTML entities in select item",(function(){i.A.loadXML(""),i.A.addQuestion("Select","select");var t=i.A.addQuestion("Choice","choice");t.p.nodeID="a&b<c";var e=i.A.call("createXML");p.include(i.A.call("createXML"),"a&amp;b&lt;c"),i.A.loadXML(e);var n=i.A.getMug("select");t=n.form.getChildren(n)[0],p.equal(t.p.nodeID,"a&b<c")})),it("should load mugs with relative paths and label without itext",(function(){i.A.loadXML(u,null,t);var e=x("getMugByPath","/data/group"),n=x("getMugByPath","/data/group/a"),o=x("getMugByPath","/data/text");p.equal(e.p.labelItext.defaultValue(),"The group"),p.equal(n.p.labelItext.defaultValue(),"The label"),p.equal(o.p.labelItext.defaultValue(),"The text"),i.A.assertXmlNotEqual(x("createXML"),u)})),it("should load question without bind element",(function(){i.A.loadXML(d)})),it("should load question with accent char in path",(function(){i.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/65D6BDD4-99E2-40CB-A8D0-71BE3CED64E7" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<t√®xt />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="#form/t√®xt" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="t√®xt-label">\n\t\t\t\t\t\t<value>text</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="t√®xt-label">\n\t\t\t\t\t\t<value>text</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input ref="#form/t√®xt">\n\t\t\t<label ref="jr:itext(\'t√®xt-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>');var t=x("getMugByPath","#form/t√®xt");p.match(i.A.getMessages(t),/t√®xt is not a valid Question ID/)})),it("should set undefined for data value",(function(){i.A.loadXML(d),i.A.clickQuestion("text"),p(!l()("[name=property-dataValue]").length)})),it("should set required correctly",(function(){i.A.loadXML(f);var t=i.A.getMug("question1");p(t.p.requiredAttr,"required is false"),p.equal(t.p.requiredCondition,void 0),p.equal(t.messages.get("requiredAttr").length,0,"requiredAttr messages"),p.equal(t.messages.get("requiredCondition").length,0,"requiredCondition messages");var e=i.A.getMug("question2");p(e.p.requiredAttr,"required is false"),p.equal(e.p.requiredCondition,"#form/question1 = 'hi'"),p.equal(e.messages.get("requiredAttr").length,0,"requiredAttr messages"),p.equal(e.messages.get("requiredCondition").length,0,"requiredCondition messages");var n=i.A.getMug("question3");p(!n.p.requiredAttr,"requiredAttr is true"),p.equal(n.p.requiredCondition,"#form/question2 = 'hello'"),p.equal(n.messages.get("requiredAttr").length,1,"requiredAttr messages"),p.equal(n.messages.get("requiredCondition").length,1,"requiredCondition messages")})),it("should not create read-only mug for child of group named 'body'",(function(){i.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/8730E8C4-2374-47E4-B293-7BA3936D0A4A" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<body>\n\t\t\t\t\t\t<text />\n\t\t\t\t\t</body>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/body" nodeset="/data/body" />\n\t\t\t<bind vellum:nodeset="#form/body/text" nodeset="/data/body/text" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="body-label">\n\t\t\t\t\t\t<value>body</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<group vellum:ref="#form/body" ref="/data/body">\n\t\t\t<label ref="jr:itext(\'body-label\')" />\n\t\t\t<input vellum:ref="#form/body/text" ref="/data/body/text">\n\t\t\t\t<label ref="jr:itext(\'body/text-label\')" />\n\t\t\t</input>\n\t\t</group>\n\t</h:body>\n</h:html>'),i.A.assertJSTreeState("body","  text")})),describe("override",(function(){before((function(t){i.A.init({plugins:g,javaRosa:{langs:["en"]},core:{onReady:function(){t()}}})})),s.Ay.each({relevantAttr:"question2",constraintAttr:"question2",calculateAttr:"question3"},(function(t,e){it("should override "+e+" in question "+t,(function(){i.A.loadXML(m);var n=i.A.getMug(t);p.strictEqual(n.p[e],"#form/question1")}))})),it("should override correctly",(function(){i.A.loadXML(m),i.A.assertXmlEqual(i.A.call("createXML"),h)})),it("should generate hashtags correctly on first load",(function(){i.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/4D3DAB74-EEED-4487-90F4-3E06E66B367C" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2 />\n\t\t\t\t\t<question3 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="/data/question1" type="xsd:string" />\n\t\t\t<bind nodeset="/data/question2" type="xsd:string" constraint="/data/question1" relevant="/data/question1" />\n\t\t\t<bind nodeset="/data/question3" calculate="/data/question1" />\n\t\t\t<setvalue event="xforms-ready" ref="/data/question2" value="/data/question1" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output value="/data/question1" /> question2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t\t<input ref="/data/question2">\n\t\t\t<label ref="jr:itext(\'question2-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n'),i.A.assertXmlEqual(i.A.call("createXML"),h)})),describe("with two languages",(function(){before((function(t){i.A.init({plugins:g,javaRosa:{langs:["en","hin"]},core:{onReady:function(){t()}}})})),it("should load jr__count as jr:count",(function(){i.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/6830242E-8941-4752-BF6F-F40F4C964878" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2 jr:template="">\n\t\t\t\t\t\t<question3 />\n\t\t\t\t\t</question2>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:int" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="/data/question2" />\n\t\t\t<bind vellum:nodeset="#form/question2/question3" nodeset="/data/question2/question3" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default=""/>\n\t\t\t\t<translation lang="hin"/>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1"/>\n\t\t<group>\n\t\t\t<repeat vellum:jr__count="#form/question1" jr:noAddRemove="true()" vellum:nodeset="#form/question2" nodeset="/data/question2">\n\t\t\t\t<input vellum:ref="#form/question2/question3" ref="/data/question2/question3"/>\n\t\t\t</repeat>\n\t\t</group>\n\t</h:body>\n</h:html>\n'),i.A.assertXmlEqual(i.A.call("createXML"),c)}))}))}))}))},1134:(t,e,n)=>{n.d(e,{A:()=>U});var o=n(8449),r=n(8324),a=n.n(r),l=n(6848),s=n.n(l),i=n(3794),u=n.n(i),d=n(4523),m=n(561),h=n.n(m),c=n(1437),f=n.n(c),p=n(3809),x=n.n(p),g=n(705),v=n.n(g),q=n(7229),w=n.n(q),b=(n(1460),n(8803),a().assert),y=["Form Builder clip","version 1"];function A(t,e,n){if((n=d.Ay.defaults(n||{},{normalize_xmlns:!1,not:!1})).normalize_xmlns){var o=w().parseXML(e).find("data").attr("xmlns");t=t.replace(/(data[^>]+xmlns=")(.+?)"/,"$1"+o+'"')}var r,a,l,i,u=(r=t,a=e,l=s().xml(r),i=s().xml(a),s().isEquivalent(l,i,{element_order:!0}));n.not&&(u=!u),u||j(t=M(t),e=M(e),"XML "+(n.not?"should not be equivalent":"mismatch"))}function j(t,e,n){if(t!==e){var o=u().createPatch("",t,e,"actual","expected");o=o.replace(/^Index:/,n||"Not equal:"),b(!1,function(t){var e={"-":31,"+":32};return t.replace(/^.+?$/gm,(function(t){return"["+(e[t[0]]||0)+"m"+t+"[0m"}))}(o))}}function M(t){return(t=t.replace(/^\t+/gm,(function(t){return t.replace(/\t/g,"  ")}))).match(/\n$/)||(t+="\n"),t}function F(t){return C("getCurrentMugInput",t)}function E(t){var e=h()("#vellum").vellum("get"),n=d.Ay.isString(t)?h()("[name="+t+"]"):t;return v().util.getWidget(n,e)}function C(){var t=Array.prototype.slice.call(arguments),e=h()("#vellum");return e.vellum.apply(e,t)}function L(){var t=[],e=d.Ay.map(arguments,(function(e){var n=d.Ay.isString(e)?X(e):e;if(!n||!n.ufid)throw new Error("mug not found: "+e);return t.push(n),n.ufid}));return C("jstree","deselect_all",!0),C("jstree","select_node",e),h()(".collapse-toggle.collapsed").click(),t}function X(t){0!==t.indexOf("/")&&(t="/data/"+t);var e=C("getMugByPath",t);if(!e){var n=t.split("/"),o=C("getMugByPath",n.slice(0,-1).join("/"));if(o&&o.__className.indexOf("Select")>-1){var r=C("getData").core.form.getChildren(o),a=n[n.length-1];if(1===r.length&&"itemset"===a&&"itemset"===r[0].options.tagName)return r[0];for(var l=0;l<r.length;l++)if(r[l].p.nodeID===a)return r[l]}}return e}b.equal=b.strictEqual,b.notEqual=b.notStrictEqual;const U={options:o.A,asyncatch:function(t){return function(){try{var e=Array.prototype.slice.call(arguments);return t.apply(this,e)}catch(t){throw t&&t.stack?new Error(t.stack):t}}},init:function(t){t=t||{};var e=h().extend(!0,{},o.A.options,t),n=h().fn.animate;h().fn.animate=function(t,e,o,r){n.apply(this,[t,0,o,r])},t.javaRosa&&t.javaRosa.langs&&(e.javaRosa.langs=t.javaRosa.langs),e.plugins=d.Ay.without(e.plugins,"atwho"),t.plugins&&(e.plugins=t.plugins),e&&e.features&&d.Ay.isUndefined(e.features.disable_popovers)&&(e.features.disable_popovers=!0),e.core=e.core||{};var r=e.core.saveUrl||function(){};e.core.saveUrl=function(t){return t.xform,r(t)};var a=h()("#vellum"),l=a.vellum("get");l&&(l.destroy(),h()("body > div.modal, body > div.modal-backdrop").remove()),a.empty().vellum(e)},call:C,loadXML:function(t,e,n,o){var r=[],a=C("getData");return o||window.history.replaceState(null,null," "),a.core.parseWarnings=[],C("loadXML",t,e||{}),n?d.Ay.isRegExp(n)&&(r=d.Ay.filter(a.core.parseWarnings,(function(t){return!n.test(t)}))):r=a.core.parseWarnings,b(!r.length,"unexpected parse warnings:\n- "+r.join("\n- ")),delete a.core.parseWarnings,a.core.form},saveAndReload:function(t){C("loadXFormOrError",C("createXML"),t)},getMug:X,getInput:F,getWidget:E,getMediaUploader:function(t){var e,n={},o=E(t);if(!o)throw new Error("media uploader widget not found");if(d.Ay.find([".widget[data-hqmediapath]",".itext-block-container"],(function(n){return(e=t.closest(n)).length})),!e)throw new Error("media uploader element not found");return n.upload=function(t){var n={ref:{path:o.getRandomizedMediaPath(t)},errors:[]};e.trigger("mediaUploadComplete",n)},n},assertEqual:j,assertInputCount:function(t,e,n){d.Ay.isString(t)?(n=" for "+(n?n+" ":"")+t,t=F(t)):n=n?" for "+n:"",b.equal(t.length,e,"wrong number of inputs"+n)},assertXmlEqual:A,assertXmlNotEqual:function(t,e,n){(n=n||{}).not=!0,A(t,e,n)},assertJSTreeState:function(){var t=Array.prototype.slice.call(arguments).join("\n")+"\n";j(function t(e,n){var o,r,a,l=[];for("#"===e.id?n=-1:l.push(Array(2*n+1).join(" ")+e.text),o=0,r=e.children.length;o<r;o++)a=C("jstree","get_node",e.children[o]),l.push(t(a,n+1));return l.join("\n")}(C("jstree","get_node","#"))+"\n",t,"Unexpected jstree state")},assertTreeState:function(t){var e=Array.prototype.slice.call(arguments,1).join("\n")+"\n";j(function t(e,n){var o,r,a,l=[];for(e.isRootNode?n=-1:l.push(Array(2*n+1).join(" ")+e.value.p.nodeID),o=0,r=e.children.length;o<r;o++)a=e.children[o],l.push(t(a,n+1));return l.join("\n")}(t.rootNode,0)+"\n",e,"Unexpected tree state")},addQuestion:function(t,e,n){n=d.Ay.extend({},n),this.prevId&&L(this.prevId);var o=C("addQuestion",t);return e||o.p.nodeID||(e=C("nodeIDFromLabel",o)),e&&(b(d.Ay.isUndefined(n.nodeID),"unexpected attribute for "+t+"["+e+"]"),o.p.labelItext&&o.p.labelItext.set(o.getLabelValue()),o.p.nodeID=e,"Choice"!==t||n.hasOwnProperty("labelItext")||(n.labelItext=e)),d.Ay.each(n,(function(t,e){d.Ay.isBoolean(t)||(t=String(t)),/.+Itext/.test(e)?o.p[e].set(t):o.p[e]=t})),d.Ay.each(C("getSections",o),(function(t){C("collapseSection",t.slug,!1)})),o},paste:function(t,e,n){d.Ay.isString(t)||(t=x().tabDelimit([y].concat(t))),n&&window.console.log(t),b.deepEqual(f().paste(t),e||[])},clickQuestion:L,selectAll:function(){C("jstree","select_all")},deleteQuestion:function(){var t=d.Ay.map(arguments,(function(t){var e=X(t);return b(e,"mug not found: "+t),e}));C("getData").core.form.removeMugsFromForm(t),d.Ay.each(arguments,(function(t){b(!X(t),"mug not removed: "+t)}))},saveButtonEnabled:function(t){var e=C("getData").core.saveButton;if(!d.Ay.isUndefined(t)){var n=t?"save":"saved";e.setStateWhenReady(n),b.equal(e.state,n,"sanity check failed")}return"save"===e.state},expandGroup:function(t){C("jstree","open_node",t.ufid),C("jstree","redraw_node",t.ufid,!0,!1,!1)},collapseGroup:function(t){C("jstree","close_node",t.ufid),C("jstree","redraw_node",t.ufid,!0,!1,!1)},getMessages:function(t){var e=[],n=null;if(d.Ay.isString(t)){var o=t;t=X(o),b(t,"mug not found: "+o)}return t.messages.each((function(t,o){o!==n&&(e.push(o+":"),n=o),e.push("  - "+t.message)})),e.join("\n")},findNode:function(t,e,n){if(d.Ay.isString(e)){var o=e;e=function(t){return t.text===o}}return function n(o){var r,a,l;if(e(o))return o;for(r=0,a=o.children.length;r<a;r++)if(l=n(t.get_node(o.children[r])))return l;return null}(n||t.get_node("#"))},isTreeNodeValid:function(t){if(d.Ay.isString(t)){var e=t;t=X(e),b(t,"mug not found: "+e)}return 0===h()("#vellum").find("#"+t.ufid+" > a").children(".fd-valid-alert-icon").length},markdownVisible:function(){return h()(".itext-block-label-group-default").find(".markdown-output").is(":visible")},parseXML:w().parseXML}},7519:t=>{t.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/D893A901-3F22-449C-B292-7D2BA95C3D59" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2 />\n\t\t\t\t\t<question3 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:string" required="true()" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="/data/question2" type="xsd:string" vellum:required="#form/question1 = \'hi\'" required="/data/question1 = \'hi\'" vellum:requiredCondition="#form/question1 = \'hi\'" requiredCondition="/data/question1 = \'hi\'" />\n\t\t\t<bind vellum:nodeset="#form/question3" nodeset="/data/question3" type="xsd:string" vellum:requiredCondition="#form/question2 = \'hello\'" requiredCondition="/data/question2 = \'hello\'" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="" />\n\t\t\t\t<translation lang="hin" />\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1" />\n\t\t<input vellum:ref="#form/question2" ref="/data/question2" />\n\t\t<input vellum:ref="#form/question3" ref="/data/question3" />\n\t</h:body>\n</h:html>\n'},6276:t=>{t.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/6830242E-8941-4752-BF6F-F40F4C964878" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2 jr:template="">\n\t\t\t\t\t\t<question3 />\n\t\t\t\t\t</question2>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:int" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="/data/question2" />\n\t\t\t<bind vellum:nodeset="#form/question2/question3" nodeset="/data/question2/question3" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="" />\n\t\t\t\t<translation lang="hin" />\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1"/>\n\t\t<group>\n\t\t\t<repeat vellum:jr__count="#form/question1" jr:count="/data/question1" jr:noAddRemove="true()" vellum:nodeset="#form/question2" nodeset="/data/question2">\n\t\t\t\t<input vellum:ref="#form/question2/question3" ref="/data/question2/question3"/>\n\t\t\t</repeat>\n\t\t</group>\n\t</h:body>\n</h:html>\n'}}]);