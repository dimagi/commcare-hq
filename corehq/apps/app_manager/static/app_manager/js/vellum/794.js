"use strict";(self.webpackChunkvellum=self.webpackChunkvellum||[]).push([[794],{6794:(t,e,n)=>{var a=n(8324),o=n.n(a),l=n(561),i=n.n(l),r=n(4523),s=n(1134),u=n(6294),d=n.n(u),m=n(3876),h=n.n(m),c=n(8094),v=n.n(c);const g='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/E2D9313B-4D8F-4E79-B37C-A2A286928A47" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<output />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/output" nodeset="/data/output" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="output-label">\n\t\t\t\t\t\t<value>x <output /> x</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/output" ref="/data/output">\n\t\t\t<label ref="jr:itext(\'output-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>',x='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/D2AEA80D-D518-430A-924B-39D1AE2207F8" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n';var f=n(8077);const p='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/D26EC2F3-D3B5-42F4-81BD-38A8342E8202" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<product />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<instance src="jr://fixture/commtrack:products" id="products"></instance>\n\t\t\t<bind nodeset="/data/product" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="product-label">\n\t\t\t\t\t\t<value><output value="if(1 &lt; 2 or 2 &gt; 3 or 3 &lt;= 3 or 4 &gt;= 5, \'product\', \'other\')" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="product-label">\n\t\t\t\t\t\t<value><output value="if(1 &lt; 2 or 2 &gt; 3 or 3 &lt;= 3 or 4 &gt;= 5, \'product\', \'other\')" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 ref="/data/product">\n\t\t\t<label ref="jr:itext(\'product-label\')" />\n\t\t\t<itemset nodeset="instance(\'products\')/products/product[(@id &gt; 3 and @id &lt; 6) or (@id &gt;= 3 and @id &lt;= 6)]">\n\t\t\t\t<label ref="name" />\n\t\t\t\t<value ref="@id" />\n\t\t\t</itemset>\n\t\t</select1>\n\t</h:body>\n</h:html>\n',q='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/10B97029-578C-4D07-B016-3351C63972F0" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<text />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/text" nodeset="/data/text" type="xsd:string" constraint="1 = 2" jr:constraintMsg="jr:itext(\'text-constraintMsg\')" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>text</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="text-constraintMsg">\n\t\t\t\t\t\t<value>English</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>text</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="text-constraintMsg">\n\t\t\t\t\t\t<value>Hindi</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/text" ref="/data/text">\n\t\t\t<label ref="jr:itext(\'text-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',b='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/514DB9BA-636E-4B9F-A913-4E0B66BC415F" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<north />\n\t\t\t\t\t<south />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/north" nodeset="/data/north" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/south" nodeset="/data/south" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="north-label">\n\t\t\t\t\t\t<value>north</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="north-label">\n\t\t\t\t\t\t<value>north</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/north" ref="/data/north">\n\t\t\t<label ref="jr:itext(\'north-label\')" />\n\t\t</input>\n\t\t<input vellum:ref="#form/south" ref="/data/south">\n\t\t\t<label ref="jr:itext(\'north-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n';var w=n(855);const A='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml"\n\txmlns:orx="http://openrosa.org/jr/xforms"\n\txmlns="http://www.w3.org/2002/xforms"\n\txmlns:xsd="http://www.w3.org/2001/XMLSchema"\n\txmlns:jr="http://openrosa.org/javarosa"\n\txmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n\t\t\t\t\txmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0"\n\t\t\t\t\tuiVersion="1"\n\t\t\t\t\tversion="1"\n\t\t\t\t\tname="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1"\n\t\t\t\ttype="xsd:string"\n\t\t\t\tconstraint="1"\n\t\t\t\tjr:constraintMsg="jr:itext(\'question1-constraintMsg\')" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>xyz</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',j='<h:html xmlns:h="http://www.w3.org/1999/xhtml"\n\txmlns:orx="http://openrosa.org/jr/xforms"\n\txmlns="http://www.w3.org/2002/xforms"\n\txmlns:xsd="http://www.w3.org/2001/XMLSchema"\n\txmlns:jr="http://openrosa.org/javarosa"\n\txmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n\t\t\t\t\txmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0"\n\t\t\t\t\tuiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1/>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="/data/question1" type="xsd:string"\n\t\t\t\tjr:constraintMsg="jr:itext(\'question1-constraintMsg\')" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 en label</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="long">question1 en long</value>\n\t\t\t\t\t\t<value form="short">question1 en short</value>\n\t\t\t\t\t\t<value form="custom">question1 en custom</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-hint">\n\t\t\t\t\t\t<value>question1 en hint</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>question1 en help</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/help/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/help/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/help/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/help/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>question1 en validation</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/constraintMsg/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/constraintMsg/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 hin label</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="long">question1 hin long</value>\n\t\t\t\t\t\t<value form="short">question1 hin short</value>\n\t\t\t\t\t\t<value form="custom">question1 hin custom</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-hint">\n\t\t\t\t\t\t<value>question1 hin hint</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>question1 hin help</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/help/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/help/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/help/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/help/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>question1 hin validation</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/constraintMsg/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/constraintMsg/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')"/>\n\t\t\t<hint ref="jr:itext(\'question1-hint\')"/>\n\t\t\t<help ref="jr:itext(\'question1-help\')"/>\n\t\t\t<alert ref="jr:itext(\'question1-constraintMsg\')"/>\n\t\t</input>\n\t</h:body>\n</h:html>\n',y='<h:html xmlns:h="http://www.w3.org/1999/xhtml"\n\txmlns:orx="http://openrosa.org/jr/xforms"\n\txmlns="http://www.w3.org/2002/xforms"\n\txmlns:xsd="http://www.w3.org/2001/XMLSchema"\n\txmlns:jr="http://openrosa.org/javarosa"\n\txmlns:vellum="http://commcarehq.org/xforms/vellum"\n\tvellum:ignore="richText">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n\t\t\t\t\txmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0"\n\t\t\t\t\tuiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1/>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="/data/question1" type="xsd:string" \n\t\t\t\tjr:constraintMsg="jr:itext(\'question1-blah-constraintMsg\')" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 en label</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="long">question1 en long</value>\n\t\t\t\t\t\t<value form="short">question1 en short</value>\n\t\t\t\t\t\t<value form="custom">question1 en custom</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-hint">\n\t\t\t\t\t\t<value>question1 en hint</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>question1 en help</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/help/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/help/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/help/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/help/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>question1 en validation</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/constraintMsg/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/constraintMsg/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 hin label</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="long">question1 hin long</value>\n\t\t\t\t\t\t<value form="short">question1 hin short</value>\n\t\t\t\t\t\t<value form="custom">question1 hin custom</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-hint">\n\t\t\t\t\t\t<value>question1 hin hint</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>question1 hin help</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/help/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/help/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/help/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/help/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>question1 hin validation</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/constraintMsg/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/constraintMsg/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')"/>\n\t\t\t<hint ref="jr:itext(\'question1-hint\')"/>\n\t\t\t<help ref="jr:itext(\'question1-help\')"/>\n\t\t\t<alert ref="jr:itext(\'question1-constraintMsg\')"/>\n\t\t</input>\n\t</h:body>\n</h:html>\n',M='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml"\n\txmlns:orx="http://openrosa.org/jr/xforms"\n\txmlns="http://www.w3.org/2002/xforms"\n\txmlns:xsd="http://www.w3.org/2001/XMLSchema"\n\txmlns:jr="http://openrosa.org/javarosa"\n\txmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n\t\t\t\t\txmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0"\n\t\t\t\t\tuiVersion="1"\n\t\t\t\t\tversion="1"\n\t\t\t\t\tname="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>xyz</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="es">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>Spanish!</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n';var L=o().assert,I=s.A.call;describe("The javaRosa plugin with multiple languages",(function(){before((function(t){s.A.init({javaRosa:{langs:["en","hin"]},core:{onReady:function(){t()}},features:{rich_text:!1}})})),it("should assign new media path on media upload",(function(){s.A.loadXML("");var t=s.A.addQuestion("Text","text").p.labelItext,e=/jr:\/\/file\/commcare\/image\/data\/text-\w+\.gif/;i()(".itext-block-label-add-form-image").click();var n=s.A.getMediaUploader(i()(".fd-mm-upload-trigger:first"));n.upload("old.gif");var a=t.get("image");L.match(a,e),n.upload("new.gif"),L.match(t.get("image"),e),L.notEqual(t.get("image"),a,"new upload should create a new path")})),it("should remove MM widget on click delete",(function(){s.A.loadXML(""),s.A.addQuestion("Text","text"),i()(".itext-block-label-add-form-image").click();var t=i()("div.widget[data-hqmediapath]:visible"),e=i()(".delete-itext-block-label-group-image");L.equal(t.length,2,"widget not found"),L(e.length,"delete button not found"),e.click(),L.equal(i()("div.widget[data-hqmediapath]").length,0,"widget not deleted")})),it("should not error on choice on add new language",(function(){s.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/DB593648-07B6-4C6A-A8DB-D71E826DA82D" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<select />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/select" nodeset="/data/select" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="select-label">\n\t\t\t\t\t\t<value>select</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select-choice-label">\n\t\t\t\t\t\t<value>choice</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 vellum:ref="#form/select" ref="/data/select">\n\t\t\t<label ref="jr:itext(\'select-label\')" />\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'select-choice-label\')" />\n\t\t\t\t<value>choice</value>\n\t\t\t</item>\n\t\t</select1>\n\t</h:body>\n</h:html>');var t=s.A.getMug("select/choice");L.equal(s.A.getMessages(t),"")})),describe("and non default language is first in options",(function(){before((function(t){s.A.init({features:{rich_text:!1},javaRosa:{langs:["hin","en"]},core:{onReady:function(){t()}}})})),it("should change default to first language on save",(function(){s.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/D6EA20CE-34CD-47A5-B783-A827F5E7DA86" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<text />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/text" nodeset="/data/text" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>test</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>test</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/text" ref="/data/text">\n\t\t\t<label ref="jr:itext(\'text-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n');var t=s.A.parseXML(I("createXML"));L(void 0===t.find("translation[lang=en]").attr("default"),"English should not be the default language"),L(""===t.find("translation[lang=hin]").attr("default"),"Hindi should be the default language")}))})),describe("with rich text enabled",(function(){before((function(t){s.A.init({javaRosa:{langs:["en","hin"]},core:{onReady:function(){t()}}})})),it("should update output refs when question ids change",(function(t){s.A.loadXML(""),s.A.addQuestion("Text","question1"),s.A.addQuestion("Text","question2");var e=s.A.getWidget("itext-en-label");e.input.promise.then((function(){var n='<output value="/data/question1" /> a <output value="/data/question1"/> b <output value="/data/question1"></output> c <output value="/data/question1" ></output> d <output value="if(/data/question1 = \'\', \'\', format-date(date(/data/question1), \'%a%b%c\'))" />';e.setItextValue(n),e.setValue(n);var a=s.A.getWidget("itext-hin-label");a.input.promise.then((function(){a.setValue('<output value="/data/question1"></output>'),s.A.clickQuestion("question1"),i()("[name=property-nodeID]").val("first_question").change(),s.A.assertXmlEqual(I("createXML"),'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<first_question />\n\t\t\t\t\t<question2 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/first_question" nodeset="/data/first_question" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="/data/question2" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output vellum:value="#form/first_question" value="/data/first_question" /> a <output vellum:value="#form/first_question" value="/data/first_question" /> b <output vellum:value="#form/first_question" value="/data/first_question" /> c <output vellum:value="#form/first_question" value="/data/first_question" /> d <output vellum:value="if(#form/first_question = \'\', \'\', format-date(date(#form/first_question), \'%a%b%c\'))" value="if(/data/first_question = \'\', \'\', format-date(date(/data/first_question), \'%a%b%c\'))" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output vellum:value="#form/first_question" value="/data/first_question" /> a <output vellum:value="#form/first_question" value="/data/first_question" /> b <output vellum:value="#form/first_question" value="/data/first_question" /> c <output vellum:value="#form/first_question" value="/data/first_question" /> d <output vellum:value="if(#form/first_question = \'\', \'\', format-date(date(#form/first_question), \'%a%b%c\'))" value="if(/data/first_question = \'\', \'\', format-date(date(/data/first_question), \'%a%b%c\'))" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/first_question" ref="/data/first_question"/>\n\t\t<input vellum:ref="#form/question2" ref="/data/question2">\n\t\t\t<label ref="jr:itext(\'question2-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',{normalize_xmlns:!0}),t()}))}))})),it("should escape HTML before setting Itext value",(function(){s.A.loadXML(""),s.A.addQuestion("Text","question1");var t=s.A.getWidget("itext-en-label");t.setItextValue('<img src="x" onerror="alert(\'XSSinbrokenimg\')"/>');var e=t.getItextItem(),n=s.A.call("getData").javaRosa.Itext.defaultLanguage;L.strictEqual(e.getForm(t.form).getValue(n),'&lt;img src="x" onerror="alert(\'XSSinbrokenimg\')"&gt;')})),describe("should preserve output tags when setting Itext value",(function(){r.Ay.each([["<output />",'<output value="#form/question1" />','<output value="#form/question1" />'],["<output></output>",'<output value="#form/question1" ></output>','<output value="#form/question1" />'],["<output /><img /><output></output>",'<output value="#form/question1" /><img src="x" onerror="alert(\'XSSinbrokenimg\')"/><output value="#form/question1" ></output>','<output value="#form/question1" />&lt;img src="x" onerror="alert(\'XSSinbrokenimg\')"&gt;<output value="#form/question1" />']],(function(t){it("for: "+t[0],(function(){s.A.loadXML(""),s.A.addQuestion("Text","question1");var e=s.A.getWidget("itext-en-label"),n=t[1];e.setItextValue(n);var a=e.getItextItem(),o=s.A.call("getData").javaRosa.Itext.defaultLanguage;L.strictEqual(a.getForm(e.form).getValue(o),t[2])}))}))})),it("should only update exact output ref matches when question ids change",(function(t){s.A.loadXML(""),s.A.addQuestion("Text","question1"),s.A.addQuestion("Text","question2");var e=s.A.getWidget("itext-en-label");e.input.promise.then((function(){var n='<output value="/data/question1" /> <output value="/data/question11" /> <output value="/data/question1/b" /> <output value="/data/question1b" /> ';e.setItextValue(n),e.setValue(n);var a=s.A.getWidget("itext-hin-label");a.input.promise.then((function(){a.setValue("question2"),s.A.clickQuestion("question1"),i()("[name=property-nodeID]").val("first_question").change(),s.A.assertXmlEqual(I("createXML"),'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<first_question />\n\t\t\t\t\t<question2 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/first_question" nodeset="/data/first_question" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/question2" nodeset="/data/question2" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output vellum:value="#form/first_question" value="/data/first_question" /> <output value="/data/question11" /> <output value="/data/question1/b" /> <output value="/data/question1b" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value><output value="/data/first_question" vellum:value="#form/first_question" /> <output value="/data/question11" /> <output value="/data/question1/b" /> <output value="/data/question1b" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/first_question" ref="/data/first_question"/>\n\t\t<input vellum:ref="#form/question2" ref="/data/question2">\n\t\t\t<label ref="jr:itext(\'question2-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',{normalize_xmlns:!0}),t()}))}))})),it("should rename itext item ID after move",(function(){s.A.loadXML(""),s.A.addQuestion("Select","ns"),s.A.addQuestion("Choice","choice1"),s.A.addQuestion("Choice","choice2"),s.A.addQuestion("Select","ew"),s.A.addQuestion("Choice","choice1"),s.A.addQuestion("Choice","choice2");var t=s.A.getMug("ns/choice1"),e=s.A.getMug("ew/choice1");t.p.nodeID="north",e.p.nodeID="south",t.form.moveMug(e,"after",t),s.A.assertXmlEqual(s.A.call("createXML"),'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/09ACF7A7-5D23-41F7-BFF6-E6977A5CA913" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<ns />\n\t\t\t\t\t<ew />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/ns" nodeset="/data/ns" />\n\t\t\t<bind vellum:nodeset="#form/ew" nodeset="/data/ew" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="ns-north-label">\n\t\t\t\t\t\t<value>choice1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="ns-south-label">\n\t\t\t\t\t\t<value>choice1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="ns-choice2-label">\n\t\t\t\t\t\t<value>choice2</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="ew-choice2-label">\n\t\t\t\t\t\t<value>choice2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="ns-north-label">\n\t\t\t\t\t\t<value>choice1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="ns-south-label">\n\t\t\t\t\t\t<value>choice1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="ns-choice2-label">\n\t\t\t\t\t\t<value>choice2</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="ew-choice2-label">\n\t\t\t\t\t\t<value>choice2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 vellum:ref="#form/ns" ref="/data/ns">\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'ns-north-label\')" />\n\t\t\t\t<value>north</value>\n\t\t\t</item>\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'ns-south-label\')" />\n\t\t\t\t<value>south</value>\n\t\t\t</item>\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'ns-choice2-label\')" />\n\t\t\t\t<value>choice2</value>\n\t\t\t</item>\n\t\t</select1>\n\t\t<select1 vellum:ref="#form/ew" ref="/data/ew">\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'ew-choice2-label\')" />\n\t\t\t\t<value>choice2</value>\n\t\t\t</item>\n\t\t</select1>\n\t</h:body>\n</h:html>\n',{normalize_xmlns:!0})})),it("should rename group's child itext item IDs after move group",(function(){s.A.loadXML("");var t=s.A.addQuestion("Group","green"),e=s.A.addQuestion("Group","blue");s.A.addQuestion("Text","text"),e.form.moveMug(e,"before",t),s.A.assertXmlEqual(s.A.call("createXML"),'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/10123843-8ECB-4F20-A41E-59ABD9764D4C" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<blue>\n\t\t\t\t\t\t<text />\n\t\t\t\t\t</blue>\n\t\t\t\t\t<green />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/blue" nodeset="/data/blue" />\n\t\t\t<bind vellum:nodeset="#form/blue/text" nodeset="/data/blue/text" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/green" nodeset="/data/green" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default=""/>\n\t\t\t\t<translation lang="hin"/>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<group vellum:ref="#form/blue" ref="/data/blue">\n\t\t\t<input vellum:ref="#form/blue/text" ref="/data/blue/text"/>\n\t\t</group>\n\t\t<group vellum:ref="#form/green" ref="/data/green"/>\n\t</h:body>\n</h:html>\n',{normalize_xmlns:!0})})),it("should not erase invalid outputs",(function(t){s.A.loadXML(""),s.A.addQuestion("Text","question1");var e=s.A.getWidget("itext-en-label");e.input.promise.then((function(){var n='<output value="concat(1, 2" />';e.setItextValue(n),e.setValue(n),s.A.clickQuestion("question1"),(e=s.A.getWidget("itext-en-label")).input.promise.then((function(){L.strictEqual(e.getValue(),n),s.A.assertXmlEqual(I("createXML"),'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/94711904-28FF-45AA-AFB3-E8543F2AA534" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value><output value="concat(1, 2" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value><output value="concat(1, 2" /></value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n',{normalize_xmlns:!0}),t()}))}))})),it("should not error on save question with markdown and missing language",(function(){s.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/DB593648-07B6-4C6A-A8DB-D71E826DA82D" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<select />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/select" nodeset="/data/select" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="select-label">\n\t\t\t\t\t\t<value>select</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select-help">\n\t\t\t\t\t\t<value>**help**</value>\n\t\t\t\t\t\t<value form="markdown">**help**</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select-choice-label">\n\t\t\t\t\t\t<value>choice</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'select-label\')" />\n\t\t</input>\n\t\t<select1 vellum:ref="#form/select" ref="/data/select">\n\t\t\t<label ref="jr:itext(\'select-label\')" />\n\t\t\t<help ref="jr:itext(\'select-help\')" />\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'select-choice-label\')" />\n\t\t\t\t<value>choice</value>\n\t\t\t</item>\n\t\t</select1>\n\t</h:body>\n</h:html>');var t=s.A.parseXML(I("createXML")).find("translation[lang=hin]>text#select-help>value[form=markdown]");L.equal(t.html(),"**help**")}))})),describe("and one has is right to left",(function(){before((function(t){s.A.init({javaRosa:{langs:["en","heb"]},core:{onReady:function(){s.A.addQuestion("Text"),t()}},features:{rich_text:!1}})})),it("should have rtl attribute",(function(){L.isUndefined(i()("[name=itext-en-label]").attr("dir")),L.strictEqual(i()("[name=itext-heb-label]").attr("dir"),"rtl")})),it("should have rtl attribute on markdown preview",(function(){var t=i()("[name=itext-en-label]"),e=i()("[name=itext-heb-label]"),n=t.closest(".form-group").parent().find(".markdown-output"),a=e.closest(".form-group").parent().find(".markdown-output");t.val("* markdown"),L.isUndefined(n.attr("dir")),L.strictEqual(a.attr("dir"),"rtl")}))})),it("should not show itext errors when there is text in any language",(function(t){s.A.loadXML(A),i()("textarea[name=itext-en-constraintMsg]").val("").change(),s.A.saveAndReload((function(){var e=i()(".alert-block");L.equal(e.length,0,e.text()),t()}))})),it("should preserve itext values on load + save",(function(){s.A.loadXML(""),s.A.addQuestion("Text","question1"),r.Ay.each(["image","audio","video","video-inline"],(function(t){i()(".btn.itext-block-label-add-form-"+t).click(),i()(".btn.itext-block-constraintMsg-add-form-"+t).click(),i()(".btn.itext-block-help-add-form-"+t).click()})),i()(".btn:contains(long)").click(),i()(".btn:contains(short)").click(),i()(".btn:contains(custom)").click(),i()(".fd-modal-generic-container").find("input").val("custom"),i()(".fd-modal-generic-container").find(".btn:contains(Add)").click(),i()("[name='itext-en-label']").val("question1 en label").change(),i()("[name='itext-hin-label']").val("question1 hin label").change(),i()("[name='itext-en-constraintMsg']").val("question1 en validation").change(),i()("[name='itext-hin-constraintMsg']").val("question1 hin validation").change(),i()("[name='itext-en-hint']").val("question1 en hint").change(),i()("[name='itext-hin-hint']").val("question1 hin hint").change(),i()("[name='itext-en-help']").val("question1 en help").change(),i()("[name='itext-hin-help']").val("question1 hin help").change(),i()("[name='itext-en-label-long']").val("question1 en long").change(),i()("[name='itext-hin-label-long']").val("question1 hin long").change(),i()("[name='itext-en-label-short']").val("question1 en short").change(),i()("[name='itext-hin-label-short']").val("question1 hin short").change(),i()("[name='itext-en-label-custom']").val("question1 en custom").change(),i()("[name='itext-hin-label-custom']").val("question1 hin custom").change(),s.A.assertXmlEqual(I("createXML"),j,{normalize_xmlns:!0})})),it("should prefer alert over constraintMsg",(function(){s.A.loadXML(y),s.A.assertXmlEqual(I("createXML"),j,{normalize_xmlns:!0})})),it("should convert constraintMsg to alert",(function(){s.A.loadXML('<h:html xmlns:h="http://www.w3.org/1999/xhtml"\n\txmlns:orx="http://openrosa.org/jr/xforms"\n\txmlns="http://www.w3.org/2002/xforms"\n\txmlns:xsd="http://www.w3.org/2001/XMLSchema"\n\txmlns:jr="http://openrosa.org/javarosa"\n\txmlns:vellum="http://commcarehq.org/xforms/vellum"\n\tvellum:ignore="richText">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n\t\t\t\t\txmlns="http://openrosa.org/formdesigner/8D6CF8A5-4396-45C3-9D05-64C3FD97A5D0"\n\t\t\t\t\tuiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1/>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="/data/question1" type="xsd:string" \n\t\t\t\tjr:constraintMsg="jr:itext(\'question1-constraintMsg\')" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 en label</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="long">question1 en long</value>\n\t\t\t\t\t\t<value form="short">question1 en short</value>\n\t\t\t\t\t\t<value form="custom">question1 en custom</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-hint">\n\t\t\t\t\t\t<value>question1 en hint</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>question1 en help</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/help/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/help/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/help/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/help/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>question1 en validation</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/constraintMsg/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/constraintMsg/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 hin label</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="long">question1 hin long</value>\n\t\t\t\t\t\t<value form="short">question1 hin short</value>\n\t\t\t\t\t\t<value form="custom">question1 hin custom</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-hint">\n\t\t\t\t\t\t<value>question1 hin hint</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>question1 hin help</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/help/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/help/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/help/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/help/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-constraintMsg">\n\t\t\t\t\t\t<value>question1 hin validation</value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/constraintMsg/data/question1.png</value>\n\t\t\t\t\t\t<value form="audio">jr://file/commcare/audio/constraintMsg/data/question1.mp3</value>\n\t\t\t\t\t\t<value form="video">jr://file/commcare/video/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t\t<value form="video-inline">jr://file/commcare/video-inline/constraintMsg/data/question1.3gp</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')"/>\n\t\t\t<hint ref="jr:itext(\'question1-hint\')"/>\n\t\t\t<help ref="jr:itext(\'question1-help\')"/>\n\t\t</input>\n\t</h:body>\n</h:html>\n'),s.A.assertXmlEqual(I("createXML"),j,{normalize_xmlns:!0})})),it("should correctly set alert's auto id",(function(){s.A.loadXML(y);var t=s.A.getMug("question1");L(t.p.constraintMsgItext.autoId)})),it("itext widget should change as default language value changes when equal",(function(){s.A.loadXML(A),s.A.addQuestion("Text","temp"),s.A.clickQuestion("question1");var t=i()("[name='itext-en-label']"),e=i()("[name='itext-hin-label']");t.val("English").change(),L.equal(t.val(),"English"),L.equal(e.val(),"English"),s.A.clickQuestion("temp"),s.A.clickQuestion("question1"),t=i()("[name='itext-en-label']"),e=i()("[name='itext-hin-label']"),L.equal(t.val(),"English"),L.equal(e.val(),"English")})),it("itext widget should be blank when empty",(function(){s.A.loadXML(A),s.A.addQuestion("Text","temp"),s.A.clickQuestion("question1");var t=i()("[name='itext-en-label']"),e=i()("[name='itext-hin-label']");t.val("").change(),L.equal(t.val(),""),L.equal(e.val(),""),s.A.clickQuestion("temp"),s.A.clickQuestion("question1"),t=i()("[name='itext-en-label']"),e=i()("[name='itext-hin-label']"),L.equal(t.val(),""),L.equal(e.val(),"")})),it("non-labelItext widget should allow non default language to be blank",(function(){s.A.loadXML(q),s.A.clickQuestion("text");var t=i()("[name='itext-en-constraintMsg']"),e=i()("[name='itext-hin-constraintMsg']");e.val("").change(),L.equal(t.val(),"English"),L.equal(e.val(),""),t.val("").change(),L.equal(t.val(),""),L.equal(e.val(),"")})),it("should display correct language for question that was collapsed when language changed",(function(){s.A.loadXML("");var t=s.A.addQuestion("Group","group");s.A.addQuestion("Text","question2"),s.A.clickQuestion("group/question2"),i()("[name='itext-en-label']").val("english").change(),i()("[name='itext-hin-label']").val("hindi").change(),s.A.collapseGroup(t),L.equal(i()(".fd-question-tree .jstree-anchor").length,1),i()(".fd-question-tree-display").val("hin").change(),s.A.expandGroup(t),L.equal(i()(".fd-question-tree .jstree-anchor:last").text(),"hindi")})),it("itext widget should not overwrite label with question id",(function(){s.A.loadXML("");var t=s.A.addQuestion("Text");s.A.addQuestion("Text"),s.A.clickQuestion("question1"),i()("[name='itext-en-label']").val("English").change(),t.p.nodeID="newid",s.A.clickQuestion("question2"),s.A.clickQuestion("newid");var e=i()("[name='itext-en-label']"),n=i()("[name='itext-hin-label']");L.equal(e.val(),"English"),L.equal(n.val(),"English")})),it("tree should note when default language is being displayed instead of selected language",(function(){s.A.loadXML(""),s.A.addQuestion("Text","question1"),s.A.clickQuestion("question1"),i()("[name='itext-en-label']").val("english").change();var t=".fd-question-tree .jstree-anchor";L.equal(i()(t).text(),"english"),i()(".fd-question-tree-display").val("hin").change(),L.equal(i()(t).text(),"english [en]"),i()("[name='itext-hin-label']").val("hindi").change(),L.equal(i()(t).text(),"hindi")})),it("should not fire lost of events for every mug on change label",(function(){var t=s.A.loadXML(""),e={q1:0,q2:0};t.on("question-label-text-change",(function(t){e[t.mug.p.nodeID]++})),s.A.paste([["id","type"],["/q1","Text"],["/q2","Text"]]),s.A.clickQuestion("q2"),i()("[name='itext-en-label']").val("english").change(),L.deepEqual(e,{q1:0,q2:1})})),it("non-labelItext widget should contain value on load",(function(){s.A.loadXML(q),s.A.clickQuestion("text"),L.equal(i()("[name='itext-en-constraintMsg']").val(),"English"),L.equal(i()("[name='itext-hin-constraintMsg']").val(),"Hindi")})),it("should enable save button on itext label change",(function(){s.A.loadXML(x),s.A.saveButtonEnabled(!1),s.A.clickQuestion("question1"),L(!s.A.saveButtonEnabled(),"click should not cause change"),i()("[name='itext-en-label']").val("new").change(),L(s.A.saveButtonEnabled(),"save button is disabled")})),it("should enable save button on itext constraintMsg change",(function(){s.A.loadXML(x),s.A.saveButtonEnabled(!1),s.A.clickQuestion("question1"),L(!s.A.saveButtonEnabled(),"click should not cause change"),i()("[name='itext-hin-constraintMsg']").val("new").change(),L(s.A.saveButtonEnabled(),"save button is disabled")})),it("should escape inequality operators in output ref",(function(){s.A.loadXML(p);var t=s.A.getMug("product");L.equal(t.p.labelItext.get(),"<output value=\"if(1 < 2 or 2 > 3 or 3 <= 3 or 4 >= 5, 'product', 'other')\" />"),s.A.assertXmlEqual(I("createXML"),p,{normalize_xmlns:!0})})),it("should only update exact output ref matches when question ids change (word boundary)",(function(){s.A.loadXML(""),s.A.addQuestion("Text","load-one");var t=s.A.addQuestion("Trigger","label"),e=s.A.addQuestion("Text","text2");t.p.labelItext.set('<output value="/data/load-one" />'),t.validate("labelItext"),e.p.nodeID="load",e.p.nodeID="load-two",L.equal(t.p.labelItext.get(),'<output value="/data/load-one" />')})),it("itext changes do not bleed back after copy",(function(t){s.A.loadXML("");var e=s.A.addQuestion("Text","question");e.form.duplicateMug(e).p.labelItext.set("q2"),s.A.saveAndReload((function(){var e=I("getMugByPath","/data/question");L.equal(e.p.labelItext.defaultValue(),""),t()}))})),it("itext changes do not bleed back from copy of copy",(function(t){s.A.loadXML("");var e=s.A.addQuestion("Text","question"),n=e.form.duplicateMug(e);e.form.duplicateMug(n).p.labelItext.set("copy"),s.A.saveAndReload((function(){var e=I("getMugByPath","/data/question"),n=I("getMugByPath","/data/copy-1-of-question"),a=I("getMugByPath","/data/copy-2-of-question");L.equal(e.p.labelItext.defaultValue(),""),L.equal(n.p.labelItext.defaultValue(),""),L.equal(a.p.labelItext.defaultValue(),"copy"),t()}))})),it("drag question into label makes output ref in correct position",(function(){s.A.loadXML("");var t=s.A.addQuestion("Text","question1"),e=s.A.addQuestion("Text","question2"),n=i()("[name='itext-en-label']");n.val("test string").change(),v().setCaretPosition(n[0],4),I("handleDropFinish",n,t.absolutePath,t);var a=e.p.labelItext.get("default","en");L.equal(a,'test<output value="#form/question1" /> string'),L.equal(n.val(),'test<output value="/data/question1" /> string')})),it("output ref deleted with single backspace",(function(){s.A.loadXML("");var t=s.A.addQuestion("Text","question1"),e=i()("[name='itext-en-label']");e.val('question1 <output value="/data/question2" /> end').change(),v().setCaretPosition(e[0],44),e.trigger({type:"keydown",which:8,ctrlKey:!1}),e.change();var n=t.p.labelItext.get("default","en");L.equal(n,"question1  end")})),it("output ref deleted with single delete keypress",(function(){s.A.loadXML("");var t=s.A.addQuestion("Text","question1"),e=i()("[name='itext-en-label']");e.val('question1 <output value="/data/question2" /> end').change(),v().setCaretPosition(e[0],10),e.trigger({type:"keydown",which:46,ctrlKey:!1}),e.change();var n=t.p.labelItext.get("default","en");L.equal(n,"question1  end")})),it("should update output ref on group rename",(function(){s.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/F8FD5842-815C-4DE5-9E27-BB623064695F" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<question2>\n\t\t\t\t\t\t<question3 />\n\t\t\t\t\t</question2>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="/data/question1" type="xsd:string" />\n\t\t\t<bind nodeset="/data/question2" />\n\t\t\t<bind nodeset="/data/question2/question3" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 <output value="/data/question2/question3"></output></value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value>group</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2/question3-label">\n\t\t\t\t\t\t<value>question3</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1 <output value="/data/question2/question3"></output></value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2-label">\n\t\t\t\t\t\t<value>group</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question2/question3-label">\n\t\t\t\t\t\t<value>question3</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t\t<group ref="/data/question2">\n\t\t\t<label ref="jr:itext(\'question2-label\')" />\n\t\t\t<input ref="/data/question2/question3">\n\t\t\t\t<label ref="jr:itext(\'question2/question3-label\')" />\n\t\t\t</input>\n\t\t</group>\n\t</h:body>\n</h:html>\n');var t=s.A.call("getMugByPath","/data/question2"),e=s.A.call("getMugByPath","/data/question1").p.labelItext;L(e.get().indexOf('"#form/question2/question3"')>0,'"#form/question2/question3" not in '+e.get()),t.p.nodeID="group",L(e.get("default","en").indexOf('"#form/group/question3"')>0,'"#form/group/question3" not in '+e.get("default","en")),L(e.get("default","hin").indexOf('"#form/group/question3"')>0,'"#form/group/question3" not in '+e.get("default","hin"))})),it("should add warning on add Audio output ref to itext",(function(){s.A.loadXML("");var t=s.A.addQuestion("Audio","audio"),e=s.A.addQuestion("Text","text"),n=i()("[name='itext-en-label']");I("handleDropFinish",n,t.absolutePath,t),o().expect(s.A.getMessages(e)).to.include("Audio Capture nodes cannot be used in an output value")})),it("should bulk update multi-line translation",(function(){var t=s.A.loadXML(x),e=s.A.call("getData").javaRosa.Itext;h().parseXLSItext(t,'label\tdefault-en\tdefault-hin\nquestion1-label\t"First ""line\nSecond"" line\nThird line"\tHindu trans\n',e);var n=s.A.getMug("question1");L.equal(n.p.labelItext.get("default","en"),'First "line\nSecond" line\nThird line'),L.equal(n.p.labelItext.get("default","hin"),"Hindu trans")})),it("should not get stuck on bulk update non-existent questions",(function(){var t=s.A.loadXML(""),e=s.A.call("getData").javaRosa.Itext;h().parseXLSItext(t,"label\tdefault-en\tdefault-hin\nquestion1-label\tlabel\tHindu trans\n",e),L(!s.A.getMug("question1"),"question1 should not exist")})),it("should generate bulk multi-line translation with user-friendly newlines",(function(){var t=s.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/D2AEA80D-D518-430A-924B-39D1AE2207F8" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>First "line\nSecond" line\nThird line</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>Hindu trans</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n'),e=s.A.call("getData").javaRosa.Itext;L.equal(h().generateItextXLS(t,e),'label\tdefault_en\tdefault_hin\taudio_en\taudio_hin\timage_en\timage_hin\tvideo_en\tvideo_hin\tvideo-inline_en\tvideo-inline_hin\nquestion1-label\t"First ""line\nSecond"" line\nThird line"\tHindu trans\t\t\t\t\t\t\t\t')})),it("should escape all languages when generating bulk translations",(function(){var t=s.A.loadXML(f),e=s.A.call("getData").javaRosa.Itext;L.equal(h().generateItextXLS(t,e),'label\tdefault_en\tdefault_hin\taudio_en\taudio_hin\timage_en\timage_hin\tvideo_en\tvideo_hin\tvideo-inline_en\tvideo-inline_hin\ntext-label\t"""Text"\t"""Text"\t\t\t\t\t\t\t\t')})),it("bulk translation tool should not create empty itext forms",(function(){var t=s.A.loadXML(x),e=s.A.call("getData").javaRosa.Itext;h().parseXLSItext(t,'label\tdefault-en\tdefault-hin\taudio-en\taudio-hin\nquestion1-label\t"First ""line\nSecond"" line\nThird line"\t\t\t\n',e);var n=s.A.getMug("question1");L.equal(n.p.labelItext.get("default","en"),'First "line\nSecond" line\nThird line'),L.equal(n.p.labelItext.get("default","hin"),""),L(!n.p.labelItext.hasForm("audio"),"unexpected form: audio")})),it("bulk translation tool should enable the save button on update",(function(){var t=s.A.loadXML(x);s.A.saveButtonEnabled(!1);var e=s.A.call("getData").javaRosa.Itext;h().parseXLSItext(t,'label\tdefault-en\tdefault-hin\taudio-en\taudio-hin\nquestion1-label\t"First ""line\nSecond"" line\nThird line"\t\t\t\n',e),L(s.A.saveButtonEnabled(),"save button not enabled")})),it("should highlight label after tab",(function(){s.A.loadXML(M),s.A.clickQuestion("question1");var t=i()("[name='itext-en-label']"),e=i()("[name='itext-hin-label']"),n=i().Event("keyup");n.which=9,t.val("test string").change(),t.trigger(n),e.val("hin test string").change(),e.trigger(n),L.equal(t[0].selectionStart,0),L.equal(t[0].selectionEnd,11),L.equal(e[0].selectionStart,0),L.equal(e[0].selectionEnd,15)})),it("should not highlight label on focus",(function(){s.A.loadXML(M),s.A.clickQuestion("question1");var t=i()("[name='itext-en-label']"),e=i()("[name='itext-hin-label']");t.val("test string").change(),t.focus(),e.val("hin test string").change(),e.focus(),L.equal(t[0].selectionStart,t[0].selectionEnd),L.equal(e[0].selectionStart,e[0].selectionEnd)})),it("should not create duplicate <help> node on select",(function(){s.A.loadXML(w);var t=I("createXML"),e=s.A.parseXML(t);L.strictEqual(e.find("help").length,1,"wrong <help> node count\n"+t)})),it("should not auto-update itext ID when multiple questions point to auto-ish-id",(function(){s.A.loadXML(b),s.A.getMug("north").p.nodeID="west";var t=I("createXML"),e=s.A.parseXML(t);L.strictEqual(e.find("text#north-label").length,2,"wrong <text> node count\n"+t)})),it("should unlink auto itext id from other questions with shared itext",(function(){s.A.loadXML(b),L.equal(i()(b).find("text#south-label").length,0,"wrong <text#south> node count\n"+b),s.A.clickQuestion("south"),i()("[name='property-labelItext']").closest(".form-group").find("input[type=checkbox]").prop("checked",!0).change(),i()("[name='itext-en-label']").val("south").change(),L.equal(s.A.getMug("north").p.labelItext.get(),"north"),L.equal(s.A.getMug("south").p.labelItext.get(),"south");var t=I("createXML"),e=s.A.parseXML(t);L.equal(e.find("text#north-label").length,2,"wrong <text#north> node count\n"+t),L.equal(e.find("text#south-label").length,2,"wrong <text#south> node count\n"+t)})),r.Ay.each(["hint","help","constraintMsg"],(function(t){it("should not serialize empty "+t+" itext item with non-empty id and autoId = true",(function(){s.A.loadXML("");var e=s.A.addQuestion("Text").p[t+"Itext"];e.id=t,e.autoId=!0;var n=I("createXML"),a=s.A.parseXML(n);"constraintMsg"===t?L.strictEqual(a.find("[jr\\:"+t+"]").length,0,"wrong "+t+" count\n"+n):L.strictEqual(a.find(t).length,0,"wrong <"+t+"> node count\n"+n)}))})),it("should not allow apostrophes in item labels",(function(){s.A.loadXML(""),s.A.addQuestion("Select","select"),s.A.addQuestion("Choice","choice1"),s.A.clickQuestion("select/choice1"),i()("[name='property-nodeID']").val("blah ' blah").change(),L.strictEqual(i()("[name='property-labelItext']").val(),"select-blah___blah-label")})),it("should not allow > in item labels",(function(){s.A.loadXML(""),s.A.addQuestion("Select","select"),s.A.addQuestion("Choice","choice1"),s.A.clickQuestion("select/choice1"),i()("[name='property-nodeID']").val("blah > blah").change(),L.strictEqual(i()("[name='property-labelItext']").val(),"select-blah___blah-label")})),it("should not change with node id when blank",(function(){s.A.loadXML(""),s.A.addQuestion("Text","text"),s.A.clickQuestion("text"),i()("[name=itext-en-label]").val("").change(),i()("[name=itext-hin-label]").val("").change(),i()("[name=property-nodeID]").val("nodeid").change(),L.strictEqual(i()("[name=itext-en-label]").val(),""),L.strictEqual(i()("[name=itext-hin-label]").val(),"")}))})),describe("The javaRosaplugin with one language",(function(){before((function(t){s.A.init({javaRosa:{langs:["en"]},core:{onReady:function(){t()}}})})),it("should allow a value to be blank",(function(){s.A.loadXML(""),s.A.addQuestion("Trigger","label"),s.A.clickQuestion("label"),i()("[name=itext-en-label]").val("blah").change(),i()(".itext-block-label-add-form-image").click(),i()("[name=itext-en-label]").val("").change(),s.A.assertXmlEqual(I("createXML"),'<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/0423112D-4950-4768-B59F-A4E4616FF73D" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<label />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/label" nodeset="/data/label" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="label-label">\n\t\t\t\t\t\t<value></value>\n\t\t\t\t\t\t<value form="image">jr://file/commcare/image/data/label.png</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<trigger vellum:ref="#form/label" ref="/data/label" appearance="minimal">\n\t\t\t<label ref="jr:itext(\'label-label\')" />\n\t\t</trigger>\n\t</h:body>\n</h:html>\n',{normalize_xmlns:!0})})),it("should not error on form with output without value",(function(){s.A.loadXML(g);var t=s.A.getMug("output");L.equal(t.p.labelItext.get(),"x <output /> x"),s.A.assertXmlEqual(I("createXML"),g)}))})),describe("The javaRosa plugin itext widgets",(function(){var t,e,n,a;function o(o){describe("itext id validation",(function(){var l;before((function(){l=["addCaptionItext","addEmptyCaptionItext"].indexOf(o)>-1?e:t,n=l.p[o],a=l.spec[o]})),it("should not display "+o+" validation error for autoId itext",(function(){var t=n.id;n.autoId=!0,L(n.id,o+".id should have a value"),L.equal(a.validationFunc(l),"pass"),n.id="";try{L.equal(a.validationFunc(l),"pass")}finally{n.id=t}})),it("should display "+o+" validation error for non-autoId non-empty itext with blank ID",(function(){var t=[n.id,n.get()];n.autoId=!1,n.id="",n.set("not empty");try{L.notEqual(a.validationFunc(l),"pass",o)}finally{n.id=t[0],n.set(t[1])}})),it("should not display "+o+" validation error for non-autoId empty itext with blank ID",(function(){var t=[n.id,n.get()];n.autoId=!1,n.id="",n.set("");try{L.equal(a.validationFunc(l),"pass")}finally{n.id=t[0],n.set(t[1])}})),it("should not display "+o+" validation error for non-autoId valid itext id",(function(){var t=[n.id,n.get(),l.p.constraintAttr];"constraintMsgItext"===o&&(l.p.constraintAttr="x = y"),n.autoId=!1,n.id="node-id-label-itext",n.set("node-id-label-itext");try{L.equal(a.validationFunc(l),"pass")}finally{n.id=t[0],n.set(t[1]),l.p.constraintAttr=t[2]}})),it("should display "+o+" validation error for non-autoId invalid itext id",(function(){var t=[n.id,n.get(),l.p.constraintAttr];"constraintMsgItext"===o&&(l.p.constraintAttr="x = y"),n.autoId=!1,n.id="node-id-label-itext'&",n.set("node-id-label-itext'&");try{L.notEqual(a.validationFunc(l),"pass",o)}finally{n.id=t[0],n.set(t[1]),l.p.constraintAttr=t[2]}})),it("should not have "+o+"ID validator (it will not be invoked)",(function(){L(!l.spec[o+"ID"].validationFunc,o+"ID virtual property validator will not be invoked")}))}))}before((function(n){s.A.init({features:{rich_text:!1,use_custom_repeat_button_text:!0},javaRosa:{langs:["en"]},core:{onReady:function(){var a=s.A.loadXML(""),o=a.vellum.data.javaRosa.Itext;t=s.A.addQuestion("Text"),e=s.A.addQuestion("Repeat"),h().parseXLSItext(a,"",o),n()}}})})),it("should detect whether or not readable itext labels are present",(function(){var t=new(d().model),e=new(d().item)({itextModel:t});L(!e.hasHumanReadableItext(),"No recognized forms"),e.addForm("short"),L(e.hasHumanReadableItext(),"Recognized form"),t.addLanguage("en"),L(!e.hasHumanReadableItext(),"No English text"),e.getForm("short").setValue("en","thing"),L(e.hasHumanReadableItext(),"Has English text"),t.addLanguage("hin"),L(!e.hasHumanReadableItext(),"No Hindi text")})),o("labelItext"),o("hintItext"),o("helpItext"),o("constraintMsgItext"),o("addEmptyCaptionItext"),o("addCaptionItext"),it("should display constraintMsgItext validation error for non-autoId itext without validation condition",(function(){var e=t.p.constraintMsgItext,n=t.spec.constraintMsgItext,a=t.p.constraintAttr;e.autoId=!1,t.p.constraintAttr="";try{L(e.id,"constraintMsgItext.id should have a value"),L.equal(n.validationFunc(t),"Can't have a Validation Message Itext ID without a Validation Condition")}finally{t.p.constraintAttr=a}})),it("should not display constraintMsgItext validation error for autoId itext with validation condition",(function(){var e=t.p.constraintMsgItext,n=t.spec.constraintMsgItext,a=t.p.constraintAttr;e.autoId=!0,t.p.constraintAttr="x = y";try{L.equal(n.validationFunc(t),"pass")}finally{t.p.constraintAttr=a}})),it("should not display constraintMsgItext validation error after removing validation message and condition",(function(){s.A.loadXML(""),s.A.paste([["id","type","constraintMsgItext:en-default","constraintAttr","constraintMsgAttr"],["/text","Text","message!",". = 'a'","jr:itext('question1-constraintMsg')"]]),i()("[name='itext-en-constraintMsg']").val("").change(),i()("[name='property-constraintAttr']").val("").change();var t=i()("[name='property-constraintAttr']").siblings(".messages").text();L(!t,"unexpected message: "+t)})),it("should show and hide the validation message as appropriate",(function(){s.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/4f203b784b4f49328949420c7047ebaf091774e6" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t\t<Group />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" />\n\t\t\t<bind vellum:nodeset="#form/Group" nodeset="/data/Group" relevant="true()" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>This is a label.</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<trigger vellum:ref="#form/question1" ref="/data/question1" appearance="minimal">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t</trigger>\n\t\t<group vellum:ref="#form/Group" ref="/data/Group" />\n\t</h:body>\n</h:html>\n'),i()("[name='property-constraintAttr']").val("true()").change(),i()("[name='itext-en-constraintMsg']").val("This is not possible").change(),L(i()("[name='itext-en-constraintMsg']").is(":visible")),i()("[name='itext-en-constraintMsg']").val("").change(),i()("[name='property-constraintAttr']").val("").change(),L(!i()("[name='itext-en-constraintMsg']").is(":visible"))})),it("should show a validation error when dropping a self reference",(function(){s.A.loadXML("");var t=s.A.addQuestion("Text","question1"),e="itext-en-label";s.A.clickQuestion("question1"),L.deepEqual(t.messages.get(e),[]),t.form.vellum.handleDropFinish(i()("[name="+e+"]"),".",t),L.equal(t.messages.get(e).length,1,s.A.getMessages(t)),t.dropMessage(e,"core-circular-reference-warning"),L.deepEqual(t.messages.get(e),[])})),it("should show a validation error for choices without labels",(function(){s.A.loadXML(""),s.A.addQuestion("Select","question1");var t=s.A.addQuestion("Choice","choice1");s.A.clickQuestion("question1/choice1");var e=t.messages.get("labelItext");L.equal(e.length,0),i()("[name='itext-en-label']").val("").change(),e=t.messages.get("labelItext"),L.equal(e.length,1),L(e[0].match(/required/i))})),it("should not show a validation error for manually added choices",(function(){s.A.loadXML(""),s.A.addQuestion("Select","question1");var t=s.A.addQuestion("Choice","choice1");s.A.clickQuestion("question1/choice1");var e=t.messages.get("labelItext");L.equal(e.length,0),s.A.clickQuestion("question1"),s.A.addQuestion("Choice","choice3"),e=t.messages.get("labelItext"),L.equal(e.length,0)})),it("should replace output values with $ on mug rename",(function(){s.A.loadXML(""),s.A.addQuestion("Text","text"),s.A.addQuestion("Text","text2"),s.A.clickQuestion("text"),i()("[name=itext-en-label]").val("<output value=\"regex(/data/text2, '$[0-9]+.[0-9]$')\" />").change(),s.A.clickQuestion("text2"),i()("[name=property-nodeID]").val("text3").change(),s.A.clickQuestion("text"),L.strictEqual(i()("[name=itext-en-label]").val(),"<output value=\"regex(/data/text3, '$[0-9]+.[0-9]$')\" />")}))})),describe("The javaRosa markdown detector",(function(){r.Ay.each(["**Word!**","**a bold phrase**"],(function(t){it("should recognize "+JSON.stringify(t),(function(){L(h().looksLikeMarkdown(t,!1),"fail")}))}));var t="| col1    | col2    | col3 |\n|:----:|:----:|:----:|\n| r1c1 | r1c2 | r1c3 |";it("should detect a markdown table"+JSON.stringify(t),(function(){L(h().looksLikeMarkdown(t,!0),"fail")})),it("should not detect a markdown table since supportMarkdown is false"+JSON.stringify(t),(function(){L(!h().looksLikeMarkdown(t,!1),"fail")})),r.Ay.each(["**not\nbold**"],(function(t){it("should NOT recognize "+JSON.stringify(t),(function(){L(!h().looksLikeMarkdown(t,!1),"fail")}))}))})),describe("The javaRosa plugin language selector",(function(){before((function(t){s.A.init({features:{rich_text:!1},javaRosa:{langs:["en"]},core:{onReady:function(){t()}}})})),it("should have option to display IDs",(function(){s.A.loadXML(""),s.A.addQuestion("Text","question1"),s.A.clickQuestion("question1");var t=i()(".fd-question-tree-display"),e=".fd-question-tree .jstree-anchor";i()("[name='itext-en-label']").val("x").change(),L.equal(i()(e).text(),"x"),i()("[name='itext-en-label']").val("").change(),L.equal(i()(e).text(),"question1"),t.val("en").change(),i()("[name='itext-en-label']").val("english").change(),L.equal(i()(e).text(),"english"),t.val("_ids").change(),L.equal(i()(e).text(),"question1")})),it("should only display once after multiple load xml",(function(){L.strictEqual(i()('.fd-questions-menu li:contains("Display")').length,1),s.A.loadXML(""),L.strictEqual(i()('.fd-questions-menu li:contains("Display")').length,1),s.A.loadXML(""),L.strictEqual(i()('.fd-questions-menu li:contains("Display")').length,1)}))})),describe("show only current language for translations",(function(){before((function(t){s.A.init({features:{rich_text:!1},javaRosa:{langs:["en","hin","tel"],showOnlyCurrentLang:!0,displayLanguage:"en"},core:{onReady:function(){t()}}})})),it("should change the property on javaRosa",(function(){L.equal(s.A.call("getData").javaRosa.showOnlyCurrentLang,!0)})),describe("when current language same as default language",(function(){it("should just show translation for the current display language",(function(){L.equal(s.A.call("getData").core.currentItextDisplayLanguage,"en"),L.equal(s.A.call("getData").javaRosa.Itext.defaultLanguage,"en"),s.A.loadXML(A),s.A.clickQuestion("question1"),L.equal(i()("[name='itext-en-label']").length,1),L.equal(i()("[name='itext-hin-label']").length,0)}))})),describe("when current display language not same as default language",(function(){describe("when current display language is one of the app langs",(function(){before((function(t){s.A.init({features:{rich_text:!1},javaRosa:{langs:["en","hin","tel"],showOnlyCurrentLang:!0,displayLanguage:"tel"},core:{onReady:function(){t()}}})})),it("should show translation for both current and default language",(function(){L.equal(s.A.call("getData").core.currentItextDisplayLanguage,"tel"),L.equal(s.A.call("getData").javaRosa.Itext.defaultLanguage,"en"),s.A.loadXML(A),s.A.clickQuestion("question1"),L.equal(i()("[name='itext-en-label']").length,1),L.equal(i()("[name='itext-hin-label']").length,0),L.equal(i()("[name='itext-tel-label']").length,1)}))})),describe("when current display language is not one of the app langs",(function(){before((function(t){s.A.init({features:{rich_text:!1},javaRosa:{langs:["en","hin","tel"],showOnlyCurrentLang:!0,displayLanguage:"_ids"},core:{onReady:function(){t()}}})})),it("should just show translation for the default language",(function(){L.equal(s.A.call("getData").core.currentItextDisplayLanguage,"_ids"),L.equal(s.A.call("getData").javaRosa.Itext.defaultLanguage,"en"),s.A.loadXML(A),s.A.clickQuestion("question1"),L.equal(i()("[name='itext-en-label']").length,1),L.equal(i()("[name='itext-hin-label']").length,0),L.equal(i()("[name='itext-tel-label']").length,0)}))}))}))}))},1134:(t,e,n)=>{n.d(e,{A:()=>k});var a=n(8449),o=n(8324),l=n.n(o),i=n(6848),r=n.n(i),s=n(3794),u=n(4523),d=n(561),m=n.n(d),h=n(1437),c=n.n(h),v=n(3809),g=n.n(v),x=n(705),f=n.n(x),p=n(7229),q=n.n(p),b=(n(1460),n(8803),l().assert),w=["Form Builder clip","version 1"];function A(t,e,n){if((n=u.Ay.defaults(n||{},{normalize_xmlns:!1,not:!1})).normalize_xmlns){var a=q().parseXML(e).find("data").attr("xmlns");t=t.replace(/(data[^>]+xmlns=")(.+?)"/,"$1"+a+'"')}var o,l,i,s,d=(o=t,l=e,i=r().xml(o),s=r().xml(l),r().isEquivalent(i,s,{element_order:!0}));n.not&&(d=!d),d||j(t=y(t),e=y(e),"XML "+(n.not?"should not be equivalent":"mismatch"))}function j(t,e,n){if(t!==e){var a=(0,s.createPatch)("",t,e,"actual","expected");a=a.replace(/^Index:/,n||"Not equal:"),b(!1,function(t){var e={"-":31,"+":32};return t.replace(/^.+?$/gm,(function(t){return"["+(e[t[0]]||0)+"m"+t+"[0m"}))}(a))}}function y(t){return(t=t.replace(/^\t+/gm,(function(t){return t.replace(/\t/g,"  ")}))).match(/\n$/)||(t+="\n"),t}function M(t){return I("getCurrentMugInput",t)}function L(t){var e=m()("#vellum").vellum("get"),n=u.Ay.isString(t)?m()("[name="+t+"]"):t;return f().util.getWidget(n,e)}function I(){var t=Array.prototype.slice.call(arguments),e=m()("#vellum");return e.vellum.apply(e,t)}function X(){var t=[],e=u.Ay.map(arguments,(function(e){var n=u.Ay.isString(e)?F(e):e;if(!n||!n.ufid)throw new Error("mug not found: "+e);return t.push(n),n.ufid}));return I("jstree","deselect_all",!0),I("jstree","select_node",e),m()(".collapse-toggle.collapsed").click(),t}function F(t){0!==t.indexOf("/")&&(t="/data/"+t);var e=I("getMugByPath",t);if(!e){var n=t.split("/"),a=I("getMugByPath",n.slice(0,-1).join("/"));if(a&&a.__className.indexOf("Select")>-1){var o=I("getData").core.form.getChildren(a),l=n[n.length-1];if(1===o.length&&"itemset"===l&&"itemset"===o[0].options.tagName)return o[0];for(var i=0;i<o.length;i++)if(o[i].p.nodeID===l)return o[i]}}return e}b.equal=b.strictEqual,b.notEqual=b.notStrictEqual;const k={options:a.A,asyncatch:function(t){return function(){try{var e=Array.prototype.slice.call(arguments);return t.apply(this,e)}catch(t){throw t&&t.stack?new Error(t.stack):t}}},init:function(t){t=t||{};var e=m().extend(!0,{},a.A.options,t),n=m().fn.animate;m().fn.animate=function(t,e,a,o){n.apply(this,[t,0,a,o])},t.javaRosa&&t.javaRosa.langs&&(e.javaRosa.langs=t.javaRosa.langs),e.plugins=u.Ay.without(e.plugins,"atwho"),t.plugins&&(e.plugins=t.plugins),e&&e.features&&u.Ay.isUndefined(e.features.disable_popovers)&&(e.features.disable_popovers=!0),e.core=e.core||{};var o=e.core.saveUrl||function(){};e.core.saveUrl=function(t){return t.xform,o(t)};var l=m()("#vellum"),i=l.vellum("get");i&&(i.destroy(),m()("body > div.modal, body > div.modal-backdrop").remove()),l.empty().vellum(e)},call:I,loadXML:function(t,e,n,a,o=!0){var l=[],i=I("getData");return a||window.history.replaceState(null,null," "),i.core.parseWarnings=[],I("loadXML",t,e||{},{reset:o}),n?u.Ay.isRegExp(n)&&(l=u.Ay.filter(i.core.parseWarnings,(function(t){return!n.test(t)}))):l=i.core.parseWarnings,b(!l.length,"unexpected parse warnings:\n- "+l.join("\n- ")),delete i.core.parseWarnings,i.core.form},saveAndReload:function(t){I("loadXFormOrError",I("createXML"),t)},getMug:F,getInput:M,getWidget:L,getMediaUploader:function(t){var e,n={},a=L(t);if(!a)throw new Error("media uploader widget not found");if(u.Ay.find([".widget[data-hqmediapath]",".itext-block-container"],(function(n){return(e=t.closest(n)).length})),!e)throw new Error("media uploader element not found");return n.upload=function(t){var n={ref:{path:a.getRandomizedMediaPath(t)},errors:[]};e.trigger("mediaUploadComplete",n)},n},assertEqual:j,assertInputCount:function(t,e,n){u.Ay.isString(t)?(n=" for "+(n?n+" ":"")+t,t=M(t)):n=n?" for "+n:"",b.equal(t.length,e,"wrong number of inputs"+n)},assertXmlEqual:A,assertXmlNotEqual:function(t,e,n){(n=n||{}).not=!0,A(t,e,n)},assertJSTreeState:function(){var t=Array.prototype.slice.call(arguments).join("\n")+"\n";j(function t(e,n){var a,o,l,i=[];for("#"===e.id?n=-1:i.push(Array(2*n+1).join(" ")+e.text),a=0,o=e.children.length;a<o;a++)l=I("jstree","get_node",e.children[a]),i.push(t(l,n+1));return i.join("\n")}(I("jstree","get_node","#"))+"\n",t,"Unexpected jstree state")},assertTreeState:function(t){var e=Array.prototype.slice.call(arguments,1).join("\n")+"\n";j(function t(e,n){var a,o,l,i=[];for(e.isRootNode?n=-1:i.push(Array(2*n+1).join(" ")+e.value.p.nodeID),a=0,o=e.children.length;a<o;a++)l=e.children[a],i.push(t(l,n+1));return i.join("\n")}(t.rootNode,0)+"\n",e,"Unexpected tree state")},addQuestion:function(t,e,n){n=u.Ay.extend({},n),this.prevId&&X(this.prevId);var a=I("addQuestion",t);return e||a.p.nodeID||(e=I("nodeIDFromLabel",a)),e&&(b(u.Ay.isUndefined(n.nodeID),"unexpected attribute for "+t+"["+e+"]"),a.p.labelItext&&a.p.labelItext.set(a.getLabelValue()),a.p.nodeID=e,"Choice"!==t||n.hasOwnProperty("labelItext")||(n.labelItext=e)),u.Ay.each(n,(function(t,e){u.Ay.isBoolean(t)||(t=String(t)),/.+Itext/.test(e)?a.p[e].set(t):a.p[e]=t})),u.Ay.each(I("getSections",a),(function(t){I("collapseSection",t.slug,!1)})),a},paste:function(t,e,n){u.Ay.isString(t)||(t=g().tabDelimit([w].concat(t))),n&&window.console.log(t),b.deepEqual(c().paste(t),e||[])},clickQuestion:X,selectAll:function(){I("jstree","select_all")},deleteQuestion:function(){var t=u.Ay.map(arguments,(function(t){var e=F(t);return b(e,"mug not found: "+t),e}));I("getData").core.form.removeMugsFromForm(t),u.Ay.each(arguments,(function(t){b(!F(t),"mug not removed: "+t)}))},saveButtonEnabled:function(t){var e=I("getData").core.saveButton;if(!u.Ay.isUndefined(t)){var n=t?"save":"saved";e.setStateWhenReady(n),b.equal(e.state,n,"sanity check failed")}return"save"===e.state},expandGroup:function(t){I("jstree","open_node",t.ufid),I("jstree","redraw_node",t.ufid,!0,!1,!1)},collapseGroup:function(t){I("jstree","close_node",t.ufid),I("jstree","redraw_node",t.ufid,!0,!1,!1)},getMessages:function(t){var e=[],n=null;if(u.Ay.isString(t)){var a=t;t=F(a),b(t,"mug not found: "+a)}return t.messages.each((function(t,a){a!==n&&(e.push(a+":"),n=a),e.push("  - "+t.message)})),e.join("\n")},findNode:function(t,e,n){if(u.Ay.isString(e)){var a=e;e=function(t){return t.text===a}}return function n(a){var o,l,i;if(e(a))return a;for(o=0,l=a.children.length;o<l;o++)if(i=n(t.get_node(a.children[o])))return i;return null}(n||t.get_node("#"))},isTreeNodeValid:function(t){if(u.Ay.isString(t)){var e=t;t=F(e),b(t,"mug not found: "+e)}return 0===m()("#vellum").find("#"+t.ufid+" > a").children(".fd-valid-alert-icon").length},markdownVisible:function(){return m()(".itext-block-label-group-default").find(".markdown-output").is(":visible")},parseXML:q().parseXML}},8077:t=>{t.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/8AC3DA3F-68C7-4451-A399-4553BB0A138F" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<text />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/text" nodeset="/data/text" type="xsd:string" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>"Text</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="text-label">\n\t\t\t\t\t\t<value>"Text</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/text" ref="/data/text">\n\t\t\t<label ref="jr:itext(\'text-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n'},855:t=>{t.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/4CA64B95-95E9-420A-90A8-7649C745D336" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>help</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-item1-label">\n\t\t\t\t\t\t<value>item1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-item2-label">\n\t\t\t\t\t\t<value>item2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-help">\n\t\t\t\t\t\t<value>help</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-item1-label">\n\t\t\t\t\t\t<value>item1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-item2-label">\n\t\t\t\t\t\t<value>item2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t\t<help ref="jr:itext(\'question1-help\')" />\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'question1-item1-label\')" />\n\t\t\t\t<value>item1</value>\n\t\t\t</item>\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'question1-item2-label\')" />\n\t\t\t\t<value>item2</value>\n\t\t\t</item>\n\t\t</select1>\n\t</h:body>\n</h:html>\n'}}]);