"use strict";(self.webpackChunkvellum=self.webpackChunkvellum||[]).push([[979],{2979:(t,e,n)=>{var a=n(8324),o=n.n(a),i=n(561),r=n.n(i),l=n(4523),d=n(1134),s=n(8094),u=n.n(s);const c='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n    <h:head>\n        <h:title>Vellum testing</h:title>\n        <model>\n            <instance>\n                <data xmlns:jrm="http://dev.commcarehq.org/jr/xforms"\n                      xmlns="http://openrosa.org/formdesigner/FFD00941-A932-471A-AEC8-87F6EFEF767F"\n                      uiVersion="1" version="1" name="Vellum testing">\n                    <state />\n                </data>\n            </instance>\n            <instance id="states" src="jr://fixture/item-list:state"></instance>\n            <bind vellum:nodeset="#form/state" nodeset="/data/state" />\n            <itext>\n                <translation lang="en" default="">\n                    <text id="state-label">\n                        <value>State</value>\n                    </text>\n                </translation>\n            </itext>\n        </model>\n    </h:head>\n    <h:body>\n        <select1 vellum:ref="#form/state" ref="/data/state">\n            <label ref="jr:itext(\'state-label\')" />\n            <itemset nodeset="instance(\'states\')/state_list/state">\n              <label ref="name"></label>\n              <value ref="id"></value>\n            </itemset>\n        </select1>\n    </h:body>\n</h:html>\n';var h=n(6468);const p='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/D3F4F84E-9F8B-442B-BCD4-6A054E1B1624" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<question1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/question1" nodeset="/data/question1" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-choice1-label">\n\t\t\t\t\t\t<value>choice1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-choice2-label">\n\t\t\t\t\t\t<value>choice2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="question1-label">\n\t\t\t\t\t\t<value>question1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-choice1-label">\n\t\t\t\t\t\t<value>choice1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="question1-choice2-label">\n\t\t\t\t\t\t<value>choice2</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 vellum:ref="#form/question1" ref="/data/question1">\n\t\t\t<label ref="jr:itext(\'question1-label\')" />\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'question1-choice1-label\')" />\n\t\t\t\t<value>choice1</value>\n\t\t\t</item>\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'question1-choice2-label\')" />\n\t\t\t\t<value>choice2</value>\n\t\t\t</item>\n\t\t</select1>\n\t</h:body>\n</h:html>\n',x='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/06C75779-84D8-4FB9-A9C6-77BF7EC832D7" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<repeat jr:template="">\n\t\t\t\t\t\t<text />\n\t\t\t\t\t\t<hidden />\n\t\t\t\t\t</repeat>\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind nodeset="/data/repeat" />\n\t\t\t<bind nodeset="/data/repeat/text" type="xsd:string" />\n\t\t\t<bind nodeset="/data/repeat/hidden" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="" />\n\t\t\t\t<translation lang="hin" />\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<group>\n\t\t\t<repeat nodeset="/data/repeat">\n\t\t\t\t<input ref="/data/repeat/text" />\n\t\t\t</repeat>\n\t\t</group>\n\t</h:body>\n\t<case_mappings />\n</h:html>\n',m='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/CB7A3F20-EE93-4371-B761-053F0412398F" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<text1 />\n\t\t\t\t\t<text2 />\n\t\t\t\t\t<group>\n\t\t\t\t\t\t<text3 />\n\t\t\t\t\t\t<text4 />\n\t\t\t\t\t\t<hidden2 />\n\t\t\t\t\t</group>\n\t\t\t\t\t<text5 />\n\t\t\t\t\t<hidden1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/text1" nodeset="/data/text1" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/text2" nodeset="/data/text2" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/group" nodeset="/data/group" />\n\t\t\t<bind vellum:nodeset="#form/group/text3" nodeset="/data/group/text3" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/group/text4" nodeset="/data/group/text4" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/group/hidden2" nodeset="/data/group/hidden2" />\n\t\t\t<bind vellum:nodeset="#form/text5" nodeset="/data/text5" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/hidden1" nodeset="/data/hidden1" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="text1-label">\n\t\t\t\t\t\t<value>text1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="text2-label">\n\t\t\t\t\t\t<value>text2</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="group-label">\n\t\t\t\t\t\t<value>group</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="group/text3-label">\n\t\t\t\t\t\t<value>text3</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="group/text4-label">\n\t\t\t\t\t\t<value>text4</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="text5-label">\n\t\t\t\t\t\t<value>text5</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/text1" ref="/data/text1">\n\t\t\t<label ref="jr:itext(\'text1-label\')" />\n\t\t</input>\n\t\t<input vellum:ref="#form/text2" ref="/data/text2">\n\t\t\t<label ref="jr:itext(\'text2-label\')" />\n\t\t</input>\n\t\t<group vellum:ref="#form/group" ref="/data/group">\n\t\t\t<label ref="jr:itext(\'group-label\')" />\n\t\t\t<input vellum:ref="#form/group/text3" ref="/data/group/text3">\n\t\t\t\t<label ref="jr:itext(\'group/text3-label\')" />\n\t\t\t</input>\n\t\t\t<input vellum:ref="#form/group/text4" ref="/data/group/text4">\n\t\t\t\t<label ref="jr:itext(\'group/text4-label\')" />\n\t\t\t</input>\n\t\t</group>\n\t\t<input vellum:ref="#form/text5" ref="/data/text5">\n\t\t\t<label ref="jr:itext(\'text5-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n';var f=o().assert,g=d.A.call,v=(0,l.Ay)(d.A.options.options.plugins||[]).without("itemset");describe("Vellum core",(function(){before((function(t){d.A.init({core:{onReady:function(){t()}},features:{rich_text:!1}})})),it("should display non-widget message",(function(){d.A.loadXML("");var t=d.A.addQuestion("Text","text"),e="Test non-widget message.";t.addMessage(null,{key:"testing-1-2-3",level:"error",message:e});var n=r()(".fd-content-right").find(".messages");o().expect(d.A.getMessages(t)).to.include(e),o().expect(n.text()).to.include(e)})),it("should escape generic messages",(function(){d.A.loadXML(""),d.A.addQuestion("Text","text").addMessage(null,{key:"testing-1-2-3",level:"error",message:"This is <b>bold</b>"});const t=r()("fieldset[data-slug='main'] + .messages");o().expect(t.html()).to.include("This is &lt;b&gt;bold&lt;/b&gt;")})),it("should respect markdown content",(function(){d.A.loadXML(""),d.A.addQuestion("Text","text").addMessage(null,{key:"testing-1-2-3",level:"error",message:{markdown:"Click [here](testurl)"}});const t=r()("fieldset[data-slug='main'] + .messages");o().expect(t.html()).to.include('Click <a href="testurl" target="_blank">here</a>')})),it("should load form with save button in 'saved' state",(function(t){d.A.init({core:{form:c,onReady:function(){f.equal(this.data.core.saveButton.state,"saved"),t()}},features:{rich_text:!1}})})),it("should allow mug rename with itemset in form when the itemset plugin is disabled",(function(t){d.A.init({plugins:v,features:{rich_text:!1},core:{form:c,onReady:function(){var e=g("getMugByPath","/data/state"),n=e.form.getChildren(e)[0];f.equal(e.form.getAbsolutePath(n,!0),null),e.p.nodeID="stat",t()}}})})),it("should update child references on group rename",(function(){d.A.loadXML(h);var t=g("getMugByPath","/data/group"),e=g("getMugByPath","/data/group/question1"),n=g("getMugByPath","/data/question2");t.p.nodeID="g8",f.equal(e.form.getAbsolutePath(e),"/data/g8/question1"),f.strictEqual(n.p.relevantAttr,"#form/g8/question1 = 'valley girl' and #form/g8/question2 = 'dude'")})),it("should update question properties header on select mug with Question ID as display name",(function(){d.A.loadXML(""),d.A.paste([["id","type"],["/q1","Text"],["/q2","Text"]]),r()(".fd-question-tree-display").val("_ids").change();var t=r()(".fd-question-properties .fd-head h2");d.A.clickQuestion("q1"),f.equal(t.text(),"q1"),d.A.clickQuestion("q2"),f.equal(t.text(),"q2")})),it("should show warning icons on invalid questions",(function(){d.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/C81D08FB-70D1-475D-80FD-467D44A47B7A" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<q0 />\n\t\t\t\t\t<q1 />\n\t\t\t\t\t<h1 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/q0" nodeset="/data/q0" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/q1" nodeset="/data/q1" type="xsd:string" relevant="/data/q2 = \'missing\'" />\n\t\t\t<bind vellum:nodeset="#form/h1" nodeset="/data/h1" calculate="/data/q3" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="q0-label">\n\t\t\t\t\t\t<value>q0</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="q1-label">\n\t\t\t\t\t\t<value>q1</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t\t<translation lang="hin">\n\t\t\t\t\t<text id="q0-label">\n\t\t\t\t\t\t<value>q0</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="q1-label">\n\t\t\t\t\t\t<value>q1</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<input vellum:ref="#form/q0" ref="/data/q0">\n\t\t\t<label ref="jr:itext(\'q0-label\')" />\n\t\t</input>\n\t\t<input vellum:ref="#form/q1" ref="/data/q1">\n\t\t\t<label ref="jr:itext(\'q1-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n');var t=g("getMugByPath","/data/q0"),e=g("getMugByPath","/data/q1"),n=g("getMugByPath","/data/h1");f(d.A.isTreeNodeValid(t),"q0 is invalid: sanity check failed"),f(!d.A.isTreeNodeValid(e),"q1 should not be valid"),f(!d.A.isTreeNodeValid(n),"h1 should not be valid")})),it("should increment item value on insert new select item as child of select",(function(){d.A.loadXML(p),d.A.clickQuestion("question1");var t=d.A.addQuestion("Choice");f.equal(t.p.nodeID,"choice3")})),it("should increment item value on insert new select item after sibling item",(function(){d.A.loadXML(p),d.A.clickQuestion("question1/choice1");var t=d.A.addQuestion("Choice");f.equal(t.p.nodeID,"choice3")})),it("should add hidden value in repeat group",(function(){d.A.loadXML(""),d.A.addQuestion("Repeat","repeat"),d.A.addQuestion.bind({prevId:"repeat"})("Text","text"),d.A.addQuestion.bind({prevId:"repeat"})("DataBindOnly","hidden"),d.A.assertXmlEqual(g("createXML"),x,{normalize_xmlns:!0})})),it("should add question outside of collapsed group (ref group)",(function(){d.A.loadXML("");var t=d.A.addQuestion("Group","group");d.A.addQuestion("Text","text1"),d.A.collapseGroup(t),d.A.addQuestion.bind({prevId:"group"})("Text","text2"),d.A.expandGroup(t),d.A.assertJSTreeState("group","  text1","text2")})),it("should add question outside of collapsed group (ref inner question)",(function(){d.A.loadXML("");var t,e=d.A.addQuestion("Group","group"),n=d.A.addQuestion("Text","text1");d.A.clickQuestion("group/text1"),t=g("getCurrentlySelectedMug"),f.equal(t,n,"wrong selected mug: "+(t&&t.p.nodeID)),d.A.collapseGroup(e),d.A.addQuestion("Text","text2"),d.A.expandGroup(e),d.A.assertJSTreeState("group","  text1","text2")})),it("should not be able to add choice to collapsed select",(function(){d.A.loadXML("");var t=d.A.addQuestion("Select","select");d.A.addQuestion("Choice","choice1"),d.A.collapseGroup(t),o().expect((function(){d.A.addQuestion.bind({prevId:"select"})("Choice","choice2")})).to.throw(Error)})),it("should add text outside of collapsed select",(function(){d.A.loadXML("");var t=d.A.addQuestion("Select","select");d.A.addQuestion("Choice","choice1"),d.A.addQuestion("Choice","choice2"),d.A.collapseGroup(t),d.A.addQuestion.bind({prevId:"select"})("Text","text1"),d.A.expandGroup(t),d.A.assertJSTreeState("select","  choice1","  choice2","text1")})),it("should not change mugs on collapse",(function(){d.A.loadXML("");var t,e,n=d.A.addQuestion("Group","group");d.A.addQuestion("Group","group"),t=d.A.addQuestion("Text","text"),d.A.clickQuestion("group/group/text"),e=g("getCurrentlySelectedMug"),f.equal(e,t,"wrong selected mug: "+(e&&e.p.nodeID)),d.A.collapseGroup(n),e=g("getCurrentlySelectedMug"),f.equal(e,t,"wrong selected mug: "+(e&&e.p.nodeID))})),it("should not select group if external question is selected on collapse group",(function(){d.A.loadXML("");var t,e=d.A.addQuestion("Text","text1"),n=d.A.addQuestion("Group","group");d.A.clickQuestion("text1"),t=g("getCurrentlySelectedMug"),f.equal(t,e,"wrong selected mug: "+(t&&t.p.nodeID)),d.A.collapseGroup(n),t=g("getCurrentlySelectedMug"),f.equal(t,e,"wrong selected mug: "+(t&&t.p.nodeID))})),it("should load hidden value in repeat group",(function(){d.A.loadXML(x),d.A.assertJSTreeState("repeat","  text","  hidden")})),it("should load hidden values interspersed with other questions",(function(){d.A.loadXML('<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n\t<h:head>\n\t\t<h:title>Untitled Form</h:title>\n\t\t<model>\n\t\t\t<instance>\n\t\t\t\t<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/CB7A3F20-EE93-4371-B761-053F0412398F" uiVersion="1" version="1" name="Untitled Form">\n\t\t\t\t\t<hidden1 />\n\t\t\t\t\t<select1 />\n\t\t\t\t\t<hidden2 />\n\t\t\t\t\t<select2 />\n\t\t\t\t\t<hidden3 />\n\t\t\t\t\t<group>\n\t\t\t\t\t\t<hidden4 />\n\t\t\t\t\t\t<text3 />\n\t\t\t\t\t\t<hidden5 />\n\t\t\t\t\t\t<text4 />\n\t\t\t\t\t\t<hidden6 />\n\t\t\t\t\t</group>\n\t\t\t\t\t<hidden7 />\n\t\t\t\t\t<text5 />\n\t\t\t\t\t<hidden8 />\n\t\t\t\t</data>\n\t\t\t</instance>\n\t\t\t<bind vellum:nodeset="#form/hidden1" nodeset="/data/hidden1" />\n\t\t\t<bind vellum:nodeset="#form/select1" nodeset="/data/select1" />\n\t\t\t<bind vellum:nodeset="#form/hidden2" nodeset="/data/hidden2" />\n\t\t\t<bind vellum:nodeset="#form/select2" nodeset="/data/select2" />\n\t\t\t<bind vellum:nodeset="#form/hidden3" nodeset="/data/hidden3" />\n\t\t\t<bind vellum:nodeset="#form/group" nodeset="/data/group" />\n\t\t\t<bind vellum:nodeset="#form/group/hidden4" nodeset="/data/group/hidden4" />\n\t\t\t<bind vellum:nodeset="#form/group/text3" nodeset="/data/group/text3" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/group/hidden5" nodeset="/data/group/hidden5" />\n\t\t\t<bind vellum:nodeset="#form/group/text4" nodeset="/data/group/text4" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/group/hidden6" nodeset="/data/group/hidden6" />\n\t\t\t<bind vellum:nodeset="#form/hidden7" nodeset="/data/hidden7" />\n\t\t\t<bind vellum:nodeset="#form/text5" nodeset="/data/text5" type="xsd:string" />\n\t\t\t<bind vellum:nodeset="#form/hidden8" nodeset="/data/hidden8" />\n\t\t\t<itext>\n\t\t\t\t<translation lang="en" default="">\n\t\t\t\t\t<text id="select1-label">\n\t\t\t\t\t\t<value>select1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select1-item1-label">\n\t\t\t\t\t\t<value>item1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select1-item2-label">\n\t\t\t\t\t\t<value>item2</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select2-label">\n\t\t\t\t\t\t<value>select2</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select2-item1-label">\n\t\t\t\t\t\t<value>item1</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="select2-item2-label">\n\t\t\t\t\t\t<value>item2</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="group-label">\n\t\t\t\t\t\t<value>group</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="group/text3-label">\n\t\t\t\t\t\t<value>text3</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="group/text4-label">\n\t\t\t\t\t\t<value>text4</value>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text id="text5-label">\n\t\t\t\t\t\t<value>text5</value>\n\t\t\t\t\t</text>\n\t\t\t\t</translation>\n\t\t\t</itext>\n\t\t</model>\n\t</h:head>\n\t<h:body>\n\t\t<select1 vellum:ref="#form/select1" ref="/data/select1">\n\t\t\t<label ref="jr:itext(\'select1-label\')" />\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'select1-item1-label\')" />\n\t\t\t\t<value>item1</value>\n\t\t\t</item>\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'select1-item2-label\')" />\n\t\t\t\t<value>item2</value>\n\t\t\t</item>\n\t\t</select1>\n\t\t<select vellum:ref="#form/select2" ref="/data/select2">\n\t\t\t<label ref="jr:itext(\'select2-label\')" />\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'select2-item1-label\')" />\n\t\t\t\t<value>item1</value>\n\t\t\t</item>\n\t\t\t<item>\n\t\t\t\t<label ref="jr:itext(\'select2-item2-label\')" />\n\t\t\t\t<value>item2</value>\n\t\t\t</item>\n\t\t</select>\n\t\t<group vellum:ref="#form/group" ref="/data/group">\n\t\t\t<label ref="jr:itext(\'group-label\')" />\n\t\t\t<input vellum:ref="#form/group/text3" ref="/data/group/text3">\n\t\t\t\t<label ref="jr:itext(\'group/text3-label\')" />\n\t\t\t</input>\n\t\t\t<input vellum:ref="#form/group/text4" ref="/data/group/text4">\n\t\t\t\t<label ref="jr:itext(\'group/text4-label\')" />\n\t\t\t</input>\n\t\t</group>\n\t\t<input vellum:ref="#form/text5" ref="/data/text5">\n\t\t\t<label ref="jr:itext(\'text5-label\')" />\n\t\t</input>\n\t</h:body>\n</h:html>\n'),d.A.assertJSTreeState("hidden1","select1","  item1","  item2","hidden2","select2","  item1","  item2","hidden3","group","  hidden4","  text3","  hidden5","  text4","  hidden6","hidden7","text5","hidden8")})),it("should add hidden value at end of group",(function(){d.A.loadXML(m),d.A.addQuestion.bind({prevId:"hidden1"})("DataBindOnly","hiddenA"),d.A.addQuestion.bind({prevId:"group/hidden2"})("DataBindOnly","hiddenB"),d.A.assertJSTreeState("text1","text2","group","  text3","  text4","  hidden2","  hiddenB","text5","hidden1","hiddenA")})),it("should add hidden value among other questions",(function(){d.A.loadXML(m),d.A.addQuestion.bind({prevId:"text1"})("DataBindOnly","hiddenA"),d.A.addQuestion.bind({prevId:"group/text3"})("DataBindOnly","hiddenB"),d.A.assertJSTreeState("text1","hiddenA","text2","group","  text3","  hiddenB","  text4","  hidden2","text5","hidden1")})),it("should add question after selected question",(function(){d.A.loadXML(m),d.A.addQuestion.bind({prevId:"text1"})("Text","textA"),d.A.addQuestion.bind({prevId:"group/text3"})("Text","textB"),d.A.assertJSTreeState("text1","textA","text2","group","  text3","  textB","  text4","  hidden2","text5","hidden1")})),it("should add question after hidden value",(function(){d.A.loadXML(m),d.A.addQuestion.bind({prevId:"hidden1"})("Text","textA"),d.A.addQuestion.bind({prevId:"group/hidden2"})("Text","textB"),d.A.assertJSTreeState("text1","text2","group","  text3","  text4","  hidden2","  textB","text5","hidden1","textA")})),it("should add question after sole hidden value",(function(t){d.A.init({core:{onReady:function(){d.A.addQuestion("DataBindOnly","hidden"),d.A.addQuestion.bind({prevId:"hidden"})("Text","text"),d.A.assertJSTreeState("hidden","text"),t()}},features:{rich_text:!1}})})),it("should display welcome message whenever there are no questions",(function(){d.A.loadXML(""),d.A.addQuestion("Text","text1"),d.A.addQuestion("Text","text2"),d.A.deleteQuestion("/data/text1"),f(!r()(".fd-default-panel").is(":visible")),f(r()(".fd-question-changer").is(":visible")),d.A.deleteQuestion("/data/text2"),f(r()(".fd-default-panel").is(":visible"))})),it("should use single quotes on drag/drop choice",(function(){d.A.loadXML(""),d.A.addQuestion("Select","select"),d.A.addQuestion("Choice","choice1");var t=d.A.addQuestion("DataBindOnly","mug"),e=r()("[name=property-calculateAttr]"),n=r()(".fd-question-tree").jstree(!0);f.equal(e.length,1),d.A.findNode(n,"choice1").data.handleDrop(e),f.equal(t.p.calculateAttr,"'choice1'")})),it("should drop /data/ reference when rich_text is false",(function(){d.A.loadXML(""),d.A.addQuestion("Text","text"),d.A.addQuestion("DataBindOnly","mug");var t=r()("[name=property-calculateAttr]"),e=r()(".fd-question-tree").jstree(!0);f.equal(t.length,1),d.A.findNode(e,"text").data.handleDrop(t),f.equal(t.val(),"/data/text")})),it("should notify activity url on form change",(function(t){var e,n=!1;f.equal(d.A.options.options.core.activityUrl,null),f.equal(d.A.options.options.core.activityTimeout,3e5),d.A.init({core:{activityTimeout:-1,activityUrl:function(){n=!0},onReady:function(){var a,o=Date.now();(e=this).onFormChange(),f.isAtLeast(this.data.core.activityTimestamp,o),a=Date.now(),e.onFormChange(),f(n),f.isAtLeast(e.data.core.activityTimestamp,a),f.isNotNull(e.opts().core.activityUrl),e.opts().core.activityUrl=null,t()}}})})),describe("with rich text disabled",(function(){var t;before((function(e){d.A.init({core:{onReady:function(){t=this,e()}},features:{rich_text:!1}})})),it("should display /data/ in the question tree",(function(){d.A.addQuestion("Text","text1");var e=d.A.addQuestion("Text","text2");f.strictEqual(t.getMugDisplayName(e),"text2"),r()("[name=itext-en-label]").val('text2 <output value="#form/text2" />').change(),f.strictEqual(t.getMugDisplayName(e),'text2 &lt;output value="/data/text2" /&gt;')})),it("should not double-escape > & < chars in the question tree",(function(){d.A.paste([["id","type","labelItext:en-default"],["/html-label","Text","<h1>a > & < b</h1>"]]);var e=d.A.getMug("html-label");f.equal(t.getMugDisplayName(e),"&lt;h1&gt;a &gt; &amp; &lt; b&lt;/h1&gt;")})),it("should not escape & char in the question tree",(function(){d.A.paste([["id","type","labelItext:en-default"],["/html-label-second","Text","a&b"]]);var t=d.A.getMug("html-label-second");f.equal(t.p.labelItext.get(),"a&b")}))})),describe("with rich text enabled",(function(){var t;before((function(e){d.A.init({core:{onReady:function(){t=this,e()}},features:{rich_text:!0}})})),it("should not double-escape > & < chars in the question tree",(function(){d.A.paste([["id","type","labelItext:en-default"],["/html-label","Text","<h1>a > & < b</h1>"]]);var e=d.A.getMug("html-label");f.equal(t.getMugDisplayName(e),"&lt;h1&gt;a &gt; &amp; &lt; b&lt;/h1&gt;")})),it("should not escape & char in the question tree",(function(){d.A.paste([["id","type","labelItext:en-default"],["/html-label-other","Text","a&b > & < a"]]);var t=d.A.getMug("html-label-other");f.equal(t.p.labelItext.get(),"a&b > & < a")}))})),describe("XML diff display",(function(){it("should generate HTML disply of XML diff",(function(){var t=u().htmlXMLDiff('<?xml version="1.0" encoding="UTF-8" ?>\n<node>\n    <value>aaa</value>\n</node>\n<node>\n    <value>bbb</value>\n</node>\n','<?xml version="1.0" encoding="UTF-8" ?>\n<node>\n    <value>ccc</value>\n</node>\n');f.equal(t.trim(),'<span>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;<br>&lt;node&gt;<br>    &lt;value&gt;</span><del style="background:#ffe6e6;">aaa&lt;/value&gt;<br>&lt;/node&gt;<br>&lt;node&gt;<br>    &lt;value&gt;bbb</del><ins style="background:#e6ffe6;">ccc</ins><span>&lt;/value&gt;<br>&lt;/node&gt;<br></span>\n'.trim())}))})),describe("save conflict resolution logic",(function(){var t,e,n,a=" line one\n line two\n line three\n line four\n line five\n",o=a.replace("two","2"),i={status:"conflict",xform:a},r=null;before((function(a){d.A.init({core:{onReady:function(){e=this.showOverwriteWarning,this.showOverwriteWarning=function(t,e,a){n(t,e,a)},t=this,a()},patchUrl:function(){return r="patch",i},saveUrl:function(t){return r="full",t.sha1?i:{xform:t.xform}}},features:{full_save_on_missing_conflict_xform:!1}})})),after((function(){t.showOverwriteWarning=e})),beforeEach((function(){n=void 0,t.data.core.saveButton.fire("change"),t.data.core.lastSavedXForm=a})),it("should re-enable save button before overwrite warning",(function(){n=function(t,n,i){f(d.A.saveButtonEnabled(),"save button is disabled"),f.equal(n,o),f.equal(i,a),e=!0};var e=!1;f(d.A.saveButtonEnabled(),"save button is disabled (sanity check)"),t.send(o,"patch"),f(e,"overwrite warning not triggered"),f.equal(r,"patch"),f.equal(t.data.core.lastSavedXForm,a)})),it("should send sha1 checksum on patch switched to full form post",(function(){n=function(t,n,i){f(d.A.saveButtonEnabled(),"save button is disabled"),f.equal(n,o),f.equal(i,a),e=!0};var e=!1,o="abc";f(d.A.saveButtonEnabled(),"save button is disabled (sanity check)"),t.send(o,null),f(e,"overwrite warning not triggered"),f.equal(r,"full"),f.equal(t.data.core.lastSavedXForm,a)})),it("should not send sha1 checksum with full form post",(function(){n=function(t,n,a){e=!0};var e=!1;f(d.A.saveButtonEnabled(),"save button is disabled (sanity check)"),t.send(o,"full"),f(!e,"should not prompt to overwrite on full save"),f(!d.A.saveButtonEnabled(),"save button should be disabled"),f.equal(r,"full"),f.equal(t.data.core.lastSavedXForm,o)}))})),describe("with duplicate ID should",(function(){var t,e;before((function(){t=d.A.loadXML(""),d.A.addQuestion("Text","same"),(e=d.A.addQuestion("Text","temp")).p.labelItext.set("same"),d.A.clickQuestion(e)})),beforeEach((function(){e.p.nodeID="same",f(t.vellum.ensureCurrentMugIsSaved(),"mug is not saved")})),it("show validation error",(function(){f(!d.A.isTreeNodeValid(e),"mug should not be valid")})),it("show placeholder on delete question ID",(function(){var n=r()("[name=property-nodeID]");n.val("").change(),f.equal(e.p.nodeID,""),f.equal(n.attr("placeholder"),"copy-1-of-same"),f(d.A.isTreeNodeValid(e),d.A.getMessages(e)),f(t.vellum.ensureCurrentMugIsSaved(),"mug is not saved"),f.equal(e.p.nodeID,"copy-1-of-same")})),it("reset question ID on dismiss duplicate path error",(function(){var t=e.messages.get("nodeID","mug-conflictedNodeId-warning");f(t,"unexpected: validation error is missing"),e.dropMessage("nodeID","mug-conflictedNodeId-warning"),f(d.A.isTreeNodeValid(e),d.A.getMessages(e)),f.match(e.p.nodeID,/^copy-\d+-of-same$/),f(!e.p.conflictedNodeId,"conflictedNodeId should not be set; got "+e.p.conflictedNodeId)}))})),describe("type changer",(function(){function t(t,a,o){it("should "+(o?"show ":"not show ")+a+" in menu for "+t,(function(){var i=n[t],r=e.vellum.getQuestionTypeChanger(i).find("[data-qtype="+a+"]");f(r.length===(o?1:0),r.parent().html()||a+" not found in menu")}))}var e,n={};before((function(){e=d.A.loadXML(""),n.Text=d.A.addQuestion("Text"),n.Select=d.A.addQuestion("Select"),d.A.addQuestion("Choice"),n.SelectDynamic=d.A.addQuestion("SelectDynamic"),n.Transfer=d.A.addQuestion("Transfer"),n.Dispense=d.A.addQuestion("Dispense"),n.Receive=d.A.addQuestion("Receive")})),t("Text","Trigger",!0),t("Text","Choice"),t("Text","Group"),t("Text","DataBindOnly"),t("Text","Select",!0),t("Text","MSelect",!0),t("Text","SelectDynamic"),t("Text","MSelectDynamic"),t("Text","Transfer"),t("Select","MSelect",!0),t("Select","Text"),t("Select","SelectDynamic"),t("Select","MSelectDynamic"),t("SelectDynamic","MSelectDynamic",!0),t("SelectDynamic","Select"),t("SelectDynamic","MSelect"),t("Transfer","Text"),t("Transfer","Dispense",!0),t("Transfer","Receive",!0),t("Dispense","Transfer",!0),t("Dispense","Receive",!0),t("Receive","Transfer",!0),t("Receive","Dispense",!0)})),describe("drag+drop should",(function(){var t;before((function(){d.A.loadXML(m),d.A.addQuestion.bind({prevId:"text2"})("Repeat","repeat"),t={text1:g("getMugByPath","/data/text1"),text2:g("getMugByPath","/data/text2"),repeat:g("getMugByPath","/data/repeat"),group:g("getMugByPath","/data/group"),text3:g("getMugByPath","/data/group/text3"),text4:g("getMugByPath","/data/group/text4"),hidden2:g("getMugByPath","/data/group/hidden2"),text5:g("getMugByPath","/data/text5"),hidden1:g("getMugByPath","/data/hidden1")}})),(0,l.Ay)([["text1","before","text1",!0],["text1","inside","text1",!0],["text1","after","text1",!0],["text1","into","text1",!0],["text1","before","text2",!0],["text1","inside","text2",!0],["text1","after","text2",!0],["text1","before","repeat",!0],["text1","inside","repeat",!0],["text1","after","repeat",!0],["text1","first","group",!0],["text1","before","group",!0],["text1","inside","group",!0],["text1","after","group",!0],["text1","last","group",!0],["text1","into","group",!0],["text1","before","text3",!0],["text1","inside","text3",!0],["text1","after","text3",!0],["text1","before","text4",!0],["text1","inside","text4",!0],["text1","after","text4",!0],["text1","before","hidden2",!0],["text1","inside","hidden2",!0],["text1","after","hidden2",!0],["text1","into","hidden2",!0],["text1","before","text5",!0],["text1","inside","text5",!0],["text1","after","text5",!0],["text1","before","hidden1",!0],["text1","inside","hidden1",!0],["text1","after","hidden1",!0],["hidden1","before","text1",!0],["hidden1","inside","text1",!0],["hidden1","after","text1",!0],["hidden1","into","text1",!0],["hidden1","before","text2",!0],["hidden1","inside","text2",!0],["hidden1","after","text2",!0],["hidden1","first","repeat",!0],["hidden1","before","repeat",!0],["hidden1","inside","repeat",!0],["hidden1","after","repeat",!0],["hidden1","into","repeat",!0],["hidden1","last","repeat",!0],["hidden1","first","group",!0],["hidden1","before","group",!0],["hidden1","inside","group",!0],["hidden1","after","group",!0],["hidden1","into","group",!0],["hidden1","last","group",!0],["hidden1","before","text3",!0],["hidden1","inside","text3",!0],["hidden1","after","text3",!0],["hidden1","before","text4",!0],["hidden1","inside","text4",!0],["hidden1","after","text4",!0],["hidden1","before","hidden2",!0],["hidden1","inside","hidden2",!0],["hidden1","after","hidden2",!0],["hidden1","before","text5",!0],["hidden1","inside","text5",!0],["hidden1","after","text5",!0],["hidden1","before","hidden1",!0],["hidden1","inside","hidden1",!0],["hidden1","after","hidden1",!0],["hidden2","before","text1",!0],["hidden2","inside","text1",!0],["hidden2","after","text1",!0],["hidden2","before","text2",!0],["hidden2","inside","text2",!0],["hidden2","after","text2",!0],["hidden2","before","repeat",!0],["hidden2","inside","repeat",!0],["hidden2","after","repeat",!0],["hidden2","before","group",!0],["hidden2","inside","group",!0],["hidden2","after","group",!0],["hidden2","before","text3",!0],["hidden2","inside","text3",!0],["hidden2","after","text3",!0],["hidden2","before","text4",!0],["hidden2","inside","text4",!0],["hidden2","after","text4",!0],["hidden2","before","hidden2",!0],["hidden2","inside","hidden2",!0],["hidden2","after","hidden2",!0],["hidden2","before","text5",!0],["hidden2","inside","text5",!0],["hidden2","after","text5",!0],["hidden2","before","hidden1",!0],["hidden2","inside","hidden1",!0],["hidden2","after","hidden1",!0]]).each((function(e){var n=e[3],a=n?"allow move ":"prevent move ",o=e[0],i=e[2],r=e[1];it(a+o+" "+r+" "+i,(function(){var e=t[o],a=t[i],l=g("checkMove",e.ufid,e.__className,a.ufid,a.__className,r);f(n?l:!l,["move",o,r,i,"->",l].join(" "))}))})),(0,l.Ay)([[null,"first",null,"first"],[null,"last",null,"last"],["group","first","group","first"],["group","last","group","last"],["group","before","group","before"],["group","after","group","after"],["text1","before","text1","before"],["text1","after","text1","after"],[null,0,null,"first"],[null,1,"text1","after"],[null,2,"text2","after"],[null,3,"repeat","after"],[null,4,"group","after"],[null,5,"text5","after"],[null,6,"hidden1","after"],[null,7,null,"last"],[null,8,null,"last"],["repeat",0,"repeat","first"],["repeat",1,"repeat","last"],["repeat",2,"repeat","last"],["group",0,"group","first"],["group",1,"text3","after"],["group",2,"text4","after"],["group",3,"hidden2","after"],["group",4,"group","last"],["group",5,"group","last"]]).each((function(e){var n=e[0],a=e[1],o=e[2],i=e[3];it("produce relative position "+n+"["+a+"] => "+i+" "+o,(function(){var e=n?t[n]:null,r=o?t[o]:null,l=g("getRelativePosition",e,a),d=String(l.position),s=l.mug?l.mug.p.nodeID:String(l.mug);f(l.position===i&&l.mug===r,[a,n,"->",d,s].join(" "))}))}))}))}))},1134:(t,e,n)=>{n.d(e,{A:()=>B});var a=n(8449),o=n(8324),i=n.n(o),r=n(6848),l=n.n(r),d=n(3794),s=n.n(d),u=n(4523),c=n(561),h=n.n(c),p=n(1437),x=n.n(p),m=n(3809),f=n.n(m),g=n(705),v=n.n(g),b=n(7229),A=n.n(b),q=(n(1460),n(8803),i().assert),y=["Form Builder clip","version 1"];function w(t,e,n){if((n=u.Ay.defaults(n||{},{normalize_xmlns:!1,not:!1})).normalize_xmlns){var a=A().parseXML(e).find("data").attr("xmlns");t=t.replace(/(data[^>]+xmlns=")(.+?)"/,"$1"+a+'"')}var o,i,r,d,s=(o=t,i=e,r=l().xml(o),d=l().xml(i),l().isEquivalent(r,d,{element_order:!0}));n.not&&(s=!s),s||M(t=j(t),e=j(e),"XML "+(n.not?"should not be equivalent":"mismatch"))}function M(t,e,n){if(t!==e){var a=s().createPatch("",t,e,"actual","expected");a=a.replace(/^Index:/,n||"Not equal:"),q(!1,function(t){var e={"-":31,"+":32};return t.replace(/^.+?$/gm,(function(t){return"["+(e[t[0]]||0)+"m"+t+"[0m"}))}(a))}}function j(t){return(t=t.replace(/^\t+/gm,(function(t){return t.replace(/\t/g,"  ")}))).match(/\n$/)||(t+="\n"),t}function T(t){return D("getCurrentMugInput",t)}function S(t){var e=h()("#vellum").vellum("get"),n=u.Ay.isString(t)?h()("[name="+t+"]"):t;return v().util.getWidget(n,e)}function D(){var t=Array.prototype.slice.call(arguments),e=h()("#vellum");return e.vellum.apply(e,t)}function Q(){var t=[],e=u.Ay.map(arguments,(function(e){var n=u.Ay.isString(e)?I(e):e;if(!n||!n.ufid)throw new Error("mug not found: "+e);return t.push(n),n.ufid}));return D("jstree","deselect_all",!0),D("jstree","select_node",e),h()(".collapse-toggle.collapsed").click(),t}function I(t){0!==t.indexOf("/")&&(t="/data/"+t);var e=D("getMugByPath",t);if(!e){var n=t.split("/"),a=D("getMugByPath",n.slice(0,-1).join("/"));if(a&&a.__className.indexOf("Select")>-1){var o=D("getData").core.form.getChildren(a),i=n[n.length-1];if(1===o.length&&"itemset"===i&&"itemset"===o[0].options.tagName)return o[0];for(var r=0;r<o.length;r++)if(o[r].p.nodeID===i)return o[r]}}return e}q.equal=q.strictEqual,q.notEqual=q.notStrictEqual;const B={options:a.A,asyncatch:function(t){return function(){try{var e=Array.prototype.slice.call(arguments);return t.apply(this,e)}catch(t){throw t&&t.stack?new Error(t.stack):t}}},init:function(t){t=t||{};var e=h().extend(!0,{},a.A.options,t),n=h().fn.animate;h().fn.animate=function(t,e,a,o){n.apply(this,[t,0,a,o])},t.javaRosa&&t.javaRosa.langs&&(e.javaRosa.langs=t.javaRosa.langs),e.plugins=u.Ay.without(e.plugins,"atwho"),t.plugins&&(e.plugins=t.plugins),e&&e.features&&u.Ay.isUndefined(e.features.disable_popovers)&&(e.features.disable_popovers=!0),e.core=e.core||{};var o=e.core.saveUrl||function(){};e.core.saveUrl=function(t){return t.xform,o(t)};var i=h()("#vellum"),r=i.vellum("get");r&&(r.destroy(),h()("body > div.modal, body > div.modal-backdrop").remove()),i.empty().vellum(e)},call:D,loadXML:function(t,e,n,a,o=!0){var i=[],r=D("getData");return a||window.history.replaceState(null,null," "),r.core.parseWarnings=[],D("loadXML",t,e||{},{reset:o}),n?u.Ay.isRegExp(n)&&(i=u.Ay.filter(r.core.parseWarnings,(function(t){return!n.test(t)}))):i=r.core.parseWarnings,q(!i.length,"unexpected parse warnings:\n- "+i.join("\n- ")),delete r.core.parseWarnings,r.core.form},saveAndReload:function(t){D("loadXFormOrError",D("createXML"),t)},getMug:I,getInput:T,getWidget:S,getMediaUploader:function(t){var e,n={},a=S(t);if(!a)throw new Error("media uploader widget not found");if(u.Ay.find([".widget[data-hqmediapath]",".itext-block-container"],(function(n){return(e=t.closest(n)).length})),!e)throw new Error("media uploader element not found");return n.upload=function(t){var n={ref:{path:a.getRandomizedMediaPath(t)},errors:[]};e.trigger("mediaUploadComplete",n)},n},assertEqual:M,assertInputCount:function(t,e,n){u.Ay.isString(t)?(n=" for "+(n?n+" ":"")+t,t=T(t)):n=n?" for "+n:"",q.equal(t.length,e,"wrong number of inputs"+n)},assertXmlEqual:w,assertXmlNotEqual:function(t,e,n){(n=n||{}).not=!0,w(t,e,n)},assertJSTreeState:function(){var t=Array.prototype.slice.call(arguments).join("\n")+"\n";M(function t(e,n){var a,o,i,r=[];for("#"===e.id?n=-1:r.push(Array(2*n+1).join(" ")+e.text),a=0,o=e.children.length;a<o;a++)i=D("jstree","get_node",e.children[a]),r.push(t(i,n+1));return r.join("\n")}(D("jstree","get_node","#"))+"\n",t,"Unexpected jstree state")},assertTreeState:function(t){var e=Array.prototype.slice.call(arguments,1).join("\n")+"\n";M(function t(e,n){var a,o,i,r=[];for(e.isRootNode?n=-1:r.push(Array(2*n+1).join(" ")+e.value.p.nodeID),a=0,o=e.children.length;a<o;a++)i=e.children[a],r.push(t(i,n+1));return r.join("\n")}(t.rootNode,0)+"\n",e,"Unexpected tree state")},addQuestion:function(t,e,n){n=u.Ay.extend({},n),this.prevId&&Q(this.prevId);var a=D("addQuestion",t);return e||a.p.nodeID||(e=D("nodeIDFromLabel",a)),e&&(q(u.Ay.isUndefined(n.nodeID),"unexpected attribute for "+t+"["+e+"]"),a.p.labelItext&&a.p.labelItext.set(a.getLabelValue()),a.p.nodeID=e,"Choice"!==t||n.hasOwnProperty("labelItext")||(n.labelItext=e)),u.Ay.each(n,(function(t,e){u.Ay.isBoolean(t)||(t=String(t)),/.+Itext/.test(e)?a.p[e].set(t):a.p[e]=t})),u.Ay.each(D("getSections",a),(function(t){D("collapseSection",t.slug,!1)})),a},paste:function(t,e,n){u.Ay.isString(t)||(t=f().tabDelimit([y].concat(t))),n&&window.console.log(t),q.deepEqual(x().paste(t),e||[])},clickQuestion:Q,selectAll:function(){D("jstree","select_all")},deleteQuestion:function(){var t=u.Ay.map(arguments,(function(t){var e=I(t);return q(e,"mug not found: "+t),e}));D("getData").core.form.removeMugsFromForm(t),u.Ay.each(arguments,(function(t){q(!I(t),"mug not removed: "+t)}))},saveButtonEnabled:function(t){var e=D("getData").core.saveButton;if(!u.Ay.isUndefined(t)){var n=t?"save":"saved";e.setStateWhenReady(n),q.equal(e.state,n,"sanity check failed")}return"save"===e.state},expandGroup:function(t){D("jstree","open_node",t.ufid),D("jstree","redraw_node",t.ufid,!0,!1,!1)},collapseGroup:function(t){D("jstree","close_node",t.ufid),D("jstree","redraw_node",t.ufid,!0,!1,!1)},getMessages:function(t){var e=[],n=null;if(u.Ay.isString(t)){var a=t;t=I(a),q(t,"mug not found: "+a)}return t.messages.each((function(t,a){a!==n&&(e.push(a+":"),n=a),e.push("  - "+t.message)})),e.join("\n")},findNode:function(t,e,n){if(u.Ay.isString(e)){var a=e;e=function(t){return t.text===a}}return function n(a){var o,i,r;if(e(a))return a;for(o=0,i=a.children.length;o<i;o++)if(r=n(t.get_node(a.children[o])))return r;return null}(n||t.get_node("#"))},isTreeNodeValid:function(t){if(u.Ay.isString(t)){var e=t;t=I(e),q(t,"mug not found: "+e)}return 0===h()("#vellum").find("#"+t.ufid+" > a").children(".fd-valid-alert-icon").length},markdownVisible:function(){return h()(".itext-block-label-group-default").find(".markdown-output").is(":visible")},parseXML:A().parseXML}},6468:t=>{t.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa" xmlns:vellum="http://commcarehq.org/xforms/vellum">\n    <h:head>\n        <h:title>Untitled Form</h:title>\n        <model>\n            <instance>\n                <data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/35276137-89A8-4DB1-8605-17E5B92D058C" uiVersion="1" version="1" name="Untitled Form">\n                    <group>\n                        <question1 />\n                        <question2 />\n                    </group>\n                    <question2 />\n                </data>\n            </instance>\n            <bind vellum:nodeset="#form/group" nodeset="/data/group" />\n            <bind vellum:nodeset="#form/group/question1" nodeset="/data/group/question1" type="xsd:string" />\n            <bind vellum:nodeset="#form/group/question2" nodeset="/data/group/question2" type="xsd:string" />\n            <bind vellum:nodeset="#form/question2" nodeset="/data/question2" type="xsd:string" vellum:relevant="#form/group/question1 = \'valley girl\' and #form/group/question2 = \'dude\'" relevant="/data/group/question1 = \'valley girl\' and /data/group/question2 = \'dude\'" />\n            <itext>\n                <translation lang="en" default="">\n                    <text id="group-label">\n                        <value>group</value>\n                    </text>\n                    <text id="group/question1-label">\n                        <value>question1</value>\n                    </text>\n                    <text id="group/question2-label">\n                        <value>question2</value>\n                    </text>\n                    <text id="question2-label">\n                        <value>question2</value>\n                    </text>\n                </translation>\n            </itext>\n        </model>\n    </h:head>\n    <h:body>\n        <group vellum:ref="#form/group" ref="/data/group">\n            <label ref="jr:itext(\'group-label\')" />\n            <input vellum:ref="#form/group/question1" ref="/data/group/question1">\n                <label ref="jr:itext(\'group/question1-label\')" />\n            </input>\n            <input vellum:ref="#form/group/question2" ref="/data/group/question2">\n                <label ref="jr:itext(\'group/question2-label\')" />\n            </input>\n        </group>\n        <input vellum:ref="#form/question2" ref="/data/question2">\n            <label ref="jr:itext(\'question2-label\')" />\n        </input>\n    </h:body>\n</h:html>\n'}}]);