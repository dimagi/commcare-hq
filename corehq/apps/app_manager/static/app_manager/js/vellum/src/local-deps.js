define("css/css!../node_modules/jstree/dist/themes/default/style",[],function(){}),function(e){"use strict";"function"==typeof define&&define.amd?define("jquery.jstree",["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var n=0,i=!1,r=!1,o=!1,a=[],s=e("script:last").attr("src"),l=window.document,d=window.setImmediate,c=window.Promise;!d&&c&&(d=function(e,t){c.resolve(t).then(e)}),e.jstree={version:"3.3.11",defaults:{plugins:[]},plugins:{},path:s&&-1!==s.indexOf("/")?s.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var r=new e.jstree.core(++n),o=i;return i=e.extend(!0,{},e.jstree.defaults,i),o&&o.plugins&&(i.plugins=o.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,i[t]))}),e(t).data("jstree",r),r.init(t,i),r},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(l).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var n=null,i=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!i||!i.length)try{i=e(t)}catch(e){}if(!i||!i.length)try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?n=i:e(".jstree").each(function(){var i=e(this).data("jstree");if(i&&i._model.data[t])return n=i,!1}),n},e.fn.jstree=function(n){var i="string"==typeof n,r=Array.prototype.slice.call(arguments,1),o=null;return!(!0===n&&!this.length)&&(this.each(function(){var a=e.jstree.reference(this),s=i&&a?a[n]:null;if(o=i&&s?s.apply(a,r):null,a||i||n!==t&&!e.isPlainObject(n)||e.jstree.create(this,n),(a&&!i||!0===n)&&(o=a||!1),null!==o&&o!==t)return!1}),null!==o&&o!==t?o:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(n){return function(n){return e(n).hasClass("jstree")&&e(n).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(t){t.type="click",e(t.currentTarget).trigger(t)},enter:function(t){t.type="click",e(t.currentTarget).trigger(t)},left:function(t){if(t.preventDefault(),this.is_open(t.currentTarget))this.close_node(t.currentTarget);else{var n=this.get_parent(t.currentTarget);n&&n.id!==e.jstree.root&&this.get_node(n,!0).children(".jstree-anchor").focus()}},up:function(e){e.preventDefault();var t=this.get_prev_dom(e.currentTarget);t&&t.length&&t.children(".jstree-anchor").focus()},right:function(t){if(t.preventDefault(),this.is_closed(t.currentTarget))this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()});else if(this.is_open(t.currentTarget)){var n=this.get_node(t.currentTarget,!0).children(".jstree-children")[0];n&&e(this._firstChild(n)).children(".jstree-anchor").focus()}},down:function(e){e.preventDefault();var t=this.get_next_dom(e.currentTarget);t&&t.length&&t.children(".jstree-anchor").focus()},"*":function(e){this.open_all()},home:function(t){t.preventDefault();var n=this._firstChild(this.get_container_ul()[0]);n&&e(n).children(".jstree-anchor").filter(":visible").focus()},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},e.jstree.core.prototype={plugin:function(t,n){var i=e.jstree.plugins[t];return i?(this._data[t]={},i.prototype=this,new i(n,this)):this},init:function(t,n){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=n,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,n=l.createElement("LI");return n.setAttribute("role","none"),e=l.createElement("I"),e.className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),n.appendChild(e),e=l.createElement("A"),e.className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),e.setAttribute("role","treeitem"),t=l.createElement("I"),t.className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),n.appendChild(e),e=t=null,n},_kbevent_to_func:function(e){var t={8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"},n=[];if(e.ctrlKey&&n.push("ctrl"),e.altKey&&n.push("alt"),e.shiftKey&&n.push("shift"),n.push(t[e.which]||e.which),"shift-shift"===(n=n.sort().join("-").toLowerCase())||"ctrl-ctrl"===n||"alt-alt"===n)return null;var i,r,o=this.settings.core.keyboard;for(i in o)if(o.hasOwnProperty(i)&&(r=i,"-"!==r&&"+"!==r&&(r=r.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS"),r=r.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),r===n))return o[i];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",n=null,i=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(l.selection&&l.selection.empty)l.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),i=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==l.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){var n=t.call(this,e);if(!1===n||!0===n)return n}},this)).on("load_node.jstree",e.proxy(function(t,n){n.status&&(n.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,n,i=[];for(t=0,n=this._data.core.selected.length;t<n;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(i=e.vakata.array_unique(i),t=0,n=i.length;t<n;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(i){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!0;n&&clearTimeout(n),n=setTimeout(function(){t=""},500);var r=String.fromCharCode(i.which).toLowerCase(),o=this.element.find(".jstree-anchor").filter(":visible"),a=o.index(l.activeElement)||0,s=!1;if(t+=r,t.length>1){if(o.slice(a).each(e.proxy(function(n,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),s=!0,!1},this)),s)return;if(o.slice(0,a).each(e.proxy(function(n,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),s=!0,!1},this)),s)return}if(new RegExp("^"+r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(o.slice(a+1).each(e.proxy(function(t,n){if(e(n).text().toLowerCase().charAt(0)===r)return e(n).focus(),s=!0,!1},this)),s)return;if(o.slice(0,a+1).each(e.proxy(function(t,n){if(e(n).text().toLowerCase().charAt(0)===r)return e(n).focus(),s=!0,!1},this)),s)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var n=this.get_node(t.currentTarget);n&&n.id&&(this._data.core.focused=n.id),this.element.find(".jstree-hovered").not(t.currentTarget).trigger("mouseleave"),e(t.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-i>500&&!this._data.core.focused&&this.settings.core.restore_focus){i=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(l).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var n=this.settings.core.strings;return e.isFunction(n)?n.call(this,t):n&&n[t]?n[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,n){t&&t.id&&(t=t.id),t instanceof e&&t.length&&t[0].id&&(t=t[0].id);var i;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(i=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=this.element.find(t)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=this.element.find(t)).length||!i.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return n&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(e){return!1}},get_path:function(t,n,i){if(!(t=t.parents?t:this.get_node(t))||t.id===e.jstree.root||!t.parents)return!1;var r,o,a=[];for(a.push(i?t.id:t.text),r=0,o=t.parents.length;r<o;r++)a.push(i?t.parents[r]:this.get_text(t.parents[r]));return a=a.reverse().slice(1),n?a.join(n):a},get_next_dom:function(t,n){var i;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(n){i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}if(t.hasClass("jstree-open")){for(i=this._firstChild(t.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return e(i)}i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return null!==i?e(i):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,n){var i;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(n){i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);if(null!==i){for(t=e(i);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return!(!(i=t[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&e(i)},get_parent:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||e.children.length>0)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,n){var i,r,o,a,s;if(e.isArray(t))return this._load_nodes(t.slice(),n),!0;if(!(t=this.get_node(t)))return n&&n.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,o=0,a=t.parents.length;o<a;o++)this._model.data[t.parents[o]].children_d=e.vakata.array_filter(this._model.data[t.parents[o]].children_d,function(n){return-1===e.inArray(n,t.children_d)});for(i=0,r=t.children_d.length;i<r;i++)this._model.data[t.children_d[i]].state.selected&&(s=!0),delete this._model.data[t.children_d[i]];s&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(n){return-1===e.inArray(n,t.children_d)})),t.children=[],t.children_d=[],s&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var i=this.get_node(t,!0),r=0,o=0,a=this._model.data,s=!1;for(r=0,o=t.children.length;r<o;r++)if(a[t.children[r]]&&!a[t.children[r]].state.hidden){s=!0;break}t.state.loaded&&i&&i.length&&(i.removeClass("jstree-closed jstree-open jstree-leaf"),s?"#"!==t.id&&i.addClass(t.state.opened?"jstree-open":"jstree-closed"):i.addClass("jstree-leaf")),i.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),n&&n.call(this,t,e)},this)),!0},_load_nodes:function(e,t,n,i){var r,o,a=!0,s=function(){this._load_nodes(e,t,!0)},l=this._model.data,d=[];for(r=0,o=e.length;r<o;r++)l[e[r]]&&(!l[e[r]].state.loaded&&!l[e[r]].state.failed||!n&&i)&&(this.is_loading(e[r])||this.load_node(e[r],s),a=!1);if(a){for(r=0,o=e.length;r<o;r++)l[e[r]]&&l[e[r]].state.loaded&&d.push(e[r]);t&&!t.done&&(t.call(this,d),t.done=!0)}},load_all:function(t,n){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,r,o=[],a=this._model.data,s=a[t.id].children_d;for(t.state&&!t.state.loaded&&o.push(t.id),i=0,r=s.length;i<r;i++)a[s[i]]&&a[s[i]].state&&!a[s[i]].state.loaded&&o.push(s[i]);o.length?this._load_nodes(o,function(){this.load_all(t,n)}):(n&&n.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,n){var i,r=this.settings.core.data,o=function(){return 3!==this.nodeType&&8!==this.nodeType};return r?e.isFunction(r)?r.call(this,t,e.proxy(function(i){!1===i?n.call(this,!1):this["string"==typeof i?"_append_html_data":"_append_json_data"](t,"string"==typeof i?e(e.parseHTML(i)).filter(o):i,function(e){n.call(this,e)})},this)):"object"==typeof r?r.url?(r=e.extend(!0,{},r),e.isFunction(r.url)&&(r.url=r.url.call(this,t)),e.isFunction(r.data)&&(r.data=r.data.call(this,t)),e.ajax(r).done(e.proxy(function(i,r,a){var s=a.getResponseHeader("Content-Type");return s&&-1!==s.indexOf("json")||"object"==typeof i?this._append_json_data(t,i,function(e){n.call(this,e)}):s&&-1!==s.indexOf("html")||"string"==typeof i?this._append_html_data(t,e(e.parseHTML(i)).filter(o),function(e){n.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:a})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))},this)).fail(e.proxy(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},n.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(i=e.isArray(r)?e.extend(!0,[],r):e.isPlainObject(r)?e.extend(!0,{},r):r,t.id===e.jstree.root?this._append_json_data(t,i,function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))):"string"==typeof r?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(r)).filter(o),function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1)):n.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){n.call(this,e)}):n.call(this,!1)},_node_changed:function(t){(t=this.get_node(t))&&-1===e.inArray(t.id,this._model.changed)&&this._model.changed.push(t.id)},_append_html_data:function(t,n,i){t=this.get_node(t),t.children=[],t.children_d=[];var r,o,a,s=n.is("ul")?n.children():n,l=t.id,d=[],c=[],h=this._model.data,u=h[l],f=this._data.core.selected.length;for(s.each(e.proxy(function(t,n){(r=this._parse_model_from_html(e(n),l,u.parents.concat()))&&(d.push(r),c.push(r),h[r].children_d.length&&(c=c.concat(h[r].children_d)))},this)),u.children=d,u.children_d=c,o=0,a=u.parents.length;o<a;o++)h[u.parents[o]].children_d=h[u.parents[o]].children_d.concat(c);this.trigger("model",{nodes:c,parent:l}),l!==e.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==f&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(t,n,i,r){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],n.d&&"string"==typeof(n=n.d)&&(n=JSON.parse(n)),e.isArray(n)||(n=[n]);var o=null,a={df:this._model.default_state,dat:n,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},s=this,l=function(e,t){e.data&&(e=e.data);var n,i,r,o,a=e.dat,l=e.par,d=[],c=[],h=[],u=e.df,f=e.t_id,g=e.t_cnt,p=e.m,m=p[l],E=e.sel,_=function(e,n,i){i=i?i.concat():[],n&&i.unshift(n);var r,o,a,s,l=e.id.toString(),d={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:n,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in u)u.hasOwnProperty(r)&&(d.state[r]=u[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(d.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(d.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(d.li_attr[r]=e.li_attr[r]);if(d.li_attr.id||(d.li_attr.id=l),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(d.a_attr[r]=e.a_attr[r]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),p[d.id]=d,r=0,o=d.children.length;r<o;r++)a=_(p[d.children[r]],d.id,i),s=p[a],d.children_d.push(a),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d));return delete e.data,delete e.children,p[d.id].original=e,d.state.selected&&h.push(d.id),d.id},T=function(e,n,i){i=i?i.concat():[],n&&i.unshift(n);var r,o,a,s,l,d=!1;do{d="j"+f+"_"+ ++g}while(p[d]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:n,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in u)u.hasOwnProperty(r)&&(l.state[r]=u[r]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(l.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(l.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(l.li_attr[r]=e.li_attr[r]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=d),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(l.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,o=e.children.length;r<o;r++)a=T(e.children[r],l.id,i),s=p[a],l.children.push(a),s.children_d.length&&(l.children_d=l.children_d.concat(s.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,p[l.id]=l,l.state.selected&&h.push(l.id),l.id};if(a.length&&a[0].id!==t&&a[0].parent!==t){for(i=0,r=a.length;i<r;i++)a[i].children||(a[i].children=[]),a[i].state||(a[i].state={}),p[a[i].id.toString()]=a[i];for(i=0,r=a.length;i<r;i++)p[a[i].parent.toString()]?(p[a[i].parent.toString()].children.push(a[i].id.toString()),m.children_d.push(a[i].id.toString())):void 0!==s&&(s._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:a[i].id.toString(),parent:a[i].parent.toString()})},s.settings.core.error.call(s,s._data.core.last_error));for(i=0,r=m.children.length;i<r;i++)n=_(p[m.children[i]],l,m.parents.concat()),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d));for(i=0,r=m.parents.length;i<r;i++)p[m.parents[i]].children_d=p[m.parents[i]].children_d.concat(c);o={cnt:g,mod:p,sel:E,par:l,dpc:c,add:h}}else{for(i=0,r=a.length;i<r;i++)(n=T(a[i],l,m.parents.concat()))&&(d.push(n),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d)));for(m.children=d,m.children_d=c,i=0,r=m.parents.length;i<r;i++)p[m.parents[i]].children_d=p[m.parents[i]].children_d.concat(c);o={cnt:g,mod:p,sel:E,par:l,dpc:c,add:h}}if("undefined"!=typeof window&&void 0!==window.document)return o;postMessage(o)},c=function(t,n){if(null!==this.element){this._cnt=t.cnt;var r,o=this._model.data;for(r in o)o.hasOwnProperty(r)&&o[r].state&&o[r].state.loading&&t.mod[r]&&(t.mod[r].state.loading=!0);if(this._model.data=t.mod,n){var a,l=t.add,c=t.sel,h=this._data.core.selected.slice();if(o=this._model.data,c.length!==h.length||e.vakata.array_unique(c.concat(h)).length!==c.length){for(r=0,a=c.length;r<a;r++)-1===e.inArray(c[r],l)&&-1===e.inArray(c[r],h)&&(o[c[r]].state.selected=!1);for(r=0,a=h.length;r<a;r++)-1===e.inArray(h[r],c)&&(o[h[r]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!n&&d?d(function(){i.call(s,!0)}):i.call(s,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+l.toString()],{type:"text/javascript"}))),!this._data.core.working||r?(this._data.core.working=!0,o=new window.Worker(this._wrk),o.onmessage=e.proxy(function(e){c.call(this,e.data,!0);try{o.terminate(),o=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),a.par?o.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,n,i,!0])}catch(e){c.call(this,l(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else c.call(this,l(a),!1)}},_parse_model_from_html:function(n,i,r){r=r?[].concat(r):[],i&&r.unshift(i);var o,a,s,l,d,c=this._model.data,h={id:!1,text:!1,icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in this._model.default_state)this._model.default_state.hasOwnProperty(s)&&(h.state[s]=this._model.default_state[s]);if(l=e.vakata.attributes(n,!0),e.each(l,function(t,n){if(n=e.vakata.trim(n),!n.length)return!0;h.li_attr[t]=n,"id"===t&&(h.id=n.toString())}),l=n.children("a").first(),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,n){n=e.vakata.trim(n),n.length&&(h.a_attr[t]=n)})),l=n.children("a").first().length?n.children("a").first().clone():n.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div></div>").html(l),h.text=this.settings.core.force_text?l.text():l.html(),l=n.data(),h.data=l?e.extend(!0,{},l):null,h.state.opened=n.hasClass("jstree-open"),h.state.selected=n.children("a").hasClass("jstree-clicked"),h.state.disabled=n.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(s in h.data.jstree)h.data.jstree.hasOwnProperty(s)&&(h.state[s]=h.data.jstree[s]);l=n.children("a").children(".jstree-themeicon"),l.length&&(h.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),l=n.children("ul").children("li");do{d="j"+this._id+"_"+ ++this._cnt}while(c[d]);return h.id=h.li_attr.id?h.li_attr.id.toString():d,l.length?(l.each(e.proxy(function(t,n){o=this._parse_model_from_html(e(n),h.id,r),a=this._model.data[o],h.children.push(o),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d))},this)),h.children_d=h.children_d.concat(h.children)):n.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr.class&&(h.li_attr.class=h.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),h.a_attr.class&&(h.a_attr.class=h.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),c[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,n,i){i=i?i.concat():[],n&&i.unshift(n);var r,o,a,s,l=e.id.toString(),d=this._model.data,c=this._model.default_state,h={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:n,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in c)c.hasOwnProperty(r)&&(h.state[r]=c[r]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(h.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(h.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(h.li_attr[r]=e.li_attr[r]);if(h.li_attr.id||(h.li_attr.id=l),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(h.a_attr[r]=e.a_attr[r]);for(e&&e.children&&!0===e.children&&(h.state.loaded=!1,h.children=[],h.children_d=[]),d[h.id]=h,r=0,o=h.children.length;r<o;r++)a=this._parse_model_from_flat_json(d[h.children[r]],h.id,i),s=d[a],h.children_d.push(a),s.children_d.length&&(h.children_d=h.children_d.concat(s.children_d));return delete e.data,delete e.children,d[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,n,i){i=i?i.concat():[],n&&i.unshift(n);var r,o,a,s,l,d=!1,c=this._model.data,h=this._model.default_state;do{d="j"+this._id+"_"+ ++this._cnt}while(c[d]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:n,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in h)h.hasOwnProperty(r)&&(l.state[r]=h[r]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,
e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(l.state[r]=e.data.jstree[r]);if(e&&"object"==typeof e.state)for(r in e.state)e.state.hasOwnProperty(r)&&(l.state[r]=e.state[r]);if(e&&"object"==typeof e.li_attr)for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(l.li_attr[r]=e.li_attr[r]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=d),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(l.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,o=e.children.length;r<o;r++)a=this._parse_model_from_json(e.children[r],l.id,i),s=c[a],l.children.push(a),s.children_d.length&&(l.children_d=l.children_d.concat(s.children_d));l.children_d=l.children.concat(l.children_d)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,c[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var t,n,i,r=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),o=l.createElement("UL"),a=this._data.core.focused;for(n=0,i=r.length;n<i;n++)(t=this.redraw_node(r[n],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&o.appendChild(t);this._model.force_full_redraw&&(o.className=this.get_container_ul()[0].className,o.setAttribute("role","group"),this.element.empty().append(o)),null!==a&&this.settings.core.restore_focus&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==l.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:r})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var n=this.get_node(t),i=!1,r=!1,o=!1,a=l;if(!n)return!1;if(n.id===e.jstree.root)return this.redraw(!0);if(!(t=this.get_node(t,!0))||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],n.children.length&&n.state.loaded){for(o=a.createElement("UL"),o.setAttribute("role","group"),o.className="jstree-children",i=0,r=n.children.length;i<r;i++)o.appendChild(this.redraw_node(n.children[i],!0,!0));t.appendChild(o)}},redraw_node:function(t,n,i,r){var o=this.get_node(t),a=!1,s=!1,d=!1,c=!1,h=!1,u=!1,f="",g=l,p=this._model.data,m=!1,E=null,_=0,T=0,C=!1,v=!1;if(!o)return!1;if(o.id===e.jstree.root)return this.redraw(!0);if(n=n||0===o.children.length,t=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(o.id[0])?"\\3"+o.id[0]+" "+o.id.substr(1).replace(e.jstree.idregex,"\\$&"):o.id.replace(e.jstree.idregex,"\\$&"))):l.getElementById(o.id))t=e(t),i||(a=t.parent().parent()[0],a===this.element[0]&&(a=null),s=t.index()),n||!o.children.length||t.children(".jstree-children").length||(n=!0),n||(d=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===l.activeElement,t.remove();else if(n=!0,!i){if(!(null===(a=o.parent!==e.jstree.root?e("#"+o.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null)||a&&p[o.parent].state.opened))return!1;s=e.inArray(o.id,null===a?p[e.jstree.root].children:p[o.parent].children)}t=this._data.core.node.cloneNode(!0),f="jstree-node ";for(c in o.li_attr)if(o.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,o.li_attr[c]):f+=o.li_attr[c]}for(o.a_attr.id||(o.a_attr.id=o.id+"_anchor"),t.childNodes[1].setAttribute("aria-selected",!!o.state.selected),t.childNodes[1].setAttribute("aria-level",o.parents.length),this.settings.core.compute_elements_positions&&(t.childNodes[1].setAttribute("aria-setsize",p[o.parent].children.length),t.childNodes[1].setAttribute("aria-posinset",p[o.parent].children.indexOf(o.id)+1)),o.state.disabled&&t.childNodes[1].setAttribute("aria-disabled",!0),c=0,h=o.children.length;c<h;c++)if(!p[o.children[c]].state.hidden){C=!0;break}if(null!==o.parent&&p[o.parent]&&!o.state.hidden&&(c=e.inArray(o.id,p[o.parent].children),v=o.id,-1!==c))for(c++,h=p[o.parent].children.length;c<h&&(p[p[o.parent].children[c]].state.hidden||(v=p[o.parent].children[c]),v===o.id);c++);o.state.hidden&&(f+=" jstree-hidden"),o.state.loading&&(f+=" jstree-loading"),o.state.loaded&&!C?f+=" jstree-leaf":(f+=o.state.opened&&o.state.loaded?" jstree-open":" jstree-closed",t.childNodes[1].setAttribute("aria-expanded",o.state.opened&&o.state.loaded)),v===o.id&&(f+=" jstree-last"),t.id=o.id,t.className=f,f=(o.state.selected?" jstree-clicked":"")+(o.state.disabled?" jstree-disabled":"");for(h in o.a_attr)if(o.a_attr.hasOwnProperty(h)){if("href"===h&&"#"===o.a_attr[h])continue;"class"!==h?t.childNodes[1].setAttribute(h,o.a_attr[h]):f+=" "+o.a_attr[h]}if(f.length&&(t.childNodes[1].className="jstree-anchor "+f),(o.icon&&!0!==o.icon||!1===o.icon)&&(!1===o.icon?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===o.icon.indexOf("/")&&-1===o.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+o.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+o.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(g.createTextNode(o.text)):t.childNodes[1].innerHTML+=o.text,n&&o.children.length&&(o.state.opened||r)&&o.state.loaded){for(u=g.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",c=0,h=o.children.length;c<h;c++)u.appendChild(this.redraw_node(o.children[c],n,!0));t.appendChild(u)}if(d&&t.appendChild(d),!i){for(a||(a=this.element[0]),c=0,h=a.childNodes.length;c<h;c++)if(a.childNodes[c]&&a.childNodes[c].className&&-1!==a.childNodes[c].className.indexOf("jstree-children")){E=a.childNodes[c];break}E||(E=g.createElement("UL"),E.setAttribute("role","group"),E.className="jstree-children",a.appendChild(E)),a=E,s<a.childNodes.length?a.insertBefore(t,a.childNodes[s]):a.appendChild(t),m&&(_=this.element[0].scrollTop,T=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=_,this.element[0].scrollLeft=T)}return o.state.opened&&!o.state.loaded&&(o.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(o.id,!1,0)},this),0)),t},open_node:function(n,i,r){var o,a,s,l;if(e.isArray(n)){for(n=n.slice(),o=0,a=n.length;o<a;o++)this.open_node(n[o],i,r);return!0}return!(!(n=this.get_node(n))||n.id===e.jstree.root)&&(r=r===t?this.settings.core.animation:r,this.is_closed(n)?this.is_loaded(n)?(s=this.get_node(n,!0),l=this,s.length&&(r&&s.children(".jstree-children").length&&s.children(".jstree-children").stop(!0,!0),n.children.length&&!this._firstChild(s.children(".jstree-children")[0])&&this.draw_children(n),r?(this.trigger("before_open",{node:n}),s.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(r,function(){this.style.display="",l.element&&l.trigger("after_open",{node:n})})):(this.trigger("before_open",{node:n}),s[0].className=s[0].className.replace("jstree-closed","jstree-open"),s[0].childNodes[1].setAttribute("aria-expanded",!0))),n.state.opened=!0,i&&i.call(this,n,!0),s.length||this.trigger("before_open",{node:n}),this.trigger("open_node",{node:n}),r&&s.length||this.trigger("after_open",{node:n}),!0):this.is_loading(n)?setTimeout(e.proxy(function(){this.open_node(n,i,r)},this),500):void this.load_node(n,function(e,t){return t?this.open_node(e,i,r):!!i&&i.call(this,e,!1)}):(i&&i.call(this,n,!1),!1))},_open_to:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var n,i,r=t.parents;for(n=0,i=r.length;n<i;n+=1)n!==e.jstree.root&&this.open_node(r[n],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(n,i){var r,o,a,s;if(e.isArray(n)){for(n=n.slice(),r=0,o=n.length;r<o;r++)this.close_node(n[r],i);return!0}return!(!(n=this.get_node(n))||n.id===e.jstree.root)&&(!this.is_closed(n)&&(i=i===t?this.settings.core.animation:i,a=this,s=this.get_node(n,!0),n.state.opened=!1,this.trigger("close_node",{node:n}),void(s.length?i?s.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",s.children(".jstree-children").remove(),a.element&&a.trigger("after_close",{node:n})}):(s[0].className=s[0].className.replace("jstree-open","jstree-closed"),s.children(".jstree-anchor").attr("aria-expanded",!1),s.children(".jstree-children").remove(),this.trigger("after_close",{node:n})):this.trigger("after_close",{node:n}))))},toggle_node:function(t){var n,i;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.toggle_node(t[n]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,n,i){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var r,o,a,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!s.length){for(r=0,o=t.children_d.length;r<o;r++)this.is_closed(this._model.data[t.children_d[r]])&&(this._model.data[t.children_d[r]].state.opened=!0);return this.trigger("open_all",{node:t})}i=i||s,a=this,s=this.is_closed(t)?s.find(".jstree-closed").addBack():s.find(".jstree-closed"),s.each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,n,i)},n||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(t,n){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,r,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),a=this;for(o.length&&(o=this.is_open(t)?o.find(".jstree-open").addBack():o.find(".jstree-open"),e(o.get().reverse()).each(function(){a.close_node(this,n||0)})),i=0,r=t.children_d.length;i<r;i++)this._model.data[t.children_d[i]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(t){var n,i;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.enable_node(t[n]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:t})},disable_node:function(t){var n,i;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.disable_node(t[n]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:t})},is_hidden:function(e){return e=this.get_node(e),!0===e.state.hidden},hide_node:function(t,n){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.hide_node(t[i],!0);return n||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),n||this.redraw(),this.trigger("hide_node",{node:t}))},show_node:function(t,n){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.show_node(t[i],!0);return n||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),n||this.redraw(),this.trigger("show_node",{node:t}))},hide_all:function(t){var n,i=this._model.data,r=[];for(n in i)i.hasOwnProperty(n)&&n!==e.jstree.root&&!i[n].state.hidden&&(i[n].state.hidden=!0,r.push(n));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:r}),r},show_all:function(t){var n,i=this._model.data,r=[];for(n in i)i.hasOwnProperty(n)&&n!==e.jstree.root&&i[n].state.hidden&&(i[n].state.hidden=!1,r.push(n));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:r}),r},activate_node:function(e,n){if(this.is_disabled(e))return!1;if(n&&"object"==typeof n||(n={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&(!n.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(n.shiftKey){var i,r,o=this.get_node(e).id,a=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(i=0,r=s.length;i<r;i+=1)s[i]===o&&(l=!l),s[i]===a&&(l=!l),this.is_disabled(s[i])||!l&&s[i]!==o&&s[i]!==a?this.deselect_node(s[i],!0,n):this.is_hidden(s[i])||this.select_node(s[i],!0,!1,n);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:n})}else this.is_selected(e)?this.deselect_node(e,!1,n):this.select_node(e,!1,!1,n);else!this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,n):(this.deselect_all(!0),this.select_node(e,!1,!1,n),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:n})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),n=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){n.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(t,n,i,r){var o,a,s;if(e.isArray(t)){for(t=t.slice(),a=0,s=t.length;a<s;a++)this.select_node(t[a],n,i,r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;o=this.get_node(t,!0),t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),i||(o=this._open_to(t)),o&&o.length&&o.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:r}),n||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:r}))},deselect_node:function(t,n,i){var r,o,a;if(e.isArray(t)){for(t=t.slice(),r=0,o=t.length;r<o;r++)this.deselect_node(t[r],n,i);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:i}),n||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:i}))},select_all:function(t){var n,i,r=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),n=0,i=this._data.core.selected.length;n<i;n++)this._model.data[this._data.core.selected[n]]&&(this._model.data[this._data.core.selected[n]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:r})},deselect_all:function(e){var t,n,i=this._data.core.selected.concat([]);for(t=0,n=this._data.core.selected.length;t<n;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var n,i,r,o,a=this.get_selected(!0),s={};for(n=0,i=a.length;n<i;n++)s[a[n].id]=a[n];for(n=0,i=a.length;n<i;n++)for(r=0,o=a[n].children_d.length;r<o;r++)s[a[n].children_d[r]]&&delete s[a[n].children_d[r]];a=[];for(n in s)s.hasOwnProperty(n)&&a.push(n);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_bottom_selected:function(t){var n,i,r=this.get_selected(!0),o=[];for(n=0,i=r.length;n<i;n++)r[n].children.length||o.push(r[n].id);return t?e.map(o,e.proxy(function(e){return this.get_node(e)},this)):o},get_state:function(){var t,n={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.loaded&&this.settings.core.loaded_state&&n.core.loaded.push(t),this._model.data[t].state.opened&&n.core.open.push(t),this._model.data[t].state.selected&&n.core.selected.push(t));return n},set_state:function(n,i){if(n){if(n.core&&n.core.selected&&n.core.initial_selection===t&&(n.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),n.core){var r,o;if(n.core.loaded)return this.settings.core.loaded_state&&e.isArray(n.core.loaded)&&n.core.loaded.length?this._load_nodes(n.core.loaded,function(e){delete n.core.loaded,this.set_state(n,i)}):(delete n.core.loaded,this.set_state(n,i)),!1;if(n.core.open)return e.isArray(n.core.open)&&n.core.open.length?this._load_nodes(n.core.open,function(e){this.open_node(e,!1,0),delete n.core.open,this.set_state(n,i)}):(delete n.core.open,this.set_state(n,i)),!1;if(n.core.scroll)return n.core.scroll&&n.core.scroll.left!==t&&this.element.scrollLeft(n.core.scroll.left),n.core.scroll&&n.core.scroll.top!==t&&this.element.scrollTop(n.core.scroll.top),delete n.core.scroll,this.set_state(n,i),!1;if(n.core.selected)return r=this,n.core.initial_selection!==t&&n.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),e.each(n.core.selected,function(e,t){r.select_node(t,!1,!0)})),delete n.core.initial_selection,delete n.core.selected,this.set_state(n,i),!1;for(o in n)n.hasOwnProperty(o)&&"core"!==o&&-1===e.inArray(o,this.settings.plugins)&&delete n[o];if(e.isEmptyObject(n.core))return delete n.core,this.set_state(n,i),!1}return!e.isEmptyObject(n)||(n=null,i&&i.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,n){this._data.core.state=!0===n?{}:this.get_state(),n&&e.isFunction(n)&&(this._data.core.state=n.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,n){n&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var n=[],i=[],r=this._data.core.selected.concat([]);i.push(t.id),!0===t.state.opened&&n.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id),n.push(this.id)}),this._load_nodes(i,e.proxy(function(e){this.open_node(n,!1,0),this.select_node(r),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,n){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var i,r,o=this._model.data,a=t.id;for(n=n.toString(),o[t.parent].children[e.inArray(t.id,o[t.parent].children)]=n,i=0,r=t.parents.length;i<r;i++)o[t.parents[i]].children_d[e.inArray(t.id,o[t.parents[i]].children_d)]=n;for(i=0,r=t.children.length;i<r;i++)o[t.children[i]].parent=n;for(i=0,r=t.children_d.length;i<r;i++)o[t.children_d[i]].parents[e.inArray(t.id,o[t.children_d[i]].parents)]=n;return i=e.inArray(t.id,this._data.core.selected),-1!==i&&(this._data.core.selected[i]=n),i=this.get_node(t.id,!0),i&&(i.attr("id",n),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",n)),delete o[t.id],t.id=n,t.li_attr.id=n,o[n]=t,this.trigger("set_id",{node:t,new:t.id,old:a}),!0},get_text:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.text},set_text:function(t,n){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.set_text(t[i],n);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.text=n,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:n}),!0)},get_json:function(t,n,i){if(!(t=this.get_node(t||e.jstree.root)))return!1;n&&n.flat&&!i&&(i=[]);var r,o,a={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!n||!n.no_data)&&e.extend(!0,e.isArray(t.data)?[]:{},t.data)};if(n&&n.flat?a.parent=t.parent:a.children=[],n&&n.no_state)delete a.state;else for(r in t.state)t.state.hasOwnProperty(r)&&(a.state[r]=t.state[r]);if(n&&n.no_li_attr&&delete a.li_attr,n&&n.no_a_attr&&delete a.a_attr,n&&n.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),n&&n.flat&&t.id!==e.jstree.root&&i.push(a),!n||!n.no_children)for(r=0,o=t.children.length;r<o;r++)n&&n.flat?this.get_json(t.children[r],n,i):a.children.push(this.get_json(t.children[r],n));return n&&n.flat?i:t.id===e.jstree.root?a.children:a},create_node:function(n,i,r,o,a){if(null===n&&(n=e.jstree.root),!(n=this.get_node(n)))return!1;if(r=r===t?"last":r,!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(n))return this.load_node(n,function(){this.create_node(n,i,r,o,!0)});i||(i={text:this.get_string("New node")}),i="string"==typeof i?{text:i}:e.extend(!0,{},i),i.text===t&&(i.text=this.get_string("New node"));var s,l,d,c;switch(n.id===e.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":s=this.get_node(n.parent),r=e.inArray(n.id,s.children),n=s;break;case"after":s=this.get_node(n.parent),r=e.inArray(n.id,s.children)+1,n=s;break;case"inside":case"first":r=0;break;case"last":r=n.children.length;break;default:r||(r=0)}if(r>n.children.length&&(r=n.children.length),i.id||(i.id=!0),!this.check("create_node",i,n,r))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===i.id&&delete i.id,!(i=this._parse_model_from_json(i,n.id,n.parents.concat())))return!1;for(s=this.get_node(i),l=[],l.push(i),l=l.concat(s.children_d),this.trigger("model",{nodes:l,parent:n.id}),n.children_d=n.children_d.concat(l),d=0,c=n.parents.length;d<c;d++)this._model.data[n.parents[d]].children_d=this._model.data[n.parents[d]].children_d.concat(l);for(i=s,s=[],d=0,c=n.children.length;d<c;d++)s[d>=r?d+1:d]=n.children[d];return s[r]=i.id,n.children=s,this.redraw_node(n,!0),this.trigger("create_node",{node:this.get_node(i),parent:n.id,position:r}),o&&o.call(this,this.get_node(i)),i.id},rename_node:function(t,n){var i,r,o;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.rename_node(t[i],n);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(o=t.text,this.check("rename_node",t,this.get_parent(t),n)?(this.set_text(t,n),this.trigger("rename_node",{node:t,text:n,old:o}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var n,i,r,o,a,s,l,d,c,h,u,f;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.delete_node(t[n]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;if(r=this.get_node(t.parent),o=e.inArray(t.id,r.children),h=!1,!this.check("delete_node",t,r,o))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==o&&(r.children=e.vakata.array_remove(r.children,o)),a=t.children_d.concat([]),a.push(t.id),s=0,l=t.parents.length;s<l;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_filter(this._model.data[t.parents[s]].children_d,function(t){return-1===e.inArray(t,a)});for(d=0,c=a.length;d<c;d++)if(this._model.data[a[d]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return-1===e.inArray(t,a)})),this.trigger("delete_node",{node:t,parent:r.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:r.id}),d=0,c=a.length;d<c;d++)delete this._model.data[a[d]];return-1!==e.inArray(this._data.core.focused,a)&&(this._data.core.focused=null,u=this.element[0].scrollTop,f=this.element[0].scrollLeft,r.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(r,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=f),this.redraw_node(r,!0),!0},check:function(t,n,i,r,o){n=n&&n.id?n:this.get_node(n),i=i&&i.id?i:this.get_node(i);var a=t.match(/^move_node|copy_node|create_node$/i)?i:n,s=this.settings.core.check_callback;if("move_node"===t||"copy_node"===t){if(!(o&&o.is_multi||"move_node"!==t||e.inArray(n.id,i.children)!==r))return this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:t,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})},!1;if(!(o&&o.is_multi||n.id!==i.id&&("move_node"!==t||e.inArray(n.id,i.children)!==r)&&-1===e.inArray(i.id,n.children_d)))return this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})},!1}return a&&a.data&&(a=a.data),a&&a.functions&&(!1===a.functions[t]||!0===a.functions[t])?(!1===a.functions[t]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})}),a.functions[t]):!(!1===s||e.isFunction(s)&&!1===s.call(this,t,n,i,r,o)||s&&!1===s[t])||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(n,i,r,o,a,s,l){var d,c,h,u,f,g,p,m,E,_,T,C,v,O;if(i=this.get_node(i),r=r===t?0:r,!i)return!1;if(!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(n,i,r,o,!0,!1,l)});if(e.isArray(n)){if(1!==n.length){for(d=0,c=n.length;d<c;d++)(E=this.move_node(n[d],i,r,o,a,!1,l))&&(i=E,r="after");return this.redraw(),!0}n=n[0]}if(!(n=n&&n.id?n:this.get_node(n))||n.id===e.jstree.root)return!1;if(h=(n.parent||e.jstree.root).toString(),f=r.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,g=l||(this._model.data[n.id]?this:e.jstree.reference(n.id)),p=!g||!g._id||this._id!==g._id,u=g&&g._id&&h&&g._model.data[h]&&g._model.data[h].children?e.inArray(n.id,g._model.data[h].children):-1,g&&g._id&&(n=g._model.data[n.id]),p)return!!(E=this.copy_node(n,i,r,o,a,!1,l))&&(g&&g.delete_node(n),E);switch(i.id===e.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":r=e.inArray(i.id,f.children);break;case"after":r=e.inArray(i.id,f.children)+1;break;case"inside":case"first":r=0;break;case"last":r=f.children.length;break;default:r||(r=0)}if(r>f.children.length&&(r=f.children.length),!this.check("move_node",n,f,r,{core:!0,origin:l,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.parent===f.id){for(m=f.children.concat(),E=e.inArray(n.id,m),-1!==E&&(m=e.vakata.array_remove(m,E),r>E&&r--),E=[],_=0,T=m.length;_<T;_++)E[_>=r?_+1:_]=m[_];E[r]=n.id,f.children=E,this._node_changed(f.id),this.redraw(f.id===e.jstree.root)}else{for(E=n.children_d.concat(),E.push(n.id),_=0,T=n.parents.length;_<T;_++){for(m=[],O=g._model.data[n.parents[_]].children_d,C=0,v=O.length;C<v;C++)-1===e.inArray(O[C],E)&&m.push(O[C]);g._model.data[n.parents[_]].children_d=m}for(g._model.data[h].children=e.vakata.array_remove_item(g._model.data[h].children,n.id),_=0,T=f.parents.length;_<T;_++)this._model.data[f.parents[_]].children_d=this._model.data[f.parents[_]].children_d.concat(E);for(m=[],_=0,T=f.children.length;_<T;_++)m[_>=r?_+1:_]=f.children[_];for(m[r]=n.id,f.children=m,f.children_d.push(n.id),f.children_d=f.children_d.concat(n.children_d),n.parent=f.id,E=f.parents.concat(),E.unshift(f.id),O=n.parents.length,n.parents=E,E=E.concat(),_=0,T=n.children_d.length;_<T;_++)this._model.data[n.children_d[_]].parents=this._model.data[n.children_d[_]].parents.slice(0,-1*O),Array.prototype.push.apply(this._model.data[n.children_d[_]].parents,E);h!==e.jstree.root&&f.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(f.id)),s||this.redraw()}return o&&o.call(this,n,f,r),this.trigger("move_node",{node:n,parent:f.id,position:r,old_parent:h,old_position:u,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id,old_instance:g,new_instance:this}),n.id},copy_node:function(n,i,r,o,a,s,l){var d,c,h,u,f,g,p,m,E,_;if(i=this.get_node(i),r=r===t?0:r,!i)return!1;if(!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(n,i,r,o,!0,!1,l)});if(e.isArray(n)){if(1!==n.length){for(d=0,c=n.length;d<c;d++)(u=this.copy_node(n[d],i,r,o,a,!0,l))&&(i=u,r="after");return this.redraw(),!0}n=n[0]}if(!(n=n&&n.id?n:this.get_node(n))||n.id===e.jstree.root)return!1;switch(m=(n.parent||e.jstree.root).toString(),E=r.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,_=l||(this._model.data[n.id]?this:e.jstree.reference(n.id)),!_||!_._id||this._id!==_._id,_&&_._id&&(n=_._model.data[n.id]),i.id===e.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":r=e.inArray(i.id,E.children);break;case"after":r=e.inArray(i.id,E.children)+1;break;case"inside":case"first":r=0;break;case"last":r=E.children.length;break;default:r||(r=0)}if(r>E.children.length&&(r=E.children.length),!this.check("copy_node",n,E,r,{core:!0,origin:l,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(p=_?_.get_json(n,{no_id:!0,no_data:!0,no_state:!0}):n))return!1;if(!0===p.id&&delete p.id,!(p=this._parse_model_from_json(p,E.id,E.parents.concat())))return!1;for(u=this.get_node(p),n&&n.state&&!1===n.state.loaded&&(u.state.loaded=!1),h=[],h.push(p),h=h.concat(u.children_d),this.trigger("model",{
nodes:h,parent:E.id}),f=0,g=E.parents.length;f<g;f++)this._model.data[E.parents[f]].children_d=this._model.data[E.parents[f]].children_d.concat(h);for(h=[],f=0,g=E.children.length;f<g;f++)h[f>=r?f+1:f]=E.children[f];return h[r]=u.id,E.children=h,E.children_d.push(u.id),E.children_d=E.children_d.concat(u.children_d),E.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(E.id),s||this.redraw(E.id===e.jstree.root),o&&o.call(this,u,E,r),this.trigger("copy_node",{node:u,original:n,parent:E.id,position:r,old_parent:m,old_position:_&&_._id&&m&&_._model.data[m]&&_._model.data[m].children?e.inArray(n.id,_._model.data[m].children):-1,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),u.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var n,a,s,l=[];for(a=0,s=t.length;a<s;a++)(n=this.get_node(t[a]))&&n.id&&n.id!==e.jstree.root&&l.push(n);if(!l.length)return!1;i=l,o=this,r="move_node",this.trigger("cut",{node:t})},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var n,a,s,l=[];for(a=0,s=t.length;a<s;a++)(n=this.get_node(t[a]))&&n.id&&n.id!==e.jstree.root&&l.push(n);if(!l.length)return!1;i=l,o=this,r="copy_node",this.trigger("copy",{node:t})},get_buffer:function(){return{mode:r,node:i,inst:o}},can_paste:function(){return!1!==r&&!1!==i},paste:function(e,t){if(!((e=this.get_node(e))&&r&&r.match(/^(copy_node|move_node)$/)&&i))return!1;this[r](i,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:i,mode:r}),i=!1,r=!1,o=!1},clear_buffer:function(){i=!1,r=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,n,i){var r,o,a,s,d,c,h,u,f,g=!1;return!!(t=this.get_node(t))&&(this.check("edit",t,this.get_parent(t))?(f=t,n="string"==typeof n?n:t.text,this.set_text(t,""),t=this._open_to(t),f.text=n,r=this._data.core.rtl,o=this.element.width(),this._data.core.focused=f.id,a=t.children(".jstree-anchor").focus(),s=e("<span></span>"),d=n,c=e("<div></div>",{css:{position:"absolute",top:"-200px",left:r?"0px":"-1000px",visibility:"hidden"}}).appendTo(l.body),h=e("<input />",{value:d,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(n){n.stopImmediatePropagation(),n.preventDefault();var r,o=s.children(".jstree-rename-input"),l=o.val(),u=this.settings.core.force_text;""===l&&(l=d),c.remove(),s.replaceWith(a),s.remove(),d=u?d:e("<div></div>").append(e.parseHTML(d)).html(),t=this.get_node(t),this.set_text(t,d),r=!!this.rename_node(t,u?e("<div></div>").text(l).text():e("<div></div>").append(e.parseHTML(l)).html()),r||this.set_text(t,d),this._data.core.focused=f.id,setTimeout(e.proxy(function(){var e=this.get_node(f.id,!0);e.length&&(this._data.core.focused=f.id,e.children(".jstree-anchor").focus())},this),0),i&&i.call(this,f,r,g,l),h=null},this),keydown:function(e){var t=e.which;27===t&&(g=!0,this.value=d),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h.width(Math.min(c.text("pW"+this.value).width(),o))},keypress:function(e){if(13===e.which)return!1}}),u={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},s.attr("class",a.attr("class")).append(a.contents().clone()).append(h),a.replaceWith(s),c.css(u),h.css(u).width(Math.min(c.text("pW"+h[0].value).width(),o))[0].select(),void e(l).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(t,n){if(!t)return!1;if(!0===n){var i=this.settings.core.themes.dir;i||(i=e.jstree.path+"/themes"),n=i+"/"+t+"/style.css"}n&&-1===e.inArray(n,a)&&(e("head").append('<link rel="stylesheet" href="'+n+'" type="text/css" />'),a.push(n)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(n,i){var r,o,a,s;if(e.isArray(n)){for(n=n.slice(),r=0,o=n.length;r<o;r++)this.set_icon(n[r],i);return!0}return!(!(n=this.get_node(n))||n.id===e.jstree.root)&&(s=n.icon,n.icon=!0===i||null===i||i===t||""===i||i,a=this.get_node(n,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===i?(a.removeClass("jstree-themeicon-custom "+s).css("background","").removeAttr("rel"),this.hide_icon(n)):!0===i||null===i||i===t||""===i?(a.removeClass("jstree-themeicon-custom "+s).css("background","").removeAttr("rel"),!1===s&&this.show_icon(n)):-1===i.indexOf("/")&&-1===i.indexOf(".")?(a.removeClass(s).css("background",""),a.addClass(i+" jstree-themeicon-custom").attr("rel",i),!1===s&&this.show_icon(n)):(a.removeClass(s).css("background",""),a.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i),!1===s&&this.show_icon(n)),!0)},get_icon:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var n,i;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.hide_icon(t[n]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var n,i,r;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.show_icon(t[n]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(r=this.get_node(t,!0),t.icon=!r.length||r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,n){t=e(t)[0];var i=n?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,r){-1===e.inArray(r.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==r.value&&""!==e.vakata.trim(r.value)&&(n?i[r.name]=r.value:i.push(r.name))}),i},e.vakata.array_unique=function(e){var n,i,r=[],o={};for(n=0,i=e.length;n<i;n++)o[e[n]]===t&&(r.push(e[n]),o[e[n]]=!0);return r},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,n){var i=e.inArray(n,t);return-1!==i?e.vakata.array_remove(t,i):t},e.vakata.array_filter=function(e,t,n,i,r){if(e.filter)return e.filter(t,n);i=[];for(r in e)~~r+""==r+""&&r>=0&&t.call(n,e[r],+r,e)&&i.push(e[r]);return i},e.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},e.jstree.plugins.changed=function(e,t){var n=[];this.trigger=function(e,i){var r,o;if(i||(i={}),"changed"===e.replace(".jstree","")){i.changed={selected:[],deselected:[]};var a={};for(r=0,o=n.length;r<o;r++)a[n[r]]=1;for(r=0,o=i.selected.length;r<o;r++)a[i.selected[r]]?a[i.selected[r]]=2:i.changed.selected.push(i.selected[r]);for(r=0,o=n.length;r<o;r++)1===a[n[r]]&&i.changed.deselected.push(n[r]);n=i.selected.slice()}t.trigger.call(this,e,i)},this.refresh=function(e,i){return n=[],t.refresh.apply(this,arguments)}};var h=l.createElement("I");h.className="jstree-icon jstree-checkbox",h.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},e.jstree.plugins.checkbox=function(n,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var n,i,r=this._model.data,o=(r[t.parent],t.nodes);for(n=0,i=o.length;n<i;n++)r[o[n]].state.checked=r[o[n]].state.checked||r[o[n]].original&&r[o[n]].original.state&&r[o[n]].original.state.checked,r[o[n]].state.checked&&this._data.checkbox.selected.push(o[n])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",e.proxy(function(t,n){var i,r,o,a,s,l,d=this._model.data,c=d[n.parent],h=n.nodes,u=[],f=this.settings.checkbox.cascade,g=this.settings.checkbox.tie_selection;if(-1!==f.indexOf("down"))if(c.state[g?"selected":"checked"]){for(r=0,o=h.length;r<o;r++)d[h[r]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(h)}else for(r=0,o=h.length;r<o;r++)if(d[h[r]].state[g?"selected":"checked"]){for(a=0,s=d[h[r]].children_d.length;a<s;a++)d[d[h[r]].children_d[a]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(d[h[r]].children_d)}if(-1!==f.indexOf("up")){for(r=0,o=c.children_d.length;r<o;r++)d[c.children_d[r]].children.length||u.push(d[c.children_d[r]].parent);for(u=e.vakata.array_unique(u),a=0,s=u.length;a<s;a++)for(c=d[u[a]];c&&c.id!==e.jstree.root;){for(i=0,r=0,o=c.children.length;r<o;r++)i+=d[c.children[r]].state[g?"selected":"checked"];if(i!==o)break;c.state[g?"selected":"checked"]=!0,this._data[g?"core":"checkbox"].selected.push(c.id),(l=this.get_node(c,!0))&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(g?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[g?"core":"checkbox"].selected=e.vakata.array_unique(this._data[g?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,n){var i,r,o,a,s=n.node,l=this._model.data,d=this.get_node(s.parent),c=this.settings.checkbox.cascade,h=this.settings.checkbox.tie_selection,u={},f=this._data[h?"core":"checkbox"].selected;for(i=0,r=f.length;i<r;i++)u[f[i]]=!0;if(-1!==c.indexOf("down")){var g=this._cascade_new_checked_state(s.id,!0),p=s.children_d.concat(s.id);for(i=0,r=p.length;i<r;i++)g.indexOf(p[i])>-1?u[p[i]]=!0:delete u[p[i]]}if(-1!==c.indexOf("up"))for(;d&&d.id!==e.jstree.root;){for(o=0,i=0,r=d.children.length;i<r;i++)o+=l[d.children[i]].state[h?"selected":"checked"];if(o!==r)break;d.state[h?"selected":"checked"]=!0,u[d.id]=!0,(a=this.get_node(d,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}f=[];for(i in u)u.hasOwnProperty(i)&&f.push(i);this._data[h?"core":"checkbox"].selected=f},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,n){var i,r,o,a=this.get_node(e.jstree.root),s=this._model.data;for(i=0,r=a.children_d.length;i<r;i++)(o=s[a.children_d[i]])&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,n){var i,r,o,a=n.node,s=(this.get_node(a,!0),this.settings.checkbox.cascade),l=this.settings.checkbox.tie_selection,d=this._data[l?"core":"checkbox"].selected,c=a.children_d.concat(a.id);if(-1!==s.indexOf("down")){var h=this._cascade_new_checked_state(a.id,!1);d=e.vakata.array_filter(d,function(e){return-1===c.indexOf(e)||h.indexOf(e)>-1})}if(-1!==s.indexOf("up")&&-1===d.indexOf(a.id)){for(i=0,r=a.parents.length;i<r;i++)o=this._model.data[a.parents[i]],o.state[l?"selected":"checked"]=!1,o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1),(o=this.get_node(a.parents[i],!0))&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked");d=e.vakata.array_filter(d,function(e){return-1===a.parents.indexOf(e)})}this._data[l?"core":"checkbox"].selected=d},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,n){for(var i,r,o,a,s=this.get_node(n.parent),l=this._model.data,d=this.settings.checkbox.tie_selection;s&&s.id!==e.jstree.root&&!s.state[d?"selected":"checked"];){for(o=0,i=0,r=s.children.length;i<r;i++)o+=l[s.children[i]].state[d?"selected":"checked"];if(!(r>0&&o===r))break;s.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(s.id),(a=this.get_node(s,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),s=this.get_node(s.parent)}},this)).on("move_node.jstree",e.proxy(function(t,n){var i,r,o,a,s,l=n.is_multi,d=n.old_parent,c=this.get_node(n.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!l)for(i=this.get_node(d);i&&i.id!==e.jstree.root&&!i.state[u?"selected":"checked"];){for(r=0,o=0,a=i.children.length;o<a;o++)r+=h[i.children[o]].state[u?"selected":"checked"];if(!(a>0&&r===a))break;i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),(s=this.get_node(i,!0))&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=c;i&&i.id!==e.jstree.root;){for(r=0,o=0,a=i.children.length;o<a;o++)r+=h[i.children[o]].state[u?"selected":"checked"];if(r===a)i.state[u?"selected":"checked"]||(i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),(s=this.get_node(i,!0))&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!i.state[u?"selected":"checked"])break;i.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,i.id),(s=this.get_node(i,!0))&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this.get_undetermined=function(n){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];var i,r,o,a,s={},l=this._model.data,d=this.settings.checkbox.tie_selection,c=this._data[d?"core":"checkbox"].selected,h=[],u=this,f=[];for(i=0,r=c.length;i<r;i++)if(l[c[i]]&&l[c[i]].parents)for(o=0,a=l[c[i]].parents.length;o<a&&s[l[c[i]].parents[o]]===t;o++)l[c[i]].parents[o]!==e.jstree.root&&(s[l[c[i]].parents[o]]=!0,h.push(l[c[i]].parents[o]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var n,d=u.get_node(this);if(d)if(d.state.loaded){for(i=0,r=d.children_d.length;i<r;i++)if(n=l[d.children_d[i]],!n.state.loaded&&n.original&&n.original.state&&n.original.state.undetermined&&!0===n.original.state.undetermined)for(s[n.id]===t&&n.id!==e.jstree.root&&(s[n.id]=!0,h.push(n.id)),o=0,a=n.parents.length;o<a;o++)s[n.parents[o]]===t&&n.parents[o]!==e.jstree.root&&(s[n.parents[o]]=!0,h.push(n.parents[o]))}else if(d.original&&d.original.state&&d.original.state.undetermined&&!0===d.original.state.undetermined)for(s[d.id]===t&&d.id!==e.jstree.root&&(s[d.id]=!0,h.push(d.id)),o=0,a=d.parents.length;o<a;o++)s[d.parents[o]]===t&&d.parents[o]!==e.jstree.root&&(s[d.parents[o]]=!0,h.push(d.parents[o]))}),i=0,r=h.length;i<r;i++)l[h[i]].state[d?"selected":"checked"]||f.push(n?l[h[i]]:h[i]);return f},this._undetermined=function(){if(null!==this.element){var e,t,n,i=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),e=0,t=i.length;e<t;e++)(n=this.get_node(i[e],!0))&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(t,n,r,o){if(t=i.redraw_node.apply(this,arguments)){var a,s,l=null,d=null;for(a=0,s=t.childNodes.length;a<s;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){l=t.childNodes[a];break}l&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(l.className+=" jstree-checked"),d=h.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(d.className+=" jstree-checkbox-disabled"),l.insertBefore(d,l.childNodes[0]))}return r||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var n,i,r=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection,a=this._data[o?"core":"checkbox"].selected,s=this._model.data;if(!t||!0===t.state[o?"selected":"checked"]||-1===r.indexOf("undetermined")||-1===r.indexOf("down")&&-1===r.indexOf("up"))return!1;if(!t.state.loaded&&!0===t.original.state.undetermined)return!0;for(n=0,i=t.children_d.length;n<i;n++)if(-1!==e.inArray(t.children_d[n],a)||!s[t.children_d[n]].state.loaded&&s[t.children_d[n]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var n,i,r;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.disable_checkbox(t[n]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;r=this.get_node(t,!0),t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))},this.enable_checkbox=function(t){var n,i,r;if(e.isArray(t)){for(t=t.slice(),n=0,i=t.length;n<i;n++)this.enable_checkbox(t[n]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;r=this.get_node(t,!0),t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))},this.activate_node=function(t,n){return!e(n.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(n.target).hasClass("jstree-checkbox"))&&(n.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(n.target).hasClass("jstree-checkbox")?i.activate_node.call(this,t,n):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,n):this.check_node(t,n),void this.trigger("activate_node",{node:this.get_node(t)})))},this._cascade_new_checked_state=function(e,t){var n,i,r,o=this,a=this.settings.checkbox.tie_selection,s=this._model.data[e],l=[],d=[];if(!this.settings.checkbox.cascade_to_disabled&&s.state.disabled||!this.settings.checkbox.cascade_to_hidden&&s.state.hidden)r=this.get_checked_descendants(e),s.state[a?"selected":"checked"]&&r.push(s.id),l=l.concat(r);else{if(s.children)for(n=0,i=s.children.length;n<i;n++){var c=s.children[n];r=o._cascade_new_checked_state(c,t),l=l.concat(r),r.indexOf(c)>-1&&d.push(c)}var h=o.get_node(s,!0),u=d.length>0&&d.length<s.children.length;s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=u),u?(s.state[a?"selected":"checked"]=!1,h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked")):t&&d.length===s.children.length?(s.state[a?"selected":"checked"]=t,l.push(s.id),h.attr("aria-selected",!0).children(".jstree-anchor").addClass(a?"jstree-clicked":"jstree-checked")):(s.state[a?"selected":"checked"]=!1,h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked"))}return l},this.get_checked_descendants=function(t){var n=this,i=n.settings.checkbox.tie_selection,r=n._model.data[t];return e.vakata.array_filter(r.children_d,function(e){return n._model.data[e].state[i?"selected":"checked"]})},this.check_node=function(t,n){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,n);var i,r,o;if(e.isArray(t)){for(t=t.slice(),r=0,o=t.length;r<o;r++)this.check_node(t[r],n);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;i=this.get_node(t,!0),t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:n}))},this.uncheck_node=function(t,n){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,n);var i,r,o;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.uncheck_node(t[i],n);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;o=this.get_node(t,!0),t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),o.length&&o.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:n}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,n;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,n=this._data.checkbox.selected.length;t<n;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,n=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:n})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.checked},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var n,i,r,o,a=this.get_checked(!0),s={};for(n=0,i=a.length;n<i;n++)s[a[n].id]=a[n];for(n=0,i=a.length;n<i;n++)for(r=0,o=a[n].children_d.length;r<o;r++)s[a[n].children_d[r]]&&delete s[a[n].children_d[r]];a=[];for(n in s)s.hasOwnProperty(n)&&a.push(n);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var n,i,r=this.get_checked(!0),o=[];for(n=0,i=r.length;n<i;n++)r[n].children.length||o.push(r[n].id);return t?e.map(o,e.proxy(function(e){return this.get_node(e)},this)):o},this.load_node=function(t,n){var r,o,a;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(a=this.get_node(t))&&a.state.loaded)for(r=0,o=a.children_d.length;r<o;r++)this._model.data[a.children_d[r]].state.checked&&(!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,a.children_d[r]));return i.load_node.apply(this,arguments)},this.get_state=function(){var e=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,n){var r=i.set_state.apply(this,arguments);if(r&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var o=this;e.each(t.checkbox,function(e,t){o.check_node(t)})}return delete t.checkbox,this.set_state(t,n),!1}return r},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,n){if(this.settings.conditionalselect.call(this,this.get_node(e),n))return t.activate_node.call(this,e,n)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,n){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var n=e.jstree.reference(t.reference),i=n.get_node(t.reference);n.create_node(i,{},"last",function(e){try{n.edit(e)}catch(t){setTimeout(function(){n.edit(e)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var n=e.jstree.reference(t.reference),i=n.get_node(t.reference);n.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var n=e.jstree.reference(t.reference),i=n.get_node(t.reference);n.is_selected(i)?n.delete_node(n.get_selected()):n.delete_node(i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var n=e.jstree.reference(t.reference),i=n.get_node(t.reference);n.is_selected(i)?n.cut(n.get_top_selected()):n.cut(i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var n=e.jstree.reference(t.reference),i=n.get_node(t.reference);n.is_selected(i)?n.copy(n.get_top_selected()):n.copy(i)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var n=e.jstree.reference(t.reference),i=n.get_node(t.reference);n.paste(i)}}}}}}},e.jstree.plugins.contextmenu=function(n,i){this.bind=function(){i.bind.call(this);var t,n,r=0,o=null;this.element.on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),r=e.ctrlKey?+new Date:0,(t||o)&&(r=+new Date+1e4),o&&clearTimeout(o),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!r||+new Date-r>250)&&e.vakata.context.hide(),r=0},this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(t=i.originalEvent.changedTouches[0].clientX,n=i.originalEvent.changedTouches[0].clientY,o=setTimeout(function(){e(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(i){o&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(Math.abs(t-i.originalEvent.changedTouches[0].clientX)>10||Math.abs(n-i.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(o),e.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){o&&clearTimeout(o)}),e(l).on("context_hide.vakata.jstree",e.proxy(function(t,n){this._data.contextmenu.visible=!1,e(n.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(n,i,r,o){if(!(n=this.get_node(n))||n.id===e.jstree.root)return!1;var a=this.settings.contextmenu,s=this.get_node(n,!0),l=s.children(".jstree-anchor"),d=!1,c=!1;(a.show_at_node||i===t||r===t)&&(d=l.offset(),i=d.left,r=d.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(n)&&this.activate_node(n,o),c=a.items,e.isFunction(c)&&(c=c.call(this,n,e.proxy(function(e){this._show_contextmenu(n,i,r,e)},this))),e.isPlainObject(c)&&this._show_contextmenu(n,i,r,c)},this._show_contextmenu=function(t,n,i,r){var o=this.get_node(t,!0),a=o.children(".jstree-anchor");e(l).one("context_show.vakata.jstree",e.proxy(function(t,n){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(n.element).addClass(i),a.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:n,y:i},r),this.trigger("show_contextmenu",{node:t,x:n,y:i})}},function(e){var t=!1,n={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(l).triggerHandler("context_"+t+".vakata",{reference:n.reference,element:n.element,position:{x:n.position_x,y:n.position_y}})},_execute:function(t){return!(!(t=n.items[t])||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:n.reference,element:n.element
}))||!t.action)&&t.action.call(null,{item:t,reference:n.reference,element:n.element,position:{x:n.position_x,y:n.position_y}})},_parse:function(t,i){if(!t)return!1;i||(n.html="",n.items=[]);var r,o="",a=!1;return i&&(o+="<ul>"),e.each(t,function(t,i){if(!i)return!0;n.items.push(i),!a&&i.separator_before&&(o+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,o+="<li class='"+(i._class||"")+(!0===i._disabled||e.isFunction(i._disabled)&&i._disabled({item:i,reference:n.reference,element:n.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",o+="<a href='#' rel='"+(n.items.length-1)+"' "+(i.title?"title='"+i.title+"'":"")+">",e.vakata.context.settings.icons&&(o+="<i ",i.icon&&(-1!==i.icon.indexOf("/")||-1!==i.icon.indexOf(".")?o+=" style='background:url(\""+i.icon+"\") center center no-repeat' ":o+=" class='"+i.icon+"' "),o+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),o+=(e.isFunction(i.label)?i.label({item:t,reference:n.reference,element:n.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(r=e.vakata.context._parse(i.submenu,!0))&&(o+=r),o+="</li>",i.separator_after&&(o+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",a=!0)}),o=o.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(o+="</ul>"),i||(n.html=o,e.vakata.context._trigger("parse")),o.length>10&&o},_show_submenu:function(n){if(n=e(n),n.length&&n.children("ul").length){var i=n.children("ul"),r=n.offset().left,o=r+n.outerWidth(),a=n.offset().top,s=i.width(),l=i.height(),d=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?n[o-(s+10+n.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):n[o+s>d&&r>d-o?"addClass":"removeClass"]("vakata-context-right"),a+l+10>c&&i.css("bottom","-1px"),n.hasClass("vakata-context-right")?r<s&&i.css("margin-right",r-s):d-o<s&&i.css("margin-left",d-o-s),i.show()}},show:function(i,r,o){var a,s,d,c,h,u,f,g;switch(n.element&&n.element.length&&n.element.width(""),!0){case!r&&!i:return!1;case!!r&&!!i:n.reference=i,n.position_x=r.x,n.position_y=r.y;break;case!r&&!!i:n.reference=i,a=i.offset(),n.position_x=a.left+i.outerHeight(),n.position_y=a.top;break;case!!r&&!i:n.position_x=r.x,n.position_y=r.y}i&&!o&&e(i).data("vakata_contextmenu")&&(o=e(i).data("vakata_contextmenu")),e.vakata.context._parse(o)&&n.element.html(n.html),n.items.length&&(n.element.appendTo(l.body),s=n.element,d=n.position_x,c=n.position_y,h=s.width(),u=s.height(),f=e(window).width()+e(window).scrollLeft(),g=e(window).height()+e(window).scrollTop(),t&&(d-=s.outerWidth()-e(i).outerWidth())<e(window).scrollLeft()+20&&(d=e(window).scrollLeft()+20),d+h+20>f&&(d=f-(h+20)),c+u+20>g&&(c=g-(u+20)),n.element.css({left:d,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),n.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){n.is_visible&&(n.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),n.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e(l.body).css("direction");var i=!1;n.element=e("<ul class='vakata-context'></ul>"),n.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(i&&clearTimeout(i),n.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(i=setTimeout(function(t){return function(){e.vakata.context.hide()}}(),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||!1===e.vakata.context._execute(e(this).attr("rel"))||e.vakata.context.hide()}).on("keydown","a",function(t){var i=null;switch(t.which){case 13:case 32:t.type="click",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:n.is_visible&&(n.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:n.is_visible&&(i=n.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),i.length||(i=n.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:n.is_visible&&(n.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:n.is_visible&&(i=n.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),i.length||(i=n.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=n.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(l).on("mousedown.vakata.jstree",function(t){n.is_visible&&n.element[0]!==t.target&&!e.contains(n.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,i){n.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&n.element.addClass("vakata-context-rtl").css("direction","rtl"),n.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var u,f;e.jstree.plugins.dnd=function(t,n){this.init=function(e,t){n.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in l.createElement("span")},this.bind=function(){n.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var n=this.get_node(t.target),i=this.is_selected(n)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,r=i>1?i+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(r=e.vakata.html.escape(r)),n&&n.id&&n.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_top_selected(!0):[n],t))){if(u={jstree:!0,origin:this,obj:this.get_node(n,!0),nodes:i>1?this.get_top_selected():[n.id]},f=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,u,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+r+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:f,data:u})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:f,data:u}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:f,data:u}),!1},this))},this.redraw_node=function(e,t,i,r){if((e=n.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var o,a,s=null;for(o=0,a=e.childNodes.length;o<a;o++)if(e.childNodes[o]&&e.childNodes[o].className&&-1!==e.childNodes[o].className.indexOf("jstree-anchor")){s=e.childNodes[o];break}s&&s.setAttribute("draggable",!0)}return e}},e(function(){var n=!1,i=!1,r=!1,o=!1,a=e('<div id="jstree-marker">&#160;</div>').hide();e(l).on("dragover.vakata.jstree",function(t){f&&e.vakata.dnd._trigger("move",t,{helper:e(),element:f,data:u})}).on("drop.vakata.jstree",function(t){f&&(e.vakata.dnd._trigger("stop",t,{helper:e(),element:f,data:u}),f=null,u=null)}).on("dnd_start.vakata.jstree",function(e,t){n=!1,r=!1,t&&t.data&&t.data.jstree&&a.appendTo(l.body)}).on("dnd_move.vakata.jstree",function(s,l){var d=l.event.target!==r.target;if(o&&(l.event&&"dragover"===l.event.type&&!d||clearTimeout(o)),l&&l.data&&l.data.jstree&&(!l.event.target.id||"jstree-marker"!==l.event.target.id)){r=l.event;var c,h,u,f,g,p,m,E,_,T,C,v,O,I,D,R,b,y=e.jstree.reference(l.event.target),K=!1,k=!1,w=!1;if(y&&y._data&&y._data.dnd)if(a.attr("class","jstree-"+y.get_theme()+(y.settings.core.themes.responsive?" jstree-dnd-responsive":"")),D=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+y.get_theme()+" jstree-"+y.get_theme()+"-"+y.get_theme_variant()+" "+(y.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[D?"show":"hide"](),l.event.target!==y.element[0]&&l.event.target!==y.get_container_ul()[0]||0!==y.get_container_ul().children().length){if((K=y.settings.dnd.large_drop_target?e(l.event.target).closest(".jstree-node").children(".jstree-anchor"):e(l.event.target).closest(".jstree-anchor"))&&K.length&&K.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(k=K.offset(),w=(l.event.pageY!==t?l.event.pageY:l.event.originalEvent.pageY)-k.top,u=K.outerHeight(),p=w<u/3?["b","i","a"]:w>u-u/3?["a","i","b"]:w>u/2?["i","a","b"]:["i","b","a"],e.each(p,function(t,r){switch(r){case"b":c=k.left-6,h=k.top,f=y.get_parent(K),g=K.parent().index(),b="jstree-below";break;case"i":O=y.settings.dnd.inside_pos,I=y.get_node(K.parent()),c=k.left-2,h=k.top+u/2+1,f=I.id,g="first"===O?0:"last"===O?I.children.length:Math.min(O,I.children.length),b="jstree-inside";break;case"a":c=k.left-6,h=k.top+u,f=y.get_parent(K),g=K.parent().index()+1,b="jstree-above"}for(m=!0,E=0,_=l.data.nodes.length;E<_;E++)if(T=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",C=g,"move_node"===T&&"a"===r&&l.data.origin&&l.data.origin===y&&f===y.get_parent(l.data.nodes[E])&&(v=y.get_node(f),C>e.inArray(l.data.nodes[E],v.children)&&(C-=1)),!(m=m&&(y&&y.settings&&y.settings.dnd&&!1===y.settings.dnd.check_while_dragging||y.check(T,l.data.origin&&l.data.origin!==y?l.data.origin.get_node(l.data.nodes[E]):l.data.nodes[E],f,C,{dnd:!0,ref:y.get_node(K.parent()),pos:r,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==y,is_foreign:!l.data.origin})))){y&&y.last_error&&(i=y.last_error());break}if("i"===r&&K.parent().is(".jstree-closed")&&y.settings.dnd.open_timeout&&(l.event&&"dragover"===l.event.type&&!d||(o&&clearTimeout(o),o=setTimeout(function(e,t){return function(){e.open_node(t)}}(y,K),y.settings.dnd.open_timeout))),m)return R=y.get_node(f,!0),R.hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),R.addClass("jstree-dnd-parent")),n={ins:y,par:f,pos:"i"!==r||"last"!==O||0!==g||y.is_loaded(I)?g:"last"},a.css({left:c+"px",top:h+"px"}).show(),a.removeClass("jstree-above jstree-inside jstree-below").addClass(b),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=D?"copy":"move"),i={},p=!0,!1}),!0===p))return}else{for(m=!0,E=0,_=l.data.nodes.length;E<_&&(m=m&&y.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==y?l.data.origin.get_node(l.data.nodes[E]):l.data.nodes[E],e.jstree.root,"last",{dnd:!0,ref:y.get_node(e.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==y,is_foreign:!l.data.origin}));E++);if(m)return n={ins:y,par:e.jstree.root,pos:"last"},a.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=D?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),n=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer,a.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(a.hide(),n=!1,r=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,s){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),o&&clearTimeout(o),s&&s.data&&s.data.jstree){a.hide().detach();var l,d,c=[];if(n){for(l=0,d=s.data.nodes.length;l<d;l++)c[l]=s.data.origin?s.data.origin.get_node(s.data.nodes[l]):s.data.nodes[l];n.ins[s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node"](c,n.par,n.pos,!1,!1,!1,s.data.origin)}else l=e(s.event.target).closest(".jstree"),l.length&&i&&i.error&&"check"===i.error&&(l=l.jstree(!0))&&l.settings.core.error.call(this,i);r=!1,n=!1}}).on("keyup.jstree keydown.jstree",function(t,s){(s=e.vakata.dnd._get())&&s.data&&s.data.jstree&&("keyup"===t.type&&27===t.which?(o&&clearTimeout(o),n=!1,i=!1,r=!1,o=!1,a.hide().detach(),e.vakata.dnd._clean()):(s.helper.find(".jstree-copy").first()[s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),r&&(r.metaKey=t.metaKey,r.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",r))))})}),function(e){e.vakata.html={div:e("<div></div>"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(n,i,r){r===t&&(r=e.vakata.dnd._get()),r.event=i,e(l).triggerHandler("dnd_"+n+".vakata",r)},_get:function(){return{data:n.data,element:n.element,helper:n.helper}},_clean:function(){n.helper&&n.helper.remove(),n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},f=null,e(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!n.scroll_e||!n.scroll_l&&!n.scroll_t)return n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),!1;if(!n.scroll_i)return n.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(!0===t)return!1;var i=n.scroll_e.scrollTop(),r=n.scroll_e.scrollLeft();n.scroll_e.scrollTop(i+n.scroll_t*e.vakata.dnd.settings.scroll_speed),n.scroll_e.scrollLeft(r+n.scroll_l*e.vakata.dnd.settings.scroll_speed),i===n.scroll_e.scrollTop()&&r===n.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",n.scroll_e)},start:function(t,i,r){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return n.init_x=t.pageX,n.init_y=t.pageY,n.data=i,n.is_down=!0,n.element=t.currentTarget,n.target=t.target,n.is_touch="touchstart"===t.type,!1!==r&&(n.helper=e("<div id='vakata-dnd'></div>").html(r).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_down){if(!n.is_drag){if(!(Math.abs(t.pageX-n.init_x)>(n.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-n.init_y)>(n.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;n.helper&&(n.helper.appendTo(l.body),n.helper_w=n.helper.outerWidth()),n.is_drag=!0,e(n.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t)}var i=!1,r=!1,o=!1,a=!1,s=!1,d=!1,c=!1,h=!1,u=!1,f=!1;return n.scroll_t=0,n.scroll_l=0,n.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=e(this),r=i.offset();if(this.scrollHeight>this.offsetHeight&&(r.top+i.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),t.pageY-r.top<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(r.left+i.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),t.pageX-r.left<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1)),n.scroll_t||n.scroll_l)return n.scroll_e=e(this),!1}),n.scroll_e||(i=e(l),r=e(window),o=i.height(),a=r.height(),s=i.width(),d=r.width(),c=i.scrollTop(),h=i.scrollLeft(),o>a&&t.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1),o>a&&a-(t.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),s>d&&t.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1),s>d&&d-(t.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),(n.scroll_t||n.scroll_l)&&(n.scroll_e=i)),n.scroll_e&&e.vakata.dnd._scroll(!0),n.helper&&(u=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),f=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),o&&u+25>o&&(u=o-50),s&&f+n.helper_w>s&&(f=s-(n.helper_w+2)),n.helper.css({left:f+"px",top:u+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=l.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag)t.target!==n.target&&e(n.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===n.target){var i=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){i&&clearTimeout(i)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,n){this.init=function(e,t){this._data.massload={},n.init.call(this,e,t)},this._load_nodes=function(t,i,r,o){var a,s,l,d=this.settings.massload,c=[],h=this._model.data;if(!r){for(a=0,s=t.length;a<s;a++)h[t[a]]&&(h[t[a]].state.loaded||h[t[a]].state.failed)&&!o||(c.push(t[a]),(l=this.get_node(t[a],!0))&&l.length&&l.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},c.length){if(e.isFunction(d))return d.call(this,c,e.proxy(function(e){var a,s;if(e)for(a in e)e.hasOwnProperty(a)&&(this._data.massload[a]=e[a]);for(a=0,s=t.length;a<s;a++)(l=this.get_node(t[a],!0))&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);n._load_nodes.call(this,t,i,r,o)},this));if("object"==typeof d&&d&&d.url)return d=e.extend(!0,{},d),e.isFunction(d.url)&&(d.url=d.url.call(this,c)),e.isFunction(d.data)&&(d.data=d.data.call(this,c)),e.ajax(d).done(e.proxy(function(e,a,s){var d,c;if(e)for(d in e)e.hasOwnProperty(d)&&(this._data.massload[d]=e[d]);for(d=0,c=t.length;d<c;d++)(l=this.get_node(t[d],!0))&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);n._load_nodes.call(this,t,i,r,o)},this)).fail(e.proxy(function(e){n._load_nodes.call(this,t,i,r,o)},this))}}return n._load_nodes.call(this,t,i,r,o)},this._load_node=function(t,i){var r,o=this._data.massload[t.id],a=null;return o?(a=this["string"==typeof o?"_append_html_data":"_append_json_data"](t,"string"==typeof o?e(e.parseHTML(o)).filter(function(){return 3!==this.nodeType}):o,function(e){i.call(this,e)}),r=this.get_node(t.id,!0),r&&r.length&&r.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],a):n._load_node.call(this,t,i)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(n,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,n){if(this._data.search.som&&n.res.length){var i,r,o,a,s=this._model.data,l=[];for(i=0,r=n.res.length;i<r;i++)if(s[n.res[i]]&&!s[n.res[i]].state.hidden&&(l.push(n.res[i]),l=l.concat(s[n.res[i]].parents),this._data.search.smc))for(o=0,a=s[n.res[i]].children_d.length;o<a;o++)s[s[n.res[i]].children_d[o]]&&!s[s[n.res[i]].children_d[o]].state.hidden&&l.push(s[n.res[i]].children_d[o]);l=e.vakata.array_remove_item(e.vakata.array_unique(l),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(l,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(n,i,r,o,a,s){if(!1===n||""===e.vakata.trim(n.toString()))return this.clear_search();o=this.get_node(o),o=o&&o.id?o.id:null,n=n.toString();var l,d,c=this.settings.search,h=!!c.ajax&&c.ajax,u=this._model.data,f=null,g=[],p=[];if(this._data.search.res.length&&!a&&this.clear_search(),r===t&&(r=c.show_only_matches),s===t&&(s=c.show_only_matches_children),!i&&!1!==h)return e.isFunction(h)?h.call(this,n,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(n,!0,r,o,a,s)})},this),o):(h=e.extend({},h),h.data||(h.data={}),h.data.str=n,o&&(h.data.inside=o),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(n,!0,r,o,a,s)})},this)),this._data.search.lastRequest);if(a||(this._data.search.str=n,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=r,this._data.search.smc=s),f=new e.vakata.search(n,!0,{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy}),e.each(u[o||e.jstree.root].children_d,function(e,t){var i=u[t];i.text&&!i.state.hidden&&(!c.search_leaves_only||i.state.loaded&&0===i.children.length)&&(c.search_callback&&c.search_callback.call(this,n,i)||!c.search_callback&&f.search(i.text).isMatch)&&(g.push(t),p=p.concat(i.parents))}),g.length){for(p=e.vakata.array_unique(p),l=0,d=p.length;l<d;l++)p[l]!==e.jstree.root&&u[p[l]]&&!0===this.open_node(p[l],null,0)&&this._data.search.opn.push(p[l]);a?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(g))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=g),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:n,res:this._data.search.res,show_only_matches:r})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,n,r,o){if((t=i.redraw_node.apply(this,arguments))&&-1!==e.inArray(t.id,this._data.search.res)){var a,s,l=null;for(a=0,s=t.childNodes.length;a<s;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){l=t.childNodes[a];break}l&&(l.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,n,i){i=i||{},i=e.extend({},e.vakata.search.defaults,i),!1!==i.fuzzy&&(i.fuzzy=!0),t=i.caseSensitive?t:t.toLowerCase();var r,o,a,s,l=i.location,d=i.distance,c=i.threshold,h=t.length;return h>32&&(i.fuzzy=!1),i.fuzzy&&(r=1<<h-1,o=function(){var e={},n=0;for(n=0;n<h;n++)e[t.charAt(n)]=0;for(n=0;n<h;n++)e[t.charAt(n)]|=1<<h-n-1;return e}(),a=function(e,t){var n=e/h,i=Math.abs(l-t);return d?n+i/d:i?1:n}),s=function(e){if(e=i.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!i.fuzzy)return{isMatch:!1,score:1};var n,s,d,u,f,g,p,m,E,_=e.length,T=c,C=e.indexOf(t,l),v=h+_,O=1,I=[];for(-1!==C&&(T=Math.min(a(0,C),T),-1!==(C=e.lastIndexOf(t,l+h))&&(T=Math.min(a(0,C),T))),C=-1,n=0;n<h;n++){for(d=0,u=v;d<u;)a(n,l+u)<=T?d=u:v=u,u=Math.floor((v-d)/2+d);for(v=u,g=Math.max(1,l-u+1),p=Math.min(l+u,_)+h,m=new Array(p+2),m[p+1]=(1<<n)-1,s=p;s>=g;s--)if(E=o[e.charAt(s-1)],m[s]=0===n?(m[s+1]<<1|1)&E:(m[s+1]<<1|1)&E|(f[s+1]|f[s])<<1|1|f[s+1],m[s]&r&&(O=a(n,s-1))<=T){if(T=O,C=s-1,I.push(C),!(C>l))break;g=Math.max(1,2*l-C)}if(a(n+1,l)>T)break;f=m}return{isMatch:C>=0,score:O}},!0===n?{search:s}:s(n)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,n){this.bind=function(){n.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,n){var i,r;if((t=this.get_node(t))&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),n))for(i=0,r=t.children_d.length;i<r;i++)this.sort(t.children_d[i],!1)}};var g=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},e.jstree.plugins.state=function(t,n){this.bind=function(){n.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){g&&clearTimeout(g),g=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,n){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t=this.get_state();this.settings.state.preserve_loaded||delete t.core.loaded;var n={state:t,ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(n))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.settings.state.preserve_loaded||delete t.core.loaded,this.element.one("set_state.jstree",function(n,i){i.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={default:{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(n,i){this.init=function(n,r){var o,a;if(r&&r.types&&r.types.default)for(o in r.types)if("default"!==o&&o!==e.jstree.root&&r.types.hasOwnProperty(o))for(a in r.types.default)r.types.default.hasOwnProperty(a)&&r.types[o][a]===t&&(r.types[o][a]=r.types.default[a]);i.init.call(this,n,r),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,n){i.refresh.call(this,t,n),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(n,i){var r,o,a,s=this._model.data,l=i.nodes,d=this.settings.types,c="default";for(r=0,o=l.length;r<o;r++){if(c="default",s[l[r]].original&&s[l[r]].original.type&&d[s[l[r]].original.type]&&(c=s[l[r]].original.type),s[l[r]].data&&s[l[r]].data.jstree&&s[l[r]].data.jstree.type&&d[s[l[r]].data.jstree.type]&&(c=s[l[r]].data.jstree.type),s[l[r]].type=c,
!0===s[l[r]].icon&&d[c].icon!==t&&(s[l[r]].icon=d[c].icon),d[c].li_attr!==t&&"object"==typeof d[c].li_attr)for(a in d[c].li_attr)if(d[c].li_attr.hasOwnProperty(a)){if("id"===a)continue;s[l[r]].li_attr[a]===t?s[l[r]].li_attr[a]=d[c].li_attr[a]:"class"===a&&(s[l[r]].li_attr.class=d[c].li_attr.class+" "+s[l[r]].li_attr.class)}if(d[c].a_attr!==t&&"object"==typeof d[c].a_attr)for(a in d[c].a_attr)if(d[c].a_attr.hasOwnProperty(a)){if("id"===a)continue;s[l[r]].a_attr[a]===t?s[l[r]].a_attr[a]=d[c].a_attr[a]:"href"===a&&"#"===s[l[r]].a_attr[a]?s[l[r]].a_attr.href=d[c].a_attr.href:"class"===a&&(s[l[r]].a_attr.class=d[c].a_attr.class+" "+s[l[r]].a_attr.class)}}s[e.jstree.root].type=e.jstree.root},this)),i.bind.call(this)},this.get_json=function(t,n,r){var o,a,s=this._model.data,l=n?e.extend(!0,{},n,{no_id:!1}):{},d=i.get_json.call(this,t,l,r);if(!1===d)return!1;if(e.isArray(d))for(o=0,a=d.length;o<a;o++)d[o].type=d[o].id&&s[d[o].id]&&s[d[o].id].type?s[d[o].id].type:"default",n&&n.no_id&&(delete d[o].id,d[o].li_attr&&d[o].li_attr.id&&delete d[o].li_attr.id,d[o].a_attr&&d[o].a_attr.id&&delete d[o].a_attr.id);else d.type=d.id&&s[d.id]&&s[d.id].type?s[d.id].type:"default",n&&n.no_id&&(d=this._delete_ids(d));return d},this._delete_ids=function(t){if(e.isArray(t)){for(var n=0,i=t.length;n<i;n++)t[n]=this._delete_ids(t[n]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(n,r,o,a,s){if(!1===i.check.call(this,n,r,o,a,s))return!1;r=r&&r.id?r:this.get_node(r),o=o&&o.id?o:this.get_node(o);var l,d,c,h,u=r&&r.id?s&&s.origin?s.origin:e.jstree.reference(r.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,n){case"create_node":case"move_node":case"copy_node":if("move_node"!==n||-1===e.inArray(r.id,o.children)){if(l=this.get_rules(o),l.max_children!==t&&-1!==l.max_children&&l.max_children===o.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+n,data:JSON.stringify({chk:n,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!o||!o.id)&&o.id})},!1;if(l.valid_children!==t&&-1!==l.valid_children&&-1===e.inArray(r.type||"default",l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+n,data:JSON.stringify({chk:n,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!o||!o.id)&&o.id})},!1;if(u&&r.children_d&&r.parents){for(d=0,c=0,h=r.children_d.length;c<h;c++)d=Math.max(d,u[r.children_d[c]].parents.length);d=d-r.parents.length+1}(d<=0||d===t)&&(d=1);do{if(l.max_depth!==t&&-1!==l.max_depth&&l.max_depth<d)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+n,data:JSON.stringify({chk:n,pos:a,obj:!(!r||!r.id)&&r.id,par:!(!o||!o.id)&&o.id})},!1;o=this.get_node(o.parent),l=this.get_rules(o),d++}while(o)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var n=this.get_type(e,!0);return n.max_depth===t&&(n.max_depth=-1),n.max_children===t&&(n.max_children=-1),n.valid_children===t&&(n.valid_children=-1),n},this.get_type=function(t,n){return!!(t=this.get_node(t))&&(n?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(n,i){var r,o,a,s,l,d,c,h,u=this._model.data;if(e.isArray(n)){for(n=n.slice(),o=0,a=n.length;o<a;o++)this.set_type(n[o],i);return!0}if(r=this.settings.types,n=this.get_node(n),!r[i]||!n)return!1;if(c=this.get_node(n,!0),c&&c.length&&(h=c.children(".jstree-anchor")),s=n.type,l=this.get_icon(n),n.type=i,(!0===l||!r[s]||r[s].icon!==t&&l===r[s].icon)&&this.set_icon(n,r[i].icon===t||r[i].icon),r[s]&&r[s].li_attr!==t&&"object"==typeof r[s].li_attr)for(d in r[s].li_attr)if(r[s].li_attr.hasOwnProperty(d)){if("id"===d)continue;"class"===d?(u[n.id].li_attr.class=(u[n.id].li_attr.class||"").replace(r[s].li_attr[d],""),c&&c.removeClass(r[s].li_attr[d])):u[n.id].li_attr[d]===r[s].li_attr[d]&&(u[n.id].li_attr[d]=null,c&&c.removeAttr(d))}if(r[s]&&r[s].a_attr!==t&&"object"==typeof r[s].a_attr)for(d in r[s].a_attr)if(r[s].a_attr.hasOwnProperty(d)){if("id"===d)continue;"class"===d?(u[n.id].a_attr.class=(u[n.id].a_attr.class||"").replace(r[s].a_attr[d],""),h&&h.removeClass(r[s].a_attr[d])):u[n.id].a_attr[d]===r[s].a_attr[d]&&("href"===d?(u[n.id].a_attr[d]="#",h&&h.attr("href","#")):(delete u[n.id].a_attr[d],h&&h.removeAttr(d)))}if(r[i].li_attr!==t&&"object"==typeof r[i].li_attr)for(d in r[i].li_attr)if(r[i].li_attr.hasOwnProperty(d)){if("id"===d)continue;u[n.id].li_attr[d]===t?(u[n.id].li_attr[d]=r[i].li_attr[d],c&&("class"===d?c.addClass(r[i].li_attr[d]):c.attr(d,r[i].li_attr[d]))):"class"===d&&(u[n.id].li_attr.class=r[i].li_attr[d]+" "+u[n.id].li_attr.class,c&&c.addClass(r[i].li_attr[d]))}if(r[i].a_attr!==t&&"object"==typeof r[i].a_attr)for(d in r[i].a_attr)if(r[i].a_attr.hasOwnProperty(d)){if("id"===d)continue;u[n.id].a_attr[d]===t?(u[n.id].a_attr[d]=r[i].a_attr[d],h&&("class"===d?h.addClass(r[i].a_attr[d]):h.attr(d,r[i].a_attr[d]))):"href"===d&&"#"===u[n.id].a_attr[d]?(u[n.id].a_attr.href=r[i].a_attr.href,h&&h.attr("href",r[i].a_attr.href)):"class"===d&&(u[n.id].a_attr.class=r[i].a_attr.class+" "+u[n.id].a_attr.class,h&&h.addClass(r[i].a_attr[d]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(n,i){this.check=function(t,n,r,o,a){if(!1===i.check.call(this,t,n,r,o,a))return!1;if(n=n&&n.id?n:this.get_node(n),!(r=r&&r.id?r:this.get_node(r))||!r.children)return!0;var s,l,d,c="rename_node"===t?o:n.text,h=[],u=this.settings.unique.case_sensitive,f=this.settings.unique.trim_whitespace,g=this._model.data;for(s=0,l=r.children.length;s<l;s++)d=g[r.children[s]].text,u||(d=d.toLowerCase()),f&&(d=d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),h.push(d);switch(u||(c=c.toLowerCase()),f&&(c=c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),t){case"delete_node":return!0;case"rename_node":return d=n.text||"",u||(d=d.toLowerCase()),f&&(d=d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),s=-1===e.inArray(c,h)||n.text&&d===c,s||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})}),s;case"create_node":return s=-1===e.inArray(c,h),s||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})}),s;case"copy_node":return s=-1===e.inArray(c,h),s||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})}),s;case"move_node":return s=n.parent===r.id&&(!a||!a.is_multi)||-1===e.inArray(c,h),s||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})}),s}return!0},this.create_node=function(n,r,o,a,s){if(!r||r.text===t){if(null===n&&(n=e.jstree.root),!(n=this.get_node(n)))return i.create_node.call(this,n,r,o,a,s);if(o=o===t?"last":o,!o.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(n))return i.create_node.call(this,n,r,o,a,s);r||(r={});var l,d,c,h,u,f,g=this._model.data,p=this.settings.unique.case_sensitive,m=this.settings.unique.trim_whitespace,E=this.settings.unique.duplicate;for(d=l=this.get_string("New node"),c=[],h=0,u=n.children.length;h<u;h++)f=g[n.children[h]].text,p||(f=f.toLowerCase()),m&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),c.push(f);for(h=1,f=d,p||(f=f.toLowerCase()),m&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==e.inArray(f,c);)d=E.call(this,l,++h).toString(),f=d,p||(f=f.toLowerCase()),m&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));r.text=d}return i.create_node.call(this,n,r,o,a,s)}};var p=l.createElement("DIV");if(p.setAttribute("unselectable","on"),p.setAttribute("role","presentation"),p.className="jstree-wholerow",p.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,n){this.bind=function(){n.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var n,i,r=!1;for(n=0,i=t.selected.length;n<i;n++)(r=this.get_node(t.selected[n],!0))&&r.length&&r.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var n=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var n=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var n=e.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var n=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),n.teardown.call(this)},this.redraw_node=function(t,i,r,o){if(t=n.redraw_node.apply(this,arguments)){var a=p.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(a.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(a.className+=" jstree-wholerow-hovered"),t.insertBefore(a,t.childNodes[0])}return t}},window.customElements&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var t,n={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(n.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(n[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(n.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(n)};try{window.customElements.define("vakata-jstree",function(){},{prototype:m})}catch(e){}}}}),function(e){"use strict";"function"==typeof define&&define.amd?define("jstree-actions",["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";e.jstree.defaults.actions=e.noop,e.jstree.plugins.actions=function(e,t){this._actions={},this.add_action=function(e,t){for(var n=this,i="object"==typeof e?e:[e],r=i.indexOf("all")>-1,o=0;o<i.length;o++){var a=i[o],s=n._actions[a]=n._actions[a]||[];n._has_action(a,t.id)||(s.push(t),r||this.redraw_node(a))}r&&this.redraw(!0)},this.remove_action=function(e,t){for(var n=this,i="object"==typeof e?e:"all"===e?Object.keys(this._actions):[e],r=i.indexOf("all")>-1,o=0;o<i.length;o++){e=i[o];for(var a=n._actions[e]||[],s=[],l=0;l<a.length;l++){var d=a[l];d.id!==t&&"all"!==t&&s.push(d)}var c=a.map(function(e){return e.id}),h=s.map(function(e){return e.id});(c.length!=h.length||c.filter(function(e){return-1===h.indexOf(e)}).length)&&(n._actions[e]=s,r||this.redraw_node(e))}r&&this.redraw(!0)},this._create_action=function(e,t){var n=this,i=this._get_action(e,t);if(null===i)return null;var r=document.createElement("i");return r.className=i.class,r.textContent=i.text,i.title&&i.title.length>0&&(r.title=i.title),r.onclick=function(o){var a=n.get_node(r);i.callback(e,a,t,r,o)},{action:i,action_el:r}},this._get_action=function(e,t){for(var n=this._actions[e]||[],i=null,r=0;r<n.length;r++){var o=n[r];o.id===t&&(i=o)}return i},this._set_action=function(e,t,n){if(null!==n){var i=t.querySelector(n.action.selector);n.action.after?i.parentNode.insertBefore(n.action_el,i.nextSibling):t.insertBefore(n.action_el,i)}},this._has_action=function(e,t){var n=!1,i=this._actions;if(i.hasOwnProperty(e))for(var r=0;r<i[e].length;r++)i[e][r].id===t&&(n=!0);if(this._actions.hasOwnProperty("all"))for(r=0;r<i.all.length;r++)i.all[r].id===t&&(n=!0);return n},this.redraw_node=function(e,n,i,r){var o=this,a="object"==typeof e?e.id:e,s=t.redraw_node.call(this,e,n,i,r);if(s){for(var l=this._actions[a]||[],d=0;d<l.length;d++){var c=o._create_action(a,l[d].id);o._set_action(a,s,c)}for(l=this._actions.all||[],d=0;d<l.length;d++)c=o._create_action("all",l[d].id),o._set_action(a,s,c)}return s}}});var SaveButton={init:function(e){var t={disabled:!1,csrftoken:e.csrftoken,$save:$("<span/>").text(SaveButton.message.SAVE).click(function(e){t.fire("save",e)}).addClass("btn btn-info"),$retry:$("<span/>").text(SaveButton.message.RETRY).click(function(e){t.fire("save",e)}).addClass("btn btn-info"),$saving:$("<span/>").text(SaveButton.message.SAVING).prepend('<i class="fa fa-refresh icon-spin"></i> ').addClass("btn btn-info disabled"),$saved:$("<span/>").text(SaveButton.message.SAVED).addClass("btn btn-info disabled"),ui:$("<div/>").addClass("pull-right"),setStateWhenReady:function(e){"saving"===this.state?this.nextState=e:this.setState(e)},setState:function(e){this.state!==e&&(this.state=e,this.$save.detach(),this.$saving.detach(),this.$saved.detach(),this.$retry.detach(),"save"===e?this.ui.append(this.$save):"saving"===e?this.ui.append(this.$saving):"saved"===e?this.ui.append(this.$saved):"retry"===e&&this.ui.append(this.$retry),this.fire("state:change"))},ajaxOptions:function(e){var e=e||{},t=e.beforeSend||function(){},n=e.success||function(){},i=e.error||function(){},r=this;return e.beforeSend=function(e){r.csrftoken&&!this.crossDomain&&e.setRequestHeader("X-CSRFToken",r.csrftoken),r.setState("saving"),r.nextState="saved",t.apply(this,arguments)},e.success=function(e){r.setState(r.nextState),n.apply(this,arguments)},e.error=function(e){r.nextState=null,r.setState("retry"),alert(SaveButton.message.ERROR_SAVING),i.apply(this,arguments)},e},ajax:function(e){if(e=t.ajaxOptions(e),"function"==typeof e.url){e.beforeSend();var n=e.url(e.data);e.success(n||{})}else $.ajax(e)},beforeunload:function(){var n="html"==t.ui.parents()[t.ui.parents().length-1].tagName.toLowerCase();if("saved"!==t.state&&n)return e.unsavedMessage||""}};return eventize(t),t.setState("saved"),t.on("change",function(){this.setStateWhenReady("save")}),t.on("disable",function(){this.disabled=!0,this.$save.addClass("disabled"),this.$saving.addClass("disabled"),this.$retry.addClass("disabled")}),t.on("enable",function(){this.disabled=!1,this.$save.removeClass("disabled"),this.$saving.removeClass("disabled"),this.$retry.removeClass("disabled")}),t.on("save",function(n){if(!t.disabled)if(e.save)e.save(n);else if(e.saveRequest){var i=t.ajaxOptions();i.beforeSend(),e.saveRequest(n).success(i.success).error(i.error)}}),t},initForm:function(e,t){var n=e.attr("action"),i=SaveButton.init({unsavedMessage:t.unsavedMessage,save:function(){i.ajax({url:n,type:"POST",dataType:"json",data:e.serialize(),success:t.success})}}),r=function(){i.fire("change")};return e.find("*").change(r),e.find("input, textarea").bind("textchange",r),i},message:{SAVE:"Save",SAVING:"Saving",SAVED:"Saved",RETRY:"Try Again",ERROR_SAVING:"There was an error saving"}},eventize=function(e){"use strict";var t={};return e.on=function(n,i){return void 0===t[n]&&(t[n]=[]),t[n].push(i),e},e.fire=function(n,i){var r;if(void 0!==t[n])for(r=0;r<t[n].length;r+=1)t[n][r].apply(e,[i]);return e},e};define("save-button",["jquery"],function(e){return function(){return e.SaveButton}}(this)),function(){window.CKEDITOR&&window.CKEDITOR.dom||(window.CKEDITOR||(window.CKEDITOR=function(){var e=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,t={timestamp:"N2U9",version:"4.21.0 DEV",revision:"5d9709a2f5",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:e},status:"unloaded",basePath:function(){var t=window.CKEDITOR_BASEPATH||"";if(!t)for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++){var r=n[i].src.match(e);if(r){t=r[1];break}}if(-1==t.indexOf(":/")&&"//"!=t.slice(0,2)&&(t=0===t.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+t:location.href.match(/^[^\?]*\/(?:)/)[0]+t),!t)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return t}(),getUrl:function(e){return-1==e.indexOf(":/")&&0!==e.indexOf("/")&&(e=this.basePath+e),e=this.appendTimestamp(e)},appendTimestamp:function(e){return!this.timestamp||"/"===e.charAt(e.length-1)||/[&?]t=/.test(e)?e:e+(0<=e.indexOf("?")?"&":"?")+"t="+this.timestamp},domReady:function(){function e(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",e,!1),window.removeEventListener("load",e,!1),t()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),window.detachEvent("onload",e),t())}catch(e){}}function t(){for(var e;e=n.shift();)e()}var n=[];return function(t){function i(){try{document.documentElement.doScroll("left")}catch(e){return void setTimeout(i,1)}e()}if(n.push(t),"complete"===document.readyState&&setTimeout(e,1),1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",e),window.attachEvent("onload",e),t=!1;try{t=!window.frameElement}catch(e){}document.documentElement.doScroll&&t&&i()}}}()},n=window.CKEDITOR_GETURL;if(n){var i=t.getUrl;t.getUrl=function(e){return n.call(t,e)||i.call(t,e)}}return t}()),function(){var e={};CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(e){var t,n=CKEDITOR.event.prototype;for(t in n)null==e[t]&&(e[t]=n[t])},CKEDITOR.event.prototype=function(){function t(e){var t=n(this);return t[e]||(t[e]=new i(e))}var n=function(e){return e=e.getPrivate&&e.getPrivate()||e._||(e._={}),e.events||(e.events={})},i=function(e){this.name=e,this.listeners=[]};return i.prototype={getListenerIndex:function(e){for(var t=0,n=this.listeners;t<n.length;t++)if(n[t].fn==e)return t;return-1}},{define:function(e,n){var i=t.call(this,e);CKEDITOR.tools.extend(i,n,!0)},on:function(n,i,r,o,a){function s(t,a,s,d){return t={name:n,sender:this,editor:t,data:a,listenerData:o,stop:s,cancel:d,removeListener:l},!1===i.call(r,t)?e:t.data}function l(){d.removeListener(n,i)}var d=this,c=t.call(this,n);if(0>c.getListenerIndex(i)){c=c.listeners,r||(r=this),isNaN(a)&&(a=10),s.fn=i,s.priority=a;for(var h=c.length-1;0<=h;h--)if(c[h].priority<=a)return c.splice(h+1,0,s),{removeListener:l};c.unshift(s)}return{removeListener:l}},once:function(){var e=Array.prototype.slice.call(arguments),t=e[1];return e[1]=function(e){return e.removeListener(),t.apply(this,arguments)},this.on.apply(this,e)},capture:function(){CKEDITOR.event.useCapture=1;var e=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,e},fire:function(){var t=0,i=function(){t=1},r=0,o=function(){r=1};return function(a,s,l){var d=n(this)[a];a=t;var c=r;if(t=r=0,d){var h=d.listeners;if(h.length)for(var u,h=h.slice(0),f=0;f<h.length;f++){if(d.errorProof)try{u=h[f].call(this,l,s,i,o)}catch(e){}else u=h[f].call(this,l,s,i,o);if(u===e?r=1:void 0!==u&&(s=u),t||r)break}}return s=!r&&(void 0===s||s),t=a,r=c,s}}(),fireOnce:function(e,t,i){return t=this.fire(e,t,i),delete n(this)[e],t},removeListener:function(e,t){var i=n(this)[e];if(i){var r=i.getListenerIndex(t);0<=r&&i.listeners.splice(r,1)}},removeAllListeners:function(){var e,t=n(this);for(e in t)delete t[e]},hasListeners:function(e){return(e=n(this)[e])&&0<e.listeners.length}}}())}(),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fire.call(this,e,t,this)},CKEDITOR.editor.prototype.fireOnce=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fireOnce.call(this,e,t,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var e=navigator.userAgent.toLowerCase(),t=e.match(/edge[ \/](\d+.?\d*)/),n=-1<e.indexOf("trident/"),n=!(!t&&!n),n={ie:n,edge:!!t,webkit:!n&&-1<e.indexOf(" applewebkit/"),air:-1<e.indexOf(" adobeair/"),mac:-1<e.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode&&(!document.documentMode||10>document.documentMode),mobile:-1<e.indexOf("mobile"),iOS:/(ipad|iphone|ipod)/.test(e),isCustomDomain:function(){if(!this.ie)return!1;var e=document.domain,t=window.location.hostname;return e!=t&&e!="["+t+"]"},secure:"https:"==location.protocol};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.ie,n.webkit&&(-1<e.indexOf("chrome")?n.chrome=!0:n.safari=!0);var i=0;return n.ie&&(i=t?parseFloat(t[1]):n.quirks||!document.documentMode?parseFloat(e.match(/msie (\d+)/)[1]):document.documentMode,n.ie9Compat=9==i,n.ie8Compat=8==i,n.ie7Compat=7==i,n.ie6Compat=7>i||n.quirks),n.gecko&&(t=e.match(/rv:([\d\.]+)/))&&(t=t[1].split("."),i=1e4*t[0]+100*(t[1]||0)+1*(t[2]||0)),n.air&&(i=parseFloat(e.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=i,n.isCompatible=!(n.ie&&7>i||n.gecko&&4e4>i||n.webkit&&534>i),n.hidpi=2<=window.devicePixelRatio,n.needsBrFiller=n.gecko||n.webkit||n.ie&&10<i,n.needsNbspFiller=n.ie&&11>i,n.cssClass="cke_browser_"+(n.ie?"ie":n.gecko?"gecko":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass+=" cke_browser_quirks"),n.ie&&(n.cssClass+=" cke_browser_ie"+(n.quirks?"6 cke_browser_iequirks":n.version)),n.air&&(n.cssClass+=" cke_browser_air"),n.iOS&&(n.cssClass+=" cke_browser_ios"),n.hidpi&&(n.cssClass+=" cke_hidpi"),n}()),"unloaded"==CKEDITOR.status&&function(){CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if("basic_ready"!=CKEDITOR.status)CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var e=document.createElement("script");e.type="text/javascript",e.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(e)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(e){(this._.pending||(this._.pending=[])).push(e)},function(){CKEDITOR.domReady(function(){var e=CKEDITOR.loadFullCore,t=CKEDITOR.loadFullCoreTimeout;e&&(CKEDITOR.status="basic_ready",e&&e._load?e():t&&setTimeout(function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()},1e3*t))})}(),CKEDITOR.status="basic_loaded"}(),CKEDITOR.VERBOSITY_WARN=1,CKEDITOR.VERBOSITY_ERROR=2,CKEDITOR.verbosity=CKEDITOR.VERBOSITY_WARN|CKEDITOR.VERBOSITY_ERROR,CKEDITOR.warn=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_WARN&&CKEDITOR.fire("log",{type:"warn",errorCode:e,additionalData:t})},CKEDITOR.error=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_ERROR&&CKEDITOR.fire("log",{type:"error",errorCode:e,additionalData:t})},CKEDITOR.on("log",function(e){if(window.console&&window.console.log){var t=console[e.data.type]?e.data.type:"log",n=e.data.errorCode;(e=e.data.additionalData)?console[t]("[CKEDITOR] Error code: "+n+".",e):console[t]("[CKEDITOR] Error code: "+n+"."),console[t]("[CKEDITOR] For more information about this error go to https://ckeditor.com/docs/ckeditor4/latest/guide/dev_errors.html#"+n)}},null,null,999),CKEDITOR.dom={},function(){function e(e,t,n){this._minInterval=e,this._context=n,this._lastOutput=this._scheduledTimer=0,this._output=CKEDITOR.tools.bind(t,n||{});var i=this;this.input=function(){function e(){i._lastOutput=(new Date).getTime(),i._scheduledTimer=0,i._call()}if(!i._scheduledTimer||!1!==i._reschedule()){var t=(new Date).getTime()-i._lastOutput;t<i._minInterval?i._scheduledTimer=setTimeout(e,i._minInterval-t):e()}}}function t(t,n,i){e.call(this,t,n,i),this._args=[];var r=this;this.input=CKEDITOR.tools.override(this.input,function(e){return function(){r._args=Array.prototype.slice.call(arguments),e.call(this)}})}var n=[],i=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",r=/&/g,o=/>/g,a=/</g,s=/"/g,l=/&(lt|gt|amp|quot|nbsp|shy|#\d{1,5});/g,d={lt:"<",gt:">",amp:"&",quot:'"',nbsp:"\xa0",shy:"\xad"},c=function(e,t){return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1),10)):d[t]};CKEDITOR.on("reset",function(){n=[]}),CKEDITOR.tools={arrayCompare:function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},getIndex:function(e,t){for(var n=0;n<e.length;++n)if(t(e[n]))return n;return-1},clone:function(e){var t;if(e&&e instanceof Array){t=[];for(var n=0;n<e.length;n++)t[n]=CKEDITOR.tools.clone(e[n]);return t}if(null===e||"object"!=typeof e||e instanceof String||e instanceof Number||e instanceof Boolean||e instanceof Date||e instanceof RegExp||e.nodeType||e.window===e)return e;t=new e.constructor;for(n in e)t[n]=CKEDITOR.tools.clone(e[n]);return t},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},extend:function(e){var t,n,i=arguments.length;"boolean"==typeof(t=arguments[i-1])?i--:"boolean"==typeof(t=arguments[i-2])&&(n=arguments[i-1],i-=2);for(var r=1;r<i;r++){var o=arguments[r]||{};CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(o),function(i){!0!==t&&null!=e[i]||(!n||i in n)&&(e[i]=o[i])})}return e},prototypedCopy:function(e){var t=function(){};return t.prototype=e,new t},copy:function(e){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},cssVendorPrefix:function(e,t,n){return n?i+e+":"+t+";"+e+":"+t:(n={},n[e]=t,n[i+e]=t,n)},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t=void 0!==e.cssFloat?"cssFloat":void 0!==e.styleFloat?"styleFloat":"float";return function(e){return"float"==e?t:e.replace(/-./g,function(e){return e.substr(1).toUpperCase()})}}(),buildStyleHtml:function(e){e=[].concat(e);for(var t,n=[],i=0;i<e.length;i++)(t=e[i])&&(/@import|[{}]/.test(t)?n.push("<style>"+t+"</style>"):(t=CKEDITOR.appendTimestamp(t),n.push('<link type="text/css" rel=stylesheet href="'+t+'">')));return n.join("")},htmlEncode:function(e){return void 0===e||null===e?"":String(e).replace(r,"&amp;").replace(o,"&gt;").replace(a,"&lt;")},htmlDecode:function(e){return e.replace(l,c)},htmlEncodeAttr:function(e){return CKEDITOR.tools.htmlEncode(e).replace(s,"&quot;")},htmlDecodeAttr:function(e){return CKEDITOR.tools.htmlDecode(e)},transformPlainTextToHtml:function(e,t){var n=t==CKEDITOR.ENTER_BR,i=this.htmlEncode(e.replace(/\r\n/g,"\n")),i=i.replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),r=t==CKEDITOR.ENTER_P?"p":"div";if(!n){var o=/\n{2}/g;if(o.test(i))var a="<"+r+">",s="</"+r+">",i=a+i.replace(o,function(){return s+a})+s}return i=i.replace(/\n/g,"<br>"),n||(i=i.replace(new RegExp("<br>(?=</"+r+">)"),function(e){return CKEDITOR.tools.repeat(e,2)})),i=i.replace(/^ | $/g,"&nbsp;"),i=i.replace(/(>|\s) /g,function(e,t){return t+"&nbsp;"}).replace(/ (?=<)/g,"&nbsp;")},getNextNumber:function(){var e=0;return function(){return++e}}(),getNextId:function(){return"cke_"+this.getNextNumber()},getUniqueId:function(){for(var e="e",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},override:function(e,t){var n=t(e);return n.prototype=e.prototype,n},setTimeout:function(e,t,n,i,r){return r||(r=window),n||(n=r),r.setTimeout(function(){i?e.apply(n,[].concat(i)):e.apply(n)},t||0)},debounce:function(e,t){var n;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout(function(){n=null,e.apply(i,r)},t)}},throttle:function(e,t,n){return new this.buffers.throttle(e,t,n)},trim:function(){var e=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(t){return t.replace(e,"")}}(),ltrim:function(){var e=/^[ \t\n\r]+/g;return function(t){return t.replace(e,"")}}(),rtrim:function(){var e=/[ \t\n\r]+$/g;return function(t){return t.replace(e,"")}}(),indexOf:function(e,t){if("function"==typeof t){for(var n=0,i=e.length;n<i;n++)if(t(e[n]))return n}else{if(e.indexOf)return e.indexOf(t);for(n=0,i=e.length;n<i;n++)if(e[n]===t)return n}return-1},search:function(e,t){var n=CKEDITOR.tools.indexOf(e,t);return 0<=n?e[n]:null},bind:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}},createClass:function(e){var t=e.$,n=e.base,i=e.privates||e._,r=e.proto;if(e=e.statics,!t&&(t=function(){n&&this.base.apply(this,arguments)}),i)var o=t,t=function(){var e,t=this._||(this._={});for(e in i){var n=i[e];t[e]="function"==typeof n?CKEDITOR.tools.bind(n,this):n}o.apply(this,arguments)};return n&&(t.prototype=this.prototypedCopy(n.prototype),t.prototype.constructor=t,t.base=n,t.baseProto=n.prototype,t.prototype.base=function e(){this.base=n.prototype.base,n.apply(this,arguments),this.base=e}),r&&this.extend(t.prototype,r,!0),e&&this.extend(t,e,!0),t},addFunction:function(e,t){return n.push(function(){return e.apply(t||this,arguments)})-1},removeFunction:function(e){n[e]=null},callFunction:function(e){var t=n[e];return t&&t.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var e,t=/^-?\d+\.?\d*px$/;return function(n){return e=CKEDITOR.tools.trim(n+"")+"px",t.test(e)?e:n||""}}(),convertToPx:function(){var e,t;return function(n){if(e&&!e.isDetached()||(e=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(e)),!/%$/.test(n)){var i=0>parseFloat(n);return i&&(n=n.replace("-","")),e.setStyle("width",n),t=e.getClientRect(),n=Math.round(t.width),i?-n:n}return n}}(),repeat:function(e,t){return Array(t+1).join(e)},tryThese:function(){for(var e,t=0,n=arguments.length;t<n;t++){var i=arguments[t];try{e=i();break}catch(e){}}return e},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(e){return function(){var t=arguments,n=this;window.setTimeout(function(){e.apply(n,t)},0)}},normalizeCssText:function(e,t){var n,i=[],r=CKEDITOR.tools.parseCssText(e,!0,t);for(n in r)i.push(n+":"+r[n]);return i.sort(),i.length?i.join(";")+";":""},
convertRgbToHex:function(e){return e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,function(e,t,n,i){for(e=[t,n,i],t=0;3>t;t++)e[t]=("0"+parseInt(e[t],10).toString(16)).slice(-2);return"#"+e.join("")})},normalizeHex:function(e){return e.replace(/#(([0-9a-f]{3}){1,2})($|;|\s+)/gi,function(e,t,n,i){return e=t.toLowerCase(),3==e.length&&(e=e.split(""),e=[e[0],e[0],e[1],e[1],e[2],e[2]].join("")),"#"+e+i})},_isValidColorFormat:function(e){return!!e&&(e=e.replace(/\s+/g,""),/^[a-z0-9()#%,./]+$/i.test(e))},parseCssText:function(e,t,n){var i={};return n&&(e=new CKEDITOR.dom.element("span").setAttribute("style",e).getAttribute("style")||""),e&&(e=CKEDITOR.tools.normalizeHex(CKEDITOR.tools.convertRgbToHex(e))),e&&";"!=e?(e.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,n,r){t&&(n=n.toLowerCase(),"font-family"==n&&(r=r.replace(/\s*,\s*/g,",")),r=CKEDITOR.tools.trim(r)),i[n]=r}),i):i},writeCssText:function(e,t){var n,i=[];for(n in e)i.push(n+":"+e[n]);return t&&i.sort(),i.join("; ")},objectCompare:function(e,t,n){var i;if(!e&&!t)return!0;if(!e||!t)return!1;for(i in e)if(e[i]!=t[i])return!1;if(!n)for(i in t)if(e[i]!=t[i])return!1;return!0},objectKeys:function(e){return CKEDITOR.tools.object.keys(e)},convertArrayToObject:function(e,t){var n={};1==arguments.length&&(t=!0);for(var i=0,r=e.length;i<r;++i)n[e[i]]=t;return n},getStyledSpans:function(e,t){var n=CKEDITOR.env.ie&&8==CKEDITOR.env.version?e.toUpperCase():e,n=t.find("span[style*="+n+"]").toArray();return CKEDITOR.tools.array.filter(n,function(t){return!!t.getStyle(e)})},fixDomain:function(){for(var e;;)try{e=window.parent.document.domain;break}catch(t){if(!(e=e?e.replace(/.+?(?:\.|$)/,""):document.domain))break;document.domain=e}return!!e},eventsBuffer:function(e,t,n){return new this.buffers.event(e,t,n)},enableHtml5Elements:function(e,t){for(var n,i="abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary time video".split(" "),r=i.length;r--;)n=e.createElement(i[r]),t&&e.appendChild(n)},checkIfAnyArrayItemMatches:function(e,t){for(var n=0,i=e.length;n<i;++n)if(e[n].match(t))return!0;return!1},checkIfAnyObjectPropertyMatches:function(e,t){for(var n in e)if(n.match(t))return!0;return!1},keystrokeToString:function(e,t){var n=this.keystrokeToArray(e,t);return n.display=n.display.join("+"),n.aria=n.aria.join("+"),n},keystrokeToArray:function(e,t){var n=16711680&t,i=65535&t,r=CKEDITOR.env.mac,o=[],a=[];return n&CKEDITOR.CTRL&&(o.push(r?"\u2318":e[17]),a.push(r?e[224]:e[17])),n&CKEDITOR.ALT&&(o.push(r?"\u2325":e[18]),a.push(e[18])),n&CKEDITOR.SHIFT&&(o.push(r?"\u21e7":e[16]),a.push(e[16])),i&&(e[i]?(o.push(e[i]),a.push(e[i])):(o.push(String.fromCharCode(i)),a.push(String.fromCharCode(i)))),{display:o,aria:a}},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==",getCookie:function(e){e=e.toLowerCase();for(var t,n=document.cookie.split(";"),i=0;i<n.length;i++)if(t=n[i].split("="),decodeURIComponent(CKEDITOR.tools.trim(t[0]).toLowerCase())===e)return decodeURIComponent(1<t.length?t[1]:"");return null},setCookie:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"},getCsrfToken:function(){var e=CKEDITOR.tools.getCookie("ckCsrfToken");if(!e||40!=e.length){var e=[],t="";if(window.crypto&&window.crypto.getRandomValues)e=new Uint8Array(40),window.crypto.getRandomValues(e);else for(var n=0;40>n;n++)e.push(Math.floor(256*Math.random()));for(n=0;n<e.length;n++)var i="abcdefghijklmnopqrstuvwxyz0123456789".charAt(e[n]%36),t=t+(.5<Math.random()?i.toUpperCase():i);e=t,CKEDITOR.tools.setCookie("ckCsrfToken",e)}return e},escapeCss:function(e){if(e)if(window.CSS&&CSS.escape)e=CSS.escape(e);else{e=String(e);for(var t,n=e.length,i=-1,r="",o=e.charCodeAt(0);++i<n;)t=e.charCodeAt(i),r=0==t?r+"\ufffd":127==t||1<=t&&31>=t||0==i&&48<=t&&57>=t||1==i&&48<=t&&57>=t&&45==o?r+"\\"+t.toString(16)+" ":0==i&&1==n&&45==t?r+"\\"+e.charAt(i):128<=t||45==t||95==t||48<=t&&57>=t||65<=t&&90>=t||97<=t&&122>=t?r+e.charAt(i):r+"\\"+e.charAt(i);e=r}else e="";return e},getMouseButton:function(e){return!!(e=e&&e.data?e.data.$:e)&&CKEDITOR.tools.normalizeMouseButton(e.button)},normalizeMouseButton:function(e,t){if(!CKEDITOR.env.ie||9<=CKEDITOR.env.version&&!CKEDITOR.env.ie6Compat)return e;for(var n=[[CKEDITOR.MOUSE_BUTTON_LEFT,1],[CKEDITOR.MOUSE_BUTTON_MIDDLE,4],[CKEDITOR.MOUSE_BUTTON_RIGHT,2]],i=0;i<n.length;i++){var r=n[i];if(r[0]===e&&t)return r[1];if(!t&&r[1]===e)return r[0]}},convertHexStringToBytes:function(e){var t,n=[],i=e.length/2;for(t=0;t<i;t++)n.push(parseInt(e.substr(2*t,2),16));return n},convertBytesToBase64:function(e){var t,n="",i=e.length;for(t=0;t<i;t+=3){var r,o=e.slice(t,t+3),a=o.length,s=[];if(3>a)for(r=a;3>r;r++)o[r]=0;for(s[0]=(252&o[0])>>2,s[1]=(3&o[0])<<4|o[1]>>4,s[2]=(15&o[1])<<2|(192&o[2])>>6,s[3]=63&o[2],r=0;4>r;r++)n=r<=a?n+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s[r]):n+"="}return n},style:{parse:{_borderStyle:"none hidden dotted dashed solid double groove ridge inset outset".split(" "),_widthRegExp:/^(thin|medium|thick|[\+-]?\d+(\.\d+)?[a-z%]+|[\+-]?0+(\.0+)?|\.\d+[a-z%]+)$/,_rgbaRegExp:/rgba?\(\s*\d+%?\s*,\s*\d+%?\s*,\s*\d+%?\s*(?:,\s*[0-9.]+\s*)?\)/gi,_hslaRegExp:/hsla?\(\s*[0-9.]+\s*,\s*\d+%\s*,\s*\d+%\s*(?:,\s*[0-9.]+\s*)?\)/gi,background:function(e){var t={},n=this._findColor(e);return n.length&&(t.color=n[0],CKEDITOR.tools.array.forEach(n,function(t){e=e.replace(t,"")})),(e=CKEDITOR.tools.trim(e))&&(t.unprocessed=e),t},margin:function(e){return CKEDITOR.tools.style.parse.sideShorthand(e,function(e){return e.match(/(?:\-?[\.\d]+(?:%|\w*)|auto|inherit|initial|unset|revert)/g)||["0px"]})},sideShorthand:function(e,t){function n(e){i.top=r[e[0]],i.right=r[e[1]],i.bottom=r[e[2]],i.left=r[e[3]]}var i={},r=t?t(e):e.split(/\s+/);switch(r.length){case 1:n([0,0,0,0]);break;case 2:n([0,1,0,1]);break;case 3:n([0,1,2,1]);break;case 4:n([0,1,2,3])}return i},border:function(e){return CKEDITOR.tools.style.border.fromCssRule(e)},_findColor:function(e){var t=[],n=CKEDITOR.tools.array,t=t.concat(e.match(this._rgbaRegExp)||[]),t=t.concat(e.match(this._hslaRegExp)||[]);return t=t.concat(n.filter(e.split(/\s+/),function(e){return!!e.match(/^\#[a-f0-9]{3}(?:[a-f0-9]{3})?$/gi)||e.toLowerCase()in CKEDITOR.tools.style.parse._colors}))}}},array:{filter:function(e,t,n){var i=[];return this.forEach(e,function(r,o){t.call(n,r,o,e)&&i.push(r)}),i},find:function(e,t,n){for(var i=e.length,r=0;r<i;){if(t.call(n,e[r],r,e))return e[r];r++}},forEach:function(e,t,n){var i,r=e.length;for(i=0;i<r;i++)t.call(n,e[i],i,e)},map:function(e,t,n){for(var i=[],r=0;r<e.length;r++)i.push(t.call(n,e[r],r,e));return i},reduce:function(e,t,n,i){for(var r=0;r<e.length;r++)n=t.call(i,n,e[r],r,e);return n},every:function(e,t,n){return!e.length||(t=this.filter(e,t,n),e.length===t.length)},some:function(e,t,n){for(var i=0;i<e.length;i++)if(t.call(n,e[i],i,e))return!0;return!1},zip:function(e,t){return CKEDITOR.tools.array.map(e,function(e,n){return[e,t[n]]})},unique:function(e){return this.filter(e,function(t,n){return n===CKEDITOR.tools.array.indexOf(e,t)})}},object:{DONT_ENUMS:"toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),entries:function(e){return CKEDITOR.tools.array.map(CKEDITOR.tools.object.keys(e),function(t){return[t,e[t]]})},values:function(e){return CKEDITOR.tools.array.map(CKEDITOR.tools.object.keys(e),function(t){return e[t]})},keys:function(e){var t=Object.prototype.hasOwnProperty,n=[],i=CKEDITOR.tools.object.DONT_ENUMS;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(!e||"object"!=typeof e)){if(t=[],"string"==typeof e)for(n=0;n<e.length;n++)t.push(String(n));return t}for(var r in e)n.push(r);if(CKEDITOR.env.ie&&9>CKEDITOR.env.version)for(r=0;r<i.length;r++)t.call(e,i[r])&&n.push(i[r]);return n},findKey:function(e,t){if("object"!=typeof e)return null;for(var n in e)if(e[n]===t)return n;return null},merge:function(e,t){var n=CKEDITOR.tools,i=n.clone(e),r=n.clone(t);return n.array.forEach(n.object.keys(r),function(e){i[e]="object"==typeof r[e]&&"object"==typeof i[e]?n.object.merge(i[e],r[e]):r[e]}),i}},getAbsoluteRectPosition:function(e,t){function n(e){if(e){var t=e.getClientRect();i.top+=t.top,i.left+=t.left,"x"in i&&"y"in i&&(i.x+=t.x,i.y+=t.y),n(e.getWindow().getFrame())}}var i=CKEDITOR.tools.copy(t);n(e.getFrame());var r=CKEDITOR.document.getWindow().getScrollPosition();return i.top+=r.y,i.left+=r.x,"x"in i&&"y"in i&&(i.y+=r.y,i.x+=r.x),i.right=i.left+i.width,i.bottom=i.top+i.height,i}},e.prototype={reset:function(){this._lastOutput=0,this._clearTimer()},_reschedule:function(){return!1},_call:function(){this._output()},_clearTimer:function(){this._scheduledTimer&&clearTimeout(this._scheduledTimer),this._scheduledTimer=0}},t.prototype=CKEDITOR.tools.prototypedCopy(e.prototype),t.prototype._reschedule=function(){this._scheduledTimer&&this._clearTimer()},t.prototype._call=function(){this._output.apply(this._context,this._args)},CKEDITOR.tools.buffers={},CKEDITOR.tools.buffers.event=e,CKEDITOR.tools.buffers.throttle=t,CKEDITOR.tools.style.border=CKEDITOR.tools.createClass({$:function(e){e=e||{},this.width=e.width,this.style=e.style,this.color=e.color,this._.normalize()},_:{normalizeMap:{color:[[/windowtext/g,"black"]]},normalize:function(){for(var e in this._.normalizeMap){var t=this[e];t&&(this[e]=CKEDITOR.tools.array.reduce(this._.normalizeMap[e],function(e,t){return e.replace(t[0],t[1])},t))}}},proto:{toString:function(){return CKEDITOR.tools.array.filter([this.width,this.style,this.color],function(e){return!!e}).join(" ")}},statics:{fromCssRule:function(e){var t={},n=e.split(/\s+/g);return e=CKEDITOR.tools.style.parse._findColor(e),e.length&&(t.color=e[0]),CKEDITOR.tools.array.forEach(n,function(e){t.style||-1===CKEDITOR.tools.indexOf(CKEDITOR.tools.style.parse._borderStyle,e)?!t.width&&CKEDITOR.tools.style.parse._widthRegExp.test(e)&&(t.width=e):t.style=e}),new CKEDITOR.tools.style.border(t)},splitCssValues:function(e,t){t=t||{};var n=CKEDITOR.tools.array.reduce(["width","style","color"],function(n,i){var r=e["border-"+i]||t[i];return n[i]=r?CKEDITOR.tools.style.parse.sideShorthand(r):null,n},{});return CKEDITOR.tools.array.reduce(["top","right","bottom","left"],function(t,i){var r,o={};for(r in n){var a=e["border-"+i+"-"+r];o[r]=a||n[r]&&n[r][i]}return t["border-"+i]=new CKEDITOR.tools.style.border(o),t},{})}}}),CKEDITOR.tools.array.indexOf=CKEDITOR.tools.indexOf,CKEDITOR.tools.array.isArray=CKEDITOR.tools.isArray,CKEDITOR.MOUSE_BUTTON_LEFT=0,CKEDITOR.MOUSE_BUTTON_MIDDLE=1,CKEDITOR.MOUSE_BUTTON_RIGHT=2}(),CKEDITOR.dtd=function(){var e=CKEDITOR.tools.extend,t=function(e,t){for(var n=CKEDITOR.tools.clone(e),i=1;i<arguments.length;i++){t=arguments[i];for(var r in t)delete n[r]}return n},n={},i={},r={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},o={command:1,link:1,meta:1,noscript:1,script:1,style:1},a={},s={"#":1},l={center:1,dir:1,noframes:1};return e(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,var:1,video:1,wbr:1},s,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),e(i,r,n,l),t={a:t(n,{a:1,button:1}),abbr:n,address:i,area:a,article:i,aside:i,audio:e({source:1,track:1},i),b:n,base:a,bdi:n,bdo:n,blockquote:i,body:i,br:a,button:t(n,{a:1,button:1}),canvas:n,caption:i,cite:n,code:n,col:a,colgroup:{col:1},command:a,datalist:e({option:1},n),dd:i,del:n,details:e({summary:1},i),dfn:n,div:i,dl:{dt:1,dd:1},dt:i,em:n,embed:a,fieldset:e({legend:1},i),figcaption:i,figure:e({figcaption:1},i),footer:i,form:i,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:e({title:1,base:1},o),header:i,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:a,html:e({head:1,body:1},i,o),i:n,iframe:s,img:a,input:a,ins:n,kbd:n,keygen:a,label:n,legend:n,li:i,link:a,main:i,map:i,mark:n,menu:e({li:1},i),meta:a,meter:t(n,{meter:1}),nav:i,noscript:e({link:1,meta:1,style:1},n),object:e({param:1},n),ol:{li:1},optgroup:{option:1},option:s,output:n,p:n,param:a,pre:n,progress:t(n,{progress:1}),q:n,rp:n,rt:n,ruby:e({rp:1,rt:1},n),s:n,samp:n,script:s,section:i,select:{optgroup:1,option:1},small:n,source:a,span:n,strong:n,style:s,sub:n,summary:e({h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},n),sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:i,textarea:s,tfoot:{tr:1},th:i,thead:{tr:1},time:t(n,{time:1}),title:s,tr:{th:1,td:1},track:a,u:n,ul:{li:1},var:n,video:e({source:1,track:1},i),wbr:a,acronym:n,applet:e({param:1},i),basefont:a,big:n,center:i,dialog:a,dir:{li:1},font:n,isindex:a,noframes:i,strike:n,tt:n},e(t,{$block:e({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},r,l),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:e({body:1,head:1,html:1},t.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,var:1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),t}(),CKEDITOR.dom.event=function(e){this.$=e},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var e=this.getKey();return(this.$.ctrlKey||this.$.metaKey)&&(e+=CKEDITOR.CTRL),this.$.shiftKey&&(e+=CKEDITOR.SHIFT),this.$.altKey&&(e+=CKEDITOR.ALT),e},preventDefault:function(e){var t=this.$;t.preventDefault?t.preventDefault():t.returnValue=!1,e&&this.stopPropagation()},stopPropagation:function(){var e=this.$;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getTarget:function(){var e=this.$.target||this.$.srcElement;return e?new CKEDITOR.dom.node(e):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var e=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(e.documentElement.scrollLeft||e.body.scrollLeft),y:this.$.pageY||this.$.clientY+(e.documentElement.scrollTop||e.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.HISTORY_NATIVE=1,CKEDITOR.HISTORY_HASH=2,CKEDITOR.HISTORY_OFF=0,CKEDITOR.dom.domObject=function(e){e&&(this.$=e)},CKEDITOR.dom.domObject.prototype=function(){var e=function(e,t){return function(n){"undefined"!=typeof CKEDITOR&&e.fire(t,new CKEDITOR.dom.event(n))}};return{getPrivate:function(){var e;return(e=this.getCustomData("_"))||this.setCustomData("_",e={}),e},on:function(t){var n=this.getCustomData("_cke_nativeListeners");return n||(n={},this.setCustomData("_cke_nativeListeners",n)),n[t]||(n=n[t]=e(this,t),this.$.addEventListener?this.$.addEventListener(t,n,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+t,n)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(e){if(CKEDITOR.event.prototype.removeListener.apply(this,arguments),!this.hasListeners(e)){var t=this.getCustomData("_cke_nativeListeners"),n=t&&t[e];n&&(this.$.removeEventListener?this.$.removeEventListener(e,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+e,n),delete t[e])}},removeAllListeners:function(){try{var e,t=this.getCustomData("_cke_nativeListeners");for(e in t){var n=t[e];this.$.detachEvent?this.$.detachEvent("on"+e,n):this.$.removeEventListener&&this.$.removeEventListener(e,n,!1),delete t[e]}}catch(e){if(!CKEDITOR.env.edge||-2146828218!==e.number)throw e}CKEDITOR.event.prototype.removeAllListeners.call(this)}}}(),function(e){var t={};CKEDITOR.on("reset",function(){t={}}),e.equals=function(e){try{return e&&e.$===this.$}catch(e){return!1}},e.setCustomData=function(e,n){var i=this.getUniqueId();return(t[i]||(t[i]={}))[e]=n,this},e.getCustomData=function(e){var n=this.$["data-cke-expando"];return(n=n&&t[n])&&e in n?n[e]:null},e.removeCustomData=function(e){var n,i,r=this.$["data-cke-expando"],r=r&&t[r];return r&&(n=r[e],i=e in r,delete r[e]),i?n:null},e.clearCustomData=function(){this.removeAllListeners();var e=this.getUniqueId();e&&delete t[e]},e.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(e)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(e){return e?new CKEDITOR.dom[e.nodeType==CKEDITOR.NODE_DOCUMENT?"document":e.nodeType==CKEDITOR.NODE_ELEMENT?"element":e.nodeType==CKEDITOR.NODE_TEXT?"text":e.nodeType==CKEDITOR.NODE_COMMENT?"comment":e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](e):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(e,t){return e.append(this,t),e},clone:function(e,t){function n(i){if(i["data-cke-expando"]&&(i["data-cke-expando"]=!1),(i.nodeType==CKEDITOR.NODE_ELEMENT||i.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(t||i.nodeType!=CKEDITOR.NODE_ELEMENT||i.removeAttribute("id",!1),e)){i=i.childNodes;for(var r=0;r<i.length;r++)n(i[r])}}function i(t){if(t.type==CKEDITOR.NODE_ELEMENT||t.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT){if(t.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=t.getName();":"==n[0]&&t.renameNode(n.substring(1))}if(e)for(n=0;n<t.getChildCount();n++)i(t.getChild(n))}}var r=this.$.cloneNode(e);return n(r),r=new CKEDITOR.dom.node(r),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(this.type==CKEDITOR.NODE_ELEMENT||this.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&i(r),r},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(e){return e.$.parentNode.insertBefore(this.$,e.$.nextSibling),e},insertBefore:function(e){return e.$.parentNode.insertBefore(this.$,e.$),e},insertBeforeMe:function(e){return this.$.parentNode.insertBefore(e.$,this.$),e},getAddress:function(e){for(var t=[],n=this.getDocument().$.documentElement,i=this;i&&i!=n;){var r=i.getParent();r&&t.unshift(this.getIndex.call(i,e)),i=r}return t},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(e){function t(e,n){var i=n?e.getNext():e.getPrevious();return i&&i.type==CKEDITOR.NODE_TEXT?i.isEmpty()?t(i,n):i:null}var n,i=this,r=-1;if(!this.getParent()||e&&i.type==CKEDITOR.NODE_TEXT&&i.isEmpty()&&!t(i)&&!t(i,!0))return-1;do{e&&!i.equals(this)&&i.type==CKEDITOR.NODE_TEXT&&(n||i.isEmpty())||(r++,n=i.type==CKEDITOR.NODE_TEXT)}while(i=i.getPrevious());return r},getNextSourceNode:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}e=!e&&this.getFirst&&this.getFirst();var r;if(!e){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getNext()}for(;!e&&(r=(r||this).getParent());){if(n&&!1===n(r,!0))return null;e=r.getNext()}return!e||n&&!1===n(e)?null:t&&t!=e.type?e.getNextSourceNode(!1,t,n):e},getPreviousSourceNode:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}e=!e&&this.getLast&&this.getLast();var r;if(!e){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getPrevious()}for(;!e&&(r=(r||this).getParent());){if(n&&!1===n(r,!0))return null;e=r.getPrevious()}return!e||n&&!1===n(e)?null:t&&e.type!=t?e.getPreviousSourceNode(!1,t,n):e},getPrevious:function(e){var t,n=this.$;do{t=(n=n.previousSibling)&&10!=n.nodeType&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getNext:function(e){var t,n=this.$;do{t=(n=n.nextSibling)&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getParent:function(e){var t=this.$.parentNode;return t&&(t.nodeType==CKEDITOR.NODE_ELEMENT||e&&t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(t):null},getParents:function(e){var t=this,n=[];do{n[e?"push":"unshift"](t)}while(t=t.getParent());return n},getCommonAncestor:function(e){if(e.equals(this))return this;if(e.contains&&e.contains(this))return e;var t=this.contains?this:this.getParent();do{if(t.contains(e))return t}while(t=t.getParent());return null},getPosition:function(e){var t=this.$,n=e.$;if(t.compareDocumentPosition)return t.compareDocumentPosition(n);if(t==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&e.type==CKEDITOR.NODE_ELEMENT){if(t.contains){if(t.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(t))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in t)return 0>t.sourceIndex||0>n.sourceIndex?CKEDITOR.POSITION_DISCONNECTED:t.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}t=this.getAddress(),e=e.getAddress();for(var n=Math.min(t.length,e.length),i=0;i<n;i++)if(t[i]!=e[i])return t[i]<e[i]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;return t.length<e.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(e,t){var n,i,r=this.$;t||(r=r.parentNode),"function"==typeof e?(i=!0,n=e):(i=!1,n=function(t){return t="string"==typeof t.nodeName?t.nodeName.toLowerCase():"","string"==typeof e?t==e:t in e});for(;r;){if(n(i?new CKEDITOR.dom.node(r):r))return new CKEDITOR.dom.node(r);try{r=r.parentNode}catch(e){r=null}}return null},hasAscendant:function(e,t){var n=this.$;for(t||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return!0;n=n.parentNode}return!1},move:function(e,t){e.append(this.remove(),t)},remove:function(e){var t=this.$,n=t.parentNode;if(n){if(e)for(;e=t.firstChild;)n.insertBefore(t.removeChild(e),t);n.removeChild(t)}return this},replace:function(e){this.insertBefore(e),e.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var e;this.getFirst&&(e=this.getFirst());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.ltrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(n-t.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var e;this.getLast&&(e=this.getLast());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.rtrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(t.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(e=this.$.lastChild)&&1==e.type&&"br"==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)},isReadOnly:function(e){var t=this;if(this.type!=CKEDITOR.NODE_ELEMENT&&(t=this.getParent()),CKEDITOR.env.edge&&t&&t.is("textarea","input")&&(e=!0),!e&&t&&void 0!==t.$.isContentEditable)return!(t.$.isContentEditable||t.data("cke-editable"));for(;t;){if(t.data("cke-editable"))return!1;if(t.hasAttribute("contenteditable"))return"false"==t.getAttribute("contenteditable");t=t.getParent()}return!0}}),CKEDITOR.dom.window=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var e=this.$.document,t="CSS1Compat"==e.compatMode;return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},getScrollPosition:function(){var e=this.$;return"pageXOffset"in e?{x:e.pageXOffset||0,y:e.pageYOffset||0}:(e=e.document,{x:e.documentElement.scrollLeft||e.body.scrollLeft||0,y:e.documentElement.scrollTop||e.body.scrollTop||0})},getFrame:function(){var e=this.$.frameElement;return e?new CKEDITOR.dom.element.get(e):null}}),CKEDITOR.dom.document=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(e){if(e=CKEDITOR.appendTimestamp(e),this.$.createStyleSheet)this.$.createStyleSheet(e);else{var t=new CKEDITOR.dom.element("link");t.setAttributes({rel:"stylesheet",type:"text/css",href:e}),this.getHead().append(t)}},appendStyleText:function(e){if(this.$.createStyleSheet){var t=this.$.createStyleSheet("");t.cssText=e}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(e,this)),this.getHead().append(n)}return t||n.$.sheet},createElement:function(e,t){var n=new CKEDITOR.dom.element(e,this);return t&&(t.attributes&&n.setAttributes(t.attributes),t.styles&&n.setStyles(t.styles)),n},createText:function(e){return new CKEDITOR.dom.text(e,this)},focus:function(){this.getWindow().focus()},getActive:function(){var e;try{e=this.$.activeElement}catch(e){return null}return new CKEDITOR.dom.element(e)},getById:function(e){return(e=this.$.getElementById(e))?new CKEDITOR.dom.element(e):null},getByAddress:function(e,t){for(var n=this.$.documentElement,i=0;n&&i<e.length;i++){var r=e[i];if(t)for(var o=-1,a=0;a<n.childNodes.length;a++){var s=n.childNodes[a];if((!0!==t||3!=s.nodeType||!s.previousSibling||3!=s.previousSibling.nodeType)&&++o==r){n=s;break}}else n=n.childNodes[r]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(e,t){return CKEDITOR.env.ie&&8>=document.documentMode||!t||(e=t+":"+e),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(e))},getHead:function(){var e=this.$.getElementsByTagName("head")[0];return e=e?new CKEDITOR.dom.element(e):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(e){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(e=e.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();<\/script>")),this.$.write(e),this.$.close()},find:function(e){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e))},findOne:function(e){return(e=this.$.querySelector(e))?new CKEDITOR.dom.element(e):null},_getHtml5ShivFrag:function(){var e=this.getCustomData("html5ShivFrag");return e||(e=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(e,!0),this.setCustomData("html5ShivFrag",e)),e}}),CKEDITOR.dom.nodeList=function(e){this.$=e},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(e){return 0>e||e>=this.$.length?null:(e=this.$[e])?new CKEDITOR.dom.node(e):null},toArray:function(){return CKEDITOR.tools.array.map(this.$,function(e){return new CKEDITOR.dom.node(e)})}},CKEDITOR.dom.element=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createElement(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.element.get=function(e){return(e="string"==typeof e?document.getElementById(e)||document.getElementsByName(e)[0]:e)&&(e.$?e:new CKEDITOR.dom.element(e))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(e,t){var n=new CKEDITOR.dom.element("div",t);return n.setHtml(e),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(e,t,n,i){var r=t.getCustomData("list_marker_id")||t.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),o=t.getCustomData("list_marker_names")||t.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return e[r]=t,o[n]=1,t.setCustomData(n,i)},CKEDITOR.dom.element.clearAllMarkers=function(e){for(var t in e)CKEDITOR.dom.element.clearMarkers(e,e[t],1)},CKEDITOR.dom.element.clearMarkers=function(e,t,n){var i,r=t.getCustomData("list_marker_names"),o=t.getCustomData("list_marker_id");for(i in r)t.removeCustomData(i);t.removeCustomData("list_marker_names"),n&&(t.removeCustomData("list_marker_id"),delete e[o])},function(){function e(e,t){return-1<(" "+e+" ").replace(o," ").indexOf(" "+t+" ")}function t(e){var t=!0;return e.$.id||(e.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),t=!1),function(){t||e.removeAttribute("id")}}function n(e,t){var n=CKEDITOR.tools.escapeCss(e.$.id);return"#"+n+" "+t.split(/,\s*/).join(", #"+n+" ")}function i(e){for(var t=0,n=0,i=a[e].length;n<i;n++)t+=parseFloat(this.getComputedStyle(a[e][n])||0,10)||0;return t}var r=document.createElement("_").classList,r=void 0!==r&&null!==String(r.add).match(/\[Native code\]/gi),o=/[\n\t\r]/g;CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:r?function(e){return this.$.classList.add(e),this}:function(t){var n=this.$.className;return n&&(e(n,t)||(n+=" "+t)),this.$.className=n||t,this},removeClass:r?function(e){var t=this.$;return t.classList.remove(e),t.className||t.removeAttribute("class"),this}:function(t){var n=this.getAttribute("class");return n&&e(n,t)&&((n=n.replace(new RegExp("(?:^|\\s+)"+t+"(?=\\s|$)"),"").replace(/^\s+/,""))?this.setAttribute("class",n):this.removeAttribute("class")),this},hasClass:function(t){return e(this.$.className,t)},append:function(e,t){return"string"==typeof e&&(e=this.getDocument().createElement(e)),t?this.$.insertBefore(e.$,this.$.firstChild):this.$.appendChild(e.$),e},appendHtml:function(e){if(this.$.childNodes.length){var t=new CKEDITOR.dom.element("div",this.getDocument());t.setHtml(e),t.moveChildren(this)}else this.setHtml(e)},appendText:function(e){null!=this.$.text&&CKEDITOR.env.ie&&9>CKEDITOR.env.version?this.$.text+=e:this.append(new CKEDITOR.dom.text(e))},appendBogus:function(e){if(e||CKEDITOR.env.needsBrFiller){for(e=this.getLast();e&&e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(e.getText());)e=e.getPrevious();e&&e.is&&e.is("br")||(e=this.getDocument().createElement("br"),CKEDITOR.env.gecko&&e.setAttribute("type","_moz"),this.append(e))}},breakParent:function(e,t){var n=new CKEDITOR.dom.range(this.getDocument());n.setStartAfter(this),n.setEndAfter(e);var i,r=n.extractContents(!1,t||!1);if(n.insertNode(this.remove()),CKEDITOR.env.ie&&!CKEDITOR.env.edge){for(n=new CKEDITOR.dom.element("div");i=r.getFirst();)i.$.style.backgroundColor&&(i.$.style.backgroundColor=i.$.style.backgroundColor),n.append(i);n.insertAfter(this),n.remove(!0)}else r.insertAfterNode(this)},contains:document.compareDocumentPosition?function(e){return!!(16&this.$.compareDocumentPosition(e.$))}:function(e){var t=this.$
;return e.type!=CKEDITOR.NODE_ELEMENT?t.contains(e.getParent().$):t!=e.$&&t.contains(e.$)},focus:function(){function e(){try{this.$.focus()}catch(e){}}return function(t){t?CKEDITOR.tools.setTimeout(e,100,this):e.call(this)}}(),getHtml:function(){var e=this.$.innerHTML;return CKEDITOR.env.ie?e.replace(/<\?[^>]*>/g,""):e},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var e=this.$.ownerDocument.createElement("div");return e.appendChild(this.$.cloneNode(!0)),e.innerHTML},getClientRect:function(e){var t=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!t.width&&(t.width=t.right-t.left),!t.height&&(t.height=t.bottom-t.top),e?CKEDITOR.tools.getAbsoluteRectPosition(this.getWindow(),t):t},setHtml:CKEDITOR.env.ie&&9>CKEDITOR.env.version?function(e){try{var t=this.$;if(this.getParent())return t.innerHTML=e;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(t),t.innerHTML=e,n.removeChild(t),e}catch(n){for(this.$.innerHTML="",t=new CKEDITOR.dom.element("body",this.getDocument()),t.$.innerHTML=e,t=t.getChildren();t.count();)this.append(t.getItem(0));return e}}:function(e){return this.$.innerHTML=e},setText:function(){var e=document.createElement("p");return e.innerHTML="x",e=e.textContent,function(t){this.$[e?"textContent":"innerText"]=t}}(),getAttribute:function(){var e=function(e){return this.$.getAttribute(e,2)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){switch(e){case"class":e="className";break;case"http-equiv":e="httpEquiv";break;case"name":return this.$.name;case"tabindex":return e=this.$.getAttribute(e,2),0!==e&&0===this.$.tabIndex&&(e=null),e;case"checked":return e=this.$.attributes.getNamedItem(e),(e.specified?e.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[e];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(e,2)}:e}(),getAttributes:function(e){var t,n={},i=this.$.attributes;for(e=CKEDITOR.tools.isArray(e)?e:[],t=0;t<i.length;t++)-1===CKEDITOR.tools.indexOf(e,i[t].name)&&(n[i[t].name]=i[t].value);return n},getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getClientSize:function(){return{width:this.$.clientWidth,height:this.$.clientHeight}},getComputedStyle:document.defaultView&&document.defaultView.getComputedStyle?function(e){var t=this.getWindow().$.getComputedStyle(this.$,null);return t?t.getPropertyValue(e):""}:function(e){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(e)]},getDtd:function(){var e=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return e},e},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:function(){var e=this.$.tabIndex;return 0!==e||CKEDITOR.dtd.$tabIndex[this.getName()]||0===parseInt(this.getAttribute("tabindex"),10)?e:-1},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var e=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&8>=document.documentMode){var t=this.$.scopeName;"HTML"!=t&&(e=t.toLowerCase()+":"+e)}return this.getName=function(){return e},this.getName()},getValue:function(){return this.$.value},getFirst:function(e){var t=this.$.firstChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getNext(e)),t},getLast:function(e){var t=this.$.lastChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getPrevious(e)),t},getStyle:function(e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]},is:function(){var e=this.getName();if("object"==typeof arguments[0])return!!arguments[0][e];for(var t=0;t<arguments.length;t++)if(arguments[t]==e)return!0;return!1},isEditable:function(e){var t=this.getName();return!(this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||CKEDITOR.dtd.$nonEditable[t]||CKEDITOR.dtd.$empty[t]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount())&&(!1===e||!(!(e=CKEDITOR.dtd[t]||CKEDITOR.dtd.span)||!e["#"]))},isIdentical:function(e){var t=this.clone(0,1);if(e=e.clone(0,1),t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),t.$.isEqualNode)return t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.isEqualNode(e.$);if(t=t.getOuterHtml(),e=e.getOuterHtml(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&(n=n.clone(),n.setHtml(t),t=n.getHtml(),n.setHtml(e),e=n.getHtml())}return t==e},isVisible:function(){var e,t,n=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility");return n&&CKEDITOR.env.webkit&&(e=this.getWindow(),!e.equals(CKEDITOR.document.getWindow())&&(t=e.$.frameElement)&&(n=new CKEDITOR.dom.element(t).isVisible())),!!n},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var e=this.getChildren(),t=0,n=e.count();t<n;t++){var i=e.getItem(t);if((i.type!=CKEDITOR.NODE_ELEMENT||!i.data("cke-bookmark"))&&(i.type==CKEDITOR.NODE_ELEMENT&&!i.isEmptyInlineRemoveable()||i.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(i.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var e=this.$.attributes,t=0;t<e.length;t++){var n=e[t];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var e=this.$.attributes,t=e.length,n={"data-cke-expando":1,_moz_dirty:1};return 0<t&&(2<t||!n[e[0].nodeName]||2==t&&!n[e[1].nodeName])},hasAttribute:function(){function e(e){var t=this.$.attributes.getNamedItem(e);if("input"==this.getName())switch(e){case"class":return 0<this.$.className.length;case"checked":return!!this.$.checked;case"value":return e=this.getAttribute("type"),"checkbox"==e||"radio"==e?"on"!=this.$.value:!!this.$.value}return!!t&&t.specified}return CKEDITOR.env.ie?8>CKEDITOR.env.version?function(t){return"name"==t?!!this.$.name:e.call(this,t)}:e:function(e){return!!this.$.attributes.getNamedItem(e)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(e,t){var n=this.$;if(e=e.$,n!=e){var i;if(t)for(;i=n.lastChild;)e.insertBefore(n.removeChild(i),e.firstChild);else for(;i=n.firstChild;)e.appendChild(n.removeChild(i))}},mergeSiblings:function(){function e(e,t,n){if(t&&t.type==CKEDITOR.NODE_ELEMENT){for(var i=[];t.data("cke-bookmark")||t.isEmptyInlineRemoveable();)if(i.push(t),!(t=n?t.getNext():t.getPrevious())||t.type!=CKEDITOR.NODE_ELEMENT)return;if(e.isIdentical(t)){for(var r=n?e.getLast():e.getFirst();i.length;)i.shift().move(e,!n);t.moveChildren(e,!n),t.remove(),r&&r.type==CKEDITOR.NODE_ELEMENT&&r.mergeSiblings()}}}return function(t){(!1===t||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))&&(e(this,this.getNext(),!0),e(this,this.getPrevious()))}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var e=function(e,t){return this.$.setAttribute(e,t),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t,n){return"class"==t?this.$.className=n:"style"==t?this.$.style.cssText=n:"tabindex"==t?this.$.tabIndex=n:"checked"==t?this.$.checked=n:"contenteditable"==t?e.call(this,"contentEditable",n):e.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(t,n){if("src"==t&&n.match(/^http:\/\//))try{e.apply(this,arguments)}catch(e){}else e.apply(this,arguments);return this}:e}(),setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t]);return this},setValue:function(e){return this.$.value=e,this},removeAttribute:function(){var e=function(e){this.$.removeAttribute(e)};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){"class"==e?e="className":"tabindex"==e?e="tabIndex":"contenteditable"==e&&(e="contentEditable"),this.$.removeAttribute(e)}:e}(),removeAttributes:function(e){if(CKEDITOR.tools.isArray(e))for(var t=0;t<e.length;t++)this.removeAttribute(e[t]);else for(t in e=e||this.getAttributes())e.hasOwnProperty(t)&&this.removeAttribute(t)},removeStyle:function(e){var t=this.$.style;if(t.removeProperty||"border"!=e&&"margin"!=e&&"padding"!=e)t.removeProperty?t.removeProperty(e):t.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(e)),this.$.style.cssText||this.removeAttribute("style");else{var n,i=["top","left","right","bottom"];"border"==e&&(n=["color","style","width"]);for(var t=[],r=0;r<i.length;r++)if(n)for(var o=0;o<n.length;o++)t.push([e,i[r],n[o]].join("-"));else t.push([e,i[r]].join("-"));for(e=0;e<t.length;e++)this.removeStyle(t[e])}},setStyle:function(e,t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]=t,this},setStyles:function(e){for(var t in e)this.setStyle(t,e[t]);return this},setOpacity:function(e){CKEDITOR.env.ie&&9>CKEDITOR.env.version?(e=Math.round(100*e),this.setStyle("filter",100<=e?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")")):this.setStyle("opacity",e)},unselectable:function(){if(this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none")),CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var e,t=this.getElementsByTag("*"),n=0,i=t.count();n<i;n++)e=t.getItem(n),e.setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var e=this;"html"!=e.getName();){if("static"!=e.getComputedStyle("position"))return e;e=e.getParent()}return null},getDocumentPosition:function(e){var t=0,n=0,i=this.getDocument(),r=i.getBody(),o="BackCompat"==i.$.compatMode;if(document.documentElement.getBoundingClientRect&&(CKEDITOR.env.ie?8!==CKEDITOR.env.version:1)){var a=this.$.getBoundingClientRect(),s=i.$.documentElement,l=s.clientTop||r.$.clientTop||0,d=s.clientLeft||r.$.clientLeft||0,c=!0;CKEDITOR.env.ie&&(c=i.getDocumentElement().contains(this),i=i.getBody().contains(this),c=o&&i||!o&&c),c&&(CKEDITOR.env.webkit||CKEDITOR.env.ie&&12<=CKEDITOR.env.version?(t=r.$.scrollLeft||s.scrollLeft,n=r.$.scrollTop||s.scrollTop):(n=o?r.$:s,t=n.scrollLeft,n=n.scrollTop),t=a.left+t-d,n=a.top+n-l)}else for(l=this,d=null;l&&"body"!=l.getName()&&"html"!=l.getName();){for(t+=l.$.offsetLeft-l.$.scrollLeft,n+=l.$.offsetTop-l.$.scrollTop,l.equals(this)||(t+=l.$.clientLeft||0,n+=l.$.clientTop||0);d&&!d.equals(l);)t-=d.$.scrollLeft,n-=d.$.scrollTop,d=d.getParent();d=l,l=(a=l.$.offsetParent)?new CKEDITOR.dom.element(a):null}return e&&(a=this.getWindow(),l=e.getWindow(),!a.equals(l)&&a.$.frameElement&&(e=new CKEDITOR.dom.element(a.$.frameElement).getDocumentPosition(e),t+=e.x,n+=e.y)),document.documentElement.getBoundingClientRect||!CKEDITOR.env.gecko||o||(t+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:t,y:n}},scrollIntoView:function(e){var t=this.getParent();if(t)do{if((t.$.clientWidth&&t.$.clientWidth<t.$.scrollWidth||t.$.clientHeight&&t.$.clientHeight<t.$.scrollHeight)&&!t.is("body")&&this.scrollIntoParent(t,e,1),t.is("html")){var n=t.getWindow();try{var i=n.$.frameElement;i&&(t=new CKEDITOR.dom.element(i))}catch(e){}}}while(t=t.getParent())},scrollIntoParent:function(e,t,n){function i(t,n){/body|html/.test(e.getName())?e.getWindow().$.scrollBy(t,n):(e.$.scrollLeft+=t,e.$.scrollTop+=n)}function r(e,t){var n={x:0,y:0};if(!e.is(c?"body":"html")){var i=e.$.getBoundingClientRect();n.x=i.left,n.y=i.top}return i=e.getWindow(),i.equals(t)||(i=r(CKEDITOR.dom.element.get(i.$.frameElement),t),n.x+=i.x,n.y+=i.y),n}function o(e,t){return parseInt(e.getComputedStyle("margin-"+t)||0,10)||0}var a,s,l,d;!e&&(e=this.getWindow()),l=e.getDocument();var c="BackCompat"==l.$.compatMode;e instanceof CKEDITOR.dom.window&&(e=c?l.getBody():l.getDocumentElement()),CKEDITOR.env.webkit&&(l=this.getEditor(!1))&&(l._.previousScrollTop=null),l=e.getWindow(),s=r(this,l);var h=r(e,l),u=this.$.offsetHeight;a=this.$.offsetWidth;var f=e.$.clientHeight,g=e.$.clientWidth;l=s.x-o(this,"left")-h.x||0,d=s.y-o(this,"top")-h.y||0,a=s.x+a+o(this,"right")-(h.x+g)||0,s=s.y+u+o(this,"bottom")-(h.y+f)||0,(0>d||0<s)&&i(0,!0===t?d:!1===t?s:0>d?d:s),n&&(0>l||0<a)&&i(0>l?l:a,0)},setState:function(e,t,n){switch(t=t||"cke",e){case CKEDITOR.TRISTATE_ON:this.addClass(t+"_on"),this.removeClass(t+"_off"),this.removeClass(t+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(t+"_disabled"),this.removeClass(t+"_off"),this.removeClass(t+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(t+"_off"),this.removeClass(t+"_on"),this.removeClass(t+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var e=this.$;try{e.contentWindow.document}catch(t){e.src=e.src}return e&&new CKEDITOR.dom.document(e.contentWindow.document)},copyAttributes:function(e,t){var n=this.$.attributes;t=t||{};for(var i=0;i<n.length;i++){var r,o=n[i],a=o.nodeName.toLowerCase();a in t||("checked"==a&&(r=this.getAttribute(a))?e.setAttribute(a,r):CKEDITOR.env.ie&&!this.hasAttribute(a)||(r=this.getAttribute(a),null===r&&(r=o.nodeValue),e.setAttribute(a,r)))}""!==this.$.style.cssText&&(e.$.style.cssText=this.$.style.cssText)},renameNode:function(e){if(this.getName()!=e){var t=this.getDocument();e=new CKEDITOR.dom.element(e,t),this.copyAttributes(e),this.moveChildren(e),this.getParent(!0)&&this.$.parentNode.replaceChild(e.$,this.$),e.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=e.$,delete this.getName}},getChild:function(){function e(e,t){var n=e.childNodes;if(0<=t&&t<n.length)return n[t]}return function(t){var n=this.$;if(t.slice)for(t=t.slice();0<t.length&&n;)n=e(n,t.shift());else n=e(n,t);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_enable_context_menu")}this.on("contextmenu",function(t){t.data.getTarget().getAscendant(e,!0)||t.data.preventDefault()})},getDirection:function(e){return e?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(e,t){return e="data-"+e,void 0===t?this.getAttribute(e):(!1===t?this.removeAttribute(e):this.setAttribute(e,t),null)},getEditor:function(e){var t,n,i,r=CKEDITOR.instances;e=e||void 0===e;for(t in r)if(n=r[t],n.element.equals(this)&&n.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||!e&&(i=n.editable())&&(i.equals(this)||i.contains(this)))return n;return null},find:function(e){var i=t(this);return e=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(n(this,e))),i(),e},findOne:function(e){var i=t(this);return e=this.$.querySelector(n(this,e)),i(),e?new CKEDITOR.dom.element(e):null},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var i=e(this);if(!1!==i){n=this.getChildren();for(var r=0;r<n.count();r++)i=n.getItem(r),i.type==CKEDITOR.NODE_ELEMENT?i.forEach(e,t):t&&i.type!=t||e(i)}},fireEventHandler:function(e,t){var n="on"+e,i=this.$;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version){var r,o=i.ownerDocument.createEventObject();for(r in t)o[r]=t[r];i.fireEvent(n,o)}else i[i[e]?e:n](t)},isDetached:function(){var e=this.getDocument(),t=e.getDocumentElement();return!t.equals(this)&&!t.contains(this)||(!CKEDITOR.env.ie||8<CKEDITOR.env.version&&!CKEDITOR.env.quirks)&&!e.$.defaultView}});var a={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(e,t,n){"number"==typeof t&&(!n||CKEDITOR.env.ie&&CKEDITOR.env.quirks||(t-=i.call(this,e)),this.setStyle(e,t+"px"))},CKEDITOR.dom.element.prototype.getSize=function(e,t){var n=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(e)],this.$["client"+CKEDITOR.tools.capitalize(e)])||0;return t&&(n-=i.call(this,e)),n}}(),CKEDITOR.dom.documentFragment=function(e){e=e||CKEDITOR.document,this.$=e.type==CKEDITOR.NODE_DOCUMENT?e.$.createDocumentFragment():e},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(e){e=e.$,e.parentNode.insertBefore(this.$,e.nextSibling)},getHtml:function(){var e=new CKEDITOR.dom.element("div");return this.clone(1,1).appendTo(e),e.getHtml().replace(/\s*data-cke-expando=".*?"/g,"")}},!0,{append:1,appendBogus:1,clone:1,getFirst:1,getHtml:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.document.prototype,!0,{find:1,findOne:1}),function(){function e(e,t){var n=this.range;if(this._.end)return null;if(!this._.start){if(this._.start=1,n.collapsed)return this.end(),null;n.optimize()}var i,r=n.startContainer;i=n.endContainer;var o,a=n.startOffset,s=n.endOffset,l=this.guard,d=this.type,c=e?"getPreviousSourceNode":"getNextSourceNode";if(!e&&!this._.guardLTR){var h=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),u=i.type==CKEDITOR.NODE_ELEMENT?i.getChild(s):i.getNext();this._.guardLTR=function(e,t){return!(t&&h.equals(e)||u&&e.equals(u)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}if(e&&!this._.guardRTL){var f=r.type==CKEDITOR.NODE_ELEMENT?r:r.getParent(),g=r.type==CKEDITOR.NODE_ELEMENT?a?r.getChild(a-1):null:r.getPrevious();this._.guardRTL=function(e,t){return!(t&&f.equals(e)||g&&e.equals(g)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}var p=e?this._.guardRTL:this._.guardLTR;for(o=l?function(e,t){return!1!==p(e,t)&&l(e,t)}:p,this.current?i=this.current[c](!1,d,o):(e?i.type==CKEDITOR.NODE_ELEMENT&&(i=0<s?i.getChild(s-1):!1===o(i,!0)?null:i.getPreviousSourceNode(!0,d,o)):(i=r,i.type==CKEDITOR.NODE_ELEMENT&&((i=i.getChild(a))||(i=!1===o(r,!0)?null:r.getNextSourceNode(!0,d,o)))),i&&!1===o(i)&&(i=null));i&&!this._.end;){if(this.current=i,this.evaluator&&!1===this.evaluator(i)){if(t&&this.evaluator)return!1}else if(!t)return i;i=i[c](!1,d,o)}return this.end(),this.current=null}function t(t){for(var n,i=null;n=e.call(this,t);)i=n;return i}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(e){this.range=e,this._={}},proto:{end:function(){this._.end=1},next:function(){return e.call(this)},previous:function(){return e.call(this,1)},checkForward:function(){return!1!==e.call(this,0,1)},checkBackward:function(){return!1!==e.call(this,1,1)},lastForward:function(){return t.call(this)},lastBackward:function(){return t.call(this,1)},reset:function(){delete this.current,this._={}}}});var n={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},i={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(e){return!("none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in i||!n[this.getComputedStyle("display")])||!!(this.is(CKEDITOR.dtd.$block)||e&&this.is(e))},CKEDITOR.dom.walker.blockBoundary=function(e){return function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary(e))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(e,t){function n(e){return e&&e.getName&&"span"==e.getName()&&e.data("cke-bookmark")}return function(i){var r,o;return r=i&&i.type!=CKEDITOR.NODE_ELEMENT&&(o=i.getParent())&&n(o),r=e?r:r||n(i),!!(t^r)}},CKEDITOR.dom.walker.whitespaces=function(e){return function(t){var n;return t&&t.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(t.getText())||CKEDITOR.env.webkit&&t.getText()==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE),!!(e^n)}},CKEDITOR.dom.walker.invisible=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.env.webkit?1:0;return function(i){return t(i)?i=1:(i.type==CKEDITOR.NODE_TEXT&&(i=i.getParent()),i=i.$.offsetWidth<=n),!!(e^i)}},CKEDITOR.dom.walker.nodeType=function(e,t){return function(n){return!!(t^n.type==e)}},CKEDITOR.dom.walker.bogus=function(e){function t(e){return!o(e)&&!a(e)}return function(n){var i=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&r.test(n.getText());return i&&(i=n.getParent(),n=n.getNext(t),i=i.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(e^i)}},CKEDITOR.dom.walker.temp=function(e){return function(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t=t&&t.hasAttribute("data-cke-temp"),!!(e^t)}};var r=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,o=CKEDITOR.dom.walker.whitespaces(),a=CKEDITOR.dom.walker.bookmark(),s=CKEDITOR.dom.walker.temp(),l=function(e){return a(e)||o(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$inline)&&!e.is(CKEDITOR.dtd.$empty)};CKEDITOR.dom.walker.ignored=function(e){return function(t){return t=o(t)||a(t)||s(t),!!(e^t)}};var d=CKEDITOR.dom.walker.ignored();CKEDITOR.dom.walker.empty=function(e){return function(t){for(var n=0,i=t.getChildCount();n<i;++n)if(!d(t.getChild(n)))return!!e;return!e}};var c=CKEDITOR.dom.walker.empty(),h=CKEDITOR.dom.walker.validEmptyBlockContainers=CKEDITOR.tools.extend(function(e){var t,n={};for(t in e)CKEDITOR.dtd[t]["#"]&&(n[t]=1);return n}(CKEDITOR.dtd.$block),{caption:1,td:1,th:1});CKEDITOR.dom.walker.editable=function(e){return function(t){return t=!d(t)&&!!(t.type==CKEDITOR.NODE_TEXT||t.type==CKEDITOR.NODE_ELEMENT&&(t.is(CKEDITOR.dtd.$inline)||t.is("hr")||"false"==t.getAttribute("contenteditable")||!CKEDITOR.env.needsBrFiller&&t.is(h)&&c(t))),!!(e^t)}},CKEDITOR.dom.element.prototype.getBogus=function(){var e=this;do{e=e.getPreviousSourceNode()}while(l(e));return!(!e||!(CKEDITOR.env.needsBrFiller?e.is&&e.is("br"):e.getText&&r.test(e.getText())))&&e}}(),CKEDITOR.dom.range=function(e){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var t=e instanceof CKEDITOR.dom.document;this.document=t?e:e.getDocument(),this.root=t?e.getBody():e},function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer.equals(e.endContainer)&&e.startOffset==e.endOffset}function t(e,t,n,i,r){function o(e,t,n,i){var o=n?e.getPrevious():e.getNext();return i&&a?o:(l||i?t.append(e.clone(!0,r),n):(e.remove(),s&&t.append(e,n)),o)}e.optimizeBookmark();var a=0===t,s=1==t,l=2==t;t=l||s;var d,c,h,u,f,g,p=e.startContainer,m=e.endContainer,E=e.startOffset,_=e.endOffset;if(l&&m.type==CKEDITOR.NODE_TEXT&&(p.equals(m)||p.type===CKEDITOR.NODE_ELEMENT&&p.getFirst().equals(m)))n.append(e.document.createText(m.substring(E,_)));else{m.type==CKEDITOR.NODE_TEXT?l?g=!0:m=m.split(_):0<m.getChildCount()?_>=m.getChildCount()?(m=m.getChild(_-1),c=!0):m=m.getChild(_):u=c=!0,p.type==CKEDITOR.NODE_TEXT?l?f=!0:p.split(E):0<p.getChildCount()?0===E?(p=p.getChild(E),d=!0):p=p.getChild(E-1):h=d=!0;for(var T,C,v,O=p.getParents(),I=m.getParents(),D=function(){var e,t,n,i=Math.min(O.length,I.length);for(e=0;e<i;e++)if(t=O[e],n=I[e],!t.equals(n))return e;return e-1}(),R=O.length-1,b=I.length-1,y=n,K=-1,k=D;k<=R;k++){for(C=O[k],v=C.getNext(),k!=R||C.equals(I[k])&&R<b?t&&(T=y.append(C.clone(0,r))):d?o(C,y,!1,h):f&&y.append(e.document.createText(C.substring(E)));v;){if(v.equals(I[k])){K=k;break}v=o(v,y)}y=T}for(y=n,k=D;k<=b;k++)if(n=I[k],v=n.getPrevious(),n.equals(O[k]))t&&(y=y.getChild(0));else{if(k!=b||n.equals(O[k])&&b<R?t&&(T=y.append(n.clone(0,r))):c?o(n,y,!1,u):g&&y.append(e.document.createText(n.substring(0,_))),k>K)for(;v;)v=o(v,y,!0);y=T}l||function(){var t=D-1,n=h&&u&&!p.equals(m);t<R-1||t<b-1||n?(n?e.moveToPosition(m,CKEDITOR.POSITION_BEFORE_START):b==t+1&&c?e.moveToPosition(I[t],CKEDITOR.POSITION_BEFORE_END):e.moveToPosition(I[t+1],CKEDITOR.POSITION_BEFORE_START),i&&(t=O[t+1])&&t.type==CKEDITOR.NODE_ELEMENT&&(n=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',e.document),n.insertAfter(t),t.mergeSiblings(!1),e.moveToBookmark({startNode:n}))):e.collapse(!0)}()}}function n(){var e=!1,t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),i=CKEDITOR.dom.walker.bogus();return function(r){return!(!n(r)&&!t(r))||(i(r)&&!e?e=!0:!(r.type==CKEDITOR.NODE_TEXT&&(r.hasAscendant("pre")||CKEDITOR.tools.trim(r.getText()).length)||r.type==CKEDITOR.NODE_ELEMENT&&!r.is(o)))}}function i(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(i){return!(!n(i)&&!t(i))||(!e&&a(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.is(CKEDITOR.dtd.$removeEmpty))}}function r(e){return function(){var t;return this[e?"getPreviousNode":"getNextNode"](function(e){return!t&&d(e)&&(t=e),l(e)&&!(a(e)&&e.equals(t))})}}var o={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1},a=CKEDITOR.dom.walker.bogus(),s=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,l=CKEDITOR.dom.walker.editable(),d=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var e=new CKEDITOR.dom.range(this.root);return e._setStartContainer(this.startContainer),e.startOffset=this.startOffset,e._setEndContainer(this.endContainer),e.endOffset=this.endOffset,e.collapsed=this.collapsed,e},collapse:function(e){e?(this._setEndContainer(this.startContainer),this.endOffset=this.startOffset):(this._setStartContainer(this.endContainer),this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(e){var n=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,2,n,!1,void 0===e||e),n},deleteContents:function(e){this.collapsed||t(this,0,null,e)},extractContents:function(e,n){var i=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,1,i,e,void 0===n||n),i},equals:function(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset&&this.startContainer.equals(e.startContainer)&&this.endContainer.equals(e.endContainer)},createBookmark:function(e){function t(e){return e.getAscendant(function(e){var t;return(t=e.data&&e.data("cke-temp"))&&(t=-1===CKEDITOR.tools.array.indexOf(["cke_copybin","cke_pastebin"],e.getAttribute("id"))),t},!0)}var n,i,r,o,a=this.startContainer,s=this.endContainer,l=this.collapsed;return n=this.document.createElement("span"),n.data("cke-bookmark",1),n.setStyle("display","none"),n.setHtml("&nbsp;"),e&&(r="cke_bm_"+CKEDITOR.tools.getNextNumber(),n.setAttribute("id",r+(l?"C":"S"))),l||(i=n.clone(),i.setHtml("&nbsp;"),e&&i.setAttribute("id",r+"E"),o=this.clone(),t(s)&&(s=t(s),o.moveToPosition(s,CKEDITOR.POSITION_AFTER_END)),o.collapse(),o.insertNode(i)),o=this.clone(),t(a)&&(s=t(a),o.moveToPosition(s,CKEDITOR.POSITION_BEFORE_START)),o.collapse(!0),o.insertNode(n),i?(this.setStartAfter(n),this.setEndBefore(i)):this.moveToPosition(n,CKEDITOR.POSITION_AFTER_END),{startNode:e?r+(l?"C":"S"):n,endNode:e?r+"E":i,serializable:e,collapsed:l}},createBookmark2:function(){function e(e){var t,i=e.container,r=e.offset;t=i;var o=r;if(t=t.type!=CKEDITOR.NODE_ELEMENT||0===o||o==t.getChildCount()?0:t.getChild(o-1).type==CKEDITOR.NODE_TEXT&&t.getChild(o).type==CKEDITOR.NODE_TEXT,t&&(i=i.getChild(r-1),r=i.getLength()),i.type==CKEDITOR.NODE_ELEMENT&&0<r){e:{for(t=i;r--;)if(0<=(o=t.getChild(r).getIndex(!0))){r=o;break e}r=-1}r+=1}if(i.type==CKEDITOR.NODE_TEXT){for(t=i,o=0;(t=t.getPrevious())&&t.type==CKEDITOR.NODE_TEXT;)o+=t.getText().replace(CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,"").length;t=o,i.isEmpty()?(o=i.getPrevious(n),t?(r=t,i=o?o.getNext():i.getParent().getFirst()):(i=i.getParent(),r=o?o.getIndex(!0)+1:0)):r+=t}e.container=i,e.offset=r}function t(e,t){var n=t.getCustomData("cke-fillingChar");if(n){var i=e.container;n.equals(i)&&(e.offset-=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE.length,0>=e.offset&&(e.offset=i.getIndex(),e.container=i.getParent()))}}var n=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_TEXT,!0);return function(n){var i=this.collapsed,r={container:this.startContainer,offset:this.startOffset},o={container:this.endContainer,offset:this.endOffset};return n&&(e(r),t(r,this.root),i||(e(o),t(o,this.root))),{start:r.container.getAddress(n),end:i?null:o.container.getAddress(n),startOffset:r.offset,endOffset:o.offset,normalized:n,collapsed:i,is2:!0}}}(),moveToBookmark:function(e){if(e.is2){var t=this.document.getByAddress(e.start,e.normalized),n=e.startOffset,i=e.end&&this.document.getByAddress(e.end,e.normalized);e=e.endOffset,this.setStart(t,n),i?this.setEnd(i,e):this.collapse(!0)}else t=(n=e.serializable)?this.document.getById(e.startNode):e.startNode,e=n?this.document.getById(e.endNode):e.endNode,this.setStartBefore(t),t.remove(),e?(this.setEndBefore(e),e.remove()):this.collapse(!0)},getBoundaryNodes:function(){var e,t=this.startContainer,n=this.endContainer,i=this.startOffset,r=this.endOffset;if(t.type==CKEDITOR.NODE_ELEMENT)if((e=t.getChildCount())>i)t=t.getChild(i);else if(1>e)t=t.getPreviousSourceNode();else{for(t=t.$;t.lastChild;)t=t.lastChild;t=new CKEDITOR.dom.node(t),t=t.getNextSourceNode()||t}if(n.type==CKEDITOR.NODE_ELEMENT)if((e=n.getChildCount())>r)n=n.getChild(r).getPreviousSourceNode(!0);else if(1>e)n=n.getPreviousSourceNode();else{for(n=n.$;n.lastChild;)n=n.lastChild;n=new CKEDITOR.dom.node(n)}return t.getPosition(n)&CKEDITOR.POSITION_FOLLOWING&&(t=n),{startNode:t,endNode:n}},getCommonAncestor:function(e,t){var n=this.startContainer,i=this.endContainer,n=n.equals(i)?e&&n.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?n.getChild(this.startOffset):n:n.getCommonAncestor(i);return t&&!n.is?n.getParent():n},optimize:function(){var e=this.startContainer,t=this.startOffset;e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setStartAfter(e):this.setStartBefore(e)),e=this.endContainer,t=this.endOffset,e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setEndAfter(e):this.setEndBefore(e))},optimizeBookmark:function(){var e=this.startContainer,t=this.endContainer;e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setStartAt(e,CKEDITOR.POSITION_BEFORE_START),t&&t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setEndAt(t,CKEDITOR.POSITION_AFTER_END)},trim:function(e,t){var n=this.startContainer,i=this.startOffset,r=this.collapsed;if((!e||r)&&n&&n.type==CKEDITOR.NODE_TEXT){if(i)if(i>=n.getLength())i=n.getIndex()+1,n=n.getParent();else{var o=n.split(i),i=n.getIndex()+1,n=n.getParent();this.startContainer.equals(this.endContainer)?this.setEnd(o,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset+=1)}else i=n.getIndex(),n=n.getParent();if(this.setStart(n,i),r)return void this.collapse(!0)}n=this.endContainer,i=this.endOffset,t||r||!n||n.type!=CKEDITOR.NODE_TEXT||(i?(i>=n.getLength()||n.split(i),i=n.getIndex()+1):i=n.getIndex(),n=n.getParent(),this.setEnd(n,i))},enlarge:function(e,t){function n(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")?null:e}function i(e,t,n){var i=new CKEDITOR.dom.range(n);for(i.setStart(e,t),i.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),n=new CKEDITOR.dom.walker(i),n.guard=function(e){return!(e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary())};i=n.next();){if(i.type!=CKEDITOR.NODE_TEXT)return!1;if(r=i!=e?i.getText():i.substring(t),a.test(r))return!1}return!0}var r,o,a=new RegExp(/[^\s\ufeff]/);switch(e){case CKEDITOR.ENLARGE_INLINE:var s=1;case CKEDITOR.ENLARGE_ELEMENT:if(this.collapsed)break;var l=this.getCommonAncestor();o=this.root;var d,c,h,u,f,g,p=!1;g=this.startContainer;var m=this.startOffset
;for(g.type==CKEDITOR.NODE_TEXT?(m&&(g=!CKEDITOR.tools.trim(g.substring(0,m)).length&&g,p=!!g),g&&((u=g.getPrevious())||(h=g.getParent()))):(m&&(u=g.getChild(m-1)||g.getLast()),u||(h=g)),h=n(h);h||u;){if(h&&!u){if(!f&&h.equals(l)&&(f=!0),s?h.isBlockBoundary():!o.contains(h))break;p&&"inline"==h.getComputedStyle("display")||(p=!1,f?d=h:this.setStartBefore(h)),u=h.getPrevious()}for(;u;)if(g=!1,u.type==CKEDITOR.NODE_COMMENT)u=u.getPrevious();else{if(u.type==CKEDITOR.NODE_TEXT)r=u.getText(),a.test(r)&&(u=null),g=/[\s\ufeff]$/.test(r);else if((u.$.offsetWidth>(CKEDITOR.env.webkit?1:0)||t&&u.is("br"))&&!u.data("cke-bookmark"))if(p&&CKEDITOR.dtd.$removeEmpty[u.getName()]){if(r=u.getText(),a.test(r))u=null;else for(var E,m=u.$.getElementsByTagName("*"),_=0;E=m[_++];)if(!CKEDITOR.dtd.$removeEmpty[E.nodeName.toLowerCase()]){u=null;break}u&&(g=!!r.length)}else u=null;if(g&&(p?f?d=h:h&&this.setStartBefore(h):p=!0),u){if(g=u.getPrevious(),!h&&!g){h=u,u=null;break}u=g}else h=null}h&&(h=n(h.getParent()))}for(g=this.endContainer,m=this.endOffset,h=u=null,f=p=!1,g.type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(g.substring(m)).length?p=!0:(p=!g.getLength(),m==g.getLength()?(u=g.getNext())||(h=g.getParent()):i(g,m,o)&&(h=g.getParent())):(u=g.getChild(m))||(h=g);h||u;){if(h&&!u){if(!f&&h.equals(l)&&(f=!0),s?h.isBlockBoundary():!o.contains(h))break;p&&"inline"==h.getComputedStyle("display")||(p=!1,f?c=h:h&&this.setEndAfter(h)),u=h.getNext()}for(;u;){if(g=!1,u.type==CKEDITOR.NODE_TEXT)r=u.getText(),i(u,0,o)||(u=null),g=/^[\s\ufeff]/.test(r);else if(u.type==CKEDITOR.NODE_ELEMENT){if((0<u.$.offsetWidth||t&&u.is("br"))&&!u.data("cke-bookmark"))if(p&&CKEDITOR.dtd.$removeEmpty[u.getName()]){if(r=u.getText(),a.test(r))u=null;else for(m=u.$.getElementsByTagName("*"),_=0;E=m[_++];)if(!CKEDITOR.dtd.$removeEmpty[E.nodeName.toLowerCase()]){u=null;break}u&&(g=!!r.length)}else u=null}else g=1;if(g&&p&&(f?c=h:this.setEndAfter(h)),u){if(g=u.getNext(),!h&&!g){h=u,u=null;break}u=g}else h=null}h&&(h=n(h.getParent()))}d&&c&&(l=d.contains(c)?c:d,this.setStartBefore(l),this.setEndAfter(l));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:h=new CKEDITOR.dom.range(this.root),o=this.root,h.setStartAt(o,CKEDITOR.POSITION_AFTER_START),h.setEnd(this.startContainer,this.startOffset),h=new CKEDITOR.dom.walker(h);var T,C,v=CKEDITOR.dom.walker.blockBoundary(e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),O=null,I=function(e){if(e.type==CKEDITOR.NODE_ELEMENT&&"false"==e.getAttribute("contenteditable"))if(O){if(O.equals(e))return void(O=null)}else O=e;else if(O)return;var t=v(e);return t||(T=e),t},s=function(e){var t=I(e);return!t&&e.is&&e.is("br")&&(C=e),t};if(h.guard=I,h=h.lastBackward(),T=T||o,this.setStartAt(T,!T.is("br")&&(!h&&this.checkStartOfBlock()||h&&T.contains(h))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END),e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){h=this.clone(),h=new CKEDITOR.dom.walker(h);var D=CKEDITOR.dom.walker.whitespaces(),R=CKEDITOR.dom.walker.bookmark();if(h.evaluator=function(e){return!D(e)&&!R(e)},(h=h.previous())&&h.type==CKEDITOR.NODE_ELEMENT&&h.is("br"))break}h=this.clone(),h.collapse(),h.setEndAt(o,CKEDITOR.POSITION_BEFORE_END),h=new CKEDITOR.dom.walker(h),h.guard=e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?s:I,T=O=C=null,h=h.lastForward(),T=T||o,this.setEndAt(T,!h&&this.checkEndOfBlock()||h&&T.contains(h)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),C&&this.setEndAfter(C)}},shrink:function(e,t,n){var i="boolean"==typeof n?n:!n||"boolean"!=typeof n.shrinkOnBlockBoundary||n.shrinkOnBlockBoundary,r=n&&n.skipBogus;if(!this.collapsed){e=e||CKEDITOR.SHRINK_TEXT;var o=this.clone(),a=this.startContainer,s=this.endContainer,l=this.startOffset,d=this.endOffset,c=n=1;a&&a.type==CKEDITOR.NODE_TEXT&&(l?l>=a.getLength()?o.setStartAfter(a):(o.setStartBefore(a),n=0):o.setStartBefore(a)),s&&s.type==CKEDITOR.NODE_TEXT&&(d?d>=s.getLength()?o.setEndAfter(s):(o.setEndAfter(s),c=0):o.setEndBefore(s));var o=new CKEDITOR.dom.walker(o),h=CKEDITOR.dom.walker.bookmark(),u=CKEDITOR.dom.walker.bogus();o.evaluator=function(t){return t.type==(e==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)};var f;return o.guard=function(t,n){return!!(r&&u(t)||h(t))||!(e==CKEDITOR.SHRINK_ELEMENT&&t.type==CKEDITOR.NODE_TEXT||n&&t.equals(f)||!1===i&&t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary()||t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable"))&&(n||t.type!=CKEDITOR.NODE_ELEMENT||(f=t),!0)},n&&(a=o[e==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(a,t?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),c&&(o.reset(),(o=o[e==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(o,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!(!n&&!c)}},insertNode:function(e){this.optimizeBookmark(),this.trim(!1,!0);var t=this.startContainer,n=t.getChild(this.startOffset);n?e.insertBefore(n):t.append(e),e.getParent()&&e.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(e)},moveToPosition:function(e,t){this.setStartAt(e,t),this.collapse(!0)},moveToRange:function(e){this.setStart(e.startContainer,e.startOffset),this.setEnd(e.endContainer,e.endOffset)},selectNodeContents:function(e){this.setStart(e,0),this.setEnd(e,e.type==CKEDITOR.NODE_TEXT?e.getLength():e.getChildCount())},setStart:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex(),t=t.getParent()),this._setStartContainer(t),this.startOffset=n,this.endContainer||(this._setEndContainer(t),this.endOffset=n),e(this)},setEnd:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex()+1,t=t.getParent()),this._setEndContainer(t),this.endOffset=n,this.startContainer||(this._setStartContainer(t),this.startOffset=n),e(this)},setStartAfter:function(e){this.setStart(e.getParent(),e.getIndex()+1)},setStartBefore:function(e){this.setStart(e.getParent(),e.getIndex())},setEndAfter:function(e){this.setEnd(e.getParent(),e.getIndex()+1)},setEndBefore:function(e){this.setEnd(e.getParent(),e.getIndex())},setStartAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setStart(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setStart(t,t.getLength()):this.setStart(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(t)}e(this)},setEndAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setEnd(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setEnd(t,t.getLength()):this.setEnd(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(t)}e(this)},fixBlock:function(e,t){var n=this.createBookmark(),i=this.document.createElement(t);this.collapse(e),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(i),i.trim(),this.insertNode(i);var r=i.getBogus();return r&&r.remove(),i.appendBogus(),this.moveToBookmark(n),i},splitBlock:function(e,t){var n=new CKEDITOR.dom.elementPath(this.startContainer,this.root),i=new CKEDITOR.dom.elementPath(this.endContainer,this.root),r=n.block,o=i.block,a=null;return n.blockLimit.equals(i.blockLimit)?("br"!=e&&(r||(r=this.fixBlock(!0,e),o=new CKEDITOR.dom.elementPath(this.endContainer,this.root).block),o||(o=this.fixBlock(!1,e))),n=r&&this.checkStartOfBlock(),i=o&&this.checkEndOfBlock(),this.deleteContents(),r&&r.equals(o)&&(i?(a=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(o,CKEDITOR.POSITION_AFTER_END),o=null):n?(a=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r=null):(o=this.splitElement(r,t||!1),r.is("ul","ol")||r.appendBogus())),{previousBlock:r,nextBlock:o,wasStartOfBlock:n,wasEndOfBlock:i,elementPath:a}):null},splitElement:function(e,t){if(!this.collapsed)return null;this.setEndAt(e,CKEDITOR.POSITION_BEFORE_END);var n=this.extractContents(!1,t||!1),i=e.clone(!1,t||!1);return n.appendTo(i),i.insertAfter(e),this.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),i},removeEmptyBlocksAtEnd:function(){function e(e){return function(i){return!(t(i)||n(i)||i.type==CKEDITOR.NODE_ELEMENT&&i.isEmptyInlineRemoveable()||e.is("table")&&i.is("caption"))}}var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(t){for(var n,i=this.createBookmark(),r=this[t?"endPath":"startPath"](),o=r.block||r.blockLimit;o&&!o.equals(r.root)&&!o.getFirst(e(o));)n=o.getParent(),this[t?"setEndAt":"setStartAt"](o,CKEDITOR.POSITION_AFTER_END),o.remove(1),o=n;this.moveToBookmark(i)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(e,t){var n=t==CKEDITOR.START,r=this.clone();return r.collapse(n),r[n?"setStartAt":"setEndAt"](e,n?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),r=new CKEDITOR.dom.walker(r),r.evaluator=i(n),r[n?"checkBackward":"checkForward"]()},checkStartOfBlock:function(e){var t=this.startContainer,i=this.startOffset;return CKEDITOR.env.ie&&i&&t.type==CKEDITOR.NODE_TEXT&&(t=CKEDITOR.tools.ltrim(t.substring(0,i)),s.test(t)&&this.trim(0,1)),e||this.trim(),e=new CKEDITOR.dom.elementPath(this.startContainer,this.root),t=this.clone(),t.collapse(!0),t.setStartAt(e.block||e.blockLimit,CKEDITOR.POSITION_AFTER_START),e=new CKEDITOR.dom.walker(t),e.evaluator=n(),e.checkBackward()},checkEndOfBlock:function(e){var t=this.endContainer,i=this.endOffset;return CKEDITOR.env.ie&&t.type==CKEDITOR.NODE_TEXT&&(t=CKEDITOR.tools.rtrim(t.substring(i)),s.test(t)&&this.trim(1,0)),e||this.trim(),e=new CKEDITOR.dom.elementPath(this.endContainer,this.root),t=this.clone(),t.collapse(!1),t.setEndAt(e.block||e.blockLimit,CKEDITOR.POSITION_BEFORE_END),e=new CKEDITOR.dom.walker(t),e.evaluator=n(),e.checkForward()},getPreviousNode:function(e,t,n){var i=this.clone();return i.collapse(1),i.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),n=new CKEDITOR.dom.walker(i),n.evaluator=e,n.guard=t,n.previous()},getNextNode:function(e,t,n){var i=this.clone();return i.collapse(),i.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),n=new CKEDITOR.dom.walker(i),n.evaluator=e,n.guard=t,n.next()},checkReadOnly:function(){function e(e,t){for(;e;){if(e.type==CKEDITOR.NODE_ELEMENT){if("false"==e.getAttribute("contentEditable")&&!e.data("cke-editable"))return 0;if(e.is("html")||"true"==e.getAttribute("contentEditable")&&(e.contains(t)||e.equals(t)))break}e=e.getParent()}return 1}return function(){var t=this.startContainer,n=this.endContainer;return!(e(t,n)&&e(n,t))}}(),moveToElementEditablePosition:function(e,t){if(e.type==CKEDITOR.NODE_ELEMENT&&!e.isEditable(!1))return this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;e;){if(e.type==CKEDITOR.NODE_TEXT){t&&this.endContainer&&this.checkEndOfBlock()&&s.test(e.getText())?this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(e.type==CKEDITOR.NODE_ELEMENT)if(e.isEditable())this.moveToPosition(e,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(t&&e.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START);else if("false"==e.getAttribute("contenteditable")&&e.is(CKEDITOR.dtd.$block))return this.setStartBefore(e),this.setEndAfter(e),!0;var i=e,r=n,o=void 0;i.type==CKEDITOR.NODE_ELEMENT&&i.isEditable(!1)&&(o=i[t?"getLast":"getFirst"](d)),r||o||(o=i[t?"getPrevious":"getNext"](d)),e=o}return!!n},moveToClosestEditablePosition:function(e,t){var n,i,r,o=0,a=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];return e?(n=new CKEDITOR.dom.range(this.root),n.moveToPosition(e,a[t?0:1])):n=this.clone(),e&&!e.is(CKEDITOR.dtd.$block)?o=1:(i=n[t?"getNextEditableNode":"getPreviousEditableNode"]())&&(o=1,(r=i.type==CKEDITOR.NODE_ELEMENT)&&i.is(CKEDITOR.dtd.$block)&&"false"==i.getAttribute("contenteditable")?(n.setStartAt(i,CKEDITOR.POSITION_BEFORE_START),n.setEndAt(i,CKEDITOR.POSITION_AFTER_END)):!CKEDITOR.env.needsBrFiller&&r&&i.is(CKEDITOR.dom.walker.validEmptyBlockContainers)?(n.setEnd(i,0),n.collapse()):n.moveToPosition(i,a[t?1:0])),o&&this.moveToRange(n),!!o},moveToElementEditStart:function(e){return this.moveToElementEditablePosition(e)},moveToElementEditEnd:function(e){return this.moveToElementEditablePosition(e,!0)},getEnclosedNode:function(){var e=this.clone();if(e.optimize(),e.startContainer.type!=CKEDITOR.NODE_ELEMENT||e.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var e=new CKEDITOR.dom.walker(e),t=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);e.evaluator=function(e){return n(e)&&t(e)};var i=e.next();return e.reset(),i&&i.equals(e.previous())?i:null},getTouchedStartNode:function(){var e=this.startContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.startOffset)||e},getTouchedEndNode:function(){var e=this.endContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.endOffset-1)||e},getNextEditableNode:r(),getPreviousEditableNode:r(1),_getTableElement:function(e){e=e||{td:1,th:1,tr:1,tbody:1,thead:1,tfoot:1,table:1};var t=this.getTouchedStartNode(),n=this.getTouchedEndNode(),i=t.getAscendant("table",!0),n=n.getAscendant("table",!0);return i&&!this.root.contains(i)?null:this.getEnclosedNode()?this.getEnclosedNode().getAscendant(e,!0):i&&n&&(i.equals(n)||i.contains(n)||n.contains(i))?t.getAscendant(e,!0):null},scrollIntoView:function(){var e,t,n,i=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),r=this.clone();r.optimize(),(n=r.startContainer.type==CKEDITOR.NODE_TEXT)?(t=r.startContainer.getText(),e=r.startContainer.split(r.startOffset),i.insertAfter(r.startContainer)):r.insertNode(i),i.scrollIntoView(),n&&(r.startContainer.setText(t),e.remove()),i.remove()},getClientRects:function(){function e(e,t){var n,i,r,o=CKEDITOR.tools.array.map(e,function(e){return e}),a=new CKEDITOR.dom.range(t.root);if(t.startContainer instanceof CKEDITOR.dom.element&&(i=0===t.startOffset&&t.startContainer.hasAttribute("data-widget")),t.endContainer instanceof CKEDITOR.dom.element&&(r=(r=t.endOffset===(t.endContainer.getChildCount?t.endContainer.getChildCount():t.endContainer.length))&&t.endContainer.hasAttribute("data-widget")),i&&a.setStart(t.startContainer.getParent(),t.startContainer.getIndex()),r&&a.setEnd(t.endContainer.getParent(),t.endContainer.getIndex()+1),(i||r)&&(t=a),a=t.cloneContents().find("[data-cke-widget-id]").toArray(),a=CKEDITOR.tools.array.map(a,function(e){var n=t.root.editor;return e=e.getAttribute("data-cke-widget-id"),n.widgets.instances[e].element}))return a=CKEDITOR.tools.array.map(a,function(e){var t;return t=e.getParent().hasClass("cke_widget_wrapper")?e.getParent():e,n=this.root.getDocument().$.createRange(),n.setStart(t.getParent().$,t.getIndex()),n.setEnd(t.getParent().$,t.getIndex()+1),t=n.getClientRects(),t.widgetRect=e.getClientRect(),t},t),CKEDITOR.tools.array.forEach(a,function(e){function t(i){CKEDITOR.tools.array.forEach(o,function(t,r){var a=CKEDITOR.tools.objectCompare(e[i],t);a||(a=CKEDITOR.tools.objectCompare(e.widgetRect,t)),a&&(Array.prototype.splice.call(o,r,e.length-i,e.widgetRect),n=!0)}),n||(i<o.length-1?t(i+1):o.push(e.widgetRect))}var n;t(0)}),o}function t(e,t,n){var r;return t.collapsed?n.startContainer instanceof CKEDITOR.dom.element?(e=n.checkStartOfBlock(),r=new CKEDITOR.dom.text("\u200b"),e?n.startContainer.append(r,!0):0===n.startOffset?r.insertBefore(n.startContainer.getFirst()):(n=n.startContainer.getChildren().getItem(n.startOffset-1),r.insertAfter(n)),t.setStart(r.$,0),t.setEnd(r.$,0),e=t.getClientRects(),r.remove()):n.startContainer instanceof CKEDITOR.dom.text&&(""===n.startContainer.getText()?(n.startContainer.setText("\u200b"),e=t.getClientRects(),n.startContainer.setText("")):e=[i(n.createBookmark())]):e=[i(n.createBookmark())],e}function n(e,t,n){return e=CKEDITOR.tools.extend({},e),t&&(e=CKEDITOR.tools.getAbsoluteRectPosition(n.document.getWindow(),e)),!e.width&&(e.width=e.right-e.left),!e.height&&(e.height=e.bottom-e.top),e}function i(e){var t=e.startNode;e=e.endNode;var n;return t.setText("\u200b"),t.removeStyle("display"),e?(e.setText("\u200b"),e.removeStyle("display"),n=[t.getClientRect(),e.getClientRect()],e.remove()):n=[t.getClientRect(),t.getClientRect()],t.remove(),{right:Math.max(n[0].right,n[1].right),bottom:Math.max(n[0].bottom,n[1].bottom),left:Math.min(n[0].left,n[1].left),top:Math.min(n[0].top,n[1].top),width:Math.abs(n[0].left-n[1].left),height:Math.max(n[0].bottom,n[1].bottom)-Math.min(n[0].top,n[1].top)}}return void 0!==document.getSelection?function(i){var r,o=this.root.getDocument().$.createRange();return o.setStart(this.startContainer.$,this.startOffset),o.setEnd(this.endContainer.$,this.endOffset),r=o.getClientRects(),r=e(r,this),r.length||(r=t(r,o,this)),CKEDITOR.tools.array.map(r,function(e){return n(e,i,this)},this)}:function(e){return[n(i(this.createBookmark()),e,this)]}}(),_setStartContainer:function(e){this.startContainer=e},_setEndContainer:function(e){this.endContainer=e},_find:function(e,t){var n,i,r,o,a=this.getCommonAncestor(),s=this.getBoundaryNodes(),l=[];if(a&&a.find)for(i=a.find(e),n=0;n<i.count();n++)a=i.getItem(n),(t||!a.isReadOnly())&&(r=a.getPosition(s.startNode)&CKEDITOR.POSITION_FOLLOWING||s.startNode.equals(a),o=a.getPosition(s.endNode)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IS_CONTAINED||s.endNode.equals(a),r&&o&&l.push(a));return l}},CKEDITOR.dom.range.mergeRanges=function(e){return CKEDITOR.tools.array.reduce(e,function(e,t){var n=e[e.length-1],i=!1;if(t=t.clone(),t.enlarge(CKEDITOR.ENLARGE_ELEMENT),n){var r=new CKEDITOR.dom.range(t.root),i=new CKEDITOR.dom.walker(r),o=CKEDITOR.dom.walker.whitespaces();for(r.setStart(n.endContainer,n.endOffset),r.setEnd(t.startContainer,t.startOffset),r=i.next();o(r)||t.endContainer.equals(r);)r=i.next();i=!r}return i?n.setEnd(t.endContainer,t.endOffset):e.push(t),e},[])}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,function(){function e(e){1>arguments.length||(this.range=e,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function t(e){var t=[];return e.forEach(function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1},CKEDITOR.NODE_ELEMENT,!0),t}function n(e,i,r,o){e:{null==o&&(o=t(r));for(var a;a=o.shift();)if(a.getDtd().p){o={element:a,remaining:o};break e}o=null}return o?(a=CKEDITOR.filter.instances[o.element.data("cke-filter")])&&!a.check(i)?n(e,i,r,o.remaining):(i=new CKEDITOR.dom.range(o.element),i.selectNodeContents(o.element),i=i.createIterator(),i.enlargeBr=e.enlargeBr,i.enforceRealBlocks=e.enforceRealBlocks,i.activeFilter=i.filter=a,e._.nestedEditable={element:o.element,container:r,remaining:o.remaining,iterator:i},1):0}function i(e,t,n){return!!t&&(e=e.clone(),e.collapse(!n),e.checkBoundaryOfElement(t,n?CKEDITOR.START:CKEDITOR.END))}var r=/^[\r\n\t ]+$/,o=CKEDITOR.dom.walker.bookmark(!1,!0),a=CKEDITOR.dom.walker.whitespaces(!0),s=function(e){return o(e)&&a(e)},l={dd:1,dt:1,li:1};e.prototype={getNextParagraph:function(e){var t,a,d,c,h;if(e=e||"p",this._.nestedEditable){if(t=this._.nestedEditable.iterator.getNextParagraph(e))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,t;if(this.activeFilter=this.filter,n(this,e,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(e);this._.nestedEditable=null}if(!this.range.root.getDtd()[e])return null;if(!this._.started){var u=this.range.clone();a=u.startPath();var f=u.endPath(),g=!u.collapsed&&i(u,a.block),p=!u.collapsed&&i(u,f.block,1);u.shrink(CKEDITOR.SHRINK_ELEMENT,!0),g&&u.setStartAt(a.block,CKEDITOR.POSITION_BEFORE_END),p&&u.setEndAt(f.block,CKEDITOR.POSITION_AFTER_START),a=u.endContainer.hasAscendant("pre",!0)||u.startContainer.hasAscendant("pre",!0),u.enlarge(this.forceBrBreak&&!a||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),u.collapsed||(a=new CKEDITOR.dom.walker(u.clone()),f=CKEDITOR.dom.walker.bookmark(!0,!0),a.evaluator=f,this._.nextNode=a.next(),a=new CKEDITOR.dom.walker(u.clone()),a.evaluator=f,a=a.previous(),this._.lastNode=a.getNextSourceNode(!0,null,u.root),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&(f=this.range.clone(),f.moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),f.checkEndOfBlock()&&(f=new CKEDITOR.dom.elementPath(f.endContainer,f.root),this._.lastNode=(f.block||f.blockLimit).getNextSourceNode(!0))),this._.lastNode&&u.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=u.document.createText(""),this._.lastNode.insertAfter(a)),u=null),this._.started=1,a=u}for(f=this._.nextNode,u=this._.lastNode,this._.nextNode=null;f;){var g=0,p=f.hasAscendant("pre"),m=f.type!=CKEDITOR.NODE_ELEMENT,E=0;if(m)f.type==CKEDITOR.NODE_TEXT&&r.test(f.getText())&&(m=0);else{var _=f.getName();if(CKEDITOR.dtd.$block[_]&&"false"==f.getAttribute("contenteditable")){t=f,n(this,e,t);break}if(f.isBlockBoundary(this.forceBrBreak&&!p&&{br:1})){if("br"==_)m=1;else if(!a&&!f.getChildCount()&&"hr"!=_){t=f,d=f.equals(u);break}a&&(a.setEndAt(f,CKEDITOR.POSITION_BEFORE_START),"br"!=_&&(this._.nextNode=f)),g=1}else{if(f.getFirst()){a||(a=this.range.clone(),a.setStartAt(f,CKEDITOR.POSITION_BEFORE_START)),f=f.getFirst();continue}m=1}}if(m&&!a&&(a=this.range.clone(),a.setStartAt(f,CKEDITOR.POSITION_BEFORE_START)),d=(!g||m)&&f.equals(u),a&&!g)for(;!f.getNext(s)&&!d;){if(_=f.getParent(),_.isBlockBoundary(this.forceBrBreak&&!p&&{br:1})){g=1,m=0,d||_.equals(u),a.setEndAt(_,CKEDITOR.POSITION_BEFORE_END);break}f=_,m=1,d=f.equals(u),E=1}if(m&&a.setEndAt(f,CKEDITOR.POSITION_AFTER_END),f=this._getNextSourceNode(f,E,u),(d=!f)||g&&a)break}if(!t){if(!a)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;t=new CKEDITOR.dom.elementPath(a.startContainer,a.root),f=t.blockLimit,g={div:1,th:1,td:1},t=t.block,!t&&f&&!this.enforceRealBlocks&&g[f.getName()]&&a.checkStartOfBlock()&&a.checkEndOfBlock()&&!f.equals(a.root)?t=f:!t||this.enforceRealBlocks&&t.is(l)?(t=this.range.document.createElement(e),a.extractContents().appendTo(t),t.trim(),a.insertNode(t),c=h=!0):"li"!=t.getName()?a.checkStartOfBlock()&&a.checkEndOfBlock()||(t=t.clone(!1),a.extractContents().appendTo(t),t.trim(),h=a.splitBlock(),c=!h.wasStartOfBlock,h=!h.wasEndOfBlock,a.insertNode(t)):d||(this._.nextNode=t.equals(u)?null:this._getNextSourceNode(a.getBoundaryNodes().endNode,1,u))}return c&&(c=t.getPrevious())&&c.type==CKEDITOR.NODE_ELEMENT&&("br"==c.getName()?c.remove():c.getLast()&&"br"==c.getLast().$.nodeName.toLowerCase()&&c.getLast().remove()),h&&(c=t.getLast())&&c.type==CKEDITOR.NODE_ELEMENT&&"br"==c.getName()&&(!CKEDITOR.env.needsBrFiller||c.getPrevious(o)||c.getNext(o))&&c.remove(),this._.nextNode||(this._.nextNode=d||t.equals(u)||!u?null:this._getNextSourceNode(t,1,u)),t},_getNextSourceNode:function(e,t,n){function i(e){return!(e.equals(n)||e.equals(r))}var r=this.range.root;for(e=e.getNextSourceNode(t,null,i);!o(e);)e=e.getNextSourceNode(t,null,i);return e}},CKEDITOR.dom.range.prototype.createIterator=function(){return new e(this)}}(),CKEDITOR.command=function(e,t){this.uiItems=[],this.exec=function(n){return!(this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed())&&(this.editorFocus&&e.focus(),!1===this.fire("exec")||!1!==t.exec.call(this,e,n))},this.refresh=function(e,n){return!(this.readOnly||!e.readOnly)||(this.context&&!n.isContextFor(this.context)||!this.checkAllowed(!0)?(this.disable(),!0):(this.startDisabled||this.enable(),this.modes&&!this.modes[e.mode]&&this.disable(),!1===this.fire("refresh",{editor:e,path:n})||t.refresh&&!1!==t.refresh.apply(this,arguments)))};var n;this.checkAllowed=function(t){return t||"boolean"!=typeof n?n=e.activeFilter.checkFeature(this):n},CKEDITOR.tools.extend(this,t,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!t.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&void 0!==this.previousState?this.previousState:CKEDITOR.TRISTATE_OFF)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(e){return!(this.state==e||e!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed())&&(this.previousState=this.state,this.state=e,this.fire("state"),!0)},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,contentsCss:CKEDITOR.getUrl("contents.css"),extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,useComputedState:!0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function e(e,t,n,i,r){var o,s;e=[];for(o in t){s=t[o],s="boolean"==typeof s?{}:"function"==typeof s?{match:s}:y(s),"$"!=o.charAt(0)&&(s.elements=o),n&&(s.featureName=n.toLowerCase());var l=s;l.elements=a(l.elements,/\s+/)||null,l.propertiesOnly=l.propertiesOnly||!0===l.elements;var d=/\s*,\s*/,c=void 0;for(c in N){l[c]=a(l[c],d)||null;var h=l,u=x[c],f=a(l[x[c]],d),g=l[c],p=[],m=!0,_=void 0;f?m=!1:f={};for(_ in g)"!"==_.charAt(0)&&(_=_.slice(1),p.push(_),f[_]=!0,m=!1);for(;_=p.pop();)g[_]=g["!"+_],delete g["!"+_];h[u]=!m&&f||null}l.match=l.match||null,i.push(s),e.push(s)}t=r.elements,r=r.generic;var T;for(n=0,i=e.length;n<i;++n){o=y(e[n]),s=!0===o.classes||!0===o.styles||!0===o.attributes,l=o,c=u=d=void 0;for(d in N)l[d]=E(l[d]);h=!0;for(c in x){d=x[c],u=l[d],f=[],g=void 0;for(g in u)-1<g.indexOf("*")?f.push(new RegExp("^"+g.replace(/\*/g,".*")+"$")):f.push(g);u=f,u.length&&(l[d]=u,h=!1)}if(l.nothingRequired=h,l.noProperties=!(l.attributes||l.classes||l.styles),!0===o.elements||null===o.elements)r[s?"unshift":"push"](o);else for(T in l=o.elements,delete o.elements,l)t[T]?t[T][s?"unshift":"push"](o):t[T]=[o]}}function t(e,t,i,r){if((!e.match||e.match(t))&&(r||s(e,t))&&(e.propertiesOnly||(i.valid=!0),i.allAttributes||(i.allAttributes=n(e.attributes,t.attributes,i.validAttributes)),i.allStyles||(i.allStyles=n(e.styles,t.styles,i.validStyles)),!i.allClasses)){if(e=e.classes,t=t.classes,r=i.validClasses,e)if(!0===e)e=!0;else{for(var o,a=0,l=t.length;a<l;++a)o=t[a],r[o]||(r[o]=e(o));e=!1}else e=!1;i.allClasses=e}}function n(e,t,n){if(!e)return!1;if(!0===e)return!0;for(var i in t)n[i]||(n[i]=e(i));return!1}function i(e,t,n){if(!e.match||e.match(t)){if(e.noProperties)return!1;if(n.hadInvalidAttribute=r(e.attributes,t.attributes)||n.hadInvalidAttribute,n.hadInvalidStyle=r(e.styles,t.styles)||n.hadInvalidStyle,e=e.classes,t=t.classes,e){for(var i=!1,o=!0===e,a=t.length;a--;)(o||e(t[a]))&&(t.splice(a,1),i=!0);e=i}else e=!1;n.hadInvalidClass=e||n.hadInvalidClass}}function r(e,t){if(!e)return!1;var n,i=!1,r=!0===e;for(n in t)(r||e(n))&&(delete t[n],i=!0);return i}function o(e,t,n){return!(e.disabled||e.customConfig&&!n||!t)&&(e._.cachedChecks={},!0)}function a(e,t){if(!e)return!1;if(!0===e)return e;if("string"==typeof e)return"*"==(e=K(e))||CKEDITOR.tools.convertArrayToObject(e.split(t));if(CKEDITOR.tools.isArray(e))return!!e.length&&CKEDITOR.tools.convertArrayToObject(e);var n,i={},r=0;for(n in e)i[n]=e[n],r++;return!!r&&i}function s(e,t){if(e.nothingRequired)return!0;var n,i,r,o;if(r=e.requiredClasses)for(o=t.classes,n=0;n<r.length;++n)if("string"==typeof(i=r[n])){if(-1==CKEDITOR.tools.indexOf(o,i))return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(o,i))return!1;return l(t.styles,e.requiredStyles)&&l(t.attributes,e.requiredAttributes)}function l(e,t){if(!t)return!0;for(var n,i=0;i<t.length;++i)if("string"==typeof(n=t[i])){if(!(n in e))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(e,n))return!1;return!0}function d(e){if(!e)return{};e=e.split(/\s*,\s*/).sort();for(var t={};e.length;)t[e.shift()]="cke-test";return t}function c(e){var t,n,i,r,o={},a=1;for(e=K(e);t=e.match(S);)(n=t[2])?(i=h(n,"styles"),r=h(n,"attrs"),n=h(n,"classes")):i=r=n=null,o["$"+a++]={elements:t[1],classes:n,styles:i,attributes:r},e=e.slice(t[0].length);return o}function h(e,t){var n=e.match(A[t]);return n?K(n[1]):null}function u(e){var t=e.styleBackup=e.attributes.style,n=e.classBackup=e.attributes.class;e.styles||(e.styles=CKEDITOR.tools.parseCssText(t||"",1)),e.classes||(e.classes=n?n.split(/\s+/):[])}function f(e,n,r,o){var a,s=0;if(o.toHtml&&(n.name=n.name.replace(L,"$1")),o.doCallbacks&&e.elementCallbacks){e:{a=e.elementCallbacks;for(var l,d=0,c=a.length;d<c;++d)if(l=a[d](n)){a=l;break e}a=void 0}if(a)return a}if(o.doTransform&&(a=e._.transformations[n.name])){for(u(n),d=0;d<a.length;++d)v(e,n,a[d]);p(n)}if(o.doFilter){e:{d=n.name,c=e._,e=c.allowedRules.elements[d],a=c.allowedRules.generic,d=c.disallowedRules.elements[d],c=c.disallowedRules.generic,l=o.skipRequired;var h,f,g={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};if(e||a){if(u(n),d)for(h=0,f=d.length;h<f;++h)if(!1===i(d[h],n,g)){e=null;break e}if(c)for(h=0,f=c.length;h<f;++h)i(c[h],n,g);if(e)for(h=0,f=e.length;h<f;++h)t(e[h],n,g,l);if(a)for(h=0,f=a.length;h<f;++h)t(a[h],n,g,l);e=g}else e=null}if(!e||!e.valid)return r.push(n),1;f=e.validAttributes;var E=e.validStyles;a=e.validClasses;var d=n.attributes,_=n.styles,c=n.classes;l=n.classBackup;var T,C,O=n.styleBackup,I=[],g=[],D=/^data-cke-/;if(h=!1,delete d.style,delete d.class,delete n.classBackup,delete n.styleBackup,!e.allAttributes)for(T in d)f[T]||(D.test(T)?T==(C=T.replace(/^data-cke-saved-/,""))||f[C]||(delete d[T],h=!0):(delete d[T],h=!0));if(!e.allStyles||e.hadInvalidStyle){for(T in _)e.allStyles||E[T]?I.push(T+":"+_[T]):h=!0;I.length&&(d.style=I.sort().join("; "))}else O&&(d.style=O);if(!e.allClasses||e.hadInvalidClass){for(T=0;T<c.length;++T)(e.allClasses||a[c[T]])&&g.push(c[T]);g.length&&(d.class=g.sort().join(" ")),l&&g.length<l.split(/\s+/).length&&(h=!0)}else l&&(d.class=l);if(h&&(s=1),!o.skipFinalValidation&&!m(n))return r.push(n),1}return o.toHtml&&(n.name=n.name.replace(P,"cke:$1")),s}function g(e){var t,n=[];for(t in e)-1<t.indexOf("*")&&n.push(t.replace(/\*/g,".*"));return n.length?new RegExp("^(?:"+n.join("|")+")$"):null}function p(e){var t,n=e.attributes;delete n.style,delete n.class,(t=CKEDITOR.tools.writeCssText(e.styles,!0))&&(n.style=t),e.classes.length&&(n.class=e.classes.sort().join(" "))}function m(e){switch(e.name){case"a":if(!(e.children.length||e.attributes.name||e.attributes.id))return!1;break;case"img":if(!e.attributes.src)return!1}return!0}function E(e){if(!e)return!1;if(!0===e)return!0;var t=g(e);return function(n){return n in e||t&&n.match(t)}}function _(){return new CKEDITOR.htmlParser.element("br")}function T(e){return e.type==CKEDITOR.NODE_ELEMENT&&("br"==e.name||b.$block[e.name])}function C(e,t,n){
var i=e.name;if(b.$empty[i]||!e.children.length)"hr"==i&&"br"==t?e.replaceWith(_()):(e.parent&&n.push({check:"it",el:e.parent}),e.remove());else if(b.$block[i]||"tr"==i)if("br"==t)e.previous&&!T(e.previous)&&(t=_(),t.insertBefore(e)),e.next&&!T(e.next)&&(t=_(),t.insertAfter(e)),e.replaceWithChildren();else{var r,i=e.children;e:{r=b[t];for(var o,a=0,s=i.length;a<s;++a)if(o=i[a],o.type==CKEDITOR.NODE_ELEMENT&&!r[o.name]){r=!1;break e}r=!0}if(r)e.name=t,e.attributes={},n.push({check:"parent-down",el:e});else{r=e.parent;for(var l,d,a=r.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==r.name,s=i.length;0<s;)o=i[--s],a&&(o.type==CKEDITOR.NODE_TEXT||o.type==CKEDITOR.NODE_ELEMENT&&b.$inline[o.name])?(l||(l=new CKEDITOR.htmlParser.element(t),l.insertAfter(e),n.push({check:"parent-down",el:l})),l.add(o,0)):(l=null,d=b[r.name]||b.span,o.insertAfter(e),r.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||o.type!=CKEDITOR.NODE_ELEMENT||d[o.name]||n.push({check:"el-up",el:o}));e.remove()}}else i in{style:1,script:1}?e.remove():(e.parent&&n.push({check:"it",el:e.parent}),e.replaceWithChildren())}function v(e,t,n){var i,r;for(i=0;i<n.length;++i)if(r=n[i],!(r.check&&!e.check(r.check,!1)||r.left&&!r.left(t))){r.right(t,w);break}}function O(e,t){var n,i,r,o,a=t.getDefinition(),s=a.attributes,l=a.styles;if(e.name!=a.element)return!1;for(n in s)if("class"==n){for(a=s[n].split(/\s+/),r=e.classes.join("|");o=a.pop();)if(-1==r.indexOf(o))return!1}else if(e.attributes[n]!=s[n])return!1;for(i in l)if(e.styles[i]!=l[i])return!1;return!0}function I(e,t){var n,i;return"string"==typeof e?n=e:e instanceof CKEDITOR.style?i=e:(n=e[0],i=e[1]),[{element:n,left:i,right:function(e,n){n.transform(e,t)}}]}function D(e){return function(t){return O(t,e)}}function R(e){return function(t,n){n[e](t)}}var b=CKEDITOR.dtd,y=CKEDITOR.tools.copy,K=CKEDITOR.tools.trim,k=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(e,t){this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{},cachedChecks:{}},CKEDITOR.filter.instances[this.id]=this;var n=this.editor=e instanceof CKEDITOR.editor?e:null;if(n&&!t){this.customConfig=!0;var i=n.config.allowedContent;!0===i?this.disabled=!0:(i||(this.customConfig=!1),this.allow(i,"config",1),this.allow(n.config.extraAllowedContent,"extra",1),this.allow(k[n.enterMode]+" "+k[n.shiftEnterMode],"default",1),this.disallow(n.config.disallowedContent))}else this.customConfig=!1,this.allow(t||e,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,n,i){if(!o(this,t,i))return!1;var r,a;if("string"==typeof t)t=c(t);else if(t instanceof CKEDITOR.style){if(t.toAllowedContentRules)return this.allow(t.toAllowedContentRules(this.editor),n,i);r=t.getDefinition(),t={},i=r.attributes,t[r.element]=r={styles:r.styles,requiredStyles:r.styles&&CKEDITOR.tools.object.keys(r.styles)},i&&(i=y(i),r.classes=i.class?i.class.split(/\s+/):null,r.requiredClasses=r.classes,delete i.class,r.attributes=i,r.requiredAttributes=i&&CKEDITOR.tools.object.keys(i))}else if(CKEDITOR.tools.isArray(t)){for(r=0;r<t.length;++r)a=this.allow(t[r],n,i);return a}return e(this,t,n,this.allowedContent,this._.allowedRules),!0},applyTo:function(e,t,n,i){if(this.disabled)return!1;var r,o=this,a=[],s=this.editor&&this.editor.config.protectedSource,l=!1,d={doFilter:!n,doTransform:!0,doCallbacks:!0,toHtml:t};e.forEach(function(e){if(e.type==CKEDITOR.NODE_ELEMENT){if("off"==e.attributes["data-cke-filter"])return!1;if(!t||"span"!=e.name||!~CKEDITOR.tools.object.keys(e.attributes).join("|").indexOf("data-cke-"))if(1&(r=f(o,e,a,d)))l=!0;else if(2&r)return!1}else if(e.type==CKEDITOR.NODE_COMMENT&&e.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;e:{var i=decodeURIComponent(e.value.replace(/^\{cke_protected\}/,""));n=[];var c,h,u;if(s)for(h=0;h<s.length;++h)if((u=i.match(s[h]))&&u[0].length==i.length){n=!0;break e}i=CKEDITOR.htmlParser.fragment.fromHtml(i),1==i.children.length&&(c=i.children[0]).type==CKEDITOR.NODE_ELEMENT&&f(o,c,n,d),n=!n.length}n||a.push(e)}},null,!0),a.length&&(l=!0);var c;e=[],i=k[i||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];for(var h;n=a.pop();)n.type==CKEDITOR.NODE_ELEMENT?C(n,i,e):n.remove();for(;c=e.pop();)if(n=c.el,n.parent)switch(h=b[n.parent.name]||b.span,c.check){case"it":b.$removeEmpty[n.name]&&!n.children.length?C(n,i,e):m(n)||C(n,i,e);break;case"el-up":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||h[n.name]||C(n,i,e);break;case"parent-down":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||h[n.name]||C(n.parent,i,e)}return l},checkFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),!e.requiredContent||this.check(e.requiredContent))},disable:function(){this.disabled=!0},disallow:function(t){return!!o(this,t,!0)&&("string"==typeof t&&(t=c(t)),e(this,t,null,this.disallowedContent,this._.disallowedRules),!0)},addContentForms:function(e){if(!this.disabled&&e){var t,n,i,r=[];for(t=0;t<e.length&&!i;++t)("string"==typeof(n=e[t])||n instanceof CKEDITOR.style)&&this.check(n)&&(i=n);if(i){for(t=0;t<e.length;++t)r.push(I(e[t],i));this.addTransformations(r)}}},addElementCallback:function(e){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(e)},addFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),this.allow(e.allowedContent,e.name),this.addTransformations(e.contentTransformations),this.addContentForms(e.contentForms),!e.requiredContent||!this.customConfig&&!this.disallowedContent.length||this.check(e.requiredContent))},addTransformations:function(e){var t,n;if(!this.disabled&&e){var i,r=this._.transformations;for(i=0;i<e.length;++i){t=e[i];var o=void 0,a=void 0,s=void 0,l=void 0,d=void 0,c=void 0;for(n=[],a=0;a<t.length;++a)s=t[a],"string"==typeof s?(s=s.split(/\s*:\s*/),l=s[0],d=null,c=s[1]):(l=s.check,d=s.left,c=s.right),o||(o=s,o=o.element?o.element:l?l.match(/^([a-z0-9]+)/i)[0]:o.left.getDefinition().element),d instanceof CKEDITOR.style&&(d=D(d)),n.push({check:l==o?null:l,left:d,right:"string"==typeof c?R(c):c});t=o,r[t]||(r[t]=[]),r[t].push(n)}}},check:function(e,t,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(e)){for(var i=e.length;i--;)if(this.check(e[i],t,n))return!0;return!1}var r,o;if("string"==typeof e){if((o=e+"<"+(!1===t?"0":"1")+(n?"1":"0")+">")in this._.cachedChecks)return this._.cachedChecks[o];r=c(e).$1;var a=r.styles,i=r.classes;r.name=r.elements,r.classes=i=i?i.split(/\s*,\s*/):[],r.styles=d(a),r.attributes=d(r.attributes),r.children=[],i.length&&(r.attributes.class=i.join(" ")),a&&(r.attributes.style=CKEDITOR.tools.writeCssText(r.styles))}else r=e.getDefinition(),a=r.styles,i=r.attributes||{},a&&!CKEDITOR.tools.isEmpty(a)?(a=y(a),i.style=CKEDITOR.tools.writeCssText(a,!0)):a={},r={name:r.element,attributes:i,classes:i.class?i.class.split(/\s+/):[],styles:a,children:[]};var s,a=CKEDITOR.tools.clone(r),l=[];if(!1!==t&&(s=this._.transformations[r.name])){for(i=0;i<s.length;++i)v(this,r,s[i]);p(r)}return f(this,a,l,{doFilter:!0,doTransform:!1!==t,skipRequired:!n,skipFinalValidation:!n}),0<l.length?n=!1:((t=r.attributes.class)&&(r.attributes.class=r.attributes.class.split(" ").sort().join(" ")),n=CKEDITOR.tools.objectCompare(r.attributes,a.attributes,!0),t&&(r.attributes.class=t)),"string"==typeof e&&(this._.cachedChecks[o]=n),n},getAllowedEnterMode:function(){var e=["p","div","br"],t={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,i){var r,o=e.slice();if(this.check(k[n]))return n;for(i||(o=o.reverse());r=o.pop();)if(this.check(r))return t[r];return CKEDITOR.ENTER_BR}}(),clone:function(){var e=new CKEDITOR.filter,t=CKEDITOR.tools.clone;return e.allowedContent=t(this.allowedContent),e._.allowedRules=t(this._.allowedRules),e.disallowedContent=t(this.disallowedContent),e._.disallowedRules=t(this._.disallowedRules),e._.transformations=t(this._.transformations),e.disabled=this.disabled,e.editor=this.editor,e},destroy:function(){delete CKEDITOR.filter.instances[this.id],delete this._,delete this.allowedContent,delete this.disallowedContent}};var w,N={styles:1,attributes:1,classes:1},x={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},S=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,A={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},L=/^cke:(object|embed|param)$/,P=/^(object|embed|param)$/;w=CKEDITOR.filter.transformationsTools={sizeToStyle:function(e){this.lengthToStyle(e,"width"),this.lengthToStyle(e,"height")},sizeToAttribute:function(e){this.lengthToAttribute(e,"width"),this.lengthToAttribute(e,"height")},lengthToStyle:function(e,t,n){if(!((n=n||t)in e.styles)){var i=e.attributes[t];i&&(/^\d+$/.test(i)&&(i+="px"),e.styles[n]=i)}delete e.attributes[t]},lengthToAttribute:function(e,t,n){if(!((n=n||t)in e.attributes)){var i=e.styles[t],r=i&&i.match(/^(\d+)(?:\.\d*)?px$/);r?e.attributes[n]=r[1]:"cke-test"==i&&(e.attributes[n]="cke-test")}delete e.styles[t]},alignmentToStyle:function(e){if(!("float"in e.styles)){var t=e.attributes.align;"left"!=t&&"right"!=t||(e.styles.float=t)}delete e.attributes.align},alignmentToAttribute:function(e){if(!("align"in e.attributes)){var t=e.styles.float;"left"!=t&&"right"!=t||(e.attributes.align=t)}delete e.styles.float},splitBorderShorthand:function(e){if(e.styles.border){var t=CKEDITOR.tools.style.parse.border(e.styles.border);t.color&&(e.styles["border-color"]=t.color),t.style&&(e.styles["border-style"]=t.style),t.width&&(e.styles["border-width"]=t.width),delete e.styles.border}},listTypeToStyle:function(e){if(e.attributes.type)switch(e.attributes.type){case"a":e.styles["list-style-type"]="lower-alpha";break;case"A":e.styles["list-style-type"]="upper-alpha";break;case"i":e.styles["list-style-type"]="lower-roman";break;case"I":e.styles["list-style-type"]="upper-roman";break;case"1":e.styles["list-style-type"]="decimal";break;default:e.styles["list-style-type"]=e.attributes.type}},splitMarginShorthand:function(e){function t(t){e.styles["margin-top"]=n[t[0]],e.styles["margin-right"]=n[t[1]],e.styles["margin-bottom"]=n[t[2]],e.styles["margin-left"]=n[t[3]]}if(e.styles.margin){var n=e.styles.margin.match(/(auto|0|(?:\-?[\.\d]+(?:\w+|%)))/g)||["0px"];switch(n.length){case 1:t([0,0,0,0]);break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}delete e.styles.margin}},matchesStyle:O,transform:function(e,t){if("string"==typeof t)e.name=t;else{var n,i,r,o,a=t.getDefinition(),s=a.styles,l=a.attributes;e.name=a.element;for(n in l)if("class"==n)for(a=e.classes.join("|"),r=l[n].split(/\s+/);o=r.pop();)-1==a.indexOf(o)&&e.classes.push(o);else e.attributes[n]=l[n];for(i in s)e.styles[i]=s[i]}}}}(),function(){CKEDITOR.focusManager=function(e){return e.focusManager?e.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:e},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(e){this._.timer&&clearTimeout(this._.timer),e&&(this.currentActive=e),this.hasFocus||this._.locked||((e=CKEDITOR.currentInstance)&&e.focusManager.blur(1),this.hasFocus=!0,(e=this._.editor.container)&&e.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(e){function t(){if(this.hasFocus){this.hasFocus=!1;var e=this._.editor.container;e&&e.removeClass("cke_focus"),this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;e||!n?t.call(this):this._.timer=CKEDITOR.tools.setTimeout(function(){delete this._.timer,t.call(this)},n,this)}},add:function(e,t){var n=e.getCustomData("focusmanager");if(!n||n!=this){n&&n.remove(e);var n="focus",i="blur";t&&(CKEDITOR.env.ie?(n="focusin",i="focusout"):CKEDITOR.event.useCapture=1);var r={blur:function(){e.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(e)}};e.on(n,r.focus,this),e.on(i,r.blur,this),t&&(CKEDITOR.event.useCapture=0),e.setCustomData("focusmanager",this),e.setCustomData("focusmanager_handlers",r)}},remove:function(e){e.removeCustomData("focusmanager");var t=e.removeCustomData("focusmanager_handlers");e.removeListener("blur",t.blur),e.removeListener("focus",t.focus)}}}(),CKEDITOR.keystrokeHandler=function(e){return e.keystrokeHandler?e.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:e},this)},function(){var e,t=function(t){t=t.data;var n=t.getKeystroke(),i=this.keystrokes[n],r=this._.editor;return e=!1===r.fire("key",{keyCode:n,domEvent:t}),e||(i&&(e=!1!==r.execCommand(i,{from:"keystrokeHandler"})),e||(e=!!this.blockedKeystrokes[n])),e&&t.preventDefault(!0),!e},n=function(t){e&&(e=!1,t.data.preventDefault(!0))};CKEDITOR.keystrokeHandler.prototype={attach:function(e){e.on("keydown",t,this),CKEDITOR.env.gecko&&CKEDITOR.env.mac&&e.on("keypress",n,this)}}}(),function(){CKEDITOR.lang={languages:{af:1,ar:1,az:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,"es-mx":1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,oc:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(e,t,n){e&&CKEDITOR.lang.languages[e]||(e=this.detect(t,e));var i=this;t=function(){i[e].dir=i.rtl[e]?"rtl":"ltr",n(e,i[e])},this[e]?t():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+e+".js"),t,this)},detect:function(e,t){var n=this.languages;t=t||navigator.userLanguage||navigator.language||e;var i=t.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),r=i[1],i=i[2];return n[r+"-"+i]?r=r+"-"+i:n[r]||(r=null),CKEDITOR.lang.detect=r?function(){return r}:function(e){return e},r||e}}}(),CKEDITOR.scriptLoader=function(){var e={},t={};return{load:function(n,i,r,o){var a="string"==typeof n;a&&(n=[n]),r||(r=CKEDITOR);var s=n.length,l=s,d=[],c=[],h=function(e){i&&(a?i.call(r,e):i.call(r,d,c))};if(0===l)h(!0);else{var u=function(e,t){(t?d:c).push(e),0>=--l&&(o&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),h(t))},f=function(n,i){e[n]=1;var r=t[n];delete t[n];for(var o=0;o<r.length;o++)r[o](n,i)};o&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var g=0;g<s;g++)!function(n){if(e[n])u(n,!0);else{var r=t[n]||(t[n]=[]);if(r.push(u),!(1<r.length)){var o=new CKEDITOR.dom.element("script");o.setAttributes({type:"text/javascript",src:n}),i&&(CKEDITOR.env.ie&&(8>=CKEDITOR.env.version||CKEDITOR.env.ie9Compat)?o.$.onreadystatechange=function(){"loaded"!=o.$.readyState&&"complete"!=o.$.readyState||(o.$.onreadystatechange=null,f(n,!0))}:(o.$.onload=function(){setTimeout(function(){o.$.onload=null,o.$.onerror=null,f(n,!0)},0)},o.$.onerror=function(){o.$.onload=null,o.$.onerror=null,f(n,!1)})),o.appendTo(CKEDITOR.document.getHead())}}}(n[g])}},queue:function(){function e(){var e;(e=t[0])&&this.load(e.scriptUrl,e.callback,CKEDITOR,0)}var t=[];return function(n,i){var r=this;t.push({scriptUrl:n,callback:function(){i&&i.apply(this,arguments),t.shift(),e.call(r)}}),1==t.length&&e.call(this)}}()}}(),CKEDITOR.resourceManager=function(e,t){this.basePath=e,this.fileName=t,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(e,t){if(this.registered[e])throw Error('[CKEDITOR.resourceManager.add] The resource name "'+e+'" is already registered.');var n=this.registered[e]=t||{};return n.name=e,n.path=this.getPath(e),CKEDITOR.fire(e+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(e)},get:function(e){return this.registered[e]||null},getPath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(t&&t.dir||this.basePath+e+"/")},getFilePath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(this.getPath(e)+(t?t.file:this.fileName+".js"))},addExternal:function(e,t,n){n||(t=t.replace(/[^\/]+$/,function(e){return n=e,""})),n=n||this.fileName+".js",e=e.split(",");for(var i=0;i<e.length;i++)this.externals[e[i]]={dir:t,file:n}},load:function(e,t,n){CKEDITOR.tools.isArray(e)||(e=e?[e]:[]);for(var i=this.loaded,r=this.registered,o=[],a={},s={},l=0;l<e.length;l++){var d=e[l];if(d)if(i[d]||r[d])s[d]=this.get(d);else{var c=this.getFilePath(d);o.push(c),c in a||(a[c]=[]),a[c].push(d)}}CKEDITOR.scriptLoader.load(o,function(e,r){if(r.length)throw Error('[CKEDITOR.resourceManager.load] Resource name "'+a[r[0]].join(",")+'" was not found at "'+r[0]+'".');for(var o=0;o<e.length;o++)for(var l=a[e[o]],d=0;d<l.length;d++){var c=l[d];s[c]=this.get(c),i[c]=1}t.call(n,s)},this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,function(e){var t={};return function(n,i,r){var o={},a=function(n){e.call(this,n,function(e){CKEDITOR.tools.extend(o,e);var n,s=[];for(n in e){var l=e[n],d=l&&l.requires;if(!t[n]){if(l.icons)for(var c=l.icons.split(","),h=c.length;h--;)CKEDITOR.skin.addIcon(c[h],l.path+"icons/"+(CKEDITOR.env.hidpi&&l.hidpi?"hidpi/":"")+c[h]+".png");l.isSupportedEnvironment=l.isSupportedEnvironment||function(){return!0},t[n]=1}if(d)for(d.split&&(d=d.split(",")),l=0;l<d.length;l++)o[d[l]]||s.push(d[l])}if(s.length)a.call(this,s);else{for(n in o)l=o[n],l.onLoad&&!l.onLoad._called&&(!1===l.onLoad()&&delete o[n],l.onLoad._called=1);i&&i.call(r||window,o)}},this)};a.call(this,n)}}),CKEDITOR.plugins.setLang=function(e,t,n){var i=this.get(e);e=i.langEntries||(i.langEntries={}),i=i.lang||(i.lang=[]),i.split&&(i=i.split(",")),-1==CKEDITOR.tools.indexOf(i,t)&&i.push(t),e[t]=n},CKEDITOR.ui=function(e){return e.ui?e.ui:(this.items={},this.instances={},this.editor=e,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(e,t,n){n.name=e.toLowerCase();var i=this.items[e]={type:t,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(i,n)},get:function(e){return this.instances[e]},create:function(e){var t=this.items[e],n=t&&this._.handlers[t.type],i=t&&t.command&&this.editor.getCommand(t.command),n=n&&n.create.apply(this,t.args);return this.instances[e]=n,i&&i.uiItems.push(n),n&&!n.type&&(n.type=t.type),n},addHandler:function(e,t){this._.handlers[e]=t},space:function(e){return CKEDITOR.document.getById(this.spaceId(e))},spaceId:function(e){return this.editor.id+"_"+e}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function e(e,r,a){if(CKEDITOR.event.call(this),e=e&&CKEDITOR.tools.clone(e),void 0!==r){if(!(r instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!a)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&a==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!n(r,a))throw Error('The specified element mode is not supported on element: "'+r.getName()+'".');this.element=r,this.elementMode=a,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(r.getId()||r.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||t(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",i),this.on("selectionChange",function(e){o(this,e.data.path)}),this.on("activeFilterChange",function(){o(this,this.elementPath(),!0)}),this.on("mode",i),CKEDITOR.dom.selection.setupEditorOptimization(this),this.on("instanceReady",function(){if(this.config.startupFocus){if("end"===this.config.startupFocus){var e=this.createRange();e.selectNodeContents(this.editable()),e.shrink(CKEDITOR.SHRINK_ELEMENT,!0),e.collapse(),this.getSelection().selectRanges([e])}this.focus()}}),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout(function(){this.isDestroyed()||this.isDetached()||s(this,e)},0,this)}function t(){do{var e="editor"+ ++g}while(CKEDITOR.instances[e]);return e}function n(e,t){return t==CKEDITOR.ELEMENT_MODE_INLINE?e.is(CKEDITOR.dtd.$editable)||e.is("textarea"):t==CKEDITOR.ELEMENT_MODE_REPLACE?!e.is(CKEDITOR.dtd.$nonBodyContent):1}function i(){var e,t=this.commands;for(e in t)r(this,t[e])}function r(e,t){t[t.startDisabled?"disable":e.readOnly&&!t.readOnly?"disable":t.modes[e.mode]?"enable":"disable"]()}function o(e,t,n){if(t){var i,r,o=e.commands;for(r in o)i=o[r],(n||i.contextSensitive)&&i.refresh(e,t)}}function a(e){var t=e.config.customConfig;if(!t)return!1;var t=CKEDITOR.getUrl(t),n=p[t]||(p[t]={});return n.fn?(n.fn.call(e,e.config),CKEDITOR.getUrl(e.config.customConfig)!=t&&a(e)||e.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(t,function(){n.fn=n.fn||CKEDITOR.editorConfig||function(){},a(e)}),!0}function s(e,t){e.on("customConfigLoaded",function(){if(t){if(t.on)for(var n in t.on)e.on(n,t.on[n]);CKEDITOR.tools.extend(e.config,t,!0),delete e.config.on}n=e.config,e.readOnly=!!n.readOnly||(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.is("textarea")?e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"):e.element.isReadOnly():e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"))),e.blockless=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!(e.element.is("textarea")||CKEDITOR.dtd[e.element.getName()].p),e.tabIndex=n.tabIndex||e.element&&e.element.getAttribute("tabindex")||0,e.activeEnterMode=e.enterMode=e.blockless?CKEDITOR.ENTER_BR:n.enterMode,e.activeShiftEnterMode=e.shiftEnterMode=e.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),e.fireOnce("configLoaded"),e.dataProcessor=new CKEDITOR.htmlDataProcessor(e),e.filter=e.activeFilter=new CKEDITOR.filter(e),l(e)}),t&&null!=t.customConfig&&(e.config.customConfig=t.customConfig),a(e)||e.fireOnce("customConfigLoaded")}function l(e){CKEDITOR.skin.loadPart("editor",function(){d(e)})}function d(e){CKEDITOR.lang.load(e.config.language,e.config.defaultLanguage,function(t,n){var i=e.config.title,r=e.config.applicationTitle;e.langCode=t,e.lang=CKEDITOR.tools.prototypedCopy(n),e.title="string"==typeof i||!1===i?i:[e.lang.editor,e.name].join(", "),e.applicationTitle="string"==typeof r||!1===r?r:[e.lang.application,e.name].join(", "),e.config.contentsLangDirection||(e.config.contentsLangDirection=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.getDirection(1):e.lang.dir),e.fire("langLoaded"),c(e)})}function c(e){e.getStylesSet(function(t){e.once("loaded",function(){e.fire("stylesSet",{styles:t})},null,null,1),h(e)})}function h(e){function t(e){return e?(CKEDITOR.tools.isArray(e)&&(e=e.join(",")),e.replace(/\s/g,"")):""}var n=e.config,i=t(n.plugins),r=t(n.extraPlugins),o=t(n.removePlugins);if(r)var a=new RegExp("(?:^|,)(?:"+r.replace(/,/g,"|")+")(?=,|$)","g"),i=i.replace(a,""),i=i+","+r;if(o)var s=new RegExp("(?:^|,)(?:"+o.replace(/,/g,"|")+")(?=,|$)","g"),i=i.replace(s,"");CKEDITOR.env.air&&(i+=",adobeair"),CKEDITOR.plugins.load(i.split(","),function(t){var i=[],r=[],o=[];e.plugins=CKEDITOR.tools.extend({},e.plugins,t);for(var a in t){var l,d=t[a],c=d.lang,h=null,u=d.requires;if(CKEDITOR.tools.isArray(u)&&(u=u.join(",")),u&&(l=u.match(s)))for(;u=l.pop();)CKEDITOR.error("editor-plugin-required",{plugin:u.replace(",",""),requiredBy:a});c&&!e.lang[a]&&(c.split&&(c=c.split(",")),0<=CKEDITOR.tools.indexOf(c,e.langCode)?h=e.langCode:(h=e.langCode.replace(/-.*/,""),h=h!=e.langCode&&0<=CKEDITOR.tools.indexOf(c,h)?h:0<=CKEDITOR.tools.indexOf(c,"en")?"en":c[0]),d.langEntries&&d.langEntries[h]?(e.lang[a]=d.langEntries[h],h=null):o.push(CKEDITOR.getUrl(d.path+"lang/"+h+".js"))),r.push(h),i.push(d)}CKEDITOR.scriptLoader.load(o,function(){if(!e.isDestroyed()&&!e.isDetached()){for(var t=["beforeInit","init","afterInit"],o=0;o<t.length;o++)for(var a=0;a<i.length;a++){var s=i[a];0===o&&r[a]&&s.lang&&s.langEntries&&(e.lang[s.name]=s.langEntries[r[a]]),s[t[o]]&&s[t[o]](e)}for(e.fireOnce("pluginsLoaded"),n.keystrokes&&e.setKeystroke(e.config.keystrokes),a=0;a<e.config.blockedKeystrokes.length;a++)e.keystrokeHandler.blockedKeystrokes[e.config.blockedKeystrokes[a]]=1;e.status="loaded",e.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,e)}})})}function u(){var e=this.element;if(e&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var t=this.getData();return this.config.htmlEncodeOutput&&(t=CKEDITOR.tools.htmlEncode(t)),e.is("textarea")?e.setValue(t):e.setHtml(t),!0}return!1}function f(e,t){for(var n,i,r,o=new CKEDITOR.dom.documentFragment,a=0;a<e.length;a++){var s=e[a],l=s.startContainer.getAscendant("tr",!0);!function(e){var t=e.startContainer,n=e.endContainer,i=t.is&&t.is("tr"),r=t.is&&t.is("td");return e=r&&t.equals(n)&&e.endOffset===t.getChildCount(),t=r&&1===t.getChildCount()&&"img"===t.getChildren().getItem(0).getName(),!!(i||e&&!t)}(s)?o.append(s.cloneContents()):(n||(n=l.getAscendant("table").clone(),n.append(l.getAscendant({thead:1,tbody:1,tfoot:1}).clone()),o.append(n),n=n.findOne("thead, tbody, tfoot")),i&&i.equals(l)||(i=l,r=l.clone(),n.append(r)),r.append(function(e){var t=e.startContainer;return t.is("tr")?e.cloneContents():t.clone(!0)}(s)))}return n?o:t.getHtmlFromRange(e[0])}e.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=e;var g=0,p={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{plugins:{detectConflict:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(this[i])return CKEDITOR.warn("editor-plugin-conflict",{plugin:e,replacedWith:i}),!0}return!1}},addCommand:function(e,t){t.name=e.toLowerCase();var n=t instanceof CKEDITOR.command?t:new CKEDITOR.command(this,t);return this.mode&&r(this,n),this.commands[e]=n},_attachToForm:function(){function e(e){t.updateElement(),t._.required&&!n.getValue()&&!1===t.fire("required")&&e.data.preventDefault()}var t=this,n=t.element,i=new CKEDITOR.dom.element(n.$.form);n.is("textarea")&&i&&(i.on("submit",e),function(e){return!!(e&&e.call&&e.apply)}(i.$.submit)&&(i.$.submit=CKEDITOR.tools.override(i.$.submit,function(t){return function(){e(),t.apply?t.apply(this):t()}})),t.on("destroy",function(){i.removeListener("submit",e)}))},destroy:function(e){var t=CKEDITOR.filter.instances,n=this;this.fire("beforeDestroy"),!e&&u.call(this),this.editable(null),this.filter&&delete this.filter,CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(t),function(e){e=t[e],n===e.editor&&e.destroy()}),delete this.activeFilter,this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(e){if(!e){if(!(e=this.getSelection()))return null;e=e.getStartElement()}return e?new CKEDITOR.dom.elementPath(e,this.editable()):null},createRange:function(){var e=this.editable();return e?new CKEDITOR.dom.range(e):null},execCommand:function(e,t){var n=this.getCommand(e),i={name:e,commandData:t||{},command:n};return!(!n||n.state==CKEDITOR.TRISTATE_DISABLED||!1===this.fire("beforeCommandExec",i)||(i.returnValue=n.exec(i.commandData),n.async||!1===this.fire("afterCommandExec",i)))&&i.returnValue},getCommand:function(e){return this.commands[e]},getData:function(e){!e&&this.fire("beforeGetData");var t=this._.data;return"string"!=typeof t&&(t=(t=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?t.is("textarea")?t.getValue():t.getHtml():""),t={dataValue:t},!e&&this.fire("getData",t),t.dataValue},getSnapshot:function(){var e=this.fire("getSnapshot");return"string"!=typeof e&&(e=(e=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?e.is("textarea")?e.getValue():e.getHtml():""),e},loadSnapshot:function(e){this.fire("loadSnapshot",e)},setData:function(e,t,n){var i=!0,r=t;t&&"object"==typeof t&&(n=t.internal,r=t.callback,i=!t.noSnapshot),!n&&i&&this.fire("saveSnapshot"),!r&&n||this.once("dataReady",function(e){!n&&i&&this.fire("saveSnapshot"),r&&r.call(e.editor)}),e={dataValue:e},!n&&this.fire("setData",e),this._.data=e.dataValue,!n&&this.fire("afterSetData",e)},setReadOnly:function(e){e=null==e||e,this.readOnly!=e&&(this.readOnly=e,this.keystrokeHandler.blockedKeystrokes[8]=+e,this.editable().setReadOnly(e),this.fire("readOnly"))},insertHtml:function(e,t,n){this.fire("insertHtml",{dataValue:e,mode:t,range:n})},insertText:function(e){this.fire("insertText",e)},insertElement:function(e){this.fire("insertElement",e)},getSelectedHtml:function(e){var t=this.editable(),n=this.getSelection(),n=n&&n.getRanges();return t&&n&&0!==n.length?(t=f(n,t),e?t.getHtml():t):null},extractSelectedHtml:function(e,t){var n,i=this.editable(),r=this.getSelection().getRanges(),o=new CKEDITOR.dom.documentFragment;if(!i||0===r.length)return null;for(n=0;n<r.length;n++)o.append(i.extractHtmlFromRange(r[n],t));return t||this.getSelection().selectRanges([r[0]]),e?o.getHtml():o},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return"ready"==this.status&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return u.call(this)},setKeystroke:function(){for(var e,t,n=this.keystrokeHandler.keystrokes,i=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],r=i.length;r--;)e=i[r],t=0,CKEDITOR.tools.isArray(e)&&(t=e[1],e=e[0]),t?n[e]=t:delete n[e]},getCommandKeystroke:function(e,t){var n="string"==typeof e?this.getCommand(e):e,i=[];if(n){var r=CKEDITOR.tools.object.findKey(this.commands,n),o=this.keystrokeHandler.keystrokes;if(n.fakeKeystroke)i.push(n.fakeKeystroke);else for(var a in o)o[a]===r&&i.push(a)}return t?i:i[0]||null},addFeature:function(e){return this.filter.addFeature(e)},setActiveFilter:function(e){e||(e=this.filter),this.activeFilter!==e&&(this.activeFilter=e,this.fire("activeFilterChange"),e===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(e.getAllowedEnterMode(this.enterMode),e.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(e,t){e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.enterMode,t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.shiftEnterMode,this.activeEnterMode==e&&this.activeShiftEnterMode==t||(this.activeEnterMode=e,this.activeShiftEnterMode=t,this.fire("activeEnterModeChange"))},showNotification:function(e){alert(e)},isDetached:function(){return!!this.container&&this.container.isDetached()},isDestroyed:function(){return"destroyed"===this.status}}),CKEDITOR.editor._getEditorElement=function(e){if(!CKEDITOR.env.isCompatible)return null;var t=CKEDITOR.dom.element.get(e);return t?t.getEditor()?(CKEDITOR.error("editor-element-conflict",{editorName:t.getEditor().name}),null):t:(CKEDITOR.error("editor-incorrect-element",{element:e}),null)},CKEDITOR.editor.initializeDelayedEditorCreation=function(e,t,n){if(t.delayIfDetached_callback)return CKEDITOR.warn("editor-delayed-creation",{method:"callback"}),t.delayIfDetached_callback(function(){CKEDITOR[n](e,t),CKEDITOR.warn("editor-delayed-creation-success",{method:"callback"})}),null;var i=void 0===t.delayIfDetached_interval?CKEDITOR.config.delayIfDetached_interval:t.delayIfDetached_interval;CKEDITOR.warn("editor-delayed-creation",{method:"interval - "+i+" ms"});var r=setInterval(function(){e.isDetached()||(clearInterval(r),CKEDITOR[n](e,t),CKEDITOR.warn("editor-delayed-creation-success",{method:"interval - "+i+" ms"}))},i);return function(){clearInterval(r)}},CKEDITOR.editor.shouldDelayEditorCreation=function(e,t){return CKEDITOR.editor.mergeDelayedCreationConfigs(t),t&&t.delayIfDetached&&e.isDetached()},CKEDITOR.editor.mergeDelayedCreationConfigs=function(e){e&&(e.delayIfDetached="boolean"==typeof e.delayIfDetached?e.delayIfDetached:CKEDITOR.config.delayIfDetached,
e.delayIfDetached_interval=isNaN(e.delayIfDetached_interval)?CKEDITOR.config.delayIfDetached_interval:e.delayIfDetached_interval,e.delayIfDetached_callback=e.delayIfDetached_callback||CKEDITOR.config.delayIfDetached_callback)}}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.config.delayIfDetached=!1,CKEDITOR.config.delayIfDetached_callback=void 0,CKEDITOR.config.delayIfDetached_interval=50,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--!?>)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}},function(){var e=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,t={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var i,r,o,a=0;i=this._.htmlPartsRegex.exec(n);)if(r=i.index,r>a&&(a=n.substring(a,r),o?o.push(a):this.onText(a)),a=this._.htmlPartsRegex.lastIndex,!(r=i[1])||(r=r.toLowerCase(),o&&CKEDITOR.dtd.$cdata[r]&&(this.onCDATA(o.join("")),o=null),o))if(o)o.push(i[0]);else if(r=i[3]){if(r=r.toLowerCase(),!/="/.test(r)){var s,l={},d=i[4];if(i=!!i[5],d)for(;s=e.exec(d);){var c=s[1].toLowerCase();s=s[2]||s[3]||s[4]||"",l[c]=!s&&t[c]?c:CKEDITOR.tools.htmlDecodeAttr(s)}this.onTagOpen(r,l,i),!o&&CKEDITOR.dtd.$cdata[r]&&(o=[])}}else(r=i[2])&&this.onComment(r);else this.onTagClose(r);n.length>a&&this.onText(n.substring(a,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(e){this._.output.push("<",e)},openTagClose:function(e,t){t?this._.output.push(" />"):this._.output.push(">")},attribute:function(e,t){"string"==typeof t&&(t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){this._.output.push("</",e,">")},text:function(e){this._.output.push(e)},comment:function(e){this._.output.push("\x3c!--",e,"--\x3e")},write:function(e){this._.output.push(e)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(e){var t=this._.output.join("");return e&&this.reset(),t}}}),function(){CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var e=this.parent.children,t=CKEDITOR.tools.indexOf(e,this),n=this.previous,i=this.next;n&&(n.next=i),i&&(i.previous=n),e.splice(t,1),this.parent=null},replaceWith:function(e){var t=this.parent.children,n=CKEDITOR.tools.indexOf(t,this),i=e.previous=this.previous,r=e.next=this.next;i&&(i.next=e),r&&(r.previous=e),t[n]=e,e.parent=this.parent,this.parent=null},insertAfter:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e),i=e.next;t.splice(n+1,0,this),this.next=e.next,this.previous=e,e.next=this,i&&(i.previous=this),this.parent=e.parent},insertBefore:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e);t.splice(n,0,this),this.next=e,(this.previous=e.previous)&&(e.previous.next=this),e.previous=this,this.parent=e.parent},getAscendant:function(e){for(var t=("function"==typeof e?e:"string"==typeof e?function(t){return t.name==e}:function(t){return t.name in e}),n=this.parent;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(t(n))return n;n=n.parent}return null},wrapWith:function(e){return this.replaceWith(e),e.add(this),e},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(e){return e||{}}}}(),CKEDITOR.htmlParser.comment=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(e,t){var n=this.value;return(n=e.onComment(t,n,this))?"string"!=typeof n?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(e,t){t&&this.filter(t),e.comment(this.value)}}),function(){CKEDITOR.htmlParser.text=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(e,t){if(!(this.value=e.onText(t,this.value,this)))return this.remove(),!1},writeHtml:function(e,t){t&&this.filter(t),e.text(this.value)}})}(),function(){CKEDITOR.htmlParser.cdata=function(e){this.value=e},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(e){var t=this.getAscendant("style");if(t&&t.getAscendant({math:1,svg:1})){var t=CKEDITOR.htmlParser.fragment.fromHtml(this.value),n=new CKEDITOR.htmlParser.basicWriter;e.applyTo(t),t.writeHtml(n),this.value=n.getHtml()}},writeHtml:function(e){e.write(this.value)}})}(),CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function e(e){return!e.attributes["data-cke-survive"]&&("a"==e.name&&e.attributes.href||CKEDITOR.dtd.$removeEmpty[e.name])}var t=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},i=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),r={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(o,a,s){function l(e){var t;if(0<m.length)for(var n=0;n<m.length;n++){var i=m[n],r=i.name,o=CKEDITOR.dtd[r],a=_.name&&CKEDITOR.dtd[_.name];a&&!a[r]||e&&o&&!o[e]&&CKEDITOR.dtd[e]?r==_.name&&(h(_,_.parent,1),n--):(t||(d(),t=1),i=i.clone(),i.parent=_,_=i,m.splice(n,1),n--)}}function d(){for(;E.length;)h(E.shift(),_)}function c(e){if(e._.isBlockLike&&"pre"!=e.name&&"textarea"!=e.name){var t,n=e.children.length,i=e.children[n-1];i&&i.type==CKEDITOR.NODE_TEXT&&((t=CKEDITOR.tools.rtrim(i.value))?i.value=t:e.children.length=n-1)}}function h(t,n,i){n=n||_||p;var r=_;void 0===t.previous&&(u(n,t)&&(_=n,g.onTagOpen(s,{}),t.returnPoint=n=_),c(t),e(t)&&!t.children.length||n.add(t),"pre"==t.name&&(C=!1),"textarea"==t.name&&(T=!1)),t.returnPoint?(_=t.returnPoint,delete t.returnPoint):_=i?n:r}function u(e,t){if((e==p||"body"==e.name)&&s&&(!e.name||CKEDITOR.dtd[e.name][s])){var n,i;return(n=t.attributes&&(i=t.attributes["data-cke-real-element-type"])?i:t.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!t.isOrphan||t.type==CKEDITOR.NODE_TEXT}}function f(e,t){return(e in CKEDITOR.dtd.$listItem||e in CKEDITOR.dtd.$tableContent)&&(e==t||"dt"==e&&"dd"==t||"dd"==e&&"dt"==t)}var g=new CKEDITOR.htmlParser,p=a instanceof CKEDITOR.htmlParser.element?a:"string"==typeof a?new CKEDITOR.htmlParser.element(a):new CKEDITOR.htmlParser.fragment,m=[],E=[],_=p,T="textarea"==p.name,C="pre"==p.name;g.onTagOpen=function(r,o,a,s){if(o=new CKEDITOR.htmlParser.element(r,o),o.isUnknown&&a&&(o.isEmpty=!0),o.isOptionalClose=s,e(o))m.push(o);else{if("pre"==r)C=!0;else{if("br"==r&&C)return void _.add(new CKEDITOR.htmlParser.text("\n"));"textarea"==r&&(T=!0)}if("br"==r)E.push(o);else{for(;s=(a=_.name)?CKEDITOR.dtd[a]||(_._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i,!(o.isUnknown||_.isUnknown||s[r]);)if(_.isOptionalClose)g.onTagClose(a);else if(r in n&&a in n)a=_.children,(a=a[a.length-1])&&"li"==a.name||h(a=new CKEDITOR.htmlParser.element("li"),_),!o.returnPoint&&(o.returnPoint=_),_=a;else if(r in CKEDITOR.dtd.$listItem&&!f(r,a))g.onTagOpen("li"==r?"ul":"dl",{},0,1);else if(a in t&&!f(r,a))!o.returnPoint&&(o.returnPoint=_),_=_.parent;else{if(a in CKEDITOR.dtd.$inline&&m.unshift(_),!_.parent){o.isOrphan=1;break}h(_,_.parent,1)}l(r),d(),o.parent=_,o.isEmpty?h(o):_=o}}},g.onTagClose=function(e){for(var t=m.length-1;0<=t;t--)if(e==m[t].name)return void m.splice(t,1);for(var n=[],i=[],r=_;r!=p&&r.name!=e;)r._.isBlockLike||i.unshift(r),n.push(r),r=r.returnPoint||r.parent;if(r!=p){for(t=0;t<n.length;t++){var o=n[t];h(o,o.parent)}_=r,r._.isBlockLike?d():!0!==(t=CKEDITOR.config.shiftLineBreaks)&&E.length&&("function"!=typeof t?d():!0!==(t=t(E[E.length-1]))&&(d(),t instanceof CKEDITOR.htmlParser.text&&_.add(t),t instanceof CKEDITOR.htmlParser.element&&h(t,_))),h(r,r.parent),r==_&&(_=_.parent),m=m.concat(i)}"body"==e&&(s=!1)},g.onText=function(e){if(_._.hasInlineStarted&&!E.length||C||T||(e=CKEDITOR.tools.ltrim(e),0!==e.length)){var n=_.name,o=n?CKEDITOR.dtd[n]||(_._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):i;!T&&!o["#"]&&n in t?(g.onTagOpen(r[n]||""),g.onText(e)):(d(),l(),C||T||(e=e.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),e=new CKEDITOR.htmlParser.text(e),u(_,e)&&this.onTagOpen(s,{},0,1),_.add(e))}},g.onCDATA=function(e){_.add(new CKEDITOR.htmlParser.cdata(e))},g.onComment=function(e){d(),l(),_.add(new CKEDITOR.htmlParser.comment(e))},g.parse(o);for(d();_!=p;)h(_,_.parent,1);return c(p),p},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(e,t){isNaN(t)&&(t=this.children.length);var n=0<t?this.children[t-1]:null;if(n){if(e._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT&&(n.value=CKEDITOR.tools.rtrim(n.value),0===n.value.length))return this.children.pop(),void this.add(e);n.next=e}e.previous=n,e.parent=this,this.children.splice(t,0,e),this._.hasInlineStarted||(this._.hasInlineStarted=e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&!e._.isBlockLike)},filter:function(e,t){t=this.getFilterContext(t),e.onRoot(t,this),this.filterChildren(e,!1,t)},filterChildren:function(e,t,n){if(this.childrenFilteredBy!=e.id)for(n=this.getFilterContext(n),t&&!this.parent&&e.onRoot(n,this),this.childrenFilteredBy=e.id,t=0;t<this.children.length;t++)!1===this.children[t].filter(e,n)&&t--},writeHtml:function(e,t){t&&this.filter(t),this.writeChildrenHtml(e)},writeChildrenHtml:function(e,t,n){var i=this.getFilterContext();for(n&&!this.parent&&t&&t.onRoot(i,this),t&&this.filterChildren(t,!1,i),t=0,n=this.children,i=n.length;t<i;t++)n[t].writeHtml(e)},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var i=e(this);if(!1!==i){n=this.children;for(var r=0;r<n.length;r++)i=n[r],i.type==CKEDITOR.NODE_ELEMENT?i.forEach(e,t):t&&i.type!=t||e(i)}},getFilterContext:function(e){return e||{}}},CKEDITOR.config.shiftLineBreaks=!0}(),function(){function e(){this.rules=[]}function t(t,n,i,r){var o,a;for(o in n)(a=t[o])||(a=t[o]=new e),a.add(n[o],i,r)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(t){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new e,this.attributeNameRules=new e,this.elementsRules={},this.attributesRules={},this.textRules=new e,this.commentRules=new e,this.rootRules=new e,t&&this.addRules(t,10)},proto:{addRules:function(e,n){var i;"number"==typeof n?i=n:n&&"priority"in n&&(i=n.priority),"number"!=typeof i&&(i=10),"object"!=typeof n&&(n={}),e.elementNames&&this.elementNameRules.addMany(e.elementNames,i,n),e.attributeNames&&this.attributeNameRules.addMany(e.attributeNames,i,n),e.elements&&t(this.elementsRules,e.elements,i,n),e.attributes&&t(this.attributesRules,e.attributes,i,n),e.text&&this.textRules.add(e.text,i,n),e.comment&&this.commentRules.add(e.comment,i,n),e.root&&this.rootRules.add(e.root,i,n)},applyTo:function(e){e.filter(this)},onElementName:function(e,t){return this.elementNameRules.execOnName(e,t)},onAttributeName:function(e,t){return this.attributeNameRules.execOnName(e,t)},onText:function(e,t,n){return this.textRules.exec(e,t,n)},onComment:function(e,t,n){return this.commentRules.exec(e,t,n)},onRoot:function(e,t){return this.rootRules.exec(e,t)},onElement:function(e,t){for(var n,i=[this.elementsRules["^"],this.elementsRules[t.name],this.elementsRules.$],r=0;3>r;r++)if(n=i[r]){if(!1===(n=n.exec(e,t,this)))return null;if(n&&n!=t)return this.onNode(e,n);if(t.parent&&!t.name)break}return t},onNode:function(e,t){var n=t.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(e,t):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(e,t.value,t)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(e,t.value,t)):null},onAttribute:function(e,t,n,i){return(n=this.attributesRules[n])?n.exec(e,i,t,this):i}}}),CKEDITOR.htmlParser.filterRulesGroup=e,e.prototype={add:function(e,t,n){this.rules.splice(this.findIndex(t),0,{value:e,priority:t,options:n})},addMany:function(e,t,n){for(var i=[this.findIndex(t),0],r=0,o=e.length;r<o;r++)i.push({value:e[r],priority:t,options:n});this.rules.splice.apply(this.rules,i)},findIndex:function(e){for(var t=this.rules,n=t.length-1;0<=n&&e<t[n].priority;)n--;return n+1},exec:function(e,t){var n,i,r,o,a=t instanceof CKEDITOR.htmlParser.node||t instanceof CKEDITOR.htmlParser.fragment,s=Array.prototype.slice.call(arguments,1),l=this.rules,d=l.length;for(o=0;o<d;o++)if(a&&(n=t.type,i=t.name),r=l[o],!(e.nonEditable&&!r.options.applyToAll||e.nestedEditable&&r.options.excludeNestedEditable)){if(!1===(r=r.value.apply(null,s))||a&&r&&(r.name!=i||r.type!=n))return r;null!=r&&(s[0]=t=r)}return t},execOnName:function(e,t){for(var n,i=0,r=this.rules,o=r.length;t&&i<o;i++)n=r[i],e.nonEditable&&!n.options.applyToAll||e.nestedEditable&&n.options.excludeNestedEditable||(t=t.replace(n.value[0],n.value[1]));return t}}}(),function(){function e(e,t){function s(e){return e||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text("\xa0"):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function l(e,t){return function(r){if(r.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var a,l,c=[],h=n(r);if(h)for(d(h,1)&&c.push(h);h;)o(h)&&(a=i(h))&&d(a)&&((l=i(a))&&!o(l)?c.push(a):(s(u).insertAfter(a),a.remove())),h=h.previous;for(h=0;h<c.length;h++)c[h].remove();(c=!e||!1!==("function"==typeof t?t(r):t))&&((u||CKEDITOR.env.needsBrFiller||r.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(u||CKEDITOR.env.needsBrFiller||!(7<document.documentMode||r.name in CKEDITOR.dtd.tr||r.name in CKEDITOR.dtd.$listItem))?(c=n(r),c=!c||"form"==r.name&&"input"==c.name):c=!1),c&&r.add(s(e))}}}function d(e,t){if((!u||CKEDITOR.env.needsBrFiller)&&e.type==CKEDITOR.NODE_ELEMENT&&"br"==e.name&&!e.attributes["data-cke-eol"])return!0;var n;return!!(e.type==CKEDITOR.NODE_TEXT&&(n=e.value.match(E))&&(n.index&&(new CKEDITOR.htmlParser.text(e.value.substring(0,n.index)).insertBefore(e),e.value=n[0]),!CKEDITOR.env.needsBrFiller&&u&&(!t||e.parent.name in f)||!u&&((n=e.previous)&&"br"==n.name||!n||o(n))))}var c,h={elements:{}},u="html"==t,f=CKEDITOR.tools.extend({},v);for(c in f)"#"in T[c]||delete f[c];for(c in f)h.elements[c]=l(u,e.config.fillEmptyBlocks);return h.root=l(u,!1),h.elements.br=function(e){return function(t){if(t.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=t.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=t.next;n&&r(n);)n=n.next;var l=i(t);!n&&o(t.parent)?a(t.parent,s(e)):o(n)&&l&&!o(l)&&s(e).insertBefore(n)}}}}(u),h}function t(e,t){return e!=CKEDITOR.ENTER_BR&&!1!==t&&(e==CKEDITOR.ENTER_DIV?"div":"p")}function n(e){for(e=e.children[e.children.length-1];e&&r(e);)e=e.previous;return e}function i(e){for(e=e.previous;e&&r(e);)e=e.previous;return e}function r(e){return e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(e.value)||e.type==CKEDITOR.NODE_ELEMENT&&e.attributes["data-cke-bookmark"]}function o(e){return e&&(e.type==CKEDITOR.NODE_ELEMENT&&e.name in v||e.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function a(e,t){var n=e.children[e.children.length-1];e.children.push(t),t.parent=e,n&&(n.next=t,t.previous=n)}function s(e){e=e.attributes,"false"!=e.contenteditable&&(e["data-cke-editable"]=e.contenteditable?"true":1),e.contenteditable="false"}function l(e){switch(e=e.attributes,e["data-cke-editable"]){case"true":e.contenteditable="true";break;case"1":delete e.contenteditable}}function d(e,t){return e.replace(b,function(e,n,i){return"<"+n+i.replace(y,function(e,n){return K.test(n)&&-1==i.indexOf("data-cke-saved-"+n)?" data-cke-saved-"+e+" data-cke-"+t+"-"+e:e})+">"})}function c(e,t){return e.replace(t,function(e,t,n){return 0===e.indexOf("<textarea")&&(e=t+f(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(e)+"</cke:encoded>"})}function h(e){return e.replace(N,function(e,t){return decodeURIComponent(t)})}function u(e){return e.replace(/\x3c!--(?!{cke_protected})[\s\S]+?--\x3e/g,function(e){return"\x3c!--"+_+"{C}"+encodeURIComponent(e).replace(/--/g,"%2D%2D")+"--\x3e"})}function f(e){return e.replace(/\x3c!--\{cke_protected\}\{C\}([\s\S]+?)--\x3e/g,function(e,t){return decodeURIComponent(t)})}function g(e,t){var n=t._.dataStore;return e.replace(/\x3c!--\{cke_protected\}([\s\S]+?)--\x3e/g,function(e,t){return decodeURIComponent(t)}).replace(/\{cke_protected_(\d+)\}/g,function(e,t){return n&&n[t]||""})}function p(e,t,n){var i=[],r=t.config.protectedSource,o=t._.dataStore||(t._.dataStore={id:1}),a=new RegExp("<\\!--\\{cke_temp_"+n+"(comment)?\\}(\\d*?)--\x3e","g"),r=[/<script[\s\S]*?(<\/script>|$)/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(r);e=e.replace(/\x3c!--[\s\S]*?--\x3e/g,function(e){return"\x3c!--{cke_temp_"+n+"comment}"+(i.push(e)-1)+"--\x3e"});for(var s=0;s<r.length;s++)e=e.replace(r[s],function(e){return e=e.replace(a,function(e,t,n){return i[n]}),a.test(e)?e:"\x3c!--{cke_temp_"+n+"}"+(i.push(e)-1)+"--\x3e"});return e=e.replace(a,function(e,t,n){return"\x3c!--"+_+(t?"{C}":"")+encodeURIComponent(i[n]).replace(/--/g,"%2D%2D")+"--\x3e"}),e=e.replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=\/>]+))+\s*\/?>/g,function(e){return e.replace(/\x3c!--\{cke_protected\}([^>]*)--\x3e/g,function(e,t){return o[o.id]=decodeURIComponent(t),"{cke_protected_"+o.id+++"}"})}),e=e.replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,function(e,n,i,r){return"<"+n+i+">"+g(f(r),t)+"</"+n+">"})}var m;CKEDITOR.htmlDataProcessor=function(n){var i,r,o=this;this.editor=n,this.dataFilter=i=new CKEDITOR.htmlParser.filter,this.htmlFilter=r=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,i.addRules(O),i.addRules(I,{applyToAll:!0}),i.addRules(e(n,"data"),{applyToAll:!0}),r.addRules(D),r.addRules(R,{applyToAll:!0}),r.addRules(e(n,"html"),{applyToAll:!0}),n.on("toHtml",function(e){var i,r=window.crypto||window.msCrypto;i=r?r.getRandomValues(new Uint32Array(1))[0]:Math.floor(9e9*Math.random()+1e9),e=e.data;var o,r=e.dataValue,r=m(r),r=p(r,n,i),r=c(r,w),r=d(r,i),r=c(r,k),r=r.replace(x,"$1cke:$2"),r=r.replace(A,"<cke:$1$2></cke:$1>"),r=r.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2"),r=r.replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+i+"-$2"),a=e.context||n.editable().getName();CKEDITOR.env.ie&&9>CKEDITOR.env.version&&"pre"==a&&(a="div",r="<pre>"+r+"</pre>",o=1),a=n.document.createElement(a),a.setHtml("a"+r),r=a.getHtml().substr(1),r=r.replace(new RegExp("data-cke-"+i+"-","ig"),""),o&&(r=r.replace(/^<pre>|<\/pre>$/gi,"")),r=r.replace(S,"$1$2"),r=h(r),r=f(r),i=!1!==e.fixForBody&&t(e.enterMode,n.config.autoParagraph),r=CKEDITOR.htmlParser.fragment.fromHtml(r,e.context,i),i&&(o=r,!o.children.length&&CKEDITOR.dtd[o.name][i]&&(i=new CKEDITOR.htmlParser.element(i),o.add(i))),e.dataValue=r},null,null,5),n.on("toHtml",function(e){e.data.filter.applyTo(e.data.dataValue,!0,e.data.dontFilter,e.data.enterMode)&&n.fire("dataFiltered")},null,null,6),n.on("toHtml",function(e){e.data.dataValue.filterChildren(o.dataFilter,!0)},null,null,10),n.on("toHtml",function(e){e=e.data;var t=e.dataValue,n=new CKEDITOR.htmlParser.basicWriter;t.writeChildrenHtml(n),t=n.getHtml(!0),e.dataValue=u(t)},null,null,15),n.on("toDataFormat",function(e){var i=e.data.dataValue;e.data.enterMode!=CKEDITOR.ENTER_BR&&(i=i.replace(/^<br *\/?>/i,"")),e.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(i,e.data.context,t(e.data.enterMode,n.config.autoParagraph))},null,null,5),n.on("toDataFormat",function(e){e.data.dataValue.filterChildren(o.htmlFilter,!0)},null,null,10),n.on("toDataFormat",function(e){e.data.filter.applyTo(e.data.dataValue,!1,!0)},null,null,11),n.on("toDataFormat",function(e){var t=e.data.dataValue,i=o.writer;i.reset(),t.writeChildrenHtml(i),t=i.getHtml(!0),t=f(t),t=g(t,n),e.data.dataValue=t},null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(e,t,n,i){var r,o,a,s,l=this.editor;return t&&"object"==typeof t?(r=t.context,n=t.fixForBody,i=t.dontFilter,o=t.filter,a=t.enterMode,s=t.protectedWhitespaces):r=t,r||null===r||(r=l.editable().getName()),l.fire("toHtml",{dataValue:e,context:r,fixForBody:n,dontFilter:i,filter:o||l.filter,enterMode:a||l.enterMode,protectedWhitespaces:s}).dataValue},toDataFormat:function(e,t){var n,i,r;return t&&(n=t.context,i=t.filter,r=t.enterMode),n||null===n||(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:e,filter:i||this.editor.filter,context:n,enterMode:r||this.editor.enterMode}).dataValue},protectSource:function(e){return p(e,this.editor)},unprotectSource:function(e){return g(e,this.editor)},unprotectRealComments:function(e){return f(e)}};var E=/(?:&nbsp;|\xa0)$/,_="{cke_protected}",T=CKEDITOR.dtd,C="caption colgroup col thead tfoot tbody".split(" "),v=CKEDITOR.tools.extend({},T.$blockLimit,T.$block),O={elements:{input:s,textarea:s}},I={attributeNames:[[/^on/,"data-cke-pa-on"],[/^srcdoc/,"data-cke-pa-srcdoc"],[/^data-cke-expando$/,""]],elements:{iframe:function(e){if(e.attributes&&e.attributes.src){var t=e.attributes.src.toLowerCase().replace(/[^a-z]/gi,"");0!==t.indexOf("javascript")&&0!==t.indexOf("data")||(e.attributes["data-cke-pa-src"]=e.attributes.src,delete e.attributes.src)}}}},D={elements:{embed:function(e){var t=e.parent;if(t&&"object"==t.name){var n=t.attributes.width,t=t.attributes.height;n&&(e.attributes.width=n),t&&(e.attributes.height=t)}},a:function(e){var t=e.attributes;if(!(e.children.length||t.name||t.id||e.attributes["data-cke-saved-name"]))return!1}}},R={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(e){var t=e.attributes;if(t){if(t["data-cke-temp"])return!1;for(var n=["name","href","src"],i=0;i<n.length;i++)"data-cke-saved-"+n[i]in t&&delete t[n[i]]}return e},table:function(e){e.children.slice(0).sort(function(e,t){var n,i;return e.type==CKEDITOR.NODE_ELEMENT&&t.type==e.type&&(n=CKEDITOR.tools.indexOf(C,e.name),i=CKEDITOR.tools.indexOf(C,t.name)),-1<n&&-1<i&&n!=i||(n=e.parent?e.getIndex():-1,i=t.parent?t.getIndex():-1),n>i?1:-1})},param:function(e){return e.children=[],e.isEmpty=!0,e},span:function(e){"Apple-style-span"==e.attributes.class&&delete e.name},html:function(e){delete e.attributes.contenteditable,delete e.attributes.class},body:function(e){delete e.attributes.spellcheck,delete e.attributes.contenteditable},style:function(e){var t=e.children[0];t&&t.value&&(t.value=CKEDITOR.tools.trim(t.value)),e.attributes.type||(e.attributes.type="text/css")},title:function(e){var t=e.children[0];!t&&a(e,t=new CKEDITOR.htmlParser.text),t.value=e.attributes["data-cke-title"]||""},input:l,textarea:l},attributes:{class:function(e){return CKEDITOR.tools.ltrim(e.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(R.attributes.style=function(e){return e.replace(/(^|;)([^\:]+)/g,function(e){return e.toLowerCase()})});var b=/<(a|area|img|input|source)\b([^>]*)>/gi,y=/([\w-:]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,K=/^(href|src|name)$/i,k=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,w=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,N=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,x=/(<\/?)((?:object|embed|param|html|body|head|title)([\s][^>]*)?>)/gi,S=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,A=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi;m=function(){function e(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(i.lastIndex=0,i.test(t))return!0}return!1}function t(e){return CKEDITOR.tools.array.reduce(e.split(""),function(e,t){var i=t.toLowerCase(),r=t.toUpperCase(),o=n(i);return i!==r&&(o+="|"+n(r)),e+"("+o+")"},"")}function n(e){var t;t=e.charCodeAt(0),t={htmlCode:"&#"+t+";?",hex:"&#x0*"+t.toString(16)+";?",entity:{"<":"&lt;",">":"&gt;",":":"&colon;"}[e]};for(var n in t)t[n]&&(e+="|"+t[n]);return e}var i=[new RegExp("("+t("<cke:encoded>")+"(.*?)"+t("</cke:encoded>")+")|("+t("<")+t("/")+"?"+t("cke:encoded>")+")","gi"),new RegExp("(("+t("{cke_protected")+")(_[0-9]*)?"+t("}")+")","gi"),/<!(?:\s*-\s*){2,3}!?\s*>/g];return function(t){for(;e(i,t);)for(var n=i,r=0;r<n.length;r++)t=t.replace(n[r],"");return t}}()}(),CKEDITOR.htmlParser.element=function(e,t){this.name=e,this.attributes=t||{},this.children=[];var n=e||"",i=n.match(/^cke:(.*)/);i&&(n=i[1]),n=!!(CKEDITOR.dtd.$nonBodyContent[n]||CKEDITOR.dtd.$block[n]||CKEDITOR.dtd.$listItem[n]||CKEDITOR.dtd.$tableContent[n]||CKEDITOR.dtd.$nonEditable[n]||"br"==n),this.isEmpty=!!CKEDITOR.dtd.$empty[e],this.isUnknown=!CKEDITOR.dtd[e],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(e){var t={};return((e instanceof CKEDITOR.htmlParser.element?e.attributes.style:e)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,n,i){"font-family"==n&&(i=i.replace(/["']/g,"")),t[n.toLowerCase()]=i}),{rules:t,populate:function(e){var t=this.toString();t&&(e instanceof CKEDITOR.dom.element?e.setAttribute("style",t):e instanceof CKEDITOR.htmlParser.element?e.attributes.style=t:e.style=t)},toString:function(){var e,n=[];for(e in t)t[e]&&n.push(e,":",t[e],";");return n.join("")}}},function(){function e(e){return function(t){return t.type==CKEDITOR.NODE_ELEMENT&&("string"==typeof e?t.name==e:t.name in e)}}var t=function(e,t){return e=e[0],t=t[0],e<t?-1:e>t?1:0},n=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:n.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(e,t){var n,i,r=this;for(t=r.getFilterContext(t),r.parent||e.onRoot(t,r);;){if(n=r.name,!(i=e.onElementName(t,n)))return this.remove(),!1;if(r.name=i,!(r=e.onElement(t,r)))return this.remove(),!1;if(r!==this)return this.replaceWith(r),!1;if(r.name==n)break;if(r.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(r),!1;if(!r.name)return this.replaceWithChildren(),!1}n=r.attributes;var o,a;for(o in n){for(i=n[o];;){if(!(a=e.onAttributeName(t,o))){delete n[o];break}if(a==o)break;delete n[o],o=a}a&&(!1===(i=e.onAttribute(t,r,a,i))?delete n[a]:n[a]=i)}return r.isEmpty||this.filterChildren(e,!1,t),!0},filterChildren:n.filterChildren,writeHtml:function(e,n){n&&this.filter(n);var i,r,o=this.name,a=[],s=this.attributes;e.openTag(o,s);for(i in s)a.push([i,s[i]]);for(e.sortAttributes&&a.sort(t),i=0,r=a.length;i<r;i++)s=a[i],e.attribute(s[0],s[1]);e.openTagClose(o,this.isEmpty),this.writeChildrenHtml(e),this.isEmpty||e.closeTag(o)},writeChildrenHtml:n.writeChildrenHtml,replaceWithChildren:function(){for(var e=this.children,t=e.length;t;)e[--t].insertAfter(this);this.remove()},forEach:n.forEach,getFirst:function(t){if(!t)return this.children.length?this.children[0]:null;"function"!=typeof t&&(t=e(t));for(var n=0,i=this.children.length;n<i;++n)if(t(this.children[n]))return this.children[n];return null},getHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(e),e.getHtml()},setHtml:function(e){e=this.children=CKEDITOR.htmlParser.fragment.fromHtml(e).children;for(var t=0,n=e.length;t<n;++t)e[t].parent=this},getOuterHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(e),e.getHtml()},split:function(e){for(var t=this.children.splice(e,this.children.length-e),n=this.clone(),i=0;i<t.length;++i)t[i].parent=n;return n.children=t,t[0]&&(t[0].previous=null),0<e&&(this.children[e-1].next=null),this.parent.add(n,this.getIndex()+1),n},find:function(e,t){void 0===t&&(t=!1);var n,i=[];for(n=0;n<this.children.length;n++){var r=this.children[n];"function"==typeof e&&e(r)?i.push(r):"string"==typeof e&&r.name===e&&i.push(r),t&&r.find&&(i=i.concat(r.find(e,t)))}return i},findOne:function(e,t){var n=null,i=CKEDITOR.tools.array.find(this.children,function(i){var r="function"==typeof e?e(i):i.name===e;return r||!t?r:(i.children&&i.findOne&&(n=i.findOne(e,!0)),!!n)});return n||i||null},addClass:function(e){if(!this.hasClass(e)){var t=this.attributes.class||"";this.attributes.class=t+(t?" ":"")+e}},removeClass:function(e){var t=this.attributes.class;t&&((t=CKEDITOR.tools.trim(t.replace(new RegExp("(?:\\s+|^)"+e+"(?:\\s+|$)")," ")))?this.attributes.class=t:delete this.attributes.class)},hasClass:function(e){var t=this.attributes.class;return!!t&&new RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t)},getFilterContext:function(e){var t=[];if(e||(e={nonEditable:!1,nestedEditable:!1}),e.nonEditable||"false"!=this.attributes.contenteditable?e.nonEditable&&!e.nestedEditable&&"true"==this.attributes.contenteditable&&t.push("nestedEditable",!0):t.push("nonEditable",!0),t.length){e=CKEDITOR.tools.copy(e);for(var n=0;n<t.length;n+=2)e[t[n]]=t[n+1]}return e}},!0)}(),function(){var e=/{([^}]+)}/g;CKEDITOR.template=function(e){this.source="function"==typeof e?e:String(e)},CKEDITOR.template.prototype.output=function(t,n){var i=("function"==typeof this.source?this.source(t):this.source).replace(e,function(e,n){return void 0!==t[n]?t[n]:e});return n?n.push(i):i}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(e){function t(){CKEDITOR.currentInstance==e&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))}CKEDITOR.instances[e.name]=e,e.on("focus",function(){CKEDITOR.currentInstance!=e&&(CKEDITOR.currentInstance=e,CKEDITOR.fire("currentInstance"))}),e.on("blur",t),e.on("destroy",t),CKEDITOR.fire("instance",null,e)},CKEDITOR.remove=function(e){delete CKEDITOR.instances[e.name]},function(){var e={};CKEDITOR.addTemplate=function(t,n){var i=e[t];return i||(i={name:t,source:n},CKEDITOR.fire("template",i),e[t]=new CKEDITOR.template(i.source))},CKEDITOR.getTemplate=function(t){return e[t]}}(),function(){var e=[];CKEDITOR.addCss=function(t){e.push(t)},CKEDITOR.getCss=function(){return e.join("\n")}}(),CKEDITOR.on("instanceDestroyed",function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")}),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,function(){CKEDITOR.inline=function(e,t){if(!(e=CKEDITOR.editor._getEditorElement(e)))return null;if(CKEDITOR.editor.shouldDelayEditorCreation(e,t))return CKEDITOR.editor.initializeDelayedEditorCreation(e,t,"inline");var n=e.is("textarea")?e:null,i=n?n.getValue():e.getHtml(),r=new CKEDITOR.editor(t,e,CKEDITOR.ELEMENT_MODE_INLINE);return n?(r.setData(i,null,!0),e=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!r.readOnly+'" class="cke_textarea_inline">'+n.getValue()+"</div>",CKEDITOR.document),e.insertAfter(n),n.hide(),n.$.form&&r._attachToForm()):(t&&void 0!==t.readOnly&&!t.readOnly&&e.setAttribute("contenteditable","true"),r.setData(i,null,!0)),r.on("loaded",function(){r.fire("uiReady"),r.editable(e),r.container=e,r.ui.contentsElement=e,r.setData(r.getData(1)),r.resetDirty(),r.fire("contentDom"),r.mode="wysiwyg",r.fire("mode"),r.status="ready",r.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,r)},null,null,1e4),r.on("destroy",function(){var e=r.container;n&&e&&(e.clearCustomData(),e.remove()),n&&n.show(),r.element.clearCustomData(),delete r.element}),r},CKEDITOR.inlineAll=function(){var e,t,n;for(n in CKEDITOR.dtd.$editable)for(var i=CKEDITOR.document.getElementsByTag(n),r=0,o=i.count();r<o;r++)e=i.getItem(r),"true"!=e.getAttribute("contenteditable")||e.getEditor()||(t={element:e,config:{}},!1!==CKEDITOR.fire("inline",t)&&CKEDITOR.inline(e,t.config))},CKEDITOR.domReady(function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()})}(),CKEDITOR.replaceClass="ckeditor",function(){function e(e,i,r,o){if(!(e=CKEDITOR.editor._getEditorElement(e)))return null
;if(CKEDITOR.editor.shouldDelayEditorCreation(e,i))return CKEDITOR.editor.initializeDelayedEditorCreation(e,i,"replace");var a=new CKEDITOR.editor(i,e,o);return o==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.setStyle("visibility","hidden"),a._.required=e.hasAttribute("required"),e.removeAttribute("required")),r&&a.setData(r,null,!0),a.on("loaded",function(){a.isDestroyed()||a.isDetached()||(n(a),o==CKEDITOR.ELEMENT_MODE_REPLACE&&a.config.autoUpdateElement&&e.$.form&&a._attachToForm(),a.setMode(a.config.startupMode,function(){a.resetDirty(),a.status="ready",a.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,a)}))}),a.on("destroy",t),a}function t(){var e=this.container,t=this.element;e&&(e.clearCustomData(),e.remove()),t&&(t.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.show(),this._.required&&t.setAttribute("required","required")),delete this.element)}function n(e){var t=e.name,n=e.element,i=e.elementMode,r=e.fire("uiSpace",{space:"top",html:""}).html,o=e.fire("uiSpace",{space:"bottom",html:""}).html,a=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(e.applicationTitle?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(e.applicationTitle?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>'),t=CKEDITOR.dom.element.createFromHtml(a.output({id:e.id,name:t,langDir:e.lang.dir,langCode:e.langCode,voiceLabel:e.applicationTitle,topHtml:r?'<span id="'+e.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+r+"</span>":"",contentId:e.ui.spaceId("contents"),bottomHtml:o?'<span id="'+e.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+o+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"}));i==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),t.insertAfter(n)):n.append(t),e.container=t,e.ui.contentsElement=e.ui.space("contents"),r&&e.ui.space("top").unselectable(),o&&e.ui.space("bottom").unselectable(),n=e.config.width,i=e.config.height,n&&t.setStyle("width",CKEDITOR.tools.cssLength(n)),i&&e.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(i)),t.disableContextMenu(),CKEDITOR.env.webkit&&t.on("focus",function(){e.focus()}),e.fireOnce("uiReady")}CKEDITOR.replace=function(t,n){return e(t,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(t,n,i){return e(t,n,i,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var e=document.getElementsByTagName("textarea"),t=0;t<e.length;t++){var n=null,i=e[t];if(i.name||i.id){if("string"==typeof arguments[0]){if(!new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(i.className))continue}else if("function"==typeof arguments[0]&&(n={},!1===arguments[0](i,n)))continue;this.replace(i,n)}}},CKEDITOR.editor.prototype.addMode=function(e,t){(this._.modes||(this._.modes={}))[e]=t},CKEDITOR.editor.prototype.setMode=function(e,t){var n=this,i=this._.modes;if(e!=n.mode&&i&&i[e]){if(n.fire("beforeSetMode",e),n.mode){var r,o=n.checkDirty(),i=n._.previousModeData,a=0;n.fire("beforeModeUnload"),n.editable(0),n._.previousMode=n.mode,n._.previousModeData=r=n.getData(1),"source"==n.mode&&i==r&&(n.fire("lockSnapshot",{forceUpdate:!0}),a=1),n.ui.space("contents").setHtml(""),n.mode=""}else n._.previousModeData=n.getData(1);this._.modes[e](function(){n.mode=e,void 0!==o&&!o&&n.resetDirty(),a?n.fire("unlockSnapshot"):"wysiwyg"==e&&n.fire("saveSnapshot"),setTimeout(function(){n.isDestroyed()||n.isDetached()||(n.fire("mode"),t&&t.call(n))},0)})}},CKEDITOR.editor.prototype.resize=function(e,t,n,i){var r=this.container,o=this.ui.space("contents"),a=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement;i=i?this.container.getFirst(function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_inner")}):r,(e||0===e)&&(e=CKEDITOR.tools.convertToPx(CKEDITOR.tools.cssLength(e))),i.setSize("width",e,!0),a&&(a.style.width="1%"),t=CKEDITOR.tools.convertToPx(CKEDITOR.tools.cssLength(t));var s=(i.$.offsetHeight||0)-(o.$.clientHeight||0),r=Math.max(t-(n?0:s),0);t=n?t+s:t,o.setStyle("height",CKEDITOR.tools.cssLength(r)),a&&(a.style.width="100%"),this.fire("resize",{outerHeight:t,contentsHeight:r,outerWidth:e||i.getSize("width")})},CKEDITOR.editor.prototype.getResizable=function(e){return e?this.ui.space("contents"):this.container},CKEDITOR.domReady(function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)})}(),CKEDITOR.config.startupMode="wysiwyg",function(){function e(e){var n,r=e.editor,o=e.data.path,a=o.blockLimit,s=e.data.selection,d=s.getRanges()[0];(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&(s=t(s,o))&&(s.appendBogus(),n=CKEDITOR.env.ie&&!CKEDITOR.env.edge||CKEDITOR.env.edge&&r._.previousActive),l(r,o.block,a)&&d.collapsed&&!d.getCommonAncestor().isReadOnly()&&(o=d.clone(),o.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),a=new CKEDITOR.dom.walker(o),a.guard=function(e){return!i(e)||e.type==CKEDITOR.NODE_COMMENT||e.isReadOnly()},!a.checkForward()||o.checkStartOfBlock()&&o.checkEndOfBlock())&&(r=d.fixBlock(!0,r.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(r=r.getFirst(i))&&r.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(r.getText()).match(/^(?:&nbsp;|\xa0)$/)&&r.remove(),n=1,e.cancel()),n&&d.select()}function t(e,t){if(e.isFake)return 0;var n=t.block||t.blockLimit,r=n&&n.getLast(i);return!n||!n.isBlockBoundary()||r&&r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()||n.is("pre")||n.getBogus()?void 0:n}function n(e){var t=e.data.getTarget();t.is("input")&&("submit"!=(t=t.getAttribute("type"))&&"reset"!=t||e.data.preventDefault())}function i(e){return f(e)&&g(e)}function r(e,t){return function(n){var i=n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget;(i=i&&i.nodeType==CKEDITOR.NODE_ELEMENT?new CKEDITOR.dom.element(i):null)&&(t.equals(i)||t.contains(i))||e.call(this,n)}}function o(e){return!!e.getRanges()[0].startPath().contains({table:1,ul:1,ol:1,dl:1})}function a(e){function t(e){var t={table:1,ul:1,ol:1,dl:1};return function(r,o){if(o&&r.type==CKEDITOR.NODE_ELEMENT&&r.is(t)&&(n=r),!(o||!i(r)||e&&m(r)))return!1}}var n,r=e.getRanges()[0],a=e.root;return o(e)&&(e=r.clone(),e.collapse(1),e.setStartAt(a,CKEDITOR.POSITION_AFTER_START),a=new CKEDITOR.dom.walker(e),a.guard=t(),a.checkBackward(),n)?(e=r.clone(),e.collapse(),e.setEndAt(n,CKEDITOR.POSITION_AFTER_END),a=new CKEDITOR.dom.walker(e),a.guard=t(!0),n=!1,a.checkForward(),n):null}function s(e){return e.block.getParent().getChildCount()}function l(e,t,n){return!1!==e.config.autoParagraph&&e.activeEnterMode!=CKEDITOR.ENTER_BR&&(e.editable().equals(n)&&!t||t&&"true"==t.getAttribute("contenteditable"))}function d(e){return e.activeEnterMode!=CKEDITOR.ENTER_BR&&!1!==e.config.autoParagraph&&(e.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p")}function c(e){e&&e.isEmptyInlineRemoveable()&&e.remove()}function h(e){var t=e.editor;t.getSelection().scrollIntoView(),setTimeout(function(){t.fire("saveSnapshot")},0)}function u(e,t,n){var i=e.getCommonAncestor(t);for(t=e=n?t:e;(e=e.getParent())&&!i.equals(e)&&1==e.getChildCount();)t=e;t.remove()}var f,g,p,m,E,_,T,C,v,O,I={ul:1,ol:1,dl:1};CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(e,t){this.base(t.$||t),this.editor=e,this.status="unloaded",this.hasFocus=!1,this.setup()},proto:{focus:function(){var e;if(CKEDITOR.env.webkit&&!this.hasFocus&&(e=this.editor._.previousActive||this.getDocument().getActive(),this.contains(e)))return void e.focus();CKEDITOR.env.edge&&14<CKEDITOR.env.version&&!this.hasFocus&&this.getDocument().equals(CKEDITOR.document)&&(this.editor._.previousScrollTop=this.$.scrollTop);try{if(!CKEDITOR.env.ie||CKEDITOR.env.edge&&14<CKEDITOR.env.version||!this.getDocument().equals(CKEDITOR.document))if(CKEDITOR.env.chrome){var t=this.$.scrollTop;this.$.focus(),this.$.scrollTop=t}else this.$.focus();else this.$.setActive()}catch(e){if(!CKEDITOR.env.ie)throw e}CKEDITOR.env.safari&&!this.isInline()&&(e=CKEDITOR.document.getActive(),e.equals(this.getWindow().getFrame())||this.getWindow().focus())},on:function(e,t){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(e)&&(e="focus"==e?"focusin":"focusout",t=r(t,this),n[0]=e,n[1]=t),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(e){!this._.listeners&&(this._.listeners=[]);var t=Array.prototype.slice.call(arguments,1),t=e.on.apply(e,t);return this._.listeners.push(t),t},clearListeners:function(){var e=this._.listeners;try{for(;e.length;)e.pop().removeListener()}catch(e){}},restoreAttrs:function(){var e,t,n=this._.attrChanges;for(t in n)n.hasOwnProperty(t)&&(e=n[t],null!==e?this.setAttribute(t,e):this.removeAttribute(t))},attachClass:function(e){var t=this.getCustomData("classes");this.hasClass(e)||(!t&&(t=[]),t.push(e),this.setCustomData("classes",t),this.addClass(e))},changeAttr:function(e,t){var n=this.getAttribute(e);t!==n&&(!this._.attrChanges&&(this._.attrChanges={}),e in this._.attrChanges||(this._.attrChanges[e]=n),this.setAttribute(e,t))},insertText:function(e){this.editor.focus(),this.insertHtml(this.transformPlainTextToHtml(e),"text")},transformPlainTextToHtml:function(e){var t=this.editor.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:this.editor.activeEnterMode;return CKEDITOR.tools.transformPlainTextToHtml(e,t)},insertHtml:function(e,t,n){var i=this.editor;i.focus(),i.fire("saveSnapshot"),n||(n=i.getSelection().getRanges()[0]),_(this,t||"html",e,n),n.select(),h(this),this.editor.fire("afterInsertHtml",{})},insertHtmlIntoRange:function(e,t,n){_(this,n||"html",e,t),this.editor.fire("afterInsertHtml",{intoRange:t})},insertElement:function(e,t){var n=this.editor;n.focus(),n.fire("saveSnapshot");var r=n.activeEnterMode,n=n.getSelection(),o=e.getName(),o=CKEDITOR.dtd.$block[o];t||(t=n.getRanges()[0]),this.insertElementIntoRange(e,t)&&(t.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),o&&((o=e.getNext(function(e){return i(e)&&!m(e)}))&&o.type==CKEDITOR.NODE_ELEMENT&&o.is(CKEDITOR.dtd.$block)?o.getDtd()["#"]?t.moveToElementEditStart(o):t.moveToElementEditEnd(e):o||r==CKEDITOR.ENTER_BR||(o=t.fixBlock(!0,r==CKEDITOR.ENTER_DIV?"div":"p"),t.moveToElementEditStart(o)))),n.selectRanges([t]),h(this)},insertElementIntoSelection:function(e){this.insertElement(e)},insertElementIntoRange:function(e,t){var n=this.editor,i=n.config.enterMode,r=e.getName(),o=CKEDITOR.dtd.$block[r];if(t.checkReadOnly())return!1;t.deleteContents(1),t.startContainer.type==CKEDITOR.NODE_ELEMENT&&(t.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})?T(t):t.startContainer.is(CKEDITOR.dtd.$list)&&C(t));var a,s;if(o)for(;(a=t.getCommonAncestor(0,1))&&(s=CKEDITOR.dtd[a.getName()])&&(!s||!s[r]);)if(a.getName()in CKEDITOR.dtd.span){var o=t.splitElement(a),l=t.createBookmark();c(a),c(o),t.moveToBookmark(l)}else t.checkStartOfBlock()&&t.checkEndOfBlock()?(t.setStartBefore(a),t.collapse(!0),a.remove()):t.splitBlock(i==CKEDITOR.ENTER_DIV?"div":"p",n.editable());return t.insertNode(e),!0},setData:function(e,t){t||(e=this.editor.dataProcessor.toHtml(e)),this.setHtml(e),this.fixInitialSelection(),"unloaded"==this.status&&(this.status="ready"),this.editor.fire("dataReady")},getData:function(e){var t=this.getHtml();return e||(t=this.editor.dataProcessor.toDataFormat(t)),t},setReadOnly:function(e){this.setAttribute("contenteditable",String(!e)),this.setAttribute("aria-readonly",String(e))},detach:function(){this.status="detached",this.editor.setData(this.editor.getData(),{internal:!0}),this.clearListeners();try{this._.cleanCustomData()}catch(e){if(!CKEDITOR.env.ie||-2146828218!==e.number)throw e}this.editor.fire("contentDomUnload"),delete this.editor.document,delete this.editor.window,delete this.editor},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},fixInitialSelection:function(){function e(){var e,n=t.getDocument().$,i=n.getSelection();e:if(i.anchorNode&&i.anchorNode==t.$)e=!0;else{if(CKEDITOR.env.webkit&&(e=t.getDocument().getActive())&&e.equals(t)&&!i.anchorNode){e=!0;break e}e=void 0}e&&(e=new CKEDITOR.dom.range(t),e.moveToElementEditStart(t),n=n.createRange(),n.setStart(e.startContainer.$,e.startOffset),n.collapse(!0),i.removeAllRanges(),i.addRange(n))}var t=this;CKEDITOR.env.ie&&(9>CKEDITOR.env.version||CKEDITOR.env.quirks)?this.hasFocus&&(this.focus(),function(){var e=t.getDocument().$,n=e.selection,i=t.getDocument().getActive();"None"==n.type&&i.equals(t)&&(n=new CKEDITOR.dom.range(t),e=e.body.createTextRange(),n.moveToElementEditStart(t),n=n.startContainer,n.type!=CKEDITOR.NODE_ELEMENT&&(n=n.getParent()),e.moveToElementText(n.$),e.collapse(!0),e.select())}()):this.hasFocus?(this.focus(),e()):this.once("focus",function(){e()},null,null,-999)},getHtmlFromRange:function(e){return e.collapsed?new CKEDITOR.dom.documentFragment(e.document):(e={doc:this.getDocument(),range:e.clone()},v.eol.detect(e,this),v.bogus.exclude(e),v.cell.shrink(e),e.fragment=e.range.cloneContents(),v.tree.rebuild(e,this),v.eol.fix(e,this),new CKEDITOR.dom.documentFragment(e.fragment.$))},extractHtmlFromRange:function(e,t){var n=O,i={range:e,doc:e.document},r=this.getHtmlFromRange(e);if(e.collapsed)return e.optimize(),r;e.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.table.detectPurge(i),i.bookmark=e.createBookmark(),delete i.range;var o=this.editor.createRange();if(o.moveToPosition(i.bookmark.startNode,CKEDITOR.POSITION_BEFORE_START),i.targetBookmark=o.createBookmark(),n.list.detectMerge(i,this),n.table.detectRanges(i,this),n.block.detectMerge(i,this),i.tableContentsRanges?(n.table.deleteRanges(i),e.moveToBookmark(i.bookmark),i.range=e):(e.moveToBookmark(i.bookmark),i.range=e,e.extractContents(n.detectExtractMerge(i))),e.moveToBookmark(i.targetBookmark),e.optimize(),n.fixUneditableRangePosition(e),n.list.merge(i,this),n.table.purge(i,this),n.block.merge(i,this),t){if(n=e.startPath(),i=e.checkStartOfBlock()&&e.checkEndOfBlock()&&n.block&&!e.root.equals(n.block)){e:{var a,i=n.block.getElementsByTag("span"),o=0;if(i)for(;a=i.getItem(o++);)if(!g(a)){i=!0;break e}i=!1}i=!i}i&&(e.moveToPosition(n.block,CKEDITOR.POSITION_BEFORE_START),n.block.remove())}else n.autoParagraph(this.editor,e),p(e.startContainer)&&e.startContainer.appendBogus();return e.startContainer.mergeSiblings(),r},setup:function(){var e=this.editor;if(this.attachListener(e,"beforeGetData",function(){var t=this.getData();this.is("textarea")||!1!==e.config.ignoreEmptyParagraph&&(t=t.replace(E,function(e,t){return t})),e.setData(t,null,1)},this),this.attachListener(e,"getSnapshot",function(e){e.data=this.getData(1)},this),this.attachListener(e,"afterSetData",function(){this.setData(e.getData(1))},this),this.attachListener(e,"loadSnapshot",function(e){this.setData(e.data,1)},this),this.attachListener(e,"beforeFocus",function(){var t=e.getSelection();(t=t&&t.getNative())&&"Control"==t.type||this.focus()},this),this.attachListener(e,"insertHtml",function(e){this.insertHtml(e.data.dataValue,e.data.mode,e.data.range)},this),this.attachListener(e,"insertElement",function(e){this.insertElement(e.data)},this),this.attachListener(e,"insertText",function(e){this.insertText(e.data)},this),this.setReadOnly(e.readOnly),this.attachClass("cke_editable"),e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?this.attachClass("cke_editable_inline"):e.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE&&e.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||this.attachClass("cke_editable_themed"),this.attachClass("cke_contents_"+e.config.contentsLangDirection),e.keystrokeHandler.blockedKeystrokes[8]=+e.readOnly,e.keystrokeHandler.attach(this),this.on("blur",function(){this.hasFocus=!1},null,null,-1),this.on("focus",function(){this.hasFocus=!0},null,null,-1),CKEDITOR.env.webkit&&this.on("scroll",function(){e._.previousScrollTop=e.editable().$.scrollTop},null,null,-1),CKEDITOR.env.edge&&14<CKEDITOR.env.version){var t=function(){var n=e.editable();null!=e._.previousScrollTop&&n.getDocument().equals(CKEDITOR.document)&&(n.$.scrollTop=e._.previousScrollTop,e._.previousScrollTop=null,this.removeListener("scroll",t))};this.on("scroll",t)}if(e.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,e.once("contentDom",function(){e.focusManager.focus(this)},this)),this.isInline()&&this.changeAttr("tabindex",e.tabIndex),!this.is("textarea")){e.document=this.getDocument(),e.window=this.getWindow();var r=e.document;this.changeAttr("spellcheck",!e.config.disableNativeSpellChecker);var l=e.config.contentsLangDirection;this.getDirection(1)!=l&&this.changeAttr("dir",l);var d=CKEDITOR.getCss();if(d){var l=r.getHead(),c=l.getCustomData("stylesheet");c?d!=c.getText()&&(CKEDITOR.env.ie&&9>CKEDITOR.env.version?c.$.styleSheet.cssText=d:c.setText(d)):(d=r.appendStyleText(d),d=new CKEDITOR.dom.element(d.ownerNode||d.owningElement),l.setCustomData("stylesheet",d),d.data("cke-temp",1))}l=r.getCustomData("stylesheet_ref")||0,r.setCustomData("stylesheet_ref",l+1),this.setCustomData("cke_includeReadonly",!e.config.disableReadonlyStyling),this.attachListener(this,"click",function(e){e=e.data;var t=new CKEDITOR.dom.elementPath(e.getTarget(),this).contains("a");t&&2!=e.$.button&&t.isReadOnly()&&e.preventDefault()});var h={8:1,46:1};this.attachListener(e,"key",function(t){if(e.readOnly)return!0;var n,i=t.data.domEvent.getKey(),r=e.getSelection();if(0!==r.getRanges().length){if(i in h){var l;t=r.getRanges()[0];var d,c,u,g=t.startPath(),i=8==i,p=!1;if(CKEDITOR.env.ie&&11>CKEDITOR.env.version&&r.getSelectedElement())l=r.getSelectedElement();else if(o(r)){var m,E=new CKEDITOR.dom.walker(t),_=t.collapsed?t.startContainer:E.next(),p=!1;if(t.checkStartOfBlock()){m=t.startPath().block||t.startPath().blockLimit;var T=m.getName();m=-1!==CKEDITOR.tools.array.indexOf(["dd","dt","li"],T)&&null===m.getPrevious()}else m=!1;if(m){for(;_&&!p;)p=_.$.nodeName.toLowerCase(),p=!!I[p],_=E.next();E=s(t.startPath()),_=s(t.endPath()),p=p||E!==_}else p=void 0;p||(l=a(r))}l||p?(e.fire("saveSnapshot"),p?((n=t.startContainer.getAscendant(I,!0))?(t.setStart(n,0),t.enlarge(CKEDITOR.ENLARGE_ELEMENT),l=t):l=null,l.deleteContents()):(t.moveToPosition(l,CKEDITOR.POSITION_BEFORE_START),l.remove()),t.select(),e.fire("saveSnapshot"),n=1):t.collapsed&&((d=g.block)&&(u=d[i?"getPrevious":"getNext"](f))&&u.type==CKEDITOR.NODE_ELEMENT&&u.is("table")&&t[i?"checkStartOfBlock":"checkEndOfBlock"]()?(e.fire("saveSnapshot"),t[i?"checkEndOfBlock":"checkStartOfBlock"]()&&d.remove(),t["moveToElementEdit"+(i?"End":"Start")](u),t.select(),e.fire("saveSnapshot"),n=1):g.blockLimit&&g.blockLimit.is("td")&&(c=g.blockLimit.getAscendant("table"))&&t.checkBoundaryOfElement(c,i?CKEDITOR.START:CKEDITOR.END)&&(u=c[i?"getPrevious":"getNext"](f))?(e.fire("saveSnapshot"),t["moveToElementEdit"+(i?"End":"Start")](u),t.checkStartOfBlock()&&t.checkEndOfBlock()?u.remove():t.select(),e.fire("saveSnapshot"),n=1):(c=g.contains(["td","th","caption"]))&&t.checkBoundaryOfElement(c,i?CKEDITOR.START:CKEDITOR.END)&&(n=1))}return!n}}),e.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",function(t){t.data.getKeystroke()in h&&!this.getFirst(i)&&(this.appendBogus(),t=e.createRange(),t.moveToPosition(this,CKEDITOR.POSITION_AFTER_START),t.select())}),this.attachListener(this,"dblclick",function(t){if(e.readOnly)return!1;t={element:t.data.getTarget()},e.fire("doubleclick",t)}),CKEDITOR.env.ie&&this.attachListener(this,"click",n),CKEDITOR.env.ie&&!CKEDITOR.env.edge||this.attachListener(this,"mousedown",function(t){var n=t.data.getTarget();n.is("img","hr","input","textarea","select")&&!n.isReadOnly()&&(e.getSelection().selectElement(n),n.is("input","textarea","select")&&t.data.preventDefault())}),CKEDITOR.env.edge&&this.attachListener(this,"mouseup",function(t){(t=t.data.getTarget())&&t.is("img")&&!t.isReadOnly()&&e.getSelection().selectElement(t)}),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",function(t){if(2==t.data.$.button&&(t=t.data.getTarget(),!t.getAscendant("table")&&!t.getOuterHtml().replace(E,""))){var n=e.createRange();n.moveToElementEditStart(t),n.select(!0)}}),CKEDITOR.env.webkit&&(this.attachListener(this,"click",function(e){e.data.getTarget().is("input","select")&&e.data.preventDefault()}),this.attachListener(this,"mouseup",function(e){e.data.getTarget().is("input","textarea")&&e.data.preventDefault()})),CKEDITOR.env.webkit&&this.attachListener(e,"key",function(t){if(e.readOnly)return!0;var n=t.data.domEvent.getKey();if(n in h&&(t=e.getSelection(),0!==t.getRanges().length)){var n=8==n,i=t.getRanges()[0];if(t=i.startPath(),i.collapsed)e:{var r=t.block;if(r&&i[n?"checkStartOfBlock":"checkEndOfBlock"](!0)&&i.moveToClosestEditablePosition(r,!n)&&i.collapsed){if(i.startContainer.type==CKEDITOR.NODE_ELEMENT){var o=i.startContainer.getChild(i.startOffset-(n?1:0));if(o&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("hr")){e.fire("saveSnapshot"),o.remove(),t=!0;break e}}if(!(i=i.startPath().block)||i&&i.contains(r))t=void 0;else{e.fire("saveSnapshot");var a;(a=(n?i:r).getBogus())&&a.remove(),a=e.getSelection(),o=a.createBookmarks(),(n?r:i).moveChildren(n?i:r,!1),t.lastElement.mergeSiblings(),u(r,i,!n),a.selectBookmarks(o),t=!0}}else t=!1}else n=i,a=t.block,i=n.endPath().block,a&&i&&!a.equals(i)?(e.fire("saveSnapshot"),(r=a.getBogus())&&r.remove(),n.enlarge(CKEDITOR.ENLARGE_INLINE),n.deleteContents(),i.getParent()&&(i.moveChildren(a,!1),t.lastElement.mergeSiblings(),u(a,i,!0)),n=e.getSelection().getRanges()[0],n.collapse(1),n.optimize(),""===n.startContainer.getHtml()&&n.startContainer.appendBogus(),n.select(),t=!0):t=!1;if(!t)return;return e.getSelection().scrollIntoView(),e.fire("saveSnapshot"),!1}},this,null,100)}},getUniqueId:function(){var e;try{this._.expandoNumber=e=CKEDITOR.dom.domObject.prototype.getUniqueId.call(this)}catch(t){e=this._&&this._.expandoNumber}return e}},_:{cleanCustomData:function(){this.removeClass("cke_editable"),this.restoreAttrs();for(var e=this.removeCustomData("classes");e&&e.length;)this.removeClass(e.pop());if(!this.is("textarea")){var e=this.getDocument(),t=e.getHead();if(t.getCustomData("stylesheet")){var n=e.getCustomData("stylesheet_ref");--n?e.setCustomData("stylesheet_ref",n):(e.removeCustomData("stylesheet_ref"),t.removeCustomData("stylesheet").remove())}}}}}),CKEDITOR.editor.prototype.editable=function(e){var t=this._.editable;return t&&e?0:arguments.length?(e?t=e instanceof CKEDITOR.editable?e:new CKEDITOR.editable(this,e):(t&&t.detach(),t=null),this._.editable=t):t},CKEDITOR.on("instanceLoaded",function(t){var n=t.editor;n.on("insertElement",function(e){e=e.data,e.type==CKEDITOR.NODE_ELEMENT&&(e.is("input")||e.is("textarea"))&&("false"!=e.getAttribute("contentEditable")&&e.data("cke-editable",e.hasAttribute("contenteditable")?"true":"1"),e.setAttribute("contentEditable",!1))}),n.on("selectionChange",function(t){if(!n.readOnly){var i=n.getSelection();i&&!i.isLocked&&(i=n.checkDirty(),n.fire("lockSnapshot"),e(t),n.fire("unlockSnapshot"),!i&&n.resetDirty())}})}),CKEDITOR.on("instanceCreated",function(e){var t=e.editor;t.on("mode",function(){var e=t.editable();if(e&&e.isInline()){var n=t.title;e.changeAttr("role","textbox"),e.changeAttr("aria-multiline","true"),n&&e.changeAttr("aria-label",n),n&&e.changeAttr("title",n);var i=t.fire("ariaEditorHelpLabel",{}).label;if(i&&(n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents"))){var r=CKEDITOR.tools.getNextId(),i=CKEDITOR.dom.element.createFromHtml('<span id="'+r+'" class="cke_voice_label">'+i+"</span>");n.append(i),e.changeAttr("aria-describedby",r)}}})}),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}"),f=CKEDITOR.dom.walker.whitespaces(!0),g=CKEDITOR.dom.walker.bookmark(!1,!0),p=CKEDITOR.dom.walker.empty(),m=CKEDITOR.dom.walker.bogus(),E=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,_=function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT}function t(n,i){var r,o,a,s,l=[],d=i.range.startContainer;r=i.range.startPath();for(var d=h[d.getName()],c=0,u=n.getChildren(),f=u.count(),g=-1,p=-1,m=0,E=r.contains(h.$list);c<f;++c)r=u.getItem(c),e(r)?(a=r.getName(),E&&a in CKEDITOR.dtd.$list?l=l.concat(t(r,i)):(s=!!d[a],"br"!=a||!r.data("cke-eol")||c&&c!=f-1||(m=(o=c?l[c-1].node:u.getItem(c+1))&&(!e(o)||!o.is("br")),o=o&&e(o)&&h.$block[o.getName()]),-1!=g||s||(g=c),s||(p=c),l.push({isElement:1,isLineBreak:m,isBlock:r.isBlockBoundary(),hasBlockSibling:o,node:r,name:a,allowed:s}),o=m=0)):l.push({isElement:0,node:r,allowed:1});return-1<g&&(l[g].firstNotAllowed=1),-1<p&&(l[p].lastNotAllowed=1),l}function n(t,i){var r,o=[],a=t.getChildren(),s=a.count(),l=0,d=h[i],c=!t.is(h.$inline)||t.is("br");for(c&&o.push(" ");l<s;l++)r=a.getItem(l),e(r)&&!r.is(d)?o=o.concat(n(r,i)):o.push(r);return c&&o.push(" "),o}function r(t){return e(t.startContainer)&&t.startContainer.getChild(t.startOffset-1)}function o(t){return t&&e(t)&&(t.is(h.$removeEmpty)||t.is("a")&&!t.isBlockBoundary())}function a(t,n,i,r){var o,s,l=t.clone();l.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(o=new CKEDITOR.dom.walker(l).next())&&e(o)&&u[o.getName()]&&(s=o.getPrevious())&&e(s)&&!s.getParent().equals(t.startContainer)&&i.contains(s)&&r.contains(o)&&o.isIdentical(s)&&(o.moveChildren(s),o.remove(),a(t,n,i,r))}function s(t,n){function i(t,n){if(n.isBlock&&n.isElement&&!n.node.is("br")&&e(t)&&t.is("br"))return t.remove(),1}var r=n.endContainer.getChild(n.endOffset),o=n.endContainer.getChild(n.endOffset-1);r&&i(r,t[t.length-1]),o&&i(o,t[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}var h=CKEDITOR.dtd,u={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},f={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},g=CKEDITOR.tools.extend({},h.$inline);return delete g.br,function(u,p,m,_){var T,C=u.editor,v=!1;if("unfiltered_html"==p&&(p="html",v=!0),!_.checkReadOnly()){var O=new CKEDITOR.dom.elementPath(_.startContainer,_.root).blockLimit||_.root;p={type:p,dontFilter:v,editable:u,editor:C,range:_,blockLimit:O,mergeCandidates:[],zombies:[]};var I,D,R,b,y,v=p.range,O=p.mergeCandidates,K="html"===p.type;if("text"==p.type&&v.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(D=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",v.document),v.insertNode(D),v.setStartAfter(D)),R=new CKEDITOR.dom.elementPath(v.startContainer),p.endPath=b=new CKEDITOR.dom.elementPath(v.endContainer),!v.collapsed){I=b.block||b.blockLimit;var k=v.getCommonAncestor();I&&!I.equals(k)&&!I.contains(k)&&v.checkEndOfBlock()&&p.zombies.push(I),v.deleteContents()}for(;(y=r(v))&&e(y)&&y.isBlockBoundary()&&R.contains(y);)v.moveToPosition(y,CKEDITOR.POSITION_BEFORE_END);for(a(v,p.blockLimit,R,b),D&&(v.setEndBefore(D),v.collapse(),D.remove()),D=v.startPath(),(I=D.contains(o,!1,1))&&(T=v.splitElement(I),p.inlineStylesRoot=I,p.inlineStylesPeak=D.lastElement),D=v.createBookmark(),K&&(c(I),c(T)),(I=D.startNode.getPrevious(i))&&e(I)&&o(I)&&O.push(I),(I=D.startNode.getNext(i))&&e(I)&&o(I)&&O.push(I),I=D.startNode;(I=I.getParent())&&o(I);)O.push(I);if(v.moveToBookmark(D),T=u.getHtml(),T=""===T||T.match(E),C.enterMode===CKEDITOR.ENTER_DIV&&T&&((C=u.getFirst())&&C.remove(),_.setStartAt(u,CKEDITOR.POSITION_AFTER_START),_.collapse(!0)),u=m){if(u=p.range,"text"==p.type&&p.inlineStylesRoot){for(_=p.inlineStylesPeak,C=_.getDocument().createText("{cke-peak}"),T=p.inlineStylesRoot.getParent();!_.equals(T);)C=C.appendTo(_.clone()),_=_.getParent();m=C.getOuterHtml().split("{cke-peak}").join(m)}if(_=p.blockLimit.getName(),/^\s+|\s+$/.test(m)&&"span"in CKEDITOR.dtd[_]){var w='<span data-cke-marker="1">&nbsp;</span>';m=w+m+w}if(m=p.editor.dataProcessor.toHtml(m,{context:null,fixForBody:!1,protectedWhitespaces:!!w,dontFilter:p.dontFilter,filter:p.editor.activeFilter,enterMode:p.editor.activeEnterMode}),_=u.document.createElement("body"),_.setHtml(m),w&&(_.getFirst().remove(),_.getLast().remove()),(w=u.startPath().block)&&(1!=w.getChildCount()||!w.getBogus()))e:{var N;if(1==_.getChildCount()&&e(N=_.getFirst())&&N.is(f)&&!N.hasAttribute("contenteditable")){for(w=N.getElementsByTag("*"),u=0,T=w.count();u<T;u++)if(C=w.getItem(u),!C.is(g))break e;N.moveChildren(N.getParent(1)),N.remove()}}p.dataWrapper=_,u=m}if(u){N=p.range,u=N.document,_=p.blockLimit,T=0;var x,S,A,w=[];m=D=0;var L,C=N.startContainer;y=p.endPath.elements[0];var P,v=y.getPosition(C),O=!(!y.getCommonAncestor(C)||v==CKEDITOR.POSITION_IDENTICAL||v&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),C=t(p.dataWrapper,p);for(p.editor.enterMode!==CKEDITOR.ENTER_BR&&s(C,N);T<C.length;T++)if(v=C[T],(K=v.isLineBreak)&&(K=N,I=_,b=R=void 0,v.hasBlockSibling?K=1:(R=K.startContainer.getAscendant(h.$block,1))&&R.is({div:1,p:1})?(b=R.getPosition(I),b==CKEDITOR.POSITION_IDENTICAL||b==CKEDITOR.POSITION_CONTAINS?K=0:(I=K.splitElement(R),K.moveToPosition(I,CKEDITOR.POSITION_AFTER_START),K=1)):K=0),K)m=0<T;else{if(K=N.startPath(),!v.isBlock&&l(p.editor,K.block,K.blockLimit)&&(A=d(p.editor))&&(A=u.createElement(A),A.appendBogus(),N.insertNode(A),CKEDITOR.env.needsBrFiller&&(x=A.getBogus())&&x.remove(),N.moveToPosition(A,CKEDITOR.POSITION_BEFORE_END)),(K=N.startPath().block)&&!K.equals(S)&&((x=K.getBogus())&&(x.remove(),w.push(K)),S=K),v.firstNotAllowed&&(D=1),D&&v.isElement){for(K=N.startContainer,I=null;K&&!h[K.getName()][v.name];){if(K.equals(_)){K=null;break}I=K,K=K.getParent()}if(K)I&&(L=N.splitElement(I),p.zombies.push(L),p.zombies.push(I));else{I=_.getName(),P=!T,K=T==C.length-1,I=n(v.node,I),R=[],b=I.length;for(var k=0,F=void 0,j=0,B=-1;k<b;k++)F=I[k]," "==F?(j||P&&!k||(R.push(new CKEDITOR.dom.text(" ")),B=R.length),j=1):(R.push(F),j=0);K&&B==R.length&&R.pop(),P=R}}if(P){for(;K=P.pop();)N.insertNode(K);P=0}else N.insertNode(v.node);v.lastNotAllowed&&T<C.length-1&&((L=O?y:L)&&N.setEndAt(L,CKEDITOR.POSITION_AFTER_START),D=0),N.collapse()}1!=C.length?x=!1:(x=C[0],x=x.isElement&&"false"==x.node.getAttribute("contenteditable")),x&&(m=!0,K=C[0].node,N.setStartAt(K,CKEDITOR.POSITION_BEFORE_START),N.setEndAt(K,CKEDITOR.POSITION_AFTER_END)),p.dontMoveCaret=m,p.bogusNeededBlocks=w}x=p.range;var $;for(P=p.bogusNeededBlocks,S=x.createBookmark();A=p.zombies.pop();)A.getParent()&&(L=x.clone(),L.moveToElementEditStart(A),L.removeEmptyBlocksAtEnd());if(P)for(;A=P.pop();)CKEDITOR.env.needsBrFiller?A.appendBogus():A.append(x.document.createText("\xa0"));for(;A=p.mergeCandidates.pop();)A.mergeSiblings();if(CKEDITOR.env.webkit&&x.startPath()&&(A=x.startPath(),A.block?A.block.$.normalize():A.blockLimit&&A.blockLimit.$.normalize()),x.moveToBookmark(S),!p.dontMoveCaret){for(A=r(x);A&&e(A)&&!A.is(h.$empty);){if(A.isBlockBoundary())x.moveToPosition(A,CKEDITOR.POSITION_BEFORE_END);else{if(o(A)&&A.getHtml().match(/(\s|&nbsp;)$/g)){$=null;break}$=x.clone(),$.moveToPosition(A,CKEDITOR.POSITION_BEFORE_END)}A=A.getLast(i)}$&&x.moveToRange($)}}}}(),T=function(){function e(e){return e=new CKEDITOR.dom.walker(e),e.guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$tableContent):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT},e}function t(e,t,n){return t=e.getDocument().createElement(t),e.append(t,n),t}function n(e){var t,n=e.count();for(n;0<n--;)t=e.getItem(n),CKEDITOR.tools.trim(t.getHtml())||(t.appendBogus(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&t.getChildCount()&&t.getFirst().remove())}return function(i){var r=i.startContainer,o=r.getAscendant("table",1),a=!1;n(o.getElementsByTag("td")),n(o.getElementsByTag("th")),o=i.clone(),o.setStart(r,0),o=e(o).lastBackward(),o||(o=i.clone(),o.setEndAt(r,CKEDITOR.POSITION_BEFORE_END),o=e(o).lastForward(),a=!0),o||(o=r),o.is("table")?(i.setStartAt(o,CKEDITOR.POSITION_BEFORE_START),i.collapse(!0),o.remove()):(o.is({tbody:1,thead:1,
tfoot:1})&&(o=t(o,"tr",a)),o.is("tr")&&(o=t(o,o.getParent().is("thead")?"th":"td",a)),(r=o.getBogus())&&r.remove(),i.moveToPosition(o,a?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}(),C=function(){function e(e){return e=new CKEDITOR.dom.walker(e),e.guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$list)||e.is(CKEDITOR.dtd.$listItem):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$listItem)},e}return function(t){var n,i=t.startContainer,r=!1;n=t.clone(),n.setStart(i,0),n=e(n).lastBackward(),n||(n=t.clone(),n.setEndAt(i,CKEDITOR.POSITION_BEFORE_END),n=e(n).lastForward(),r=!0),n||(n=i),n.is(CKEDITOR.dtd.$list)?(t.setStartAt(n,CKEDITOR.POSITION_BEFORE_START),t.collapse(!0),n.remove()):((i=n.getBogus())&&i.remove(),t.moveToPosition(n,r?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),t.select())}}(),v={eol:{detect:function(e,t){var n=e.range,i=n.clone(),r=n.clone(),o=new CKEDITOR.dom.elementPath(n.startContainer,t),a=new CKEDITOR.dom.elementPath(n.endContainer,t);i.collapse(1),r.collapse(),o.block&&i.checkBoundaryOfElement(o.block,CKEDITOR.END)&&(n.setStartAfter(o.block),e.prependEolBr=1),a.block&&r.checkBoundaryOfElement(a.block,CKEDITOR.START)&&(n.setEndBefore(a.block),e.appendEolBr=1)},fix:function(e,t){var n,i=t.getDocument();e.appendEolBr&&(n=this.createEolBr(i),e.fragment.append(n)),!e.prependEolBr||n&&!n.getPrevious()||e.fragment.append(this.createEolBr(i),1)},createEolBr:function(e){return e.createElement("br",{attributes:{"data-cke-eol":1}})}},bogus:{exclude:function(e){var t=e.range.getBoundaryNodes(),n=t.startNode,t=t.endNode;!t||!m(t)||n&&n.equals(t)||e.range.setEndBefore(t)}},tree:{rebuild:function(e,t){var n,i=e.range,r=i.getCommonAncestor(),o=new CKEDITOR.dom.elementPath(r,t),a=new CKEDITOR.dom.elementPath(i.startContainer,t),i=new CKEDITOR.dom.elementPath(i.endContainer,t);if(r.type==CKEDITOR.NODE_TEXT&&(r=r.getParent()),o.blockLimit.is({tr:1,table:1})){var s=o.contains("table").getParent();n=function(e){return!e.equals(s)}}else if(o.block&&o.block.is(CKEDITOR.dtd.$listItem)&&(a=a.contains(CKEDITOR.dtd.$list),i=i.contains(CKEDITOR.dtd.$list),!a.equals(i))){var l=o.contains(CKEDITOR.dtd.$list).getParent();n=function(e){return!e.equals(l)}}n||(n=function(e){return!e.equals(o.block)&&!e.equals(o.blockLimit)}),this.rebuildFragment(e,t,r,n)},rebuildFragment:function(e,t,n,i){for(var r;n&&!n.equals(t)&&i(n);)r=n.clone(0,1),e.fragment.appendTo(r),e.fragment=r,n=n.getParent()}},cell:{shrink:function(e){e=e.range;var t=e.startContainer,n=e.endContainer,i=e.startOffset,r=e.endOffset;t.type==CKEDITOR.NODE_ELEMENT&&t.equals(n)&&t.is("tr")&&++i==r&&e.shrink(CKEDITOR.SHRINK_TEXT)}}},O=function(){function e(e,t){var n=e.getParent();n.is(CKEDITOR.dtd.$inline)&&e[t?"insertBefore":"insertAfter"](n)}function t(t,n,i){e(n),e(i,1);for(var r;r=i.getNext();)r.insertAfter(n),n=r;p(t)&&t.remove()}function n(e,t){var n=new CKEDITOR.dom.range(e);return n.setStartAfter(t.startNode),n.setEndBefore(t.endNode),n}return{list:{detectMerge:function(e,t){var i=n(t,e.bookmark),r=i.startPath(),o=i.endPath(),a=r.contains(CKEDITOR.dtd.$list),s=o.contains(CKEDITOR.dtd.$list);e.mergeList=a&&s&&a.getParent().equals(s.getParent())&&!a.equals(s),e.mergeListItems=r.block&&o.block&&r.block.is(CKEDITOR.dtd.$listItem)&&o.block.is(CKEDITOR.dtd.$listItem),(e.mergeList||e.mergeListItems)&&(i=i.clone(),i.setStartBefore(e.bookmark.startNode),i.setEndAfter(e.bookmark.endNode),e.mergeListBookmark=i.createBookmark())},merge:function(e,n){if(e.mergeListBookmark){var i=e.mergeListBookmark.startNode,r=e.mergeListBookmark.endNode,o=new CKEDITOR.dom.elementPath(i,n),a=new CKEDITOR.dom.elementPath(r,n);if(e.mergeList){var s=o.contains(CKEDITOR.dtd.$list),l=a.contains(CKEDITOR.dtd.$list);s.equals(l)||(l.moveChildren(s),l.remove())}e.mergeListItems&&(o=o.contains(CKEDITOR.dtd.$listItem),a=a.contains(CKEDITOR.dtd.$listItem),o.equals(a)||t(a,i,r)),i.remove(),r.remove()}}},block:{detectMerge:function(e,t){if(!e.tableContentsRanges&&!e.mergeListBookmark){var n=new CKEDITOR.dom.range(t);n.setStartBefore(e.bookmark.startNode),n.setEndAfter(e.bookmark.endNode),e.mergeBlockBookmark=n.createBookmark()}},merge:function(e,n){if(e.mergeBlockBookmark&&!e.purgeTableBookmark){var i=e.mergeBlockBookmark.startNode,r=e.mergeBlockBookmark.endNode,o=new CKEDITOR.dom.elementPath(i,n),a=new CKEDITOR.dom.elementPath(r,n),o=o.block,a=a.block;o&&a&&!o.equals(a)&&t(a,i,r),i.remove(),r.remove()}}},table:function(){function e(e){var n,r=[],o=new CKEDITOR.dom.walker(e),a=e.startPath().contains(i),s=e.endPath().contains(i),l={};return o.guard=function(o,d){if(o.type==CKEDITOR.NODE_ELEMENT){var c="visited_"+(d?"out":"in");if(o.getCustomData(c))return;CKEDITOR.dom.element.setMarker(l,o,c,1)}if(d&&a&&o.equals(a))n=e.clone(),n.setEndAt(a,CKEDITOR.POSITION_BEFORE_END),r.push(n);else if(!d&&s&&o.equals(s))n=e.clone(),n.setStartAt(s,CKEDITOR.POSITION_AFTER_START),r.push(n);else{if((c=!d)&&(c=o.type==CKEDITOR.NODE_ELEMENT&&o.is(i)&&(!a||t(o,a))&&(!s||t(o,s))),!c&&(c=d))if(o.is(i))var c=a&&a.getAscendant("table",!0),h=s&&s.getAscendant("table",!0),u=o.getAscendant("table",!0),c=c&&c.contains(u)||h&&h.contains(u);else c=void 0;c&&(n=e.clone(),n.selectNodeContents(o),r.push(n))}},o.lastForward(),CKEDITOR.dom.element.clearAllMarkers(l),r}function t(e,t){var n=CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED,i=e.getPosition(t);return i!==CKEDITOR.POSITION_IDENTICAL&&0==(i&n)}var i={td:1,th:1,caption:1};return{detectPurge:function(e){var t=e.range,n=t.clone();n.enlarge(CKEDITOR.ENLARGE_ELEMENT);var n=new CKEDITOR.dom.walker(n),r=0;if(n.evaluator=function(e){e.type==CKEDITOR.NODE_ELEMENT&&e.is(i)&&++r},n.checkForward(),1<r){var n=t.startPath().contains("table"),o=t.endPath().contains("table");n&&o&&t.checkBoundaryOfElement(n,CKEDITOR.START)&&t.checkBoundaryOfElement(o,CKEDITOR.END)&&(t=e.range.clone(),t.setStartBefore(n),t.setEndAfter(o),e.purgeTableBookmark=t.createBookmark())}},detectRanges:function(r,o){var a,s,l=n(o,r.bookmark),d=l.clone(),c=l.getCommonAncestor();c.is(CKEDITOR.dtd.$tableContent)&&!c.is(i)&&(c=c.getAscendant("table",!0)),s=c,c=new CKEDITOR.dom.elementPath(l.startContainer,s),s=new CKEDITOR.dom.elementPath(l.endContainer,s),c=c.contains("table"),s=s.contains("table"),(c||s)&&(c&&s&&t(c,s)?(r.tableSurroundingRange=d,d.setStartAt(c,CKEDITOR.POSITION_AFTER_END),d.setEndAt(s,CKEDITOR.POSITION_BEFORE_START),d=l.clone(),d.setEndAt(c,CKEDITOR.POSITION_AFTER_END),a=l.clone(),a.setStartAt(s,CKEDITOR.POSITION_BEFORE_START),a=e(d).concat(e(a))):c?s||(r.tableSurroundingRange=d,d.setStartAt(c,CKEDITOR.POSITION_AFTER_END),l.setEndAt(c,CKEDITOR.POSITION_AFTER_END)):(r.tableSurroundingRange=d,d.setEndAt(s,CKEDITOR.POSITION_BEFORE_START),l.setStartAt(s,CKEDITOR.POSITION_AFTER_START)),r.tableContentsRanges=a||e(l))},deleteRanges:function(e){for(var t;t=e.tableContentsRanges.pop();)t.extractContents(),p(t.startContainer)&&t.startContainer.appendBogus();e.tableSurroundingRange&&e.tableSurroundingRange.extractContents()},purge:function(e){if(e.purgeTableBookmark){var t=e.doc,n=e.range.clone(),t=t.createElement("p");t.insertBefore(e.purgeTableBookmark.startNode),n.moveToBookmark(e.purgeTableBookmark),n.deleteContents(),e.range.moveToPosition(t,CKEDITOR.POSITION_AFTER_START)}}}}(),detectExtractMerge:function(e){return!(e.range.startPath().contains(CKEDITOR.dtd.$listItem)&&e.range.endPath().contains(CKEDITOR.dtd.$listItem))},fixUneditableRangePosition:function(e){e.startContainer.getDtd()["#"]||e.moveToClosestEditablePosition(null,!0)},autoParagraph:function(e,t){var n,i=t.startPath();l(e,i.block,i.blockLimit)&&(n=d(e))&&(n=t.document.createElement(n),n.appendBogus(),t.insertNode(n),t.moveToPosition(n,CKEDITOR.POSITION_AFTER_START))}}}()}(),function(){function e(e){return CKEDITOR.plugins.widget&&CKEDITOR.plugins.widget.isDomWidget(e)}function t(t,n){if(0===t.length||e(t[0].getEnclosedNode()))return!1;var i,r;if((i=!n&&1===t.length)&&!(i=t[0].collapsed)){var o=t[0];i=o.startContainer.getAscendant({td:1,th:1},!0);var a=o.endContainer.getAscendant({td:1,th:1},!0);r=CKEDITOR.tools.trim,i&&i.equals(a)&&!i.findOne("td, th, tr, tbody, table")?(o=o.cloneContents(),i=!o.getFirst()||r(o.getFirst().getText())!==r(i.getText())):i=!1}if(i)return!1;for(r=0;r<t.length;r++)if(!(i=t[r]._getTableElement()))return!1;return!0}function n(e){var t,n,i=[];for(n=0;n<e.length;n++)t=e[n]._getTableElement(),t.is&&t.is({td:1,th:1})?i.push(t):i=i.concat(function(e){e=e.find("td, th");var t,n=[];for(t=0;t<e.count();t++)n.push(e.getItem(t));return n}(t));return i}function i(e){e=n(e);var t,i,r="",o=[];for(i=0;i<e.length;i++)t&&!t.equals(e[i].getAscendant("tr"))?(r+=o.join("\t")+"\n",t=e[i].getAscendant("tr"),o=[]):0===i&&(t=e[i].getAscendant("tr")),o.push(e[i].getText());return r+=o.join("\t")}function r(e){var t=this.root.editor,n=t.getSelection(1);this.reset(),m=!0,n.root.once("selectionchange",function(e){e.cancel()},null,null,0),n.selectRanges([e[0]]),n=this._.cache,n.ranges=new CKEDITOR.dom.rangeList(e),n.type=CKEDITOR.SELECTION_TEXT,n.selectedElement=e[0]._getTableElement(),n.selectedText=i(e),n.nativeSel=null,this.isFake=1,this.rev=C++,t._.fakeSelection=this,m=!1,this.root.fire("selectionchange")}function o(){var n,i=this._.fakeSelection;if(i){n=this.getSelection(1);var r;if(!(r=!n)&&(r=!n.isHidden())){r=i;var o=n.getRanges(),a=r.getRanges(),s=o.length&&o[0]._getTableElement()&&o[0]._getTableElement().getAscendant("table",!0),l=a.length&&a[0]._getTableElement()&&a[0]._getTableElement().getAscendant("table",!0),d=1===o.length&&o[0]._getTableElement()&&o[0]._getTableElement().is("table"),c=1===a.length&&a[0]._getTableElement()&&a[0]._getTableElement().is("table");if(e(r.getSelectedElement()))r=!1;else{var h=1===o.length&&o[0].collapsed,a=t(o,!!CKEDITOR.env.webkit)&&t(a);s=!(!s||!l)&&(s.equals(l)||l.contains(s)),s&&(h||a)?(d&&!c&&r.selectRanges(o),r=!0):r=!1}r=!r}r&&(i.reset(),i=0)}(i||(i=n||this.getSelection(1))&&i.getType()!=CKEDITOR.SELECTION_NONE)&&(this.fire("selectionCheck",i),n=this.elementPath(),n.compare(this._.selectionPreviousPath)||(r=this._.selectionPreviousPath&&this._.selectionPreviousPath.blockLimit.equals(n.blockLimit),!CKEDITOR.env.webkit&&!CKEDITOR.env.gecko||r||(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=n,this.fire("selectionChange",{selection:i,path:n})))}function a(){_=!0,E||(s.call(this),E=CKEDITOR.tools.setTimeout(s,200,this))}function s(){E=null,_&&(CKEDITOR.tools.setTimeout(o,0,this),_=!1)}function l(e){return!(!I(e)&&(e.type!=CKEDITOR.NODE_ELEMENT||e.is(CKEDITOR.dtd.$empty)))}function d(e){function t(t,n){return!(!t||t.type==CKEDITOR.NODE_TEXT)&&e.clone()["moveToElementEdit"+(n?"End":"Start")](t)}if(!(e.root instanceof CKEDITOR.editable))return!1;var n=e.startContainer,i=e.getPreviousNode(l,null,n),r=e.getNextNode(l,null,n);return!(!t(i)&&!t(r,1)&&(i||r||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()&&n.getBogus()))}function c(e){h(e,!1);var t=e.getDocument().createText(v);return e.setCustomData("cke-fillingChar",t),t}function h(e,t){var n=e&&e.removeCustomData("cke-fillingChar");if(n){if(!1!==t){var i=e.getDocument().getSelection().getNative(),r=i&&"None"!=i.type&&i.getRangeAt(0),o=v.length;if(n.getLength()>o&&r&&r.intersectsNode(n.$)){var a=[{node:i.anchorNode,offset:i.anchorOffset},{node:i.focusNode,offset:i.focusOffset}];i.anchorNode==n.$&&i.anchorOffset>o&&(a[0].offset-=o),i.focusNode==n.$&&i.focusOffset>o&&(a[1].offset-=o)}}n.setText(u(n.getText(),1)),a&&(n=e.getDocument().$,i=n.getSelection(),n=n.createRange(),n.setStart(a[0].node,a[0].offset),n.collapse(!0),i.removeAllRanges(),i.addRange(n),i.extend(a[1].node,a[1].offset))}}function u(e,t){return t?e.replace(O,function(e,t){return t?"\xa0":""}):e.replace(v,"")}function f(e,t){var n=t&&CKEDITOR.tools.htmlEncode(t)||"&nbsp;",n=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie&&14>CKEDITOR.env.version?"display:none":"position:fixed;top:0;left:-1000px;width:0;height:0;overflow:hidden;")+'">'+n+"</div>",e.document);e.fire("lockSnapshot"),e.editable().append(n);var i=e.getSelection(1),r=e.createRange(),o=i.root.on("selectionchange",function(e){e.cancel()},null,null,0);r.setStartAt(n,CKEDITOR.POSITION_AFTER_START),r.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),i.selectRanges([r]),o.removeListener(),e.fire("unlockSnapshot"),e._.hiddenSelectionContainer=n}function g(t){var n={35:1,36:1,2228259:1,2228260:1,2228261:1,2228262:1,2228263:1,2228264:1,1114149:1,1114151:1,3342373:1,3342375:1},i=CKEDITOR.tools.extend({8:1,37:1,39:1,46:1},n);return function(r){var o=r.data.getKeystroke();if(i[o]){var a=t.getSelection(),s=a.getRanges()[0];n[o]?a.isFake&&(o=r.data.getKey(),s.moveToClosestEditablePosition(r.selected,36===o||37===o||38==o),s.select()):a.isCollapsed()&&(s=s[38>o?"getPreviousEditableNode":"getNextEditableNode"]())&&s.type==CKEDITOR.NODE_ELEMENT&&"false"==s.getAttribute("contenteditable")&&(a=a.getStartElement(),!a.isBlockBoundary()||""!==(void 0===a.$.textContent?a.$.innerText:a.$.textContent)||e(a.getFirst())||8!==o&&46!==o||(a.remove(),t.fire("saveSnapshot")),t.getSelection().fake(s),r.data.preventDefault(),r.cancel())}}}function p(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.getCommonAncestor().isReadOnly()&&e.splice(t,1),!n.collapsed){if(n.startContainer.isReadOnly())for(var i,r=n.startContainer;r&&!((i=r.type==CKEDITOR.NODE_ELEMENT)&&r.is("body")||!r.isReadOnly());)i&&"false"==r.getAttribute("contentEditable")&&n.setStartAfter(r),r=r.getParent();r=n.startContainer,i=n.endContainer;var o=n.startOffset,a=n.endOffset,s=n.clone();r&&r.type==CKEDITOR.NODE_TEXT&&(o>=r.getLength()?s.setStartAfter(r):s.setStartBefore(r)),i&&i.type==CKEDITOR.NODE_TEXT&&(a?s.setEndAfter(i):s.setEndBefore(i)),r=new CKEDITOR.dom.walker(s),r.evaluator=function(i){if(i.type==CKEDITOR.NODE_ELEMENT&&i.isReadOnly()){var r=n.clone();return n.setEndBefore(i),n.collapsed&&e.splice(t--,1),i.getPosition(s.endContainer)&CKEDITOR.POSITION_CONTAINS||(r.setStartAfter(i),r.collapsed||e.splice(t+1,0,r)),!0}return!1},r.next()}}return e}var m,E,_,T="function"!=typeof window.getSelection,C=1,v=CKEDITOR.tools.repeat("\u200b",7),O=new RegExp(v+"( )?","g"),I=CKEDITOR.dom.walker.invisible(1),D=function(){function e(e){return function(t){var n=t.editor.createRange();return n.moveToClosestEditablePosition(t.selected,e)&&t.editor.getSelection().selectRanges([n]),!1}}function t(e){return function(t){var n,i=t.editor,r=i.createRange();if(!i.readOnly)return(n=r.moveToClosestEditablePosition(t.selected,e))||(n=r.moveToClosestEditablePosition(t.selected,!e)),n&&i.getSelection().selectRanges([r]),i.fire("saveSnapshot"),t.selected.remove(),n||(r.moveToElementEditablePosition(i.editable()),i.getSelection().selectRanges([r])),i.fire("saveSnapshot"),!1}}var n=e(),i=e(1);return{37:n,38:n,39:i,40:i,8:t(),46:t(1)}}();CKEDITOR.on("instanceCreated",function(e){function t(){var e=n.getSelection();e&&e.removeAllRanges()}var n=e.editor;n.on("contentDom",function(){function e(){l=new CKEDITOR.dom.selection(n.getSelection()),l.lock()}function t(){c.removeListener("mouseup",t),p.removeListener("mouseup",t);var e=CKEDITOR.document.$.selection,n=e.createRange();"None"!=e.type&&n.parentElement()&&n.parentElement().ownerDocument==d.$&&n.select()}function i(e){var t,n;(t=!!(t=this.document.getActive())&&("input"===t.getName()||"textarea"===t.getName()))||(t=this.getSelection(1),(n=r(t))&&!n.equals(u)&&(t.selectElement(n),e.data.preventDefault()))}function r(e){return e=e.getRanges()[0],e&&(e=e.startContainer.getAscendant(function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")},!0))&&"false"===e.getAttribute("contenteditable")?e:null}var s,l,d=n.document,c=CKEDITOR.document,u=n.editable(),f=d.getBody(),p=d.getDocumentElement(),m=u.isInline();if(CKEDITOR.env.gecko&&u.attachListener(u,"focus",function(e){e.removeListener(),0!==s&&(e=n.getSelection().getNative())&&e.isCollapsed&&e.anchorNode==u.$&&(e=n.createRange(),e.moveToElementEditStart(u),e.select())},null,null,-2),u.attachListener(u,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusin":"focus",function(){if(s&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)){s=n._.previousActive&&n._.previousActive.equals(d.getActive());var e=null!=n._.previousScrollTop&&n._.previousScrollTop!=u.$.scrollTop;CKEDITOR.env.webkit&&s&&e&&(u.$.scrollTop=n._.previousScrollTop)}n.unlockSelection(s),s=0},null,null,-1),u.attachListener(u,"mousedown",function(){s=0}),(CKEDITOR.env.ie||CKEDITOR.env.gecko||m)&&(T?u.attachListener(u,"beforedeactivate",e,null,null,-1):u.attachListener(n,"selectionCheck",e,null,null,-1),u.attachListener(u,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusout":"blur",function(){var e=l&&(l.isFake||2>l.getRanges().length);CKEDITOR.env.gecko&&!m&&e||(n.lockSelection(l),s=1)},null,null,-1),u.attachListener(u,"mousedown",function(){s=0})),CKEDITOR.env.ie&&!m){var E;if(u.attachListener(u,"mousedown",function(e){2==e.data.$.button&&((e=n.document.getSelection())&&e.getType()!=CKEDITOR.SELECTION_NONE||(E=n.window.getScrollPosition()))}),u.attachListener(u,"mouseup",function(e){2==e.data.$.button&&E&&(n.document.$.documentElement.scrollLeft=E.x,n.document.$.documentElement.scrollTop=E.y),E=null}),"BackCompat"!=d.$.compatMode){if(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat){var _,C;p.on("mousedown",function(e){function t(e){if(e=e.data.$,_){var t=f.$.createTextRange();try{t.moveToPoint(e.clientX,e.clientY)}catch(e){}_.setEndPoint(0>C.compareEndPoints("StartToStart",t)?"EndToEnd":"StartToStart",t),_.select()}}function n(){p.removeListener("mousemove",t),c.removeListener("mouseup",n),p.removeListener("mouseup",n),_.select()}if(e=e.data,e.getTarget().is("html")&&e.$.y<p.$.clientHeight&&e.$.x<p.$.clientWidth){_=f.$.createTextRange();try{_.moveToPoint(e.$.clientX,e.$.clientY)}catch(e){}C=_.duplicate(),p.on("mousemove",t),c.on("mouseup",n),p.on("mouseup",n)}})}7<CKEDITOR.env.version&&11>CKEDITOR.env.version&&p.on("mousedown",function(e){e.data.getTarget().is("html")&&(c.on("mouseup",t),p.on("mouseup",t))})}}if(u.attachListener(u,"selectionchange",o,n),u.attachListener(u,"keyup",a,n),u.attachListener(u,"touchstart",a,n),u.attachListener(u,"touchend",a,n),CKEDITOR.env.ie&&u.attachListener(u,"keydown",i,n),u.attachListener(u,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusin":"focus",function(){n.forceNextSelectionCheck(),n.selectionChange(1)}),m&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)){var v;u.attachListener(u,"mousedown",function(){v=1}),u.attachListener(d.getDocumentElement(),"mouseup",function(){v&&a.call(n),v=0})}else u.attachListener(CKEDITOR.env.ie?u:d.getDocumentElement(),"mouseup",a,n);CKEDITOR.env.webkit&&u.attachListener(d,"keydown",function(e){switch(e.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:u.hasFocus&&h(u)}},null,null,-1),u.attachListener(u,"keydown",g(n),null,null,-1)}),n.on("setData",function(){n.unlockSelection(),CKEDITOR.env.webkit&&t()}),n.on("contentDomUnload",function(){n.unlockSelection()}),CKEDITOR.env.ie9Compat&&n.on("beforeDestroy",t,null,null,9),n.on("dataReady",function(){delete n._.fakeSelection,delete n._.hiddenSelectionContainer,n.selectionChange(1)}),n.on("loadSnapshot",function(){var e=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT),t=n.editable().getLast(e);t&&t.hasAttribute("data-cke-hidden-sel")&&(t.remove(),CKEDITOR.env.gecko&&(e=n.editable().getFirst(e))&&e.is("br")&&e.getAttribute("_moz_editor_bogus_node")&&e.remove())},null,null,100),n.on("key",function(e){if("wysiwyg"==n.mode){var t=n.getSelection();if(t.isFake){var i=D[e.data.keyCode];if(i)return i({editor:n,selected:t.getSelectedElement(),selection:t,keyEvent:e})}}})}),CKEDITOR.env.webkit&&CKEDITOR.on("instanceReady",function(e){var t=e.editor;t.on("selectionChange",function(){var e=t.editable(),n=e.getCustomData("cke-fillingChar");n&&(n.getCustomData("ready")?(h(e),e.editor.fire("selectionCheck")):n.setCustomData("ready",1))},null,null,-1),t.on("beforeSetMode",function(){h(t.editable())},null,null,-1),t.on("getSnapshot",function(e){e.data&&(e.data=u(e.data))},t,null,20),t.on("toDataFormat",function(e){e.data.dataValue=u(e.data.dataValue)},null,null,0)}),CKEDITOR.editor.prototype.selectionChange=function(e){(e?o:a).call(this)},CKEDITOR.editor.prototype.getSelection=function(e){return!this._.savedSelection&&!this._.fakeSelection||e?(e=this.editable())&&"wysiwyg"==this.mode&&"recreating"!==this.status?new CKEDITOR.dom.selection(e):null:this._.savedSelection||this._.fakeSelection},CKEDITOR.editor.prototype.getSelectedRanges=function(e){var t=this.getSelection();return t&&t.getRanges(e)||[]},CKEDITOR.editor.prototype.lockSelection=function(e){return e=e||this.getSelection(1),e.getType()!=CKEDITOR.SELECTION_NONE&&(!e.isLocked&&e.lock(),this._.savedSelection=e,!0)},CKEDITOR.editor.prototype.unlockSelection=function(e){var t=this._.savedSelection;return!!t&&(t.unlock(e),delete this._.savedSelection,!0)},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var e=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return e.selectRanges([this]),e},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3,CKEDITOR.dom.selection=function(e){if(e instanceof CKEDITOR.dom.selection){var t=e;e=e.root}var n=e instanceof CKEDITOR.dom.element;if(this.rev=t?t.rev:C++,this.document=e instanceof CKEDITOR.dom.document?e:e.getDocument(),this.root=n?e:this.document.getBody(),this.isLocked=0,this._={cache:{}},t)return CKEDITOR.tools.extend(this._.cache,t._.cache),this.isFake=t.isFake,this.isLocked=t.isLocked,this;e=this.getNative();var i,r;if(e)if(e.getRangeAt)i=(r=e.rangeCount&&e.getRangeAt(0))&&new CKEDITOR.dom.node(r.commonAncestorContainer);else{try{r=e.createRange()}catch(e){}i=r&&CKEDITOR.dom.element.get(r.item&&r.item(0)||r.parentElement())}return(!i||i.type!=CKEDITOR.NODE_ELEMENT&&i.type!=CKEDITOR.NODE_TEXT||!this.root.equals(i)&&!this.root.contains(i))&&(this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList),this};var R={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.tools.extend(CKEDITOR.dom.selection,{_removeFillingCharSequenceString:u,_createFillingCharSequenceNode:c,FILLING_CHAR_SEQUENCE:v}),CKEDITOR.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=T?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:T?function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_NONE;try{var n=this.getNative(),i=n.type;"Text"==i&&(t=CKEDITOR.SELECTION_TEXT),"Control"==i&&(t=CKEDITOR.SELECTION_ELEMENT),n.createRange().parentElement()&&(t=CKEDITOR.SELECTION_TEXT)}catch(e){}return e.type=t}:function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_TEXT,n=this.getNative();if(n&&n.rangeCount){if(1==n.rangeCount){var n=n.getRangeAt(0),i=n.startContainer;i==n.endContainer&&1==i.nodeType&&1==n.endOffset-n.startOffset&&R[i.childNodes[n.startOffset].nodeName.toLowerCase()]&&(t=CKEDITOR.SELECTION_ELEMENT)}}else t=CKEDITOR.SELECTION_NONE;return e.type=t},getRanges:function(){var e=T?function(){function e(e){return new CKEDITOR.dom.node(e).getIndex()}var t=function(t,n){t=t.duplicate(),t.collapse(n);var i=t.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};for(var r,o,a,s,l=i.children,d=t.duplicate(),c=0,h=l.length-1,u=-1;c<=h;)if(u=Math.floor((c+h)/2),r=l[u],d.moveToElementText(r),0<(a=d.compareEndPoints("StartToStart",t)))h=u-1;else{if(!(0>a))return{container:i,offset:e(r)};c=u+1}if(-1==u||u==l.length-1&&0>a){if(d.moveToElementText(i),d.setEndPoint("StartToStart",t),d=d.text.replace(/(\r\n|\r)/g,"\n").length,l=i.childNodes,!d)return r=l[l.length-1],r.nodeType!=CKEDITOR.NODE_TEXT?{container:i,offset:l.length}:{container:r,offset:r.nodeValue.length};for(i=l.length;0<d&&0<i;)o=l[--i],o.nodeType==CKEDITOR.NODE_TEXT&&(s=o,d-=o.nodeValue.length);return{container:s,offset:-d}}if(d.collapse(0<a),d.setEndPoint(0<a?"StartToStart":"EndToStart",t),!(d=d.text.replace(/(\r\n|\r)/g,"\n").length))return{container:i,offset:e(r)+(0<a?0:1)};for(;0<d;)try{o=r[0<a?"previousSibling":"nextSibling"],o.nodeType==CKEDITOR.NODE_TEXT&&(d-=o.nodeValue.length,s=o),r=o}catch(t){return{container:i,offset:e(r)}}return{container:s,offset:0<a?-d:s.nodeValue.length+d}};return function(){var e=this.getNative(),n=e&&e.createRange(),i=this.getType();if(!e)return[];if(i==CKEDITOR.SELECTION_TEXT)return e=new CKEDITOR.dom.range(this.root),i=t(n,!0),e.setStart(new CKEDITOR.dom.node(i.container),i.offset),i=t(n),e.setEnd(new CKEDITOR.dom.node(i.container),i.offset),e.endContainer.getPosition(e.startContainer)&CKEDITOR.POSITION_PRECEDING&&e.endOffset<=e.startContainer.getIndex()&&e.collapse(),[e];if(i==CKEDITOR.SELECTION_ELEMENT){for(var i=[],r=0;r<n.length;r++){for(var o=n.item(r),a=o.parentNode,s=0,e=new CKEDITOR.dom.range(this.root);s<a.childNodes.length&&a.childNodes[s]!=o;s++);e.setStart(new CKEDITOR.dom.node(a),s),e.setEnd(new CKEDITOR.dom.node(a),s+1),i.push(e)}return i}return[]}}():function(){var e,t=[],n=this.getNative();if(!n)return t;for(var i=0;i<n.rangeCount;i++){var r=n.getRangeAt(i);e=new CKEDITOR.dom.range(this.root),e.setStart(new CKEDITOR.dom.node(r.startContainer),r.startOffset),e.setEnd(new CKEDITOR.dom.node(r.endContainer),r.endOffset),t.push(e)}return t};return function(t){var n=this._.cache,i=n.ranges;return i||(n.ranges=i=new CKEDITOR.dom.rangeList(e.call(this))),t?p(new CKEDITOR.dom.rangeList(i.slice())):i}}(),getStartElement:function(){var e=this._.cache;if(void 0!==e.startElement)return e.startElement;var t;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)t=n.startContainer,t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent());else{for(n.optimize();t=n.startContainer,n.startOffset==(t.getChildCount?t.getChildCount():t.getLength())&&!t.isBlockBoundary();)n.setStartAfter(t);if(t=n.startContainer,t.type!=CKEDITOR.NODE_ELEMENT)return t.getParent();if((t=t.getChild(n.startOffset))&&t.type==CKEDITOR.NODE_ELEMENT)for(n=t.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)t=n,n=n.getFirst();else t=n.startContainer}t=t.$}}return e.startElement=t?new CKEDITOR.dom.element(t):null},getSelectedElement:function(){var e=this._.cache;if(void 0!==e.selectedElement)return e.selectedElement;var t=this,n=CKEDITOR.tools.tryThese(function(){return t.getNative().createRange().item(0)},function(){for(var e,n,i=t.getRanges()[0].clone(),r=2;r&&!((e=i.getEnclosedNode())&&e.type==CKEDITOR.NODE_ELEMENT&&R[e.getName()]&&(n=e));r--)i.shrink(CKEDITOR.SHRINK_ELEMENT);return n&&n.$});return e.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var e=this._.cache;if(void 0!==e.selectedText)return e.selectedText;var t=this.getNative(),t=T?"Control"==t.type?"":t.createRange().text:t.toString();return e.selectedText=t},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(e){if(this.isLocked){if(e)var n=this.getSelectedElement(),i=this.getRanges(),o=this.isFake;this.isLocked=0,this.reset(),e&&(e=n||i[0]&&i[0].getCommonAncestor())&&e.getAscendant("body",1)&&((e=this.root.editor)&&e.plugins.tableselection&&e.plugins.tableselection.isSupportedEnvironment(e)&&t(i)?r.call(this,i):o?this.fake(n):n&&2>i.length?this.selectElement(n):this.selectRanges(i))}},reset:function(){this._.cache={},this.isFake=0;var e=this.root.editor;if(e&&e._.fakeSelection)if(this.rev==e._.fakeSelection.rev){delete e._.fakeSelection;var t=e._.hiddenSelectionContainer;if(t){var n=e.checkDirty();e.fire("lockSnapshot"),t.remove(),e.fire("unlockSnapshot"),!n&&e.resetDirty()}delete e._.hiddenSelectionContainer}else CKEDITOR.warn("selection-fake-reset");this.rev=C++},selectElement:function(e){var t=new CKEDITOR.dom.range(this.root);t.setStartBefore(e),t.setEndAfter(e),this.selectRanges([t])},selectRanges:function(e){var n=this.root.editor,i=n&&n._.hiddenSelectionContainer;if(this.reset(),i)for(var o,i=this.root,a=0;a<e.length;++a)o=e[a],o.endContainer.equals(i)&&(o.endOffset=Math.min(o.endOffset,i.getChildCount()));if(e.length)if(this.isLocked){var s=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(e),this.lock(),s&&!s.equals(this.root)&&s.focus()}else{var l,u,f;if(1==e.length&&!(f=e[0]).collapsed&&(l=f.getEnclosedNode())&&l.type==CKEDITOR.NODE_ELEMENT&&(f=f.clone(),f.shrink(CKEDITOR.SHRINK_ELEMENT,!0),(u=f.getEnclosedNode())&&u.type==CKEDITOR.NODE_ELEMENT&&(l=u),"false"==l.getAttribute("contenteditable"))||(l=void 0),l)this.fake(l);else if(n&&n.plugins.tableselection&&n.plugins.tableselection.isSupportedEnvironment(n)&&t(e)&&!m&&!e[0]._getTableElement({table:1}).hasAttribute("data-cke-tableselection-ignored"))r.call(this,e);else{if(T){u=CKEDITOR.dom.walker.whitespaces(!0),l=/\ufeff|\u00a0/,f={table:1,tbody:1,tr:1},1<e.length&&(n=e[e.length-1],e[0].setEnd(n.endContainer,n.endOffset)),n=e[0],e=n.collapsed;var g,p,E;if((i=n.getEnclosedNode())&&i.type==CKEDITOR.NODE_ELEMENT&&i.getName()in R&&(!i.is("a")||!i.getText()))try{return E=i.$.createControlRange(),E.addElement(i.$),void E.select()}catch(e){}(n.startContainer.type==CKEDITOR.NODE_ELEMENT&&n.startContainer.getName()in f||n.endContainer.type==CKEDITOR.NODE_ELEMENT&&n.endContainer.getName()in f)&&(n.shrink(CKEDITOR.NODE_ELEMENT,!0),e=n.collapsed),E=n.createBookmark(),f=E.startNode,e||(s=E.endNode),E=n.document.$.body.createTextRange(),E.moveToElementText(f.$),E.moveStart("character",1),s?(l=n.document.$.body.createTextRange(),l.moveToElementText(s.$),E.setEndPoint("EndToEnd",l),E.moveEnd("character",-1)):(g=f.getNext(u),p=f.hasAscendant("pre"),g=!(g&&g.getText&&g.getText().match(l))&&(p||!f.hasPrevious()||f.getPrevious().is&&f.getPrevious().is("br")),p=n.document.createElement("span"),p.setHtml("&#65279;"),p.insertBefore(f),g&&n.document.createText("\ufeff").insertBefore(f)),n.setStartBefore(f),f.remove(),e?(g?(E.moveStart("character",-1),E.select(),n.document.$.selection.clear()):E.select(),n.moveToPosition(p,CKEDITOR.POSITION_BEFORE_START),p.remove()):(n.setEndBefore(s),s.remove(),E.select())}else{if(!(s=this.getNative()))return;for(this.removeAllRanges(),E=0;E<e.length;E++)if(E<e.length-1&&(g=e[E],p=e[E+1],l=g.clone(),l.setStart(g.endContainer,g.endOffset),l.setEnd(p.startContainer,p.startOffset),!l.collapsed&&(l.shrink(CKEDITOR.NODE_ELEMENT,!0),n=l.getCommonAncestor(),l=l.getEnclosedNode(),n.isReadOnly()||l&&l.isReadOnly())))p.setStart(g.startContainer,g.startOffset),e.splice(E--,1);else{n=e[E],p=this.document.$.createRange(),n.collapsed&&CKEDITOR.env.webkit&&d(n)&&(l=c(this.root),n.insertNode(l),(g=l.getNext())&&!l.getPrevious()&&g.type==CKEDITOR.NODE_ELEMENT&&"br"==g.getName()?(h(this.root),n.moveToPosition(g,CKEDITOR.POSITION_BEFORE_START)):n.moveToPosition(l,CKEDITOR.POSITION_AFTER_END)),p.setStart(n.startContainer.$,n.startOffset);try{p.setEnd(n.endContainer.$,n.endOffset)}catch(e){if(!(0<=e.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")))throw e;n.collapse(1),p.setEnd(n.endContainer.$,n.endOffset)}s.addRange(p)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(e,t){var n=this.root.editor;void 0===t&&e.hasAttribute("aria-label")&&(t=e.getAttribute("aria-label")),this.reset(),f(n,t);var i=this._.cache,r=new CKEDITOR.dom.range(this.root);r.setStartBefore(e),r.setEndAfter(e),i.ranges=new CKEDITOR.dom.rangeList(r),i.selectedElement=i.startElement=e,
i.type=CKEDITOR.SELECTION_ELEMENT,i.selectedText=i.nativeSel=null,this.isFake=1,this.rev=C++,n._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var e=this.getCommonAncestor();return e&&e.type==CKEDITOR.NODE_TEXT&&(e=e.getParent()),!(!e||!e.data("cke-hidden-sel"))},isInTable:function(e){return t(this.getRanges(),e)},isCollapsed:function(){var e=this.getRanges();return 1===e.length&&e[0].collapsed},createBookmarks:function(e){return e=this.getRanges().createBookmarks(e),this.isFake&&(e.isFake=1),e},createBookmarks2:function(e){return e=this.getRanges().createBookmarks2(e),this.isFake&&(e.isFake=1),e},selectBookmarks:function(e){for(var n,i=[],r=0;r<e.length;r++){var o=new CKEDITOR.dom.range(this.root);o.moveToBookmark(e[r]),i.push(o)}return e.isFake&&((n=t(i)?i[0]._getTableElement():i[0].getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT||(CKEDITOR.warn("selection-not-fake"),e.isFake=0)),e.isFake&&!t(i)?this.fake(n):this.selectRanges(i),this},getCommonAncestor:function(){var e=this.getRanges();return e.length?e[0].startContainer.getCommonAncestor(e[e.length-1].endContainer):null},scrollIntoView:function(){this.getType()!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var e=this.getNative();try{e&&e[T?"empty":"removeAllRanges"]()}catch(e){}this.reset()}}}}(),CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function e(e,t){for(var n,i;(e=e.getParent())&&!e.equals(t);)if(e.getAttribute("data-nostyle"))n=e;else if(!i){var r=e.getAttribute("contentEditable");"false"==r?n=e:"true"==r&&(i=1)}return n}function t(e,t,n,i){return(e.getPosition(t)|i)==i&&(!n.childRule||n.childRule(e))}function n(i){var o=i.document;if(i.collapsed)o=E(this,o),i.insertNode(o),i.moveToPosition(o,CKEDITOR.POSITION_BEFORE_END);else{var a,s=this.element,l=this._.definition,d=l.ignoreReadonly,c=d||l.includeReadonly;null==c&&(c=i.root.getCustomData("cke_includeReadonly"));var h=CKEDITOR.dtd[s];h||(a=!0,h=CKEDITOR.dtd.span),i.enlarge(CKEDITOR.ENLARGE_INLINE,1),i.trim();var u,f=i.createBookmark(),p=f.startNode,m=f.endNode,_=p;if(!d){var T=i.getCommonAncestor(),d=e(p,T),T=e(m,T);d&&(_=d.getNextSourceNode(!0)),T&&(m=T)}for(_.getPosition(m)==CKEDITOR.POSITION_FOLLOWING&&(_=0);_;){if(d=!1,_.equals(m))_=null,d=!0;else{var C=_.type==CKEDITOR.NODE_ELEMENT?_.getName():null,T=C&&"false"==_.getAttribute("contentEditable"),v=C&&-1!==CKEDITOR.tools.array.indexOf(CKEDITOR.style.unstylableElements,C),v=C&&(_.getAttribute("data-nostyle")||v);if(C&&_.data("cke-bookmark")||_.type===CKEDITOR.NODE_COMMENT){_=_.getNextSourceNode(!0);continue}if(T&&c&&CKEDITOR.dtd.$block[C])for(var O=_,I=r(O),D=void 0,R=I.length,b=0,O=R&&new CKEDITOR.dom.range(O.getDocument());b<R;++b){var D=I[b],y=CKEDITOR.filter.instances[D.data("cke-filter")];(y?y.check(this):1)&&(O.selectNodeContents(D),n.call(this,O))}if(I=C?!h[C]||v?0:T&&!c?0:t(_,m,l,w):1){if(D=_.getParent(),I=l,R=s,b=a,!D||!(D.getDtd()||CKEDITOR.dtd.span)[R]&&!b||I.parentRule&&!I.parentRule(D))d=!0;else if(u||C&&CKEDITOR.dtd.$removeEmpty[C]&&(_.getPosition(m)|w)!=w||(u=i.clone(),u.setStartBefore(_)),(C=_.type)==CKEDITOR.NODE_TEXT||T||C==CKEDITOR.NODE_ELEMENT&&!_.getChildCount()){for(var k,C=_;(d=!C.getNext(K))&&(k=C.getParent(),h[k.getName()])&&t(k,p,l,N);)C=k;u.setEndAfter(C)}}else d=!0;_=_.getNextSourceNode(v||T)}if(d&&u&&!u.collapsed){for(var x,S,A,d=E(this,o),T=d.hasAttributes(),v=u.getCommonAncestor(),C={},I={},D={},R={};d&&v;){if(v.getName()==s){for(x in l.attributes)!R[x]&&(A=v.getAttribute(S))&&(d.getAttribute(x)==A?I[x]=1:R[x]=1);for(S in l.styles)!D[S]&&(A=v.getStyle(S))&&(d.getStyle(S)==A?C[S]=1:D[S]=1)}v=v.getParent()}for(x in I)d.removeAttribute(x);for(S in C)d.removeStyle(S);T&&!d.hasAttributes()&&(d=null),d?(u.extractContents().appendTo(d),u.insertNode(d),g.call(this,d),d.mergeSiblings(),CKEDITOR.env.ie||d.$.normalize()):(d=new CKEDITOR.dom.element("span"),u.extractContents().appendTo(d),u.insertNode(d),g.call(this,d),d.remove(!0)),u=null}}i.moveToBookmark(f),i.shrink(CKEDITOR.SHRINK_TEXT),i.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function i(e){function t(){for(var e=new CKEDITOR.dom.elementPath(i.getParent()),t=new CKEDITOR.dom.elementPath(c.getParent()),n=null,r=null,o=0;o<e.elements.length;o++){var a=e.elements[o];if(a==e.block||a==e.blockLimit)break;h.checkElementRemovable(a,!0)&&(n=a)}for(o=0;o<t.elements.length&&((a=t.elements[o])!=t.block&&a!=t.blockLimit);o++)h.checkElementRemovable(a,!0)&&(r=a);r&&c.breakParent(r),n&&i.breakParent(n)}e.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=e.createBookmark(),i=n.startNode,r=this._.definition.alwaysRemoveElement;if(e.collapsed){for(var o,a,s=new CKEDITOR.dom.elementPath(i.getParent(),e.root),l=0;l<s.elements.length&&(a=s.elements[l])&&a!=s.block&&a!=s.blockLimit;l++)if(this.checkElementRemovable(a)){var d;!r&&e.collapsed&&(e.checkBoundaryOfElement(a,CKEDITOR.END)||(d=e.checkBoundaryOfElement(a,CKEDITOR.START)))?(o=a,o.match=d?"start":"end"):(a.mergeSiblings(),a.is(this.element)?f.call(this,a):p(a,C(this)[a.getName()]))}if(o){for(r=i,l=0;a=s.elements[l],!a.equals(o);l++)a.match||(a=a.clone(),a.append(r),r=a);r["start"==o.match?"insertBefore":"insertAfter"](o)}}else{var c=n.endNode,h=this;for(t(),s=i;!s.equals(c);)o=s.getNextSourceNode(),s.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(s)&&(s.getName()==this.element?f.call(this,s):p(s,C(this)[s.getName()]),o.type==CKEDITOR.NODE_ELEMENT&&o.contains(i)&&(t(),o=i.getNext())),s=o}e.moveToBookmark(n),e.shrink(CKEDITOR.NODE_ELEMENT,!0)}function r(e){var t=[];return e.forEach(function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1},CKEDITOR.NODE_ELEMENT,!0),t}function o(e){var t=e.getEnclosedNode()||e.getCommonAncestor(!1,!0);(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1))&&!e.isReadOnly()&&_(e,this)}function a(e){var t=e.getCommonAncestor(!0,!0);if(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1)){var t=this._.definition,n=t.attributes;if(n)for(var i in n)e.removeAttribute(i,n[i]);if(t.styles)for(var r in t.styles)t.styles.hasOwnProperty(r)&&e.removeStyle(r)}}function s(e){var t=e.createBookmark(!0),n=e.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var i,r,o=e.document;i=n.getNextParagraph();)!i.isReadOnly()&&(n.activeFilter?n.activeFilter.check(this):1)&&(r=E(this,o,i),d(i,r));e.moveToBookmark(t)}function l(e){var t=e.createBookmark(1),n=e.createIterator();n.enforceRealBlocks=!0,n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;for(var i,r;i=n.getNextParagraph();)this.checkElementRemovable(i)&&(i.is("pre")?((r=this._.enterMode==CKEDITOR.ENTER_BR?null:e.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&i.copyAttributes(r),d(i,r)):f.call(this,i));e.moveToBookmark(t)}function d(e,t){var n=!t;n&&(t=e.getDocument().createElement("div"),e.copyAttributes(t));var i=t&&t.is("pre"),r=e.is("pre"),o=!i&&r;if(i&&!r){if(r=t,(o=e.getBogus())&&o.remove(),o=e.getHtml(),o=h(o,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,""),o=o.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1"),o=o.replace(/([ \t\n\r]+|&nbsp;)/g," "),o=o.replace(/<br\b[^>]*>/gi,"\n"),CKEDITOR.env.ie){var a=e.getDocument().createElement("div");a.append(r),r.$.outerHTML="<pre>"+o+"</pre>",r.copyAttributes(a.getFirst()),r=a.getFirst().remove()}else r.setHtml(o);t=r}else o?t=u(n?[e.getHtml()]:c(e),t):e.moveChildren(t);if(t.replace(e),i){var s,n=t;(s=n.getPrevious(k))&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("pre")&&(i=h(s.getHtml(),/\n$/,"")+"\n\n"+h(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+i+"</pre>":n.setHtml(i),s.remove())}else n&&m(t)}function c(e){var t=[];return h(e.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,function(e,t,n){return t+"</pre>"+n+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(e,n){t.push(n)}),t}function h(e,t,n){var i="",r="";return e=e.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(e,t,n){return t&&(i=t),n&&(r=n),""}),i+e.replace(t,n)+r}function u(e,t){var n;1<e.length&&(n=new CKEDITOR.dom.documentFragment(t.getDocument()));for(var i=0;i<e.length;i++){var r=e[i],r=r.replace(/(\r\n|\r)/g,"\n"),r=h(r,/^[ \t]*\n/,""),r=h(r,/\n$/,""),r=h(r,/^[ \t]+|[ \t]+$/g,function(e,t){return 1==e.length?"&nbsp;":t?" "+CKEDITOR.tools.repeat("&nbsp;",e.length-1):CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "}),r=r.replace(/\n/g,"<br>"),r=r.replace(/[ \t]{2,}/g,function(e){return CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "});if(n){var o=t.clone();o.setHtml(r),n.append(o)}else t.setHtml(r)}return n||t}function f(e,t){var n,i=this._.definition,r=i.attributes,i=i.styles,o=C(this)[e.getName()],a=CKEDITOR.tools.isEmpty(r)&&CKEDITOR.tools.isEmpty(i);for(n in r)("class"!=n&&!this._.definition.fullMatch||e.getAttribute(n)==v(n,r[n]))&&(t&&"data-"==n.slice(0,5)||(a=e.hasAttribute(n),e.removeAttribute(n)));for(var s in i)this._.definition.fullMatch&&e.getStyle(s)!=v(s,i[s],!0)||(a=a||!!e.getStyle(s),e.removeStyle(s));p(e,o,D[e.getName()]),a&&(this._.definition.alwaysRemoveElement?m(e,1):!CKEDITOR.dtd.$block[e.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!e.hasAttributes()?m(e):e.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function g(e){for(var t,n=C(this),i=e.getElementsByTag(this.element),r=i.count();0<=--r;)t=i.getItem(r),t.isReadOnly()||f.call(this,t,!0);for(var o in n)if(o!=this.element)for(i=e.getElementsByTag(o),r=i.count()-1;0<=r;r--)t=i.getItem(r),t.isReadOnly()||p(t,n[o])}function p(e,t,n){if(t=t&&t.attributes)for(var i=0;i<t.length;i++){var r,o=t[i][0];if(r=e.getAttribute(o)){var a=t[i][1];(null===a||a.test&&a.test(r)||"string"==typeof a&&r==a)&&e.removeAttribute(o)}}n||m(e)}function m(e,t){if(!e.hasAttributes()||t)if(CKEDITOR.dtd.$block[e.getName()]){var n=e.getPrevious(k),i=e.getNext(k);!n||n.type!=CKEDITOR.NODE_TEXT&&n.isBlockBoundary({br:1})||e.append("br",1),!i||i.type!=CKEDITOR.NODE_TEXT&&i.isBlockBoundary({br:1})||e.append("br"),e.remove(!0)}else n=e.getFirst(),i=e.getLast(),e.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),i&&!n.equals(i)&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings())}function E(e,t,n){var i;return i=e.element,"*"==i&&(i="span"),i=new CKEDITOR.dom.element(i,t),n&&n.copyAttributes(i),i=_(i,e),t.getCustomData("doc_processing_style")&&i.hasAttribute("id")?i.removeAttribute("id"):t.setCustomData("doc_processing_style",1),i}function _(e,t){var n=t._.definition,i=n.attributes,n=CKEDITOR.style.getStyleText(n);if(i)for(var r in i)e.setAttribute(r,i[r]);return n&&e.setAttribute("style",n),e.getDocument().removeCustomData("doc_processing_style"),e}function T(e,t){for(var n in e)e[n]=e[n].replace(y,function(e,n){return t[n]})}function C(e){if(e._.overrides)return e._.overrides;var t=e._.overrides={},n=e._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var r,o,a=n[i];if("string"==typeof a?r=a.toLowerCase():(r=a.element?a.element.toLowerCase():e.element,o=a.attributes),a=t[r]||(t[r]={}),o){var s,a=a.attributes=a.attributes||[];for(s in o)a.push([s.toLowerCase(),o[s]])}}}return t}function v(e,t,n){var i=new CKEDITOR.dom.element("span");return i[n?"setStyle":"setAttribute"](e,t),i[n?"getStyle":"getAttribute"](e)}function O(e,t){function n(e,t){return"font-family"==t.toLowerCase()?e.replace(/["']/g,""):e}"string"==typeof e&&(e=CKEDITOR.tools.parseCssText(e)),"string"==typeof t&&(t=CKEDITOR.tools.parseCssText(t,!0));for(var i in e)if(!(i in t)||n(t[i],i)!=n(e[i],i)&&"inherit"!=e[i]&&"inherit"!=t[i])return!1;return!0}function I(e,t,n){var i=e.getRanges();t=t?this.removeFromRange:this.applyToRange;for(var r,o=i.createIterator();r=o.getNextRange();)t.call(this,r,n);e.selectRanges(i)}var D={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},R={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},b=/\s*(?:;\s*|$)/,y=/#\((.+?)\)/g,K=CKEDITOR.dom.walker.bookmark(0,1),k=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(e,t){if("string"==typeof e.type)return new CKEDITOR.style.customHandlers[e.type](e);var n=e.attributes;n&&n.style&&(e.styles=CKEDITOR.tools.extend({},e.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),t&&(e=CKEDITOR.tools.clone(e),T(e.attributes,t),T(e.styles,t)),n=this.element=e.element?"string"==typeof e.element?e.element.toLowerCase():e.element:"*",this.type=e.type||(D[n]?CKEDITOR.STYLE_BLOCK:R[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),"object"==typeof this.element&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:e}},CKEDITOR.style.prototype={apply:function(e){if(e instanceof CKEDITOR.dom.document)return I.call(this,e.getSelection());if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),I.call(this,e.getSelection(),0,e),this._.enterMode=t}},remove:function(e){if(e instanceof CKEDITOR.dom.document)return I.call(this,e.getSelection(),1);if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),I.call(this,e.getSelection(),1,e),this._.enterMode=t}},applyToRange:function(e){return this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?s:this.type==CKEDITOR.STYLE_OBJECT?o:null,this.applyToRange(e)},removeFromRange:function(e){return this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?i:this.type==CKEDITOR.STYLE_BLOCK?l:this.type==CKEDITOR.STYLE_OBJECT?a:null,this.removeFromRange(e)},applyToObject:function(e){_(e,this)},checkActive:function(e,t){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(e.block||e.blockLimit,!0,t);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var n,i=e.elements,r=0;r<i.length;r++)if(n=i[r],this.type!=CKEDITOR.STYLE_INLINE||n!=e.block&&n!=e.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var o=n.getName();if(!("string"==typeof this.element?o==this.element:o in this.element))continue}if(this.checkElementRemovable(n,!0,t))return!0}}return!1},checkApplicable:function(e,t,n){if(t&&t instanceof CKEDITOR.filter&&(n=t),n&&!n.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!e.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!e.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(e,t){var n=this._.definition;if(!e||!n.ignoreReadonly&&e.isReadOnly())return!1;var i=e.getName();if("string"==typeof this.element?i==this.element:i in this.element){if(!t&&!e.hasAttributes())return!0;if(i=n._AC)n=i;else{var i={},r=0,o=n.attributes;if(o)for(var a in o)r++,i[a]=o[a];(a=CKEDITOR.style.getStyleText(n))&&(i.style||r++,i.style=a),i._length=r,n=n._AC=i}if(!n._length)return!0;for(var s in n)if("_length"!=s)if(i=e.getAttribute(s)||"","style"==s?O(n[s],i):n[s]==i){if(!t)return!0}else if(t)return!1;if(t)return!0}return!1},checkElementRemovable:function(e,t,n){if(this.checkElementMatch(e,t,n))return!0;if(t=C(this)[e.getName()]){var i;if(!(t=t.attributes))return!0;for(n=0;n<t.length;n++)if(i=t[n][0],i=e.getAttribute(i)){var r=t[n][1];if(null===r)return!0;if("string"==typeof r){if(i==r)return!0}else if(r.test(i))return!0}}return!1},buildPreview:function(e){var t=this._.definition,n=[],i=t.element;"bdo"==i&&(i="span");var n=["<",i],r=t.attributes;if(r)for(var o in r)n.push(" ",o,'="',r[o],'"');return(r=CKEDITOR.style.getStyleText(t))&&n.push(' style="',r,'"'),n.push(">",e||t.name,"</",i,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(e){var t=e._ST;if(t)return t;var t=e.styles,n=e.attributes&&e.attributes.style||"",i="";n.length&&(n=n.replace(b,";"));for(var r in t){var o=t[r],a=(r+":"+o).replace(b,";");"inherit"==o?i+=a:n+=a}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),e._ST=n+i},CKEDITOR.style.customHandlers={},CKEDITOR.style.unstylableElements=[],CKEDITOR.style.addCustomHandler=function(e){var t=function(e){this._={definition:e},this.setup&&this.setup(e)};return t.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},e,!0),this.customHandlers[e.type]=t};var w=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,N=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(e,t){this.requiredContent=this.allowedContent=this.style=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.styleCommand.prototype.exec=function(e){e.focus(),this.state==CKEDITOR.TRISTATE_OFF?e.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&e.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(e,t,n){CKEDITOR.stylesSet.addExternal(e,t,""),CKEDITOR.stylesSet.load(e,n)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(e,t){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",function(e){for(var t=0;t<n.length;t++){var i=n[t],r=i.style.checkActive(e.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;i.fn.call(this,r)}})),n.push({style:e,fn:t})},applyStyle:function(e){e.apply(this)},removeStyle:function(e){e.remove(this)},getStylesSet:function(e){if(this._.stylesDefinitions)e(this._.stylesDefinitions);else{var t=this,n=t.config.stylesCombo_stylesSet||t.config.stylesSet;if(!1===n)e(null);else if(n instanceof Array)t._.stylesDefinitions=n,e(n);else{n||(n="default");var n=n.split(":"),i=n[0];CKEDITOR.stylesSet.addExternal(i,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(i,function(n){t._.stylesDefinitions=n[i],e(t._.stylesDefinitions)})}}}}),function(){if(window.Promise)CKEDITOR.tools.promise=Promise;else{var e=CKEDITOR.getUrl("vendor/promise.js");if("function"==typeof window.define&&window.define.amd&&"function"==typeof window.require)return window.require([e],function(e){CKEDITOR.tools.promise=e});CKEDITOR.scriptLoader.load(e,function(t){return t?void 0!==window.ES6Promise?CKEDITOR.tools.promise=ES6Promise:void 0:CKEDITOR.error("no-vendor-lib",{path:e})})}}(),function(){function e(e,i,r){e.once("selectionCheck",function(e){if(!t){var o=e.data.getRanges()[0];r.equals(o)?e.cancel():i.equals(o)&&(n=!0)}},null,null,-1)}var t=!0,n=!1;CKEDITOR.dom.selection.setupEditorOptimization=function(e){e.on("selectionCheck",function(e){e.data&&!n&&e.data.optimizeInElementEnds(),n=!1}),e.on("contentDom",function(){var t=e.editable();t&&(t.attachListener(t,"keydown",function(e){this._.shiftPressed=e.data.$.shiftKey},this),t.attachListener(t,"keyup",function(e){this._.shiftPressed=e.data.$.shiftKey},this))})},CKEDITOR.dom.selection.prototype.optimizeInElementEnds=function(){var n,i=this.getRanges()[0],r=this.root.editor;if(this.root.editor._.shiftPressed||this.isFake||i.isCollapsed||i.startContainer.equals(i.endContainer)||(i.endContainer.is?i.endContainer.is("li"):i.endContainer.getParent().is&&i.endContainer.getParent().is("li")))n=!1;else if(0===i.endOffset)n=!0;else{n=i.startContainer.type===CKEDITOR.NODE_TEXT;var o=i.endContainer.type===CKEDITOR.NODE_TEXT,a=n?i.startContainer.getLength():i.startContainer.getChildCount();n=i.startOffset===a||n^o}n&&(n=i.clone(),i.shrink(CKEDITOR.SHRINK_TEXT,!1,{skipBogus:!CKEDITOR.env.webkit}),t=!1,e(r,i,n),i.select(),t=!0)}}(),function(){function e(e,t){return n(e)?e=Math.round(t*(parseFloat(e)/100)):("string"==typeof e&&e.match(/^\d+$/gm)||"string"==typeof e&&e.match(/^\d+(?:deg)?$/gm))&&(e=parseInt(e,10)),e}function t(e,t){return n(e)?e=t*(parseFloat(e)/100):"string"==typeof e&&e.match(/^\d?\.\d+/gm)&&(e=parseFloat(e)),e}function n(e){return"string"==typeof e&&e.match(/^((\d*\.\d+)|(\d+))%{1}$/gm)}function i(e,t,n){return!isNaN(e)&&e>=t&&e<=n}function r(e){return e=e.toString(16),1==e.length?"0"+e:e}CKEDITOR.tools.color=CKEDITOR.tools.createClass({$:function(e,t){this._.initialColorCode=e,this._.defaultValue=t,this._.parseInput(e)},proto:{getHex:function(){if(!this._.isValidColor)return this._.defaultValue;var e=this._.blendAlphaColor(this._.red,this._.green,this._.blue,this._.alpha);return this._.formatHexString(e[0],e[1],e[2])},getHexWithAlpha:function(){if(!this._.isValidColor)return this._.defaultValue;var e=Math.round(this._.alpha*CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE);return this._.formatHexString(this._.red,this._.green,this._.blue,e)},getRgb:function(){if(!this._.isValidColor)return this._.defaultValue;var e=this._.blendAlphaColor(this._.red,this._.green,this._.blue,this._.alpha);return this._.formatRgbString("rgb",e[0],e[1],e[2])},getRgba:function(){return this._.isValidColor?this._.formatRgbString("rgba",this._.red,this._.green,this._.blue,this._.alpha):this._.defaultValue},getHsl:function(){var e=0===this._.alpha||1===this._.alpha;return this._.isValidColor?(this._.type===CKEDITOR.tools.color.TYPE_HSL&&e?e=[this._.hue,this._.saturation,this._.lightness]:(e=this._.blendAlphaColor(this._.red,this._.green,this._.blue,this._.alpha),e=this._.rgbToHsl(e[0],e[1],e[2])),this._.formatHslString("hsl",e[0],e[1],e[2])):this._.defaultValue},getHsla:function(){var e;return this._.isValidColor?(e=this._.type===CKEDITOR.tools.color.TYPE_HSL?[this._.hue,this._.saturation,this._.lightness]:this._.rgbToHsl(this._.red,this._.green,this._.blue),this._.formatHslString("hsla",e[0],e[1],e[2],this._.alpha)):this._.defaultValue},getInitialValue:function(){return this._.initialColorCode}},_:{initialColorCode:"",isValidColor:!0,type:0,hue:0,saturation:0,lightness:0,red:0,green:0,blue:0,alpha:1,blendAlphaColor:function(e,t,n,i){return CKEDITOR.tools.array.map([e,t,n],function(e){return Math.round(CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE-i*(CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE-e))})},formatHexString:function(e,t,n,i){return e="#"+r(e)+r(t)+r(n),void 0!==i&&(e+=r(i)),e.toUpperCase()},formatRgbString:function(e,t,n,i,r){return t=[t,n,i],void 0!==r&&t.push(r),e+"("+t.join(",")+")"},formatHslString:function(e,t,n,i,r){return e+"("+t+","+n+"%,"+i+"%"+(void 0!==r?","+r:"")+")"},parseInput:function(e){if("string"!=typeof e)this._.isValidColor=!1;else{e=CKEDITOR.tools.trim(e);var t=this._.matchStringToNamedColor(e);t&&(e=t);var t=this._.extractColorChannelsFromHex(e),n=this._.extractColorChannelsFromRgba(e);e=this._.extractColorChannelsFromHsla(e),(e=t||n||e)?(this._.type=e.type,this._.red=e.red,this._.green=e.green,this._.blue=e.blue,this._.alpha=e.alpha,e.type===CKEDITOR.tools.color.TYPE_HSL&&(this._.hue=e.hue,this._.saturation=e.saturation,this._.lightness=e.lightness)):this._.isValidColor=!1}},matchStringToNamedColor:function(e){return CKEDITOR.tools.color.namedColors[e.toLowerCase()]||null},extractColorChannelsFromHex:function(e){if(-1===e.indexOf("#")&&(e="#"+e),e.match(CKEDITOR.tools.color.hex3CharsRegExp)&&(e=this._.hex3ToHex6(e)),e.match(CKEDITOR.tools.color.hex4CharsRegExp)&&(e=this._.hex4ToHex8(e)),!e.match(CKEDITOR.tools.color.hex6CharsRegExp)&&!e.match(CKEDITOR.tools.color.hex8CharsRegExp))return null;e=e.split("");var t=1;return e[7]&&e[8]&&(t=parseInt(e[7]+e[8],16),t/=CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE,t=Number(t.toFixed(1))),{type:CKEDITOR.tools.color.TYPE_RGB,red:parseInt(e[1]+e[2],16),green:parseInt(e[3]+e[4],16),blue:parseInt(e[5]+e[6],16),alpha:t}},extractColorChannelsFromRgba:function(n){var i=this._.extractColorChannelsByPattern(n,CKEDITOR.tools.color.rgbRegExp);if(!i||3>i.length||4<i.length)return null;var r=4===i.length;n=e(i[0],CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE);var o=e(i[1],CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE),a=e(i[2],CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE),s=1;return r&&(s=t(i[3],CKEDITOR.tools.color.MAX_ALPHA_CHANNEL_VALUE)),i={type:CKEDITOR.tools.color.TYPE_RGB,red:n,green:o,blue:a,alpha:s},this._.areColorChannelsValid(n,o,a,s)?i:null},extractColorChannelsFromHsla:function(n){var i=this._.extractColorChannelsByPattern(n,CKEDITOR.tools.color.hslRegExp);if(!i||3>i.length||4<i.length)return null;var r=4===i.length,o=e(i[0],CKEDITOR.tools.color.MAX_HUE_CHANNEL_VALUE),a=t(i[1],CKEDITOR.tools.color.MAX_SATURATION_LIGHTNESS_CHANNEL_VALUE),s=t(i[2],CKEDITOR.tools.color.MAX_SATURATION_LIGHTNESS_CHANNEL_VALUE),l=1;return n=this._.hslToRgb(o,a,s),r&&(l=t(i[3],CKEDITOR.tools.color.MAX_ALPHA_CHANNEL_VALUE)),n.push(l),i={type:CKEDITOR.tools.color.TYPE_HSL,red:n[0],green:n[1],blue:n[2],alpha:n[3],hue:o,saturation:Math.round(100*a),lightness:Math.round(100*s)},this._.areColorChannelsValid(n[0],n[1],n[2],n[3])?i:null},hex3ToHex6:function(e){return e=e.split(""),"#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]},hex4ToHex8:function(e){return this._.hex3ToHex6(e.substr(0,4))+CKEDITOR.tools.repeat(e[4],2)},extractColorChannelsByPattern:function(e,t){var n=e.match(t);if(!n)return null;var i=-1===n[1].indexOf(",")?/\s/:",",i=n[1].split(i),i=CKEDITOR.tools.array.reduce(i,function(e,t){var n=CKEDITOR.tools.trim(t);return 0===n.length?e:e.concat([n])},[]);return n[2]&&(n=CKEDITOR.tools.trim(n[2].replace(/[\/,]/,"")),i.push(n)),i},areColorChannelsValid:function(e,t,n,r){return i(e,0,CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)&&i(t,0,CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)&&i(n,0,CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)&&i(r,0,CKEDITOR.tools.color.MAX_ALPHA_CHANNEL_VALUE)},hslToRgb:function(e,t,n){var i=function(i){var r=(i+e/30)%12;return i=t*Math.min(n,1-n),r=Math.min(r-3,9-r,1),r=Math.max(-1,r),Math.round((n-i*r)*CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE)};return[i(0),i(8),i(4)]},rgbToHsl:function(e,t,n){e/=CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE,t/=CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE;var i=n/CKEDITOR.tools.color.MAX_RGB_CHANNEL_VALUE,r=Math.max(e,t,i),o=Math.min(e,t,i);n=r-o;var a=0;switch(r){case e:a=(t-i)/n%6;break;case t:a=(i-e)/n+2;break;case i:a=(e-t)/n+4}return e=0===n?0:60*a,t=(r+o)/2,r=0,1!==t&&0!==t&&(r=n/(1-Math.abs(2*t-1))),e=Math.round(e),r=Math.round(100*r),t=Math.round(100*t),[e,r,t]}},statics:{TYPE_RGB:1,TYPE_HSL:2,MAX_RGB_CHANNEL_VALUE:255,MAX_ALPHA_CHANNEL_VALUE:1,MAX_HUE_CHANNEL_VALUE:360,MAX_SATURATION_LIGHTNESS_CHANNEL_VALUE:1,hex3CharsRegExp:/#([0-9a-f]{3}$)/gim,hex4CharsRegExp:/#([0-9a-f]{4}$)/gim,hex6CharsRegExp:/#([0-9a-f]{6}$)/gim,hex8CharsRegExp:/#([0-9a-f]{8}$)/gim,rgbRegExp:/rgba?\(([.,\d\s%]*)(\s*\/\s*[\d.%]+)?\s*\)/i,hslRegExp:/hsla?\((\s*(?:[.\d]+(?:deg)?)(?:\s*,?\s*[.\d]+%){2})((?:(?:\s*\/\s*)|(?:\s*,\s*))[\d.]+%?)?\s*\)/i,namedColors:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",windowtext:"windowtext",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"}}}),CKEDITOR.tools.style.parse._colors=CKEDITOR.tools.color.namedColors}(),CKEDITOR.dom.comment=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createComment(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"\x3c!--"+this.$.nodeValue+"--\x3e"}}),function(){var e,t={},n={};for(e in CKEDITOR.dtd.$blockLimit)e in CKEDITOR.dtd.$list||(t[e]=1);for(e in CKEDITOR.dtd.$block)e in CKEDITOR.dtd.$blockLimit||e in CKEDITOR.dtd.$empty||(n[e]=1);CKEDITOR.dom.elementPath=function(e,i){var r,o=null,a=null,s=[],l=e;i=i||e.getDocument().getBody(),l||(l=i);do{if(l.type==CKEDITOR.NODE_ELEMENT){if(s.push(l),!this.lastElement&&(this.lastElement=l,l.is(CKEDITOR.dtd.$object)||"false"==l.getAttribute("contenteditable")))continue;if(l.equals(i))break;if(!a&&(r=l.getName(),"true"==l.getAttribute("contenteditable")?a=l:!o&&n[r]&&(o=l),t[r])){if(r=!o&&"div"==r){e:{r=l.getChildren();for(var d=0,c=r.count();d<c;d++){var h=r.getItem(d);if(h.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[h.getName()]){r=!0;break e}}r=!1}r=!r}r?o=l:a=l}}}while(l=l.getParent());a||(a=i),this.block=o,this.blockLimit=a,this.root=i,this.elements=s}}(),CKEDITOR.dom.elementPath.prototype={compare:function(e){var t=this.elements;if(!(e=e&&e.elements)||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0},contains:function(e,t,n){var i,r=0;"string"==typeof e&&(i=function(t){return t.getName()==e}),e instanceof CKEDITOR.dom.element?i=function(t){return t.equals(e)}:CKEDITOR.tools.isArray(e)?i=function(t){return-1<CKEDITOR.tools.indexOf(e,t.getName())}:"function"==typeof e?i=e:"object"==typeof e&&(i=function(t){return t.getName()in e});var o=this.elements,a=o.length;for(t&&(n?r+=1:--a),n&&(o=Array.prototype.slice.call(o,0),o.reverse());r<a;r++)if(i(o[r]))return o[r];return null},isContextFor:function(e){var t;return!(e in CKEDITOR.dtd.$block)||(t=this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit,!!t.getDtd()[e])},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(e,t){
"string"==typeof e&&(e=(t?t.$:document).createTextNode(e)),this.$=e},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(e){this.$.nodeValue=e},isEmpty:function(e){var t=this.getText();return e&&(t=CKEDITOR.tools.trim(t)),!t||t===CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE},split:function(e){var t=this.$.parentNode,n=t.childNodes.length,i=this.getLength(),r=this.getDocument(),o=new CKEDITOR.dom.text(this.$.splitText(e),r);return t.childNodes.length==n&&(e>=i?(o=r.createText(""),o.insertAfter(this)):(e=r.createText(""),e.insertAfter(o),e.remove())),o},substring:function(e,t){return"number"!=typeof t?this.$.nodeValue.substr(e):this.$.nodeValue.substring(e,t)}}),function(){function e(e,t,n){var i=e.serializable,r=t[n?"endContainer":"startContainer"],o=n?"endOffset":"startOffset",a=i?t.document.getById(e.startNode):e.startNode;return e=i?t.document.getById(e.endNode):e.endNode,r.equals(a.getPrevious())?(t.startOffset=t.startOffset-r.getLength()-e.getPrevious().getLength(),r=e.getNext()):r.equals(e.getPrevious())&&(t.startOffset-=r.getLength(),r=e.getNext()),r.equals(a.getParent())&&t[o]++,r.equals(e.getParent())&&t[o]++,t[n?"endContainer":"startContainer"]=r,t}CKEDITOR.dom.rangeList=function(e){return e instanceof CKEDITOR.dom.rangeList?e:(e?e instanceof CKEDITOR.dom.range&&(e=[e]):e=[],CKEDITOR.tools.extend(e,t))};var t={createIterator:function(){var e,t=this,n=CKEDITOR.dom.walker.bookmark(),i=[];return{getNextRange:function(r){e=void 0===e?0:e+1;var o=t[e];if(o&&1<t.length){if(!e)for(var a=t.length-1;0<=a;a--)i.unshift(t[a].createBookmark(!0));if(r)for(var s=0;t[e+s+1];){var l=o.document;for(r=0,a=l.getById(i[s].endNode),l=l.getById(i[s+1].startNode);;){if(a=a.getNextSourceNode(!1),l.equals(a))r=1;else if(n(a)||a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary())continue;break}if(!r)break;s++}for(o.moveToBookmark(i.shift());s--;)a=t[++e],a.moveToBookmark(i.shift()),o.setEnd(a.endContainer,a.endOffset)}return o}}},createBookmarks:function(t){for(var n,i=[],r=0;r<this.length;r++){i.push(n=this[r].createBookmark(t,!0));for(var o=r+1;o<this.length;o++)this[o]=e(n,this[o]),this[o]=e(n,this[o],!0)}return i},createBookmarks2:function(e){for(var t=[],n=0;n<this.length;n++)t.push(this[n].createBookmark2(e));return t},moveToBookmarks:function(e){for(var t=0;t<this.length;t++)this[t].moveToBookmark(e[t])}}}(),function(){function e(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function t(t){var n=CKEDITOR.skin["ua_"+t],i=CKEDITOR.env;if(n)for(var r,n=n.split(",").sort(function(e,t){return e>t?-1:1}),o=0;o<n.length;o++)if(r=n[o],i.ie&&(r.replace(/^ie/,"")==i.version||i.quirks&&"iequirks"==r)&&(r="ie"),i[r]){t+="_"+n[o];break}return CKEDITOR.getUrl(e()+t+".css")}function n(e,n){o[e]||(CKEDITOR.document.appendStyleSheet(t(e)),o[e]=1),n&&n()}function i(e){var t=e.getById(a);return t||(t=e.getHead().append("style"),t.setAttribute("id",a),t.setAttribute("type","text/css")),t}function r(e,t,n){var i,r,o;if(CKEDITOR.env.webkit)for(t=t.split("}").slice(0,-1),r=0;r<t.length;r++)t[r]=t[r].split("{");for(var a=0;a<e.length;a++)if(CKEDITOR.env.webkit)for(r=0;r<t.length;r++){for(o=t[r][1],i=0;i<n.length;i++)o=o.replace(n[i][0],n[i][1]);e[a].$.sheet.addRule(t[r][0],o)}else{for(o=t,i=0;i<n.length;i++)o=o.replace(n[i][0],n[i][1]);CKEDITOR.env.ie&&11>CKEDITOR.env.version?e[a].$.styleSheet.cssText+=o:e[a].$.innerHTML+=o}}var o={};CKEDITOR.skin={path:e,loadPart:function(t,i){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e()+"skin.js"),function(){n(t,i)}):n(t,i)},getPath:function(e){return CKEDITOR.getUrl(t(e))},icons:{},addIcon:function(e,t,n,i){e=e.toLowerCase(),this.icons[e]||(this.icons[e]={path:t,offset:n||0,bgsize:i||"16px"})},getIconStyle:function(e,t,n,i,r){var o;return e&&(e=e.toLowerCase(),t&&(o=this.icons[e+"-rtl"]),o||(o=this.icons[e])),e=n||o&&o.path||"",i=i||o&&o.offset,r=r||o&&o.bgsize||"16px",e&&(e=e.replace(/'/g,"\\'")),e&&"background-image:url('"+CKEDITOR.getUrl(e)+"');background-position:0 "+i+"px;background-size:"+r+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(e){var t=i(CKEDITOR.document);return(this.setUiColor=function(e){this.uiColor=e;var n=CKEDITOR.skin.chameleon,i="",o="";"function"==typeof n&&(i=n(this,"editor"),o=n(this,"panel")),e=[[l,e]],r([t],i,e),r(s,o,e)}).call(this,e)}});var a="cke_ui_color",s=[],l=/\$color/g;CKEDITOR.on("instanceLoaded",function(e){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var t=e.editor;e=function(e){if(e=(e.data[0]||e.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument(),!e.getById("cke_ui_color")){var n=i(e);s.push(n),t.on("destroy",function(){s=CKEDITOR.tools.array.filter(s,function(e){return n!==e})}),(e=t.getUiColor())&&r([n],CKEDITOR.skin.chameleon(t,"panel"),[[l,e]])}},t.on("panelShow",e),t.on("menuShow",e),t.config.uiColor&&t.setUiColor(t.config.uiColor)}})}(),function(){var e=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);e.appendTo(CKEDITOR.document.getHead());try{var t=e.getComputedStyle("border-top-color"),n=e.getComputedStyle("border-right-color");CKEDITOR.env.hc=!(!t||t!=n)}catch(e){CKEDITOR.env.hc=!1}if(e.remove(),CKEDITOR.env.hc&&(CKEDITOR.env.cssClass+=" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded"),e=CKEDITOR._.pending)for(delete CKEDITOR._.pending,t=0;t<e.length;t++)CKEDITOR.editor.prototype.constructor.apply(e[t][0],e[t][1]),CKEDITOR.add(e[t][0])}(),CKEDITOR.skin.name="minimalist",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8",CKEDITOR.skin.chameleon=function(){var e=function(){return function(e,t){for(var n=e.match(/[^#]./g),i=0;3>i;i++){var r,o=n,a=i;r=parseInt(n[i],16),r=("0"+(0>t?0|r*(1+t):0|r+(255-r)*t).toString(16)).slice(-2),o[a]=r}return"#"+n.join("")}}(),t=function(){var e=new CKEDITOR.template("background:#{to};background-image:-webkit-gradient(linear,lefttop,leftbottom,from({from}),to({to}));background-image:-moz-linear-gradient(top,{from},{to});background-image:-webkit-linear-gradient(top,{from},{to});background-image:-o-linear-gradient(top,{from},{to});background-image:-ms-linear-gradient(top,{from},{to});background-image:linear-gradient(top,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');");return function(t,n){return e.output({from:t,to:n})}}(),n={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(i,r){var o=i.uiColor,o={id:"."+i.id,defaultBorder:e(o,-.1),defaultGradient:t(e(o,.9),o),lightGradient:t(e(o,1),e(o,.7)),mediumGradient:t(e(o,.8),e(o,.5)),ckeButtonOn:t(e(o,.6),e(o,.7)),ckeResizer:e(o,-.4),ckeToolbarSeparator:e(o,.5),ckeColorauto:e(o,.8),dialogBody:e(o,.7),dialogTabSelected:t("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:e(o,-.6),elementsPathBg:o,menubuttonIcon:e(o,.5),menubuttonIconHover:e(o,.3)};return n[r].output(o).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var e=function(e){this._||(this._={}),this._.default=this._.initValue=e.default||"",this._.required=e.required||!1;for(var t=[this._],n=1;n<arguments.length;n++)t.push(arguments[n]);return t.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,t),this._},t={build:function(e,t,n){return new CKEDITOR.ui.dialog.textInput(e,t,n)}},n={build:function(e,t,n){return new CKEDITOR.ui.dialog[t.type](e,t,n)}},i={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(e){this.setValue(this.getInitValue(),e)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._.default},getInitValue:function(){return this._.initValue}},r=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(e,t){this._.domOnChangeRegistered||(e.on("load",function(){this.getInputElement().on("change",function(){e.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",t)}},!0),o=/^on([A-Z]\w+)/,a=function(e){for(var t in e)(o.test(t)||"title"==t||"type"==t)&&delete e[t];return e},s=function(e){e=e.data.getKeystroke(),e==CKEDITOR.SHIFT+CKEDITOR.ALT+36?this.setDirectionMarker("ltr"):e==CKEDITOR.SHIFT+CKEDITOR.ALT+35&&this.setDirectionMarker("rtl")};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(t,n,i,r){if(!(4>arguments.length)){var o=e.call(this,n);o.labelId=CKEDITOR.tools.getNextId()+"_label",this._.children=[];var a={role:n.role||"presentation"};n.includeLabel&&(a["aria-labelledby"]=o.labelId),CKEDITOR.ui.dialog.uiElement.call(this,t,n,i,"div",null,a,function(){var e=[],i=n.required?" cke_required":"";return"horizontal"!=n.labelLayout?e.push('<label class="cke_dialog_ui_labeled_label'+i+'" ',' id="'+o.labelId+'"',o.inputId?' for="'+o.inputId+'"':"",(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",n.required?n.label+'<span class="cke_dialog_ui_labeled_required" aria-hidden="true">*</span>':n.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',n.controlStyle?' style="'+n.controlStyle+'"':"",' role="presentation">',r.call(this,t,n),"</div>"):(i={type:"hbox",widths:n.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+i+'" id="'+o.labelId+'" for="'+o.inputId+'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(n.label)+"</label>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(n.controlStyle?' style="'+n.controlStyle+'"':"")+">"+r.call(this,t,n)+"</span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(t,i,e)),e.join("")})}},textInput:function(t,n,i){if(!(3>arguments.length)){e.call(this,n);var r=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",o={class:"cke_dialog_ui_input_"+n.type,id:r,type:n.type};n.validate&&(this.validate=n.validate),n.maxLength&&(o.maxlength=n.maxLength),n.size&&(o.size=n.size),n.inputStyle&&(o.style=n.inputStyle);var a=this,l=!1;t.on("load",function(){a.getInputElement().on("keydown",function(e){13==e.data.getKeystroke()&&(l=!0)}),a.getInputElement().on("keyup",function(e){13==e.data.getKeystroke()&&l&&(t.getButton("ok")&&setTimeout(function(){t.getButton("ok").click()},0),l=!1),a.bidi&&s.call(a,e)},null,null,1e3)}),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){var e=['<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'];n.width&&e.push('style="width:'+n.width+'" '),e.push("><input "),o["aria-labelledby"]=this._.labelId,this._.required&&(o["aria-required"]=this._.required);for(var t in o)e.push(t+'="'+o[t]+'" ');return e.push(" /></div>"),e.join("")})}},textarea:function(t,n,i){if(!(3>arguments.length)){e.call(this,n);var r=this,o=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",a={};n.validate&&(this.validate=n.validate),a.rows=n.rows||5,a.cols=n.cols||20,a.class="cke_dialog_ui_input_textarea "+(n.class||""),void 0!==n.inputStyle&&(a.style=n.inputStyle),n.dir&&(a.dir=n.dir),r.bidi&&t.on("load",function(){r.getInputElement().on("keyup",s)},r),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){a["aria-labelledby"]=this._.labelId,this._.required&&(a["aria-required"]=this._.required);var e,t=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',o,'" '];for(e in a)t.push(e+'="'+CKEDITOR.tools.htmlEncode(a[e])+'" ');return t.push(">",CKEDITOR.tools.htmlEncode(r._.default),"</textarea></div>"),t.join("")})}},checkbox:function(t,n,i){if(!(3>arguments.length)){var r=e.call(this,n,{default:!!n.default});n.validate&&(this.validate=n.validate),CKEDITOR.ui.dialog.uiElement.call(this,t,n,i,"span",null,null,function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},!0),i=[],o=CKEDITOR.tools.getNextId()+"_label",s={class:"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":o};return a(e),n.default&&(s.checked="checked"),void 0!==e.inputStyle&&(e.style=e.inputStyle),r.checkbox=new CKEDITOR.ui.dialog.uiElement(t,e,i,"input",null,s),i.push(' <label id="',o,'" for="',s.id,'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(n.label),"</label>"),i.join("")})}},radio:function(t,n,i){if(!(3>arguments.length)){e.call(this,n),this._.default||(this._.default=this._.initValue=n.items[0][1]),n.validate&&(this.validate=n.validate);var r=[],o=this;n.role="radiogroup",n.includeLabel=!0,CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){for(var e=[],i=[],s=(n.id?n.id:CKEDITOR.tools.getNextId())+"_radio",l=0;l<n.items.length;l++){var d=n.items[l],c=void 0!==d[2]?d[2]:d[0],h=void 0!==d[1]?d[1]:d[0],u=CKEDITOR.tools.getNextId()+"_radio_input",f=u+"_label",u=CKEDITOR.tools.extend({},n,{id:u,title:null,type:null},!0),c=CKEDITOR.tools.extend({},u,{title:c},!0),g={type:"radio",class:"cke_dialog_ui_radio_input",name:s,value:h,"aria-labelledby":f},p=[];o._.default==h&&(g.checked="checked"),a(u),a(c),void 0!==u.inputStyle&&(u.style=u.inputStyle),h=new CKEDITOR.ui.dialog.uiElement(t,u,p,"input",null,g),h.on("focus",function(){o.click()}),r.push(h),p.push(" "),new CKEDITOR.ui.dialog.uiElement(t,c,p,"label",null,{id:f,for:g.id},d[0]),e.push(p.join(""))}return new CKEDITOR.ui.dialog.hbox(t,r,e,i),i.join("")}),this._.children=r}},button:function(t,n,i){if(arguments.length){"function"==typeof n&&(n=n(t.getParentEditor())),e.call(this,n,{disabled:n.disabled||!1}),CKEDITOR.event.implementOn(this);var r=this;t.on("load",function(){var e=this.getElement();!function(){e.on("click",function(e){r.click(),e.data.preventDefault()}),e.on("keydown",function(e){e.data.getKeystroke()in{32:1}&&(r.click(),e.data.preventDefault())})}(),e.unselectable()},this);var o=CKEDITOR.tools.extend({},n);delete o.style;var a=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,t,o,i,"a",null,{style:n.style,href:"javascript:void(0)",title:n.label,hidefocus:"true",class:n.class,role:"button","aria-labelledby":a},'<span id="'+a+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(n.label)+"</span>")}},select:function(t,n,i){if(!(3>arguments.length)){var r=e.call(this,n);n.validate&&(this.validate=n.validate),r.inputId=CKEDITOR.tools.getNextId()+"_select",CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_select":CKEDITOR.tools.getNextId()+"_select"},!0),i=[],o=[],s={id:r.inputId,class:"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};i.push('<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'),n.width&&i.push('style="width:'+n.width+'" '),i.push(">"),void 0!==n.size&&(s.size=n.size),void 0!==n.multiple&&(s.multiple=n.multiple),a(e);for(var l,d=0;d<n.items.length&&(l=n.items[d]);d++)o.push('<option value="',CKEDITOR.tools.htmlEncode(void 0!==l[1]?l[1]:l[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(l[0]));return void 0!==e.inputStyle&&(e.style=e.inputStyle),r.select=new CKEDITOR.ui.dialog.uiElement(t,e,i,"select",null,s,o.join("")),i.push("</div>"),i.join("")})}},file:function(t,n,i){if(!(3>arguments.length)){void 0===n.default&&(n.default="");var r=CKEDITOR.tools.extend(e.call(this,n),{definition:n,buttons:[]});n.validate&&(this.validate=n.validate),t.on("load",function(){CKEDITOR.document.getById(r.frameId).getParent().addClass("cke_dialog_ui_input_file")}),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,i,function(){r.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var e=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',r.frameId,'" title="',n.label,'" src="javascript:void('];return e.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0"),e.push(')"></iframe>'),e.join("")})}},fileButton:function(t,n,i){var r=this;if(!(3>arguments.length)){e.call(this,n),n.validate&&(this.validate=n.validate);var o=CKEDITOR.tools.extend({},n),a=o.onClick;o.className=(o.className?o.className+" ":"")+"cke_dialog_ui_button",o.onClick=function(e){var i=n.for;!1!==(e=!!a&&a.call(this,e))&&("xhr"!==e&&t.getContentElement(i[0],i[1]).submit(),this.disable())},t.on("load",function(){t.getContentElement(n.for[0],n.for[1])._.buttons.push(r)}),CKEDITOR.ui.dialog.button.call(this,t,o,i)}},html:function(){var e=/^\s*<[\w:]+\s+([^>]*)?>/,t=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,n=/\/$/;return function(i,r,o){if(!(3>arguments.length)){var a=[],s=r.html;"<"!=s.charAt(0)&&(s="<span>"+s+"</span>");var l=r.focus;if(l){var d=this.focus;this.focus=function(){("function"==typeof l?l:d).call(this),this.fire("focus")},r.isFocusable&&(this.isFocusable=this.isFocusable),this.keyboardFocusable=!0}CKEDITOR.ui.dialog.uiElement.call(this,i,r,a,"span",null,null,""),a=a.join("").match(e),s=s.match(t)||["","",""],n.test(s[1])&&(s[1]=s[1].slice(0,-1),s[2]="/"+s[2]),o.push([s[1]," ",a[1]||"",s[2]].join(""))}}}(),fieldset:function(e,t,n,i,r){var o=r.label;this._={children:t},CKEDITOR.ui.dialog.uiElement.call(this,e,r,i,"fieldset",null,null,function(){var e=[];o&&e.push("<legend"+(r.labelStyle?' style="'+r.labelStyle+'"':"")+">"+o+"</legend>");for(var t=0;t<n.length;t++)e.push(n[t]);return e.join("")})}},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(e){var t=CKEDITOR.document.getById(this._.labelId);return 1>t.getChildCount()?new CKEDITOR.dom.text(e,CKEDITOR.document).appendTo(t):t.getChild(0).$.nodeValue=e,this},getLabel:function(){var e=CKEDITOR.document.getById(this._.labelId);return!e||1>e.getChildCount()?"":e.getChild(0).getText()},eventProcessors:r},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return!this._.disabled&&this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var e=this.getElement();e&&e.removeClass("cke_disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(e,t){this.on("click",function(){t.apply(this,arguments)})}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var e=this.selectParentTab();setTimeout(function(){var t=e.getInputElement();t&&t.$.focus()},0)},select:function(){var e=this.selectParentTab();setTimeout(function(){var t=e.getInputElement();t&&(t.$.focus(),t.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(e){if(this.bidi){var t=e&&e.charAt(0);(t="\u202a"==t?"ltr":"\u202b"==t?"rtl":null)&&(e=e.slice(1)),this.setDirectionMarker(t)}return e||(e=""),CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},getValue:function(){var e=CKEDITOR.ui.dialog.uiElement.prototype.getValue.call(this);if(this.bidi&&e){var t=this.getDirectionMarker();t&&(e=("ltr"==t?"\u202a":"\u202b")+e)}return e},setDirectionMarker:function(e){var t=this.getInputElement();e?t.setAttributes({dir:e,"data-cke-dir-marker":e}):this.getDirectionMarker()&&t.removeAttributes(["dir","data-cke-dir-marker"])},getDirectionMarker:function(){return this.getInputElement().data("cke-dir-marker")},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(e,t,n){var i=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),r=this.getInputElement().$;return i.$.text=e,i.$.value=void 0===t||null===t?e:t,void 0===n||null===n?CKEDITOR.env.ie?r.add(i.$):r.add(i.$,null):r.add(i.$,n),this},remove:function(e){return this.getInputElement().$.remove(e),this},clear:function(){for(var e=this.getInputElement().$;0<e.length;)e.remove(0);return this},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(e,t){return this.getInputElement().$.checked=e,!t&&this.fire("change",{value:e}),this},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?r.onChange.apply(this,arguments):(e.on("load",function(){var e=this._.checkbox.getElement();e.on("propertychange",function(t){t=t.data.$,"checked"==t.propertyName&&this.fire("change",{value:e.$.checked})},this)},this),this.on("change",t),null)}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{focus:function(){var e=this._.children,t=e[0],n=this._.dialog._,i=n.currentFocusIndex,r=i===n.focusList.length-1&&0===this.focusIndex;for(i>this.focusIndex&&!r&&(t=e[e.length-1]),n.currentFocusIndex=this.focusIndex,n=0;n<e.length;n++)if(i=e[n],i.getInputElement().$.checked){t=i;break}t.focus()},setValue:function(e,t){for(var n,i=this._.children,r=0;r<i.length&&(n=i[r]);r++)n.getElement().$.checked=n.getValue()==e;return!t&&this.fire("change",{value:e}),this},getValue:function(){for(var e=this._.children,t=0;t<e.length;t++)if(e[t].getElement().$.checked)return e[t].getValue();return null},accessKeyUp:function(){var e,t=this._.children;for(e=0;e<t.length;e++)if(t[e].getElement().$.checked)return void t[e].getElement().focus();t[0].getElement().focus()},click:function(){this._.dialog._.currentFocusIndex=this.focusIndex},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?r.onChange.apply(this,arguments):(e.on("load",function(){for(var e=this._.children,t=this,n=0;n<e.length;n++)e[n].getElement().on("propertychange",function(e){e=e.data.$,"checked"==e.propertyName&&this.$.checked&&t.fire("change",{value:this.getAttribute("value")})})},this),this.on("change",t),null)}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,i,{getInputElement:function(){var e=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return 0<e.$.forms.length?new CKEDITOR.dom.element(e.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(e){var t,n,i=/^on([A-Z]\w+)/;for(n in e)(t=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,e[n]):function(e,t,n,i){e.on("formLoaded",function(){e.getInputElement().on(n,i,e)})}(this,this._.dialog,t[1].toLowerCase(),e[n]));return this},reset:function(){function e(){n.$.open();var e="";i.size&&(e=i.size-(CKEDITOR.env.ie?7:0));var d=t.frameId+"_input";for(n.$.write(['<html dir="'+s+'" lang="'+l+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+s+'" lang="'+l+'" action="',CKEDITOR.tools.htmlEncode(i.action),'"><label id="',t.labelId,'" for="',d,'" style="display:none">',CKEDITOR.tools.htmlEncode(i.label),'</label><input style="width:100%" id="',d,'" aria-labelledby="',t.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(i.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(0<e?e:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+o+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+a+")}","<\/script>"].join("")),n.$.close(),e=0;e<r.length;e++)r[e].enable()}var t=this._,n=CKEDITOR.document.getById(t.frameId).getFrameDocument(),i=t.definition,r=t.buttons,o=this.formLoadedNumber,a=this.formUnloadNumber,s=t.dialog._.editor.lang.dir,l=t.dialog._.editor.langCode;o||(o=this.formLoadedNumber=CKEDITOR.tools.addFunction(function(){this.fire("formLoaded")},this),a=this.formUnloadNumber=CKEDITOR.tools.addFunction(function(){this.getInputElement().clearCustomData()},this),this.getDialog()._.editor.on("destroy",function(){CKEDITOR.tools.removeFunction(o),CKEDITOR.tools.removeFunction(a)})),CKEDITOR.env.gecko?setTimeout(e,500):e()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(e,t){this._.domOnChangeRegistered||(this.on("formLoaded",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this),this._.domOnChangeRegistered=!0),this.on("change",t)}},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype),CKEDITOR.dialog.addUIElement("text",t),CKEDITOR.dialog.addUIElement("password",t),CKEDITOR.dialog.addUIElement("tel",t),CKEDITOR.dialog.addUIElement("textarea",n),CKEDITOR.dialog.addUIElement("checkbox",n),CKEDITOR.dialog.addUIElement("radio",n),CKEDITOR.dialog.addUIElement("button",n),CKEDITOR.dialog.addUIElement("select",n),CKEDITOR.dialog.addUIElement("file",n),CKEDITOR.dialog.addUIElement("fileButton",n),CKEDITOR.dialog.addUIElement("html",n),CKEDITOR.dialog.addUIElement("fieldset",{build:function(e,t,n){for(var i,r=t.children,o=[],a=[],s=0;s<r.length&&(i=r[s]);s++){var l=[];o.push(l),a.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(e,i,l))}return new CKEDITOR.ui.dialog[t.type](e,a,o,n,t)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,CKEDITOR.DIALOG_STATE_IDLE=1,CKEDITOR.DIALOG_STATE_BUSY=2,function(){function e(e){e._.tabBarMode=!0,e._.tabs[e._.currentTabId][0].focus(),e._.currentFocusIndex=-1}function t(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+e,n=t-1;n>t-e;n--)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function n(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),n=t+1;n<t+e;n++)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function i(e,t){for(var n=e.$.getElementsByTagName("input"),i=0,r=n.length;i<r;i++){var o=new CKEDITOR.dom.element(n[i]);"text"==o.getAttribute("type").toLowerCase()&&(t?(o.setAttribute("value",o.getCustomData("fake_value")||""),o.removeCustomData("fake_value")):(o.setCustomData("fake_value",o.getAttribute("value")),o.setAttribute("value","")))}}function r(e,t){var n=this.getInputElement();n&&(e?n.removeAttribute("aria-invalid"):n.setAttribute("aria-invalid",!0)),e||(this.select?this.select():this.focus()),t&&alert(t),this.fire("validated",{valid:e,msg:t})}function o(){var e=this.getInputElement();e&&e.removeAttribute("aria-invalid")}function a(e){var t=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",K).output({id:CKEDITOR.tools.getNextNumber(),editorId:e.id,langDir:e.lang.dir,langCode:e.langCode,editorDialogClass:"cke_editor_"+e.name.replace(/\./g,"\\.")+"_dialog",closeTitle:e.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),n=t.getChild([0,0,0,0,0]),i=n.getChild(0),r=n.getChild(1);return e.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(n),!CKEDITOR.env.ie||CKEDITOR.env.quirks||CKEDITOR.env.edge||(e="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())",CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+e+'" tabIndex="-1"></iframe>').appendTo(n.getParent())),i.unselectable(),r.unselectable(),{element:t,parts:{dialog:t.getChild(0),title:i,close:r,tabs:n.getChild(2),contents:n.getChild([3,0,0,0]),footer:n.getChild([3,0,1,0])}}}function s(e,t,n){this.element=t,this.focusIndex=n,this.tabIndex=0,this.isFocusable=function(){return!t.getAttribute("disabled")&&t.isVisible()},this.focus=function(){e._.currentFocusIndex=this.focusIndex,this.element.focus()},t.on("keydown",function(e){e.data.getKeystroke()in{32:1,13:1}&&this.fire("click")}),t.on("focus",function(){this.fire("mouseover")}),t.on("blur",function(){this.fire("mouseout")})}function l(e){function t(){e.layout()}var n=CKEDITOR.document.getWindow();n.on("resize",t),e.on("hide",function(){n.removeListener("resize",t)})}function d(e,t){this.dialog=e;for(var n,i=t.contents,r=0;n=i[r];r++)i[r]=n&&new c(e,n);CKEDITOR.tools.extend(this,t)}function c(e,t){this._={dialog:e},CKEDITOR.tools.extend(this,t)}function h(e){function t(t){var n=e.getSize(),l=e.parts.dialog.getParent().getClientSize(),d=t.data.$.screenX,c=t.data.$.screenY,h=d-i.x,u=c-i.y;i={x:d,y:c},r.x+=h,r.y+=u,d=r.x+s[3]<a?-s[3]:r.x-s[1]>l.width-n.width-a?l.width-n.width+("rtl"==o.lang.dir?0:s[1]):r.x,
n=r.y+s[0]<a?-s[0]:r.y-s[2]>l.height-n.height-a?l.height-n.height+s[2]:r.y,d=Math.floor(d),n=Math.floor(n),e.move(d,n,1),t.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mousemove",t),CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.env.ie6Compat){var e=D.getChild(0).getFrameDocument();e.removeListener("mousemove",t),e.removeListener("mouseup",n)}}var i=null,r=null,o=e.getParentEditor(),a=o.config.dialog_magnetDistance,s=CKEDITOR.skin.margins||[0,0,0,0];void 0===a&&(a=20),e.parts.title.on("mousedown",function(o){if(!e._.moved){var a=e._.element;a.getFirst().setStyle("position","absolute"),a.removeStyle("display"),e._.moved=!0,e.layout()}i={x:o.data.$.screenX,y:o.data.$.screenY},CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),r=e.getPosition(),CKEDITOR.env.ie6Compat&&(a=D.getChild(0).getFrameDocument(),a.on("mousemove",t),a.on("mouseup",n)),o.data.preventDefault()},e)}function u(e){function t(t){var n="rtl"==h.lang.dir,c=d.width,u=d.height,g=c+(t.data.$.screenX-l.x)*(n?-1:1)*(e._.moved?1:2),p=u+(t.data.$.screenY-l.y)*(e._.moved?1:2),m=e._.element.getFirst(),m=n&&parseInt(m.getComputedStyle("right"),10),E=e.getPosition();E.x=E.x||0,E.y=E.y||0,E.y+p>s.height&&(p=s.height-E.y),(n?m:E.x)+g>s.width&&(g=s.width-(n?m:E.x)),p=Math.floor(p),g=Math.floor(g),r!=CKEDITOR.DIALOG_RESIZE_WIDTH&&r!=CKEDITOR.DIALOG_RESIZE_BOTH||(c=Math.max(i.minWidth||0,g-o)),r!=CKEDITOR.DIALOG_RESIZE_HEIGHT&&r!=CKEDITOR.DIALOG_RESIZE_BOTH||(u=Math.max(i.minHeight||0,p-a)),e.resize(c,u),e._.moved&&f(e,e._.position.x,e._.position.y),e._.moved||e.layout(),t.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.document.removeListener("mousemove",t),c&&(c.remove(),c=null),CKEDITOR.env.ie6Compat){var e=D.getChild(0).getFrameDocument();e.removeListener("mouseup",n),e.removeListener("mousemove",t)}}var i=e.definition,r=i.resizable;if(r!=CKEDITOR.DIALOG_RESIZE_NONE){var o,a,s,l,d,c,h=e.getParentEditor(),u=CKEDITOR.tools.addFunction(function(i){function r(e){return e.isVisible()}d=e.getSize();var h=e.parts.contents,u=h.$.getElementsByTagName("iframe").length,f=!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks);u&&(c=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%; left:0; top:0;"></div>'),h.append(c)),a=d.height-e.parts.contents.getFirst(r).getSize("height",f),o=d.width-e.parts.contents.getFirst(r).getSize("width",1),l={x:i.screenX,y:i.screenY},s=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),CKEDITOR.env.ie6Compat&&(h=D.getChild(0).getFrameDocument(),h.on("mousemove",t),h.on("mouseup",n)),i.preventDefault&&i.preventDefault()});e.on("load",function(){var t="";r==CKEDITOR.DIALOG_RESIZE_WIDTH?t=" cke_resizer_horizontal":r==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(t=" cke_resizer_vertical"),t=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+t+" cke_resizer_"+h.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(h.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+u+', event )">'+("ltr"==h.lang.dir?"\u25e2":"\u25e3")+"</div>"),e.parts.footer.append(t,1)}),h.on("destroy",function(){CKEDITOR.tools.removeFunction(u)})}}function f(e,t,n){var i=e.parts.dialog.getParent().getClientSize(),r=e.getSize(),o=e._.viewportRatio,a=Math.max(i.width-r.width,0),i=Math.max(i.height-r.height,0);o.width=a?t/a:o.width,o.height=i?n/i:o.height,e._.viewportRatio=o}function g(e){e.data.preventDefault(1)}function p(e){var t=e.config,n=CKEDITOR.skinName||e.config.skin,i=t.dialog_backgroundCoverColor||("moono-lisa"==n?"black":"white"),n=t.dialog_backgroundCoverOpacity,r=t.baseFloatZIndex,t=CKEDITOR.tools.genKey(i,n,r),o=x[t];CKEDITOR.document.getBody().addClass("cke_dialog_open"),o?o.show():(r=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",r,"; top: 0px; left: 0px; ","; width: 100%; height: 100%;",CKEDITOR.env.ie6Compat?"":"background-color: "+i,'" class="cke_dialog_background_cover">'],CKEDITOR.env.ie6Compat&&(i="<html><body style=\\'background-color:"+i+";\\'></body></html>",r.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),r.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+i+"' );document.close();")+"})())"),r.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')),r.push("</div>"),o=CKEDITOR.dom.element.createFromHtml(r.join("")),o.setOpacity(void 0!==n?n:.5),o.on("keydown",g),o.on("keypress",g),o.on("keyup",g),o.appendTo(CKEDITOR.document.getBody()),x[t]=o),e.focusManager.add(o),D=o,CKEDITOR.env.mac&&CKEDITOR.env.webkit||o.focus()}function m(e){CKEDITOR.document.getBody().removeClass("cke_dialog_open"),D&&(e.focusManager.remove(D),D.hide())}function E(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,i=e.data.$.shiftKey,r=String.fromCharCode(e.data.$.keyCode);(t=S[(t?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+r])&&t.length&&(t=t[t.length-1],t.keydown&&t.keydown.call(t.uiElement,t.dialog,t.key),e.data.preventDefault())}function _(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,i=e.data.$.shiftKey,r=String.fromCharCode(e.data.$.keyCode);(t=S[(t?"CTRL+":"")+(n?"ALT+":"")+(i?"SHIFT+":"")+r])&&t.length&&(t=t[t.length-1],t.keyup&&(t.keyup.call(t.uiElement,t.dialog,t.key),e.data.preventDefault()))}function T(e,t,n,i,r){(S[n]||(S[n]=[])).push({uiElement:e,dialog:t,key:n,keyup:r||e.accessKeyUp,keydown:i||e.accessKeyDown})}function C(e){for(var t in S){for(var n=S[t],i=n.length-1;0<=i;i--)n[i].dialog!=e&&n[i].uiElement!=e||n.splice(i,1);0===n.length&&delete S[t]}}function v(e,t){e._.accessKeyMap[t]&&e.selectPage(e._.accessKeyMap[t])}function O(){}var I,D,R=CKEDITOR.tools.cssLength,b=!1,y=!CKEDITOR.env.ie||CKEDITOR.env.edge,K='<div class="cke_reset_all cke_dialog_container {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" style="'+(y?"display:flex":"")+'" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="'+(y?"margin:auto":"position:absolute")+'" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(i,s){function l(){var e=D._.focusList;e.sort(function(e,t){return e.tabIndex!=t.tabIndex?t.tabIndex-e.tabIndex:e.focusIndex-t.focusIndex});for(var t=e.length,n=0;n<t;n++)e[n].focusIndex=n}function c(e){var t=D._.focusList;if(e=e||0,!(1>t.length)){var n=D._.currentFocusIndex;D._.tabBarMode&&0>e&&(n=0);try{t[n].getInputElement().$.blur()}catch(e){}var i=n,r=1<D._.pageCount;do{if(i+=e,r&&!D._.tabBarMode&&(i==t.length||-1==i))return D._.tabBarMode=!0,D._.tabs[D._.currentTabId][0].focus(),void(D._.currentFocusIndex=-1);if((i=(i+t.length)%t.length)==n)break}while(e&&!t[i].isFocusable());t[i].focus(),"text"==t[i].type&&t[i].select()}}function f(r){if(D==CKEDITOR.dialog._.currentTop){var o=r.data.getKeystroke(),a="rtl"==i.lang.dir,s=[37,38,39,40];if(p=m=0,9==o||o==CKEDITOR.SHIFT+9)c(o==CKEDITOR.SHIFT+9?-1:1),p=1;else if(o==CKEDITOR.ALT+121&&!D._.tabBarMode&&1<D.getPageCount())e(D),p=1;else if(-1!=CKEDITOR.tools.indexOf(s,o)&&D._.tabBarMode)o=-1!=CKEDITOR.tools.indexOf([a?39:37,38],o)?t.call(D):n.call(D),D.selectPage(o),D._.tabs[o][0].focus(),p=1;else if(13!=o&&32!=o||!D._.tabBarMode)if(13==o)o=r.data.getTarget(),o.is("a","button","select","textarea")||o.is("input")&&"button"==o.$.type||((o=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(o.click,0,o),p=1),m=1;else{if(27!=o)return;(o=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(o.click,0,o):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),m=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,c(1),p=1;g(r)}}function g(e){p?e.data.preventDefault(1):m&&e.data.stopPropagation()}var p,m,E=CKEDITOR.dialog._.dialogDefinitions[s],_=CKEDITOR.tools.clone(I),T=i.config.dialog_buttonsOrder||"OS",C=i.lang.dir,v={};if(("OS"==T&&CKEDITOR.env.mac||"rtl"==T&&"ltr"==C||"ltr"==T&&"rtl"==C)&&_.buttons.reverse(),E=CKEDITOR.tools.extend(E(i),_),E=CKEDITOR.tools.clone(E),E=new d(this,E),_=a(i),this._={editor:i,element:_.element,name:s,model:null,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},viewportRatio:{width:.5,height:.5},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=_.parts,CKEDITOR.tools.setTimeout(function(){i.fire("ariaWidget",this.parts.contents)},0,this),_={top:0,visibility:"hidden"},CKEDITOR.env.ie6Compat&&(_.position="absolute"),_["rtl"==C?"right":"left"]=0,this.parts.dialog.setStyles(_),CKEDITOR.event.call(this),this.definition=E=CKEDITOR.fire("dialogDefinition",{name:s,definition:E,dialog:this},i).definition,!("removeDialogTabs"in i._)&&i.config.removeDialogTabs){for(_=i.config.removeDialogTabs.split(";"),C=0;C<_.length;C++)if(T=_[C].split(":"),2==T.length){var O=T[0];v[O]||(v[O]=[]),v[O].push(T[1])}i._.removeDialogTabs=v}if(i._.removeDialogTabs&&(v=i._.removeDialogTabs[s]))for(C=0;C<v.length;C++)E.removeContents(v[C]);E.onLoad&&this.on("load",E.onLoad),E.onShow&&this.on("show",E.onShow),E.onHide&&this.on("hide",E.onHide),E.onOk&&this.on("ok",function(e){i.fire("saveSnapshot"),setTimeout(function(){i.fire("saveSnapshot")},0),!1===E.onOk.call(this,e)&&(e.data.hide=!1)}),this.state=CKEDITOR.DIALOG_STATE_IDLE,E.onCancel&&this.on("cancel",function(e){!1===E.onCancel.call(this,e)&&(e.data.hide=!1)});var D=this,R=function(e){var t,n=D._.contents;for(t in n)for(var i in n[t])if(e.call(this,n[t][i]))return};this.on("ok",function(e){R(function(t){if(t.validate){var n=t.validate(this),i="string"==typeof n||!1===n;return i&&(e.data.hide=!1,e.stop()),r.call(t,!i,"string"==typeof n?n:void 0),i}})},this,null,0),this.on("cancel",function(e){R(function(t){if(t.isChanged())return i.config.dialog_noConfirmCancel||confirm(i.lang.common.confirmCancel)||(e.data.hide=!1),!0})},this,null,0),this.parts.close.on("click",function(e){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),e.data.preventDefault()},this),this.changeFocus=c;var b=this._.element;for(i.focusManager.add(b,1),this.on("show",function(){b.on("keydown",f,this),CKEDITOR.env.gecko&&b.on("keypress",g,this)}),this.on("hide",function(){b.removeListener("keydown",f),CKEDITOR.env.gecko&&b.removeListener("keypress",g),R(function(e){o.apply(e)})}),this.on("iframeAdded",function(e){new CKEDITOR.dom.document(e.data.iframe.$.contentWindow.document).on("keydown",f,this,null,0)}),this.on("show",function(){l();var e=1<D._.pageCount;i.config.dialog_startupFocusTab&&e?(D._.tabBarMode=!0,D._.tabs[D._.currentTabId][0].focus(),D._.currentFocusIndex=-1):this._.hasFocus||(this._.currentFocusIndex=e?-1:this._.focusList.length-1,E.onFocus?(e=E.onFocus.call(this))&&e.focus():c(1))},this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",function(){var e=this.getElement(),t=e.getFirst();t.remove(),t.appendTo(e)},this),h(this),u(this),new CKEDITOR.dom.text(E.title,CKEDITOR.document).appendTo(this.parts.title),C=0;C<E.contents.length;C++)(v=E.contents[C])&&this.addPage(v);for(this.parts.tabs.on("click",function(t){var n=t.data.getTarget();n.hasClass("cke_dialog_tab")&&(n=n.$.id,this.selectPage(n.substring(4,n.lastIndexOf("_"))),e(this),t.data.preventDefault())},this),C=[],v=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:E.buttons},C).getChild(),this.parts.footer.setHtml(C.join("")),C=0;C<v.length;C++)this._.buttons[v[C].id]=v[C]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(e,t){if(!this._.contentSize||this._.contentSize.width!=e||this._.contentSize.height!=t){if(CKEDITOR.dialog.fire("resize",{dialog:this,width:e,height:t},this._.editor),this.fire("resize",{width:e,height:t},this._.editor),this.parts.contents.setStyles({width:e+"px",height:t+"px"}),"rtl"==this._.editor.lang.dir&&this._.position){var n=this.parts.dialog.getParent().getClientSize().width;this._.position.x=n-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)}this._.contentSize={width:e,height:t}}},getSize:function(){var e=this._.element.getFirst();return{width:e.$.offsetWidth||0,height:e.$.offsetHeight||0}},move:function(e,t,n){var i=this._.element.getFirst(),r="rtl"==this._.editor.lang.dir;CKEDITOR.env.ie&&i.setStyle("zoom","100%");var o=this.parts.dialog.getParent().getClientSize(),a=this.getSize(),s=this._.viewportRatio,l=Math.max(o.width-a.width,0),o=Math.max(o.height-a.height,0);this._.position&&this._.position.x==e&&this._.position.y==t?(e=Math.floor(l*s.width),t=Math.floor(o*s.height)):f(this,e,t),this._.position={x:e,y:t},r&&(e=l-e),t={top:(0<t?t:0)+"px"},t[r?"right":"left"]=(0<e?e:0)+"px",i.setStyles(t),n&&(this._.moved=1)},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var e=this._.element,t=this.definition,n=CKEDITOR.document.getBody(),i=this._.editor.config.baseFloatZIndex;e.getParent()&&e.getParent().equals(n)?e.setStyle("display",y?"flex":"block"):e.appendTo(n),this.resize(this._.contentSize&&this._.contentSize.width||t.width||t.minWidth,this._.contentSize&&this._.contentSize.height||t.height||t.minHeight),this.reset(),null===this._.currentTabId&&this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=i),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10),this.getElement().setStyle("z-index",CKEDITOR.dialog._.currentZIndex),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,p(this._.editor)):CKEDITOR.dialog._.currentTop!==this&&(this._.parentDialog=CKEDITOR.dialog._.currentTop,n=this._.parentDialog.getElement().getFirst(),n.$.style.zIndex-=Math.floor(i/2),this._.parentDialog.getElement().setStyle("z-index",n.$.style.zIndex),CKEDITOR.dialog._.currentTop=this),e.on("keydown",E),e.on("keyup",_),this._.hasFocus=!1;for(var r in t.contents)if(t.contents[r]){var e=t.contents[r],i=this._.tabs[e.id],n=e.requiredContent,o=0;if(i){for(var a in this._.contents[e.id]){var s=this._.contents[e.id][a];"hbox"!=s.type&&"vbox"!=s.type&&s.getInputElement()&&(s.requiredContent&&!this._.editor.activeFilter.check(s.requiredContent)?s.disable():(s.enable(),o++))}!o||n&&!this._.editor.activeFilter.check(n)?i[0].addClass("cke_dialog_tab_disabled"):i[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout(function(){this.layout(),l(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach(function(e){e.setInitValue&&e.setInitValue()})},100,this)},layout:function(){var e=this.parts.dialog;if(this._.moved||!y){var t,n=this.getSize(),i=CKEDITOR.document.getWindow().getViewPaneSize();this._.moved&&this._.position?(t=this._.position.x,n=this._.position.y):(t=(i.width-n.width)/2,n=(i.height-n.height)/2),CKEDITOR.env.ie6Compat||(e.setStyle("position","absolute"),e.removeStyle("margin")),t=Math.floor(t),n=Math.floor(n),this.move(t,n)}},foreach:function(e){for(var t in this._.contents)for(var n in this._.contents[t])e.call(this,this._.contents[t][n]);return this},reset:function(){var e=function(e){e.reset&&e.reset(1)};return function(){return this.foreach(e),this}}(),setupContent:function(){var e=arguments;this.foreach(function(t){t.setup&&t.setup.apply(t,e)})},commitContent:function(){var e=arguments;this.foreach(function(t){CKEDITOR.env.ie&&this._.currentFocusIndex==t.focusIndex&&t.getInputElement().$.blur(),t.commit&&t.commit.apply(t,e)})},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var e=this._.element;for(e.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden"),C(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var t=this._.parentDialog.getElement().getFirst(),n=parseInt(t.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2);this._.parentDialog.getElement().setStyle("z-index",n),t.setStyle("z-index",n)}else m(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex-=10;else{CKEDITOR.dialog._.currentZIndex=null,e.removeListener("keydown",E),e.removeListener("keyup",_);var i=this._.editor;i.focus(),setTimeout(function(){i.focusManager.unlock(),CKEDITOR.env.iOS&&i.window.focus()},0)}delete this._.parentDialog,this.foreach(function(e){e.resetInitValue&&e.resetInitValue()}),this.setState(CKEDITOR.DIALOG_STATE_IDLE)}},addPage:function(e){if(!e.requiredContent||this._.editor.filter.check(e.requiredContent)){for(var t=[],n=e.label?' title="'+CKEDITOR.tools.htmlEncode(e.label)+'"':"",i=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:e.elements,expand:!!e.expand,padding:e.padding,style:e.style||"width: 100%;"},t),r=this._.contents[e.id]={},o=i.getChild(),a=0;i=o.shift();)i.notAllowed||"hbox"==i.type||"vbox"==i.type||a++,r[i.id]=i,"function"==typeof i.getChild&&o.push.apply(o,i.getChild());a||(e.hidden=!0),t=CKEDITOR.dom.element.createFromHtml(t.join("")),t.setAttribute("role","tabpanel"),t.setStyle("min-height","100%"),i=CKEDITOR.env,r="cke_"+e.id+"_"+CKEDITOR.tools.getNextNumber(),n=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',0<this._.pageCount?" cke_last":"cke_first",n,e.hidden?' style="display:none"':"",' id="',r,'"',i.gecko&&!i.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',e.label,"</a>"].join("")),t.setAttribute("aria-labelledby",r),this._.tabs[e.id]=[n,t],this._.tabIdList.push(e.id),!e.hidden&&this._.pageCount++,this._.lastTab=n,this.updateStyle(),t.setAttribute("name",e.id),t.appendTo(this.parts.contents),n.unselectable(),this.parts.tabs.append(n),e.accessKey&&(T(this,this,"CTRL+"+e.accessKey,O,v),this._.accessKeyMap["CTRL+"+e.accessKey]=e.id)}},selectPage:function(e){if(this._.currentTabId!=e&&!this._.tabs[e][0].hasClass("cke_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:e,currentPage:this._.currentTabId})){for(var t in this._.tabs){var n=this._.tabs[t][0],r=this._.tabs[t][1];t!=e&&(n.removeClass("cke_dialog_tab_selected"),n.removeAttribute("aria-selected"),r.hide()),r.setAttribute("aria-hidden",t!=e)}var o=this._.tabs[e];o[0].addClass("cke_dialog_tab_selected"),o[0].setAttribute("aria-selected",!0),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(i(o[1]),o[1].show(),setTimeout(function(){i(o[1],1)},0)):o[1].show(),this._.currentTabId=e,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,e)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(e){var n=this._.tabs[e]&&this._.tabs[e][0];n&&1!=this._.pageCount&&n.isVisible()&&(e==this._.currentTabId&&this.selectPage(t.call(this)),n.hide(),this._.pageCount--,this.updateStyle())},showPage:function(e){(e=this._.tabs[e]&&this._.tabs[e][0])&&(e.show(),this._.pageCount++,this.updateStyle())},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(e,t){var n=this._.contents[e];return n&&n[t]},getValueOf:function(e,t){return this.getContentElement(e,t).getValue()},setValueOf:function(e,t,n){return this.getContentElement(e,t).setValue(n)},getButton:function(e){return this._.buttons[e]},click:function(e){return this._.buttons[e].click()},disableButton:function(e){return this._.buttons[e].disable()},enableButton:function(e){return this._.buttons[e].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(e,t){if(void 0===t)t=this._.focusList.length,this._.focusList.push(new s(this,e,t));else{this._.focusList.splice(t,0,new s(this,e,t));for(var n=t+1;n<this._.focusList.length;n++)this._.focusList[n].focusIndex++}},setState:function(e){if(this.state!=e){if(this.state=e,e==CKEDITOR.DIALOG_STATE_BUSY){if(!this.parts.spinner){var t=this.getParentEditor().lang.dir,n={attributes:{class:"cke_dialog_spinner"},styles:{float:"rtl"==t?"right":"left"}};n.styles["margin-"+("rtl"==t?"left":"right")]="8px",this.parts.spinner=CKEDITOR.document.createElement("div",n),this.parts.spinner.setHtml("&#8987;"),this.parts.spinner.appendTo(this.parts.title,1)}this.parts.spinner.show(),this.getButton("ok")&&this.getButton("ok").disable()}else e==CKEDITOR.DIALOG_STATE_IDLE&&(this.parts.spinner&&this.parts.spinner.hide(),this.getButton("ok")&&this.getButton("ok").enable());this.fire("state",e)}},getModel:function(e){return this._.model?this._.model:this.definition.getModel?this.definition.getModel(e):null},setModel:function(e){this._.model=e},getMode:function(e){return this.definition.getMode?this.definition.getMode(e):(e=this.getModel(e),!e||e instanceof CKEDITOR.dom.element&&!e.getParent()?CKEDITOR.dialog.CREATION_MODE:CKEDITOR.dialog.EDITING_MODE)}},CKEDITOR.tools.extend(CKEDITOR.dialog,{CREATION_MODE:0,EDITING_MODE:1,add:function(e,t){this._.dialogDefinitions[e]&&"function"!=typeof t||(this._.dialogDefinitions[e]=t)},exists:function(e){return!!this._.dialogDefinitions[e]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(e,t,n){return!((e=e.config.removeDialogTabs)&&e.match(new RegExp("(?:^|;)"+t+":"+n+"(?:$|;)","i")))},okButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:e.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(e){e=e.data.dialog,!1!==e.fire("ok",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend(function(n){return e(n,t)},{type:"button"},!0)},e}(),cancelButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:e.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(e){e=e.data.dialog,!1!==e.fire("cancel",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend(function(n){return e(n,t)},{type:"button"},!0)},e}(),addUIElement:function(e,t){this._.uiElementBuilders[e]=t}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype),I={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]};var k=function(e,t,n){for(var i,r=0;i=e[r];r++)if(i.id==t||n&&i[n]&&(i=k(i[n],t,n)))return i;return null},w=function(e,t,n,i,r){if(n){for(var o,a=0;o=e[a];a++){if(o.id==n)return e.splice(a,0,t),t;if(i&&o[i]&&(o=w(o[i],t,n,i,!0)))return o}if(r)return null}return e.push(t),t},N=function(e,t,n){for(var i,r=0;i=e[r];r++){if(i.id==t)return e.splice(r,1);if(n&&i[n]&&(i=N(i[n],t,n)))return i}return null};d.prototype={getContents:function(e){return k(this.contents,e)},getButton:function(e){return k(this.buttons,e)},addContents:function(e,t){return w(this.contents,e,t)},addButton:function(e,t){return w(this.buttons,e,t)},removeContents:function(e){N(this.contents,e)},removeButton:function(e){N(this.buttons,e)}},c.prototype={get:function(e){return k(this.elements,e,"children")},add:function(e,t){return w(this.elements,e,t,"children")},remove:function(e){N(this.elements,e,"children")}};var x={},S={};!function(){CKEDITOR.ui.dialog={uiElement:function(e,t,n,i,r,o,a){if(!(4>arguments.length)){var s=(i.call?i(t):i)||"div",l=["<",s," "],d=(r&&r.call?r(t):r)||{},c=(o&&o.call?o(t):o)||{},h=(a&&a.call?a.call(this,e,t):a)||"",u=this.domId=c.id||CKEDITOR.tools.getNextId()+"_uiElement";t.requiredContent&&!e.getParentEditor().filter.check(t.requiredContent)&&(d.display="none",this.notAllowed=!0),c.id=u;var f={};t.type&&(f["cke_dialog_ui_"+t.type]=1),t.className&&(f[t.className]=1),t.disabled&&(f.cke_disabled=1);for(var g=c.class&&c.class.split?c.class.split(" "):[],u=0;u<g.length;u++)g[u]&&(f[g[u]]=1);g=[];for(u in f)g.push(u);c.class=g.join(" "),t.title&&(c.title=t.title),f=(t.style||"").split(";"),t.align&&(g=t.align,d["margin-left"]="left"==g?0:"auto",d["margin-right"]="right"==g?0:"auto");for(u in d)f.push(u+":"+d[u]);for(t.hidden&&f.push("display:none"),u=f.length-1;0<=u;u--)""===f[u]&&f.splice(u,1);0<f.length&&(c.style=(c.style?c.style+"; ":"")+f.join("; "));for(u in c)l.push(u+'="'+CKEDITOR.tools.htmlEncode(c[u])+'" ');l.push(">",h,"</",s,">"),n.push(l.join("")),(this._||(this._={})).dialog=e,"boolean"==typeof t.isChanged&&(this.isChanged=function(){return t.isChanged}),"function"==typeof t.isChanged&&(this.isChanged=t.isChanged),"function"==typeof t.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,function(e){return function(n){e.call(this,t.setValue.call(this,n))}})),"function"==typeof t.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,function(e){return function(){return t.getValue.call(this,e.call(this))}})),CKEDITOR.event.implementOn(this),this.registerEvents(t),this.accessKeyUp&&this.accessKeyDown&&t.accessKey&&T(this,e,"CTRL+"+t.accessKey);var p=this;e.on("load",function(){var t=p.getInputElement();if(t){var n=p.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?"cke_dialog_ui_focused":"";t.on("focus",function(){e._.tabBarMode=!1,e._.hasFocus=!0,p.fire("focus"),n&&this.addClass(n)}),t.on("blur",function(){p.fire("blur"),n&&this.removeClass(n)})}}),CKEDITOR.tools.extend(this,t),this.keyboardFocusable&&(this.tabIndex=t.tabIndex||0,this.focusIndex=e._.focusList.push(this)-1,this.on("focus",function(){e._.currentFocusIndex=p.focusIndex}))}},hbox:function(e,t,n,i,r){if(!(4>arguments.length)){this._||(this._={});var o,a=this._.children=t,s=r&&r.widths||null,l=r&&r.height||null,d={role:"presentation"};r&&r.align&&(d.align=r.align),CKEDITOR.ui.dialog.uiElement.call(this,e,r||{type:"hbox"},i,"table",{},d,function(){var e=['<tbody><tr class="cke_dialog_ui_hbox">'];for(o=0;o<n.length;o++){var t="cke_dialog_ui_hbox_child",i=[];0===o&&(t="cke_dialog_ui_hbox_first"),o==n.length-1&&(t="cke_dialog_ui_hbox_last"),e.push('<td class="',t,'" role="presentation" '),s?s[o]&&i.push("width:"+R(s[o])):i.push("width:"+Math.floor(100/n.length)+"%"),l&&i.push("height:"+R(l)),r&&void 0!==r.padding&&i.push("padding:"+R(r.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&a[o].align&&i.push("text-align:"+a[o].align),0<i.length&&e.push('style="'+i.join("; ")+'" '),e.push(">",n[o],"</td>")}return e.push("</tr></tbody>"),e.join("")})}},vbox:function(e,t,n,i,r){if(!(3>arguments.length)){this._||(this._={});var o=this._.children=t,a=r&&r.width||null,s=r&&r.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,e,r||{type:"vbox"},i,"div",null,{role:"presentation"},function(){var t=['<table role="presentation" cellspacing="0" border="0" '];t.push('style="'),r&&r.expand&&t.push("height:100%;"),t.push("width:"+R(a||"100%"),";"),CKEDITOR.env.webkit&&t.push("float:none;"),t.push('"'),t.push('align="',CKEDITOR.tools.htmlEncode(r&&r.align||("ltr"==e.getParentEditor().lang.dir?"left":"right")),'" '),t.push("><tbody>");for(var i=0;i<n.length;i++){var l=[];t.push('<tr><td role="presentation" '),a&&l.push("width:"+R(a||"100%")),s?l.push("height:"+R(s[i])):r&&r.expand&&l.push("height:"+Math.floor(100/n.length)+"%"),r&&void 0!==r.padding&&l.push("padding:"+R(r.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&o[i].align&&l.push("text-align:"+o[i].align),0<l.length&&t.push('style="',l.join("; "),'" '),t.push(' class="cke_dialog_ui_vbox_child">',n[i],"</td></tr>")}return t.push("</tbody></table>"),t.join("")})}}}}(),CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(e,t){return this.getInputElement().setValue(e),!t&&this.fire("change",{value:e}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var e=this.getInputElement();(e=e.getParent())&&-1==e.$.className.search("cke_dialog_page_contents"););return e?(e=e.getAttribute("name"),this._.dialog._.currentTabId!=e&&this._.dialog.selectPage(e),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(e){var t,n,i=/^on([A-Z]\w+)/;for(n in e)(t=n.match(i))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,e[n]):function(e,t,n,i){t.on("load",function(){e.getInputElement().on(n,i,e)})}(this,this._.dialog,t[1].toLowerCase(),e[n]));return this},eventProcessors:{onLoad:function(e,t){e.on("load",t,this)},onShow:function(e,t){e.on("show",t,this)},onHide:function(e,t){e.on("hide",t,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var e=this.getElement();this.getInputElement().setAttribute("disabled","true"),e.addClass("cke_disabled")},enable:function(){var e=this.getElement();this.getInputElement().removeAttribute("disabled"),e.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!(!this.isEnabled()||!this.isVisible())}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(e){return 1>arguments.length?this._.children.concat():(e.splice||(e=[e]),2>e.length?this._.children[e[0]]:this._.children[e[0]]&&this._.children[e[0]].getChild?this._.children[e[0]].getChild(e.slice(1,e.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var e={build:function(e,t,n){for(var i,r=t.children,o=[],a=[],s=0;s<r.length&&(i=r[s]);s++){var l=[];o.push(l),a.push(CKEDITOR.dialog._.uiElementBuilders[i.type].build(e,i,l))}return new CKEDITOR.ui.dialog[t.type](e,a,o,n,t)}};CKEDITOR.dialog.addUIElement("hbox",e),CKEDITOR.dialog.addUIElement("vbox",e)}(),CKEDITOR.dialogCommand=function(e,t){this.dialogName=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.dialogCommand.prototype={exec:function(e){var t=this.tabId;e.openDialog(this.dialogName,function(e){t&&e.selectPage(t)})},canUndo:!1,editorFocus:1},function(){var e=/^\d*$/,t=/^\d*(?:\.\d+)?$/,n=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,i=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,r=/^(--|-?([a-zA-Z_]|\\))(\\|[a-zA-Z0-9-_])*\s*?:\s*?[^:;]+$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var e=arguments;return function(t){this&&this.getValue&&(t=this.getValue());var n,i,r=CKEDITOR.VALIDATE_AND,o=[];for(i=0;i<e.length&&"function"==typeof e[i];i++)o.push(e[i]);i<e.length&&"string"==typeof e[i]&&(n=e[i],i++),i<e.length&&"number"==typeof e[i]&&(r=e[i]),i=r==CKEDITOR.VALIDATE_AND;for(var a=0;a<o.length;a++){
var s=!0===o[a](t);i=r==CKEDITOR.VALIDATE_AND?i&&s:i||s}return!!i||n}},regex:function(e,t){return this.functions(function(t){return e.test(t)},t)},notEmpty:function(e){return this.functions(function(e){return 0<e.replace(RegExp("^[\\u0020\\u00a0\\u1680\\u202f\\u205f\\u3000\\u2000-\\u200a\\s]+|[\\u0020\\u00a0\\u1680\\u202f\\u205f\\u3000\\u2000-\\u200a\\s]+$","g"),"").length},e)},integer:function(t){return this.regex(e,t)},number:function(e){return this.regex(t,e)},cssLength:function(e){return this.functions(function(e){return i.test(CKEDITOR.tools.trim(e))},e)},htmlLength:function(e){return this.functions(function(e){return n.test(CKEDITOR.tools.trim(e))},e)},inlineStyle:function(e){return this.functions(function(e){return e=CKEDITOR.tools.trim(e).split(";"),""===e[e.length-1]&&e.pop(),CKEDITOR.tools.array.every(e,function(e){return r.test(CKEDITOR.tools.trim(e))})},e)},equals:function(e,t){return this.functions(function(t){return t==e},t)},notEqual:function(e,t){return this.functions(function(t){return t!=e},t)}},CKEDITOR.on("instanceDestroyed",function(e){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var t;t=CKEDITOR.dialog._.currentTop;)t.hide();for(var n in x)x[n].remove();x={}}e=e.editor._.storedDialogs;for(var i in e)e[i].destroy()})}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(e,t,n){var i=null,r=CKEDITOR.dialog._.dialogDefinitions[e];if(null===CKEDITOR.dialog._.currentTop&&p(this),"function"==typeof r)r=this._.storedDialogs||(this._.storedDialogs={}),i=r[e]||(r[e]=new CKEDITOR.dialog(this,e)),i.setModel(n),t&&t.call(i,i),i.show();else{if("failed"==r)throw m(this),Error('[CKEDITOR.dialog.openDialog] Dialog "'+e+'" failed when loading definition.');"string"==typeof r&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(r),function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[e]&&(CKEDITOR.dialog._.dialogDefinitions[e]="failed"),this.openDialog(e,t,n)},this,0,1)}return CKEDITOR.skin.loadPart("dialog"),i&&i.once("hide",function(){i.setModel(null)},null,null,999),i}}),CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(e){b||(CKEDITOR.document.appendStyleSheet(this.path+"styles/dialog.css"),b=!0),e.on("doubleclick",function(t){t.data.dialog&&e.openDialog(t.data.dialog)},null,null,999)}})}(),function(){function e(e,t){CKEDITOR.tools.extend(this,t,{editor:e,id:"cke-"+CKEDITOR.tools.getUniqueId(),area:e._.notificationArea}),t.type||(this.type="info"),this.element=this._createElement(),e.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(this.element)}function t(e){var t=this;this.editor=e,this.notifications=[],this.element=this._createElement(),this._uiBuffer=CKEDITOR.tools.eventsBuffer(10,this._layout,this),this._changeBuffer=CKEDITOR.tools.eventsBuffer(500,this._layout,this),e.on("destroy",function(){t._removeListeners(),t.element.remove()})}CKEDITOR.plugins.add("notification",{init:function(e){function n(e){var t=new CKEDITOR.dom.element("div");t.setStyles({position:"fixed","margin-left":"-9999px"}),t.setAttributes({"aria-live":"assertive","aria-atomic":"true"}),t.setText(e),CKEDITOR.document.getBody().append(t),setTimeout(function(){t.remove()},100)}e._.notificationArea=new t(e),e.showNotification=function(t,n,i){var r,o;return"progress"==n?r=i:o=i,t=new CKEDITOR.plugins.notification(e,{message:t,type:n,progress:r,duration:o}),t.show(),t},e.on("key",function(t){if(27==t.data.keyCode){var i=e._.notificationArea.notifications;i.length&&(n(e.lang.notification.closed),i[i.length-1].hide(),t.cancel())}})}}),e.prototype={show:function(){!1!==this.editor.fire("notificationShow",{notification:this})&&(this.area.add(this),this._hideAfterTimeout())},update:function(e){var t=!0;!1===this.editor.fire("notificationUpdate",{notification:this,options:e})&&(t=!1);var n=this.element,i=n.findOne(".cke_notification_message"),r=n.findOne(".cke_notification_progress"),o=e.type;n.removeAttribute("role"),e.progress&&"progress"!=this.type&&(o="progress"),o&&(n.removeClass(this._getClass()),n.removeAttribute("aria-label"),this.type=o,n.addClass(this._getClass()),n.setAttribute("aria-label",this.type),"progress"!=this.type||r?"progress"!=this.type&&r&&r.remove():(r=this._createProgressElement(),r.insertBefore(i))),void 0!==e.message&&(this.message=e.message,i.setHtml(this.message)),void 0!==e.progress&&(this.progress=e.progress,r&&r.setStyle("width",this._getPercentageProgress())),t&&e.important&&(n.setAttribute("role","alert"),this.isVisible()||this.area.add(this)),this.duration=e.duration,this._hideAfterTimeout()},hide:function(){!1!==this.editor.fire("notificationHide",{notification:this})&&this.area.remove(this)},isVisible:function(){return 0<=CKEDITOR.tools.indexOf(this.area.notifications,this)},_createElement:function(){var e,t,n=this,i=this.editor.lang.common.close;return e=new CKEDITOR.dom.element("div"),e.addClass("cke_notification"),e.addClass(this._getClass()),e.setAttributes({id:this.id,role:"alert","aria-label":this.type}),"progress"==this.type&&e.append(this._createProgressElement()),t=new CKEDITOR.dom.element("p"),t.addClass("cke_notification_message"),t.setHtml(this.message),e.append(t),t=CKEDITOR.dom.element.createFromHtml('<a class="cke_notification_close" href="javascript:void(0)" title="'+i+'" role="button" tabindex="-1"><span class="cke_label">X</span></a>'),e.append(t),t.on("click",function(){n.editor.focus(),n.hide()}),e},_getClass:function(){return"progress"==this.type?"cke_notification_info":"cke_notification_"+this.type},_createProgressElement:function(){var e=new CKEDITOR.dom.element("span");return e.addClass("cke_notification_progress"),e.setStyle("width",this._getPercentageProgress()),e},_getPercentageProgress:function(){return Math.round(100*(this.progress||0))+"%"},_hideAfterTimeout:function(){var e,t=this;this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),"number"==typeof this.duration?e=this.duration:"info"!=this.type&&"success"!=this.type||(e="number"==typeof this.editor.config.notification_duration?this.editor.config.notification_duration:5e3),e&&(t._hideTimeoutId=setTimeout(function(){t.hide()},e))}},t.prototype={add:function(e){this.notifications.push(e),this.element.append(e.element),1==this.element.getChildCount()&&(CKEDITOR.document.getBody().append(this.element),this._attachListeners()),this._layout()},remove:function(e){var t=CKEDITOR.tools.indexOf(this.notifications,e);0>t||(this.notifications.splice(t,1),e.element.remove(),this.element.getChildCount()||(this._removeListeners(),this.element.remove()))},_createElement:function(){var e=this.editor,t=e.config,n=new CKEDITOR.dom.element("div");return n.addClass("cke_notifications_area"),n.setAttribute("id","cke_notifications_area_"+e.name),n.setStyle("z-index",t.baseFloatZIndex-2),n},_attachListeners:function(){var e=CKEDITOR.document.getWindow(),t=this.editor;e.on("scroll",this._uiBuffer.input),e.on("resize",this._uiBuffer.input),t.on("change",this._changeBuffer.input),t.on("floatingSpaceLayout",this._layout,this,null,20),t.on("blur",this._layout,this,null,20)},_removeListeners:function(){var e=CKEDITOR.document.getWindow(),t=this.editor;e.removeListener("scroll",this._uiBuffer.input),e.removeListener("resize",this._uiBuffer.input),t.removeListener("change",this._changeBuffer.input),t.removeListener("floatingSpaceLayout",this._layout),t.removeListener("blur",this._layout)},_layout:function(){function e(){r.setStyle("left",p(m+a.width-d-c))}var t,n,i,r=this.element,o=this.editor,a=o.ui.contentsElement.getClientRect(),s=o.ui.contentsElement.getDocumentPosition(),l=r.getClientRect(),d=this._notificationWidth,c=this._notificationMargin;i=CKEDITOR.document.getWindow();var h=i.getScrollPosition(),u=i.getViewPaneSize(),f=CKEDITOR.document.getBody(),g=f.getDocumentPosition(),p=CKEDITOR.tools.cssLength;d&&c||(i=this.element.getChild(0),d=this._notificationWidth=i.getClientRect().width,c=this._notificationMargin=parseInt(i.getComputedStyle("margin-left"),10)+parseInt(i.getComputedStyle("margin-right"),10)),o.toolbar&&(t=o.ui.space(o.config.toolbarLocation),n=t.getClientRect()),t&&t.isVisible()&&n.bottom>a.top&&n.bottom<a.bottom-l.height?r.setStyles({position:"fixed",top:p(n.bottom)}):0<a.top?r.setStyles({position:"absolute",top:p(s.y)}):s.y+a.height-l.height>h.y?r.setStyles({position:"fixed",top:0}):r.setStyles({position:"absolute",top:p(s.y+a.height-l.height)});var m="fixed"==r.getStyle("position")?a.left:"static"!=f.getComputedStyle("position")?s.x-g.x:s.x;a.width<d+c?s.x+d+c>h.x+u.width?e():r.setStyle("left",p(m)):s.x+d+c>h.x+u.width?r.setStyle("left",p(m)):s.x+a.width/2+d/2+c>h.x+u.width?r.setStyle("left",p(m-s.x+h.x+u.width-d-c)):0>a.left+a.width-d-c?e():0>a.left+a.width/2-d/2?r.setStyle("left",p(m-s.x+h.x)):r.setStyle("left",p(m+a.width/2-d/2-c/2))}},CKEDITOR.plugins.notification=e}(),function(){var e='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-describedby="{id}_description" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"{hasArrowAriaHtml}{toggleAriaHtml}';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"');var t="";CKEDITOR.env.ie&&(t='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)==CKEDITOR.MOUSE_BUTTON_LEFT&&');var e=e+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" onclick="'+t+'CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}">&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span><span id="{id}_description" class="cke_button_label" aria-hidden="false">{ariaShortcutSpace}{ariaShortcut}</span>{arrowHtml}</a>',n=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),i=CKEDITOR.addTemplate("button",e);CKEDITOR.plugins.add("button",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}}),CKEDITOR.UI_BUTTON="button",CKEDITOR.ui.button=function(e){CKEDITOR.tools.extend(this,e,{isToggle:e.isToggle||!1,title:e.label,click:e.click||function(t){t.execCommand(e.command)}}),this._={}},CKEDITOR.ui.button.handler={create:function(e){return new CKEDITOR.ui.button(e)}},CKEDITOR.ui.button.prototype={render:function(e,t){function r(){var t=e.mode;t&&(t=this.modes[t]?void 0!==l[t]?l[t]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,t=e.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:t,this.setState(t),this.refresh&&this.refresh())}var o,a,s,l=null,d=CKEDITOR.env,c=this._.id=CKEDITOR.tools.getNextId(),h="",u=this.command;this._.editor=e;var f={id:c,button:this,editor:e,focus:function(){CKEDITOR.document.getById(c).focus()},execute:function(){this.button.click(e)},attach:function(e){this.button.attach(e)}},g=CKEDITOR.tools.addFunction(function(e){if(f.onkey)return e=new CKEDITOR.dom.event(e),!1!==f.onkey(f,e.getKeystroke())}),p=CKEDITOR.tools.addFunction(function(e){var t;return f.onfocus&&(t=!1!==f.onfocus(f,new CKEDITOR.dom.event(e))),t}),m=0;f.clickFn=o=CKEDITOR.tools.addFunction(function(){m&&(e.unlockSelection(1),m=0),f.execute(),d.iOS&&e.focus()}),this.modes?(l={},e.on("beforeModeUnload",function(){e.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED&&(l[e.mode]=this._.state)},this),e.on("activeFilterChange",r,this),e.on("mode",r,this),!this.readOnly&&e.on("readOnly",r,this)):u&&(u=e.getCommand(u))&&(u.on("state",function(){this.setState(u.state)},this),h+=u.state==CKEDITOR.TRISTATE_ON?"on":u.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off");var E;this.directional&&e.on("contentDirChanged",function(t){var n=CKEDITOR.document.getById(this._.id),i=n.getFirst();t=t.data,t!=e.lang.dir?n.addClass("cke_"+t):n.removeClass("cke_ltr").removeClass("cke_rtl"),i.setAttribute("style",CKEDITOR.skin.getIconStyle(E,"rtl"==t,this.icon,this.iconOffset))},this),u?(a=e.getCommandKeystroke(u))&&(s=CKEDITOR.tools.keystrokeToString(e.lang.common.keyboard,a)):h+="off",a=this.name||this.command;var _=null,T=this.icon;return E=a,this.icon&&!/\./.test(this.icon)?(E=this.icon,T=null):(this.icon&&(_=this.icon),CKEDITOR.env.hidpi&&this.iconHiDpi&&(_=this.iconHiDpi)),_?(CKEDITOR.skin.addIcon(_,_),T=null):_=E,h={id:c,name:a,iconName:E,label:this.label,cls:(this.hasArrow?"cke_button_expandable ":"")+(this.className||""),state:h,ariaDisabled:"disabled"==h?"true":"false",title:this.title+(s?" ("+s.display+")":""),ariaShortcutSpace:s?"&nbsp;":"",ariaShortcut:s?e.lang.common.keyboardShortcut+" "+s.aria:"",titleJs:d.gecko&&!d.hc?"":(this.title||"").replace("'",""),hasArrow:"string"==typeof this.hasArrow&&this.hasArrow||(this.hasArrow?"true":"false"),keydownFn:g,focusFn:p,clickFn:o,style:CKEDITOR.skin.getIconStyle(_,"rtl"==e.lang.dir,T,this.iconOffset),arrowHtml:this.hasArrow?n.output():"",hasArrowAriaHtml:this.hasArrow?' aria-expanded="false"':"",toggleAriaHtml:this.isToggle?'aria-pressed="false"':""},i.output(h,t),this.onRender&&this.onRender(),f},setState:function(e){if(this._.state==e)return!1;this._.state=e;var t=CKEDITOR.document.getById(this._.id);return!!t&&(t.setState(e,"cke_button"),t.setAttribute("aria-disabled",e==CKEDITOR.TRISTATE_DISABLED),this.isToggle&&!this.hasArrow&&t.setAttribute("aria-pressed",e===CKEDITOR.TRISTATE_ON),!0)},getState:function(){return this._.state},toFeature:function(e){if(this._.feature)return this._.feature;var t=this;return this.allowedContent||this.requiredContent||!this.command||(t=e.getCommand(this.command)||t),this._.feature=t}},CKEDITOR.ui.prototype.addButton=function(e,t){this.add(e,CKEDITOR.UI_BUTTON,t)}}(),function(){function e(e){function n(){var t,n,i,r={};for(t in e.ui.items)n=e.ui.items[t],i=n.toolbar||"others",i=i.split(","),n=i[0],i=parseInt(i[1]||-1,10),r[n]||(r[n]=[]),r[n].push({name:t,order:i});for(n in r)r[n]=r[n].sort(function(e,t){return e.order==t.order?0:0>t.order?-1:0>e.order?1:e.order<t.order?-1:1});return r}function i(t,n){if(n.length){t.items?t.items.push(e.ui.create("-")):t.items=[];for(var i;i=n.shift();)i="string"==typeof i?i:i.name,r&&-1!=CKEDITOR.tools.indexOf(r,i)||(i=e.ui.create(i))&&e.addFeature(i)&&t.items.push(i)}}var r=function(e){return e&&"string"==typeof e?e.split(","):e}(e.config.removeButtons),o=e.config.toolbar;return"string"==typeof o&&(o=e.config["toolbar_"+o]),e.toolbar=o?function(e){var t,n,r,o=[];for(t=0;t<e.length;++t)n=e[t],r={},"/"==n?o.push(n):CKEDITOR.tools.isArray(n)?(i(r,CKEDITOR.tools.clone(n)),o.push(r)):n.items&&(i(r,CKEDITOR.tools.clone(n.items)),r.name=n.name,o.push(r));return o}(o):function(){for(var r=n(),o=CKEDITOR.tools.clone(e.config.toolbarGroups)||t(e),a=0;a<o.length;a++){var s=o[a];if("/"!=s){"string"==typeof s&&(s=o[a]={name:s});var l,d=s.groups;if(d)for(var c=0;c<d.length;c++)l=d[c],(l=r[l])&&i(s,l);(l=r[s.name])&&i(s,l)}}return o}()}function t(e){return e._.toolbarGroups||(e._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var n=function(){this.toolbars=[]};n.prototype.focus=function(){for(var e,t=0;e=this.toolbars[t++];)for(var n,i=0;n=e.items[i++];)if(n.focus)return void n.focus()};var i={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(e){e.toolbox&&(CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout(function(){e.toolbox.focus()},100):e.toolbox.focus())}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(t){var r,o=function(e,n){var i,a="rtl"==t.lang.dir,s=t.config.toolbarGroupCycling,l=a?37:39,a=a?39:37,s=void 0===s||s;switch(n){case 9:case CKEDITOR.SHIFT+9:for(;!i||!i.items.length;)if(i=9==n?(i?i.next:e.toolbar.next)||t.toolbox.toolbars[0]:(i?i.previous:e.toolbar.previous)||t.toolbox.toolbars[t.toolbox.toolbars.length-1],i.items.length)for(e=i.items[r?i.items.length-1:0];e&&!e.focus;)(e=r?e.previous:e.next)||(i=0);return e&&e.focus(),!1;case l:i=e;do{!(i=i.next)&&s&&(i=e.toolbar.items[0])}while(i&&!i.focus);return i?i.focus():o(e,9),!1;case 40:return e.button&&e.button.hasArrow?e.execute():o(e,40==n?l:a),!1;case a:case 38:i=e;do{!(i=i.previous)&&s&&(i=e.toolbar.items[e.toolbar.items.length-1])}while(i&&!i.focus);return i?i.focus():(r=1,o(e,CKEDITOR.SHIFT+9),r=0),!1;case 27:return t.focus(),!1;case 13:case 32:return e.execute(),!1;case CKEDITOR.ALT+122:return t.execCommand("elementsPathFocus"),!1}return!0};t.on("uiSpace",function(i){if(i.data.space==t.config.toolbarLocation){i.removeListener(),t.toolbox=new n;var r,a,s=CKEDITOR.tools.getNextId(),l=['<span id="',s,'" class="cke_voice_label">',t.lang.toolbar.toolbars,"</span>",'<span id="'+t.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',s,'" onmousedown="return false;">'],s=!1!==t.config.toolbarStartupExpanded;t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&l.push('<span class="cke_toolbox_main"'+(s?">":' style="display:none">'));for(var d=t.toolbox.toolbars,c=e(t),h=c.length,u=0;u<h;u++){var f,g,p,m=0,E=c[u],_="/"!==E&&("/"===c[u+1]||u==h-1);if(E)if(r&&(l.push("</span>"),a=r=0),"/"===E)l.push('<span class="cke_toolbar_break"></span>');else{p=E.items||E;for(var T=0;T<p.length;T++){var C,v=p[T];if(v){var O=function(e){e=e.render(t,l),I=m.items.push(e)-1,0<I&&(e.previous=m.items[I-1],e.previous.next=e),e.toolbar=m,e.onkey=o};if(v.type==CKEDITOR.UI_SEPARATOR)a=r&&v;else{if(C=!1!==v.canGroup,!m){f=CKEDITOR.tools.getNextId(),m={id:f,items:[]},g=E.name&&(t.lang.toolbar.toolbarGroups[E.name]||E.name),l.push('<span id="',f,'" class="cke_toolbar'+(_?' cke_toolbar_last"':'"'),g?' aria-labelledby="'+f+'_label"':"",' role="toolbar">'),g&&l.push('<span id="',f,'_label" class="cke_voice_label">',g,"</span>"),l.push('<span class="cke_toolbar_start"></span>');var I=d.push(m)-1;0<I&&(m.previous=d[I-1],m.previous.next=m)}C?r||(l.push('<span class="cke_toolgroup" role="presentation">'),r=1):r&&(l.push("</span>"),r=0),a&&(O(a),a=0),O(v)}}}r&&(l.push("</span>"),a=r=0),m&&l.push('<span class="cke_toolbar_end"></span></span>')}}if(t.config.toolbarCanCollapse&&l.push("</span>"),t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var D=CKEDITOR.tools.addFunction(function(){t.execCommand("toolbarCollapse")});t.on("destroy",function(){CKEDITOR.tools.removeFunction(D)}),t.addCommand("toolbarCollapse",{readOnly:1,exec:function(e){var t=e.ui.space("toolbar_collapser"),n=t.getPrevious(),i=e.ui.space("contents"),r=n.getParent(),o=parseInt(i.$.style.height,10),a=r.$.offsetHeight,s=t.hasClass("cke_toolbox_collapser_min");s?(n.show(),t.removeClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarCollapse)):(n.hide(),t.addClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarExpand)),t.getFirst().setText(s?"\u25b2":"\u25c0"),i.setStyle("height",o-(r.$.offsetHeight-a)+"px"),e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:i.$.offsetHeight,outerWidth:e.container.$.offsetWidth})},modes:{wysiwyg:1,source:1}}),t.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse"),l.push('<a title="'+(s?t.lang.toolbar.toolbarCollapse:t.lang.toolbar.toolbarExpand)+'" id="'+t.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser'),s||l.push(" cke_toolbox_collapser_min"),l.push('" onclick="CKEDITOR.tools.callFunction('+D+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}l.push("</span>"),i.data.html+=l.join("")}}),t.on("destroy",function(){if(this.toolbox){var e,t,n,i,r=0;for(e=this.toolbox.toolbars;r<e.length;r++)for(n=e[r].items,t=0;t<n.length;t++)i=n[t],i.clickFn&&CKEDITOR.tools.removeFunction(i.clickFn),i.keyDownFn&&CKEDITOR.tools.removeFunction(i.keyDownFn)}}),t.on("uiReady",function(){var e=t.ui.space("toolbox");e&&t.focusManager.add(e,1)}),t.addCommand("toolbarFocus",i),t.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus"),t.ui.add("-",CKEDITOR.UI_SEPARATOR,{}),t.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(e,t){return t.push('<span class="cke_toolbar_separator" role="separator"></span>'),{}}}}})}}),CKEDITOR.ui.prototype.addToolbarGroup=function(e,n,i){var r=t(this.editor),o=0===n,a={name:e};if(i){if(i=CKEDITOR.tools.search(r,function(e){return e.name==i}))return!i.groups&&(i.groups=[]),n&&0<=(n=CKEDITOR.tools.indexOf(i.groups,n))?void i.groups.splice(n+1,0,e):void(o?i.groups.splice(0,0,e):i.groups.push(e));n=null}n&&(n=CKEDITOR.tools.indexOf(r,function(e){return e.name==n})),o?r.splice(0,0,e):"number"==typeof n?r.splice(n+1,0,a):r.push(e)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top",function(){function e(e,t,n){return t.type||(t.type="auto"),!(n&&!1===e.fire("beforePaste",t)||!t.dataValue&&t.dataTransfer.isEmpty())&&(t.dataValue||(t.dataValue=""),CKEDITOR.env.gecko&&"drop"==t.method&&e.toolbox&&e.once("afterPaste",function(){e.toolbox.focus(),e.focus()}),e.fire("paste",t))}function t(t){function n(){var e=t.editable();if(CKEDITOR.plugins.clipboard.isCustomCopyCutSupported){var n=function(e){t.getSelection().isCollapsed()||(t.readOnly&&"cut"==e.name||p.initPasteDataTransfer(e,t),e.data.preventDefault())};e.on("copy",n),e.on("cut",n),e.on("cut",function(){t.readOnly||t.extractSelectedHtml()},null,null,999)}e.on(p.mainPasteEvent,function(e){"beforepaste"==p.mainPasteEvent&&m||u(e)}),"beforepaste"==p.mainPasteEvent&&(e.on("paste",function(e){E||(o(),e.data.preventDefault(),u(e),s("paste"))}),e.on("contextmenu",a,null,null,0),e.on("beforepaste",function(e){!e.data||e.data.$.ctrlKey||e.data.$.shiftKey||a()},null,null,0)),e.on("beforecut",function(){!m&&l()});var i;e.attachListener(CKEDITOR.env.ie?e:t.document.getDocumentElement(),"mouseup",function(){i=setTimeout(f,0)}),t.on("destroy",function(){clearTimeout(i)}),e.on("keyup",f)}function i(e){return{type:e,canUndo:"cut"==e,startDisabled:!0,fakeKeystroke:"cut"==e?CKEDITOR.CTRL+88:CKEDITOR.CTRL+67,exec:function(){"cut"==this.type&&l();var e,n=this.type;if(CKEDITOR.env.ie)e=s(n);else try{e=t.document.$.execCommand(n,!1,null)}catch(t){e=!1}return e||t.showNotification(t.lang.clipboard[this.type+"Error"]),e}}}function r(){return{canUndo:!1,async:!0,fakeKeystroke:CKEDITOR.CTRL+86,exec:function(t,n){function i(n,i){i=void 0===i||i,n?(n.method="paste",n.dataTransfer||(n.dataTransfer=p.initPasteDataTransfer()),e(t,n,i)):o&&!t._.forcePasteDialog&&t.showNotification(l,"info",t.config.clipboard_notificationDuration),t._.forcePasteDialog=!1,t.fire("afterCommandExec",{name:"paste",command:r,returnValue:!!n})}n=void 0!==n&&null!==n?n:{};var r=this,o=void 0===n.notification||n.notification,a=n.type,s=CKEDITOR.tools.keystrokeToString(t.lang.common.keyboard,t.getCommandKeystroke(this)),l="string"==typeof o?o:t.lang.clipboard.pasteNotification.replace(/%1/,'<kbd aria-label="'+s.aria+'">'+s.display+"</kbd>"),s="string"==typeof n?n:n.dataValue;a&&!0!==t.config.forcePasteAsPlainText&&"allow-word"!==t.config.forcePasteAsPlainText?t._.nextPasteType=a:delete t._.nextPasteType,"string"==typeof s?i({dataValue:s}):t.getClipboardData(i)}}}function o(){E=1,setTimeout(function(){E=0},100)}function a(){m=1,setTimeout(function(){m=0},10)}function s(e){var n=t.document,i=n.getBody(),r=!1,o=function(){r=!0};return i.on(e,o),7<CKEDITOR.env.version?n.$.execCommand(e):n.$.selection.createRange().execCommand(e),i.removeListener(e,o),r}function l(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var e,n,i,r=t.getSelection();r.getType()==CKEDITOR.SELECTION_ELEMENT&&(e=r.getSelectedElement())&&(n=r.getRanges()[0],i=t.document.createText(""),i.insertBefore(e),n.setStartBefore(i),n.setEndAfter(e),r.selectRanges([n]),setTimeout(function(){e.getParent()&&(i.remove(),r.selectElement(e))},0))}}function d(e,n){var i,r=t.document,o=t.editable(),a=function(e){e.cancel()};if(!r.getById("cke_pastebin")){var s=t.getSelection(),l=s.createBookmarks();CKEDITOR.env.ie&&s.root.fire("selectionchange");var d=new CKEDITOR.dom.element(!CKEDITOR.env.webkit&&!o.is("body")||CKEDITOR.env.ie?"div":"body",r);d.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var c=0,r=r.getWindow();CKEDITOR.env.webkit?(o.append(d),d.addClass("cke_editable"),o.is("body")||(c="static"!=o.getComputedStyle("position")?o:CKEDITOR.dom.element.get(o.$.offsetParent),c=c.getDocumentPosition().y)):o.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(d),d.setStyles({position:"absolute",top:r.getScrollPosition().y-c+10+"px",width:"1px",height:Math.max(1,r.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0}),CKEDITOR.env.safari&&d.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","text")),(c=d.getParent().isReadOnly())?(d.setOpacity(0),d.setAttribute("contenteditable",!0)):d.setStyle("ltr"==t.config.contentsLangDirection?"left":"right","-10000px"),t.on("selectionChange",a,null,null,0),(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(i=o.once("blur",a,null,null,-100)),c&&d.focus(),c=new CKEDITOR.dom.range(d),c.selectNodeContents(d);var h=c.select();CKEDITOR.env.ie&&(i=o.once("blur",function(){t.lockSelection(h)}));var u=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout(function(){CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=u),i&&i.removeListener(),CKEDITOR.env.ie&&o.focus(),s.selectBookmarks(l),d.remove();var e;CKEDITOR.env.webkit&&(e=d.getFirst())&&e.is&&e.hasClass("Apple-style-span")&&(d=e),t.removeListener("selectionChange",a),n(d.getHtml())},0)}}function c(){if("paste"==p.mainPasteEvent)return t.fire("beforePaste",{type:"auto",method:"paste"}),!1;t.focus(),o();var e=t.focusManager;return e.lock(),t.editable().fire(p.mainPasteEvent)&&!s("paste")?(e.unlock(),!1):(e.unlock(),!0)}function h(e){if("wysiwyg"==t.mode)switch(e.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:e=t.editable(),o(),"paste"==p.mainPasteEvent&&e.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:t.fire("saveSnapshot"),setTimeout(function(){t.fire("saveSnapshot")},50)}}function u(n){var i={type:"auto",method:"paste",dataTransfer:p.initPasteDataTransfer(n)};i.dataTransfer.cacheData();var r=!1!==t.fire("beforePaste",i);r&&p.canClipboardApiBeTrusted(i.dataTransfer,t)?(n.data.preventDefault(),setTimeout(function(){e(t,i)},0)):d(n,function(n){i.dataValue=n.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/gi,""),r&&e(t,i)})}function f(){if("wysiwyg"==t.mode){var e=g("paste");t.getCommand("cut").setState(g("cut")),t.getCommand("copy").setState(g("copy")),t.getCommand("paste").setState(e),t.fire("pasteState",e)}}function g(e){var n=t.getSelection(),n=n&&n.getRanges()[0];return(t.readOnly||n&&n.checkReadOnly())&&e in{paste:1,cut:1}?CKEDITOR.TRISTATE_DISABLED:"paste"==e?CKEDITOR.TRISTATE_OFF:(e=t.getSelection(),n=e.getRanges(),e.getType()==CKEDITOR.SELECTION_NONE||1==n.length&&n[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF)}var p=CKEDITOR.plugins.clipboard,m=0,E=0;!function(){if(t.on("key",h),t.on("contentDom",n),t.on("selectionChange",f),t.contextMenu){t.contextMenu.addListener(function(){return{cut:g("cut"),copy:g("copy"),paste:g("paste")}});var e=null;t.on("menuShow",function(){e&&(e.removeListener(),e=null);var n=t.contextMenu.findItemByCommandName("paste");n&&n.element&&(e=n.element.on("touchend",function(){t._.forcePasteDialog=!0}))})}t.ui.addButton&&t.once("instanceReady",function(){t._.pasteButtons&&CKEDITOR.tools.array.forEach(t._.pasteButtons,function(e){(e=t.ui.get(e))&&(e=CKEDITOR.document.getById(e._.id))&&e.on("touchend",function(){t._.forcePasteDialog=!0})})})}(),function(){function e(e,n,i,r,o){var a=t.lang.clipboard[n];t.addCommand(n,i),t.ui.addButton&&t.ui.addButton(e,{label:a,command:n,toolbar:"clipboard,"+r}),t.addMenuItems&&t.addMenuItem(n,{label:a,command:n,group:"clipboard",order:o})}e("Cut","cut",i("cut"),10,1),e("Copy","copy",i("copy"),20,4),e("Paste","paste",r(),30,8),t._.pasteButtons||(t._.pasteButtons=[]),t._.pasteButtons.push("Paste")}(),t.getClipboardData=function(e,n){function i(e){e.removeListener(),e.cancel(),n(e.data)}function r(e){e.removeListener(),e.cancel(),n({type:a,dataValue:e.data.dataValue,dataTransfer:e.data.dataTransfer,method:"paste"})}var o=!1,a="auto";n||(n=e,e=null),t.on("beforePaste",function(e){e.removeListener(),o=!0,a=e.data.type},null,null,1e3),t.on("paste",i,null,null,0),!1===c()&&(t.removeListener("paste",i),t._.forcePasteDialog&&o&&t.fire("pasteDialog")?(t.on("pasteDialogCommit",r),t.on("dialogHide",function(e){e.removeListener(),e.data.removeListener("pasteDialogCommit",r),e.data._.committed||n(null)})):n(null))}}function n(e){if(CKEDITOR.env.webkit){if(!e.match(/^[^<]*$/g)&&!e.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!e.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko)return"html";if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}function i(e,t){function n(e){return CKEDITOR.tools.repeat("</p><p>",~~(e/2))+(1==e%2?"<br>":"")}return t=t.replace(/(?!\u3000)\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>"),t=t.replace(/<\/?[A-Z]+>/g,function(e){return e.toLowerCase()}),t.match(/^[^<]$/)?t:(CKEDITOR.env.webkit&&-1<t.indexOf("<div>")&&(t=t.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>"),t.match(/<div>(<br>|)<\/div>/)&&(t="<p>"+t.replace(/(<div>(<br>|)<\/div>)+/g,function(e){return n(e.split("</div><div>").length+1)})+"</p>"),t=t.replace(/<\/div><div>/g,"<br>"),t=t.replace(/<\/?div>/g,"")),CKEDITOR.env.gecko&&e.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(t=t.replace(/^<br><br>$/,"<br>")),-1<t.indexOf("<br><br>")&&(t="<p>"+t.replace(/(<br>){2,}/g,function(e){return n(e.length/4)})+"</p>")),a(e,t))}function r(e){function t(){var e,t={};for(e in CKEDITOR.dtd)"$"!=e.charAt(0)&&"div"!=e&&"span"!=e&&(t[e]=1);return t}var n={};return{get:function(i){return"plain-text"==i?n.plainText||(n.plainText=new CKEDITOR.filter(e,"br")):"semantic-content"==i?((i=n.semanticContent)||(i=new CKEDITOR.filter(e,{}),i.allow({$1:{elements:t(),attributes:!0,styles:!1,classes:!1}}),i=n.semanticContent=i),i):i?new CKEDITOR.filter(e,i):null}}}function o(e,t,n){t=CKEDITOR.htmlParser.fragment.fromHtml(t);var i=new CKEDITOR.htmlParser.basicWriter;return n.applyTo(t,!0,!1,e.activeEnterMode),t.writeHtml(i),i.getHtml()}function a(e,t){return e.enterMode==CKEDITOR.ENTER_BR?t=t.replace(/(<\/p><p>)+/g,function(e){return CKEDITOR.tools.repeat("<br>",e.length/7*2)}).replace(/<\/?p>/g,""):e.enterMode==CKEDITOR.ENTER_DIV&&(t=t.replace(/<(\/)?p>/g,"<$1div>")),t}function s(e){e.data.preventDefault(),e.data.$.dataTransfer.dropEffect="none"}function l(t){var n=CKEDITOR.plugins.clipboard;t.on("contentDom",function(){function i(n,i,r){i.select(),e(t,{dataTransfer:r,method:"drop"},1),r.sourceEditor.fire("saveSnapshot"),r.sourceEditor.editable().extractHtmlFromRange(n),r.sourceEditor.getSelection().selectRanges([n]),r.sourceEditor.fire("saveSnapshot")}function r(i,r){i.select(),e(t,{dataTransfer:r,method:"drop"},1),n.resetDragDataTransfer()}function o(e,n,i){var r={$:e.data.$,target:e.data.getTarget()};n&&(r.dragRange=n),i&&(r.dropRange=i),!1===t.fire(e.name,r)&&e.data.preventDefault()}function a(e){return e.type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent()),e.getChildCount()}var s=t.editable(),l=CKEDITOR.plugins.clipboard.getDropTarget(t),d=t.ui.space("top"),c=t.ui.space("bottom");n.preventDefaultDropOnElement(d),n.preventDefaultDropOnElement(c),s.attachListener(l,"dragstart",o),
s.attachListener(t,"dragstart",n.resetDragDataTransfer,n,null,1),s.attachListener(t,"dragstart",function(e){n.initDragDataTransfer(e,t)},null,null,2),s.attachListener(t,"dragstart",function(){var e=n.dragRange=t.getSelection().getRanges()[0];CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(n.dragStartContainerChildCount=e?a(e.startContainer):null,n.dragEndContainerChildCount=e?a(e.endContainer):null)},null,null,100),s.attachListener(l,"dragend",o),s.attachListener(t,"dragend",n.initDragDataTransfer,n,null,1),s.attachListener(t,"dragend",n.resetDragDataTransfer,n,null,100),s.attachListener(l,"dragover",function(e){if(CKEDITOR.env.edge)e.data.preventDefault();else{var t=e.data.getTarget();t&&t.is&&t.is("html")?e.data.preventDefault():CKEDITOR.env.ie&&CKEDITOR.plugins.clipboard.isFileApiSupported&&e.data.$.dataTransfer.types.contains("Files")&&e.data.preventDefault()}}),s.attachListener(l,"drop",function(e){if(!e.data.$.defaultPrevented&&(e.data.preventDefault(),!t.readOnly)){var i=e.data.getTarget();if(!i.isReadOnly()||i.type==CKEDITOR.NODE_ELEMENT&&i.is("html")){var i=n.getRangeAtDropPosition(e,t),r=n.dragRange;i&&o(e,r,i)}}},null,null,9999),s.attachListener(t,"drop",n.initDragDataTransfer,n,null,1),s.attachListener(t,"drop",function(e){if(e=e.data){var o=e.dropRange,a=e.dragRange,s=e.dataTransfer;s.getTransferType(t)==CKEDITOR.DATA_TRANSFER_INTERNAL?setTimeout(function(){n.internalDrop(a,o,s,t)},0):s.getTransferType(t)==CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?i(a,o,s):r(o,s)}},null,null,9999)})}var d;CKEDITOR.plugins.add("clipboard",{requires:"dialog,notification,toolbar",_supportedFileMatchers:[],init:function(e){function a(t){return!!e.config.clipboard_handleImages&&-1!==CKEDITOR.tools.indexOf(["image/png","image/jpeg","image/gif"],t.type)}function s(t){return CKEDITOR.tools.array.some(e.plugins.clipboard._supportedFileMatchers,function(e){return e(t)})}function d(t){t.length&&(t=CKEDITOR.tools.array.unique(t),t=CKEDITOR.tools.array.filter(t,function(e){return!!CKEDITOR.tools.trim(e)}),t=c(t.join(", ")),e.showNotification(t,"info",e.config.clipboard_notificationDuration))}function c(t){return t?e.lang.clipboard.fileFormatNotSupportedNotification.replace(/\${formats\}/g,"<em>"+t+"</em>"):e.lang.clipboard.fileWithoutFormatNotSupportedNotification}function h(e,t){return!(CKEDITOR.env.ie&&e.data.fileTransferCancel||!(CKEDITOR.env.ie||t&&g!==t.id))&&(t.isFileTransfer()&&1===t.getFilesCount())}var u,f=r(e);e.config.forcePasteAsPlainText?u="plain-text":e.config.pasteFilter?u=e.config.pasteFilter:!CKEDITOR.env.webkit||"pasteFilter"in e.config||(u="semantic-content"),e.pasteFilter=f.get(u),t(e),l(e),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js"));var g,p=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||CKEDITOR.plugins.clipboard.isFileApiSupported;CKEDITOR.plugins.clipboard.addFileMatcher(e,a),e.on("paste",function(e){if(p){var t=e.data;if(e=t.dataTransfer,!t.dataValue){for(var t=[],n=0;n<e.getFilesCount();n++){var i=e.getFile(n);s(i)||t.push(i.type)}d(t)}}},null,null,1),e.on("paste",function(t){if(p&&e.config.clipboard_handleImages){var n=t.data,i=n.dataTransfer;if(!n.dataValue&&h(t,i)&&(i=i.getFile(0),a(i))){var r=new FileReader;r.addEventListener("load",function(){t.data.dataValue='<img src="'+r.result+'" />',e.fire("paste",t.data)},!1),r.addEventListener("abort",function(){CKEDITOR.env.ie&&(t.data.fileTransferCancel=!0),e.fire("paste",t.data)},!1),r.addEventListener("error",function(){CKEDITOR.env.ie&&(t.data.fileTransferCancel=!0),e.fire("paste",t.data)},!1),r.readAsDataURL(i),g=n.dataTransfer.id,t.stop()}}},null,null,1),e.on("paste",function(t){if(t.data.dataTransfer||(t.data.dataTransfer=new CKEDITOR.plugins.clipboard.dataTransfer),!t.data.dataValue){var n=t.data.dataTransfer,i=n.getData("text/html");i?(t.data.dataValue=i,t.data.type="html"):(i=n.getData("text/plain"))&&(t.data.dataValue=e.editable().transformPlainTextToHtml(i),t.data.type="text")}},null,null,1),e.on("paste",function(e){var t=e.data.dataValue,n=CKEDITOR.dtd.$block;if(-1<t.indexOf("Apple-")&&(t=t.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=e.data.type&&(t=t.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,function(e,t){return t.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")})),-1<t.indexOf('<br class="Apple-interchange-newline">')&&(e.data.startsWithEOL=1,e.data.preSniffing="html",t=t.replace(/<br class="Apple-interchange-newline">/,"")),t=t.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")),t.match(/^<[^<]+cke_(editable|contents)/i)){var i,r,o=new CKEDITOR.dom.element("div");for(o.setHtml(t);1==o.getChildCount()&&(i=o.getFirst())&&i.type==CKEDITOR.NODE_ELEMENT&&(i.hasClass("cke_editable")||i.hasClass("cke_contents"));)o=r=i;r&&(t=r.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?t=t.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,function(t,i){return i.toLowerCase()in n?(e.data.preSniffing="html","<"+i):t}):CKEDITOR.env.webkit?t=t.replace(/<\/(\w+)><div><br><\/div>$/,function(t,i){return i in n?(e.data.endsWithEOL=1,"</"+i+">"):t}):CKEDITOR.env.gecko&&(t=t.replace(/(\s)<br>$/,"$1")),e.data.dataValue=t},null,null,3),e.on("paste",function(t){t=t.data;var r,a=e._.nextPasteType||t.type,s=t.dataValue,l=e.config.clipboard_defaultContentType||"html",d=t.dataTransfer.getTransferType(e)==CKEDITOR.DATA_TRANSFER_EXTERNAL,c=!0===e.config.forcePasteAsPlainText;r="html"==a||"html"==t.preSniffing?"html":n(s),delete e._.nextPasteType,"htmlifiedtext"==r&&(s=i(e.config,s)),"text"==a&&"html"==r?s=o(e,s,f.get("plain-text")):(d&&e.pasteFilter&&!t.dontFilter||c)&&(s=o(e,s,e.pasteFilter)),t.startsWithEOL&&(s='<br data-cke-eol="1">'+s),t.endsWithEOL&&(s+='<br data-cke-eol="1">'),"auto"==a&&(a="html"==r||"html"==l?"html":"text"),t.type=a,t.dataValue=s,delete t.preSniffing,delete t.startsWithEOL,delete t.endsWithEOL},null,null,6),e.on("paste",function(t){t=t.data,t.dataValue&&(e.insertHtml(t.dataValue,t.type,t.range),setTimeout(function(){e.fire("afterPaste")},0))},null,null,1e3),e.on("pasteDialog",function(t){setTimeout(function(){e.openDialog("paste",t.data)},0)})}}),CKEDITOR.plugins.clipboard={addFileMatcher:function(e,t){e.plugins.clipboard._supportedFileMatchers.push(t)},isCustomCopyCutSupported:!(CKEDITOR.env.ie&&16>CKEDITOR.env.version||CKEDITOR.env.iOS&&605>CKEDITOR.env.version),isCustomDataTypesSupported:!CKEDITOR.env.ie||16<=CKEDITOR.env.version,isFileApiSupported:!CKEDITOR.env.ie||9<CKEDITOR.env.version,mainPasteEvent:CKEDITOR.env.ie&&!CKEDITOR.env.edge?"beforepaste":"paste",addPasteButton:function(e,t,n){e.ui.addButton&&(e.ui.addButton(t,n),e._.pasteButtons||(e._.pasteButtons=[]),e._.pasteButtons.push(t))},canClipboardApiBeTrusted:function(e,t){return!!(e.getTransferType(t)!=CKEDITOR.DATA_TRANSFER_EXTERNAL||CKEDITOR.env.chrome&&!e.isEmpty()||CKEDITOR.env.gecko&&(e.getData("text/html")||e.getFilesCount())||CKEDITOR.env.safari&&603<=CKEDITOR.env.version&&!CKEDITOR.env.iOS||CKEDITOR.env.iOS&&605<=CKEDITOR.env.version||CKEDITOR.env.edge&&16<=CKEDITOR.env.version)},getDropTarget:function(e){var t=e.editable();return CKEDITOR.env.ie&&9>CKEDITOR.env.version||t.isInline()?t:e.document},fixSplitNodesAfterDrop:function(e,t,n,i){function r(e,n,i){var r=e;if(r.type==CKEDITOR.NODE_TEXT&&(r=e.getParent()),r.equals(n)&&i!=n.getChildCount())return e=t.startContainer.getChild(t.startOffset-1),n=t.startContainer.getChild(t.startOffset),e&&e.type==CKEDITOR.NODE_TEXT&&n&&n.type==CKEDITOR.NODE_TEXT&&(i=e.getLength(),e.setText(e.getText()+n.getText()),n.remove(),t.setStart(e,i),t.collapse(!0)),!0}var o=t.startContainer;"number"==typeof i&&"number"==typeof n&&o.type==CKEDITOR.NODE_ELEMENT&&(r(e.startContainer,o,n)||r(e.endContainer,o,i))},isDropRangeAffectedByDragRange:function(e,t){var n=t.startContainer,i=t.endOffset;return!!(e.endContainer.equals(n)&&e.endOffset<=i||e.startContainer.getParent().equals(n)&&e.startContainer.getIndex()<i||e.endContainer.getParent().equals(n)&&e.endContainer.getIndex()<i)},internalDrop:function(t,n,i,r){var o,a,s=CKEDITOR.plugins.clipboard,l=r.editable();r.fire("saveSnapshot"),r.fire("lockSnapshot",{dontUpdate:1}),CKEDITOR.env.ie&&10>CKEDITOR.env.version&&this.fixSplitNodesAfterDrop(t,n,s.dragStartContainerChildCount,s.dragEndContainerChildCount),(a=this.isDropRangeAffectedByDragRange(t,n))||(o=t.createBookmark(!1)),s=n.clone().createBookmark(!1),a&&(o=t.createBookmark(!1)),t=o.startNode,n=o.endNode,a=s.startNode,n&&t.getPosition(a)&CKEDITOR.POSITION_PRECEDING&&n.getPosition(a)&CKEDITOR.POSITION_FOLLOWING&&a.insertBefore(t),t=r.createRange(),t.moveToBookmark(o),l.extractHtmlFromRange(t,1),n=r.createRange(),s.startNode.getCommonAncestor(l)||(s=r.getSelection().createBookmarks()[0]),n.moveToBookmark(s),e(r,{dataTransfer:i,method:"drop",range:n},1),r.fire("unlockSnapshot")},getRangeAtDropPosition:function(e,t){var n=e.data.$,i=n.clientX,r=n.clientY,o=t.getSelection(!0).getRanges()[0],a=t.createRange();if(e.data.testRange)return e.data.testRange;if(document.caretRangeFromPoint&&t.document.$.caretRangeFromPoint(i,r))n=t.document.$.caretRangeFromPoint(i,r),a.setStart(CKEDITOR.dom.node(n.startContainer),n.startOffset),a.collapse(!0);else if(n.rangeParent)a.setStart(CKEDITOR.dom.node(n.rangeParent),n.rangeOffset),a.collapse(!0);else{if(CKEDITOR.env.ie&&8<CKEDITOR.env.version&&o&&t.editable().hasFocus)return o;if(!document.body.createTextRange)return null;t.focus(),n=t.document.getBody().$.createTextRange();try{for(var s=!1,l=0;20>l&&!s;l++){if(!s)try{n.moveToPoint(i,r-l),s=!0}catch(e){}if(!s)try{n.moveToPoint(i,r+l),s=!0}catch(e){}}if(s){var d="cke-temp-"+(new Date).getTime();n.pasteHTML('<span id="'+d+'">\u200b</span>');var c=t.document.getById(d);a.moveToPosition(c,CKEDITOR.POSITION_BEFORE_START),c.remove()}else{var h,u=t.document.$.elementFromPoint(i,r),f=new CKEDITOR.dom.element(u);if(f.equals(t.editable())||"html"==f.getName())return o&&o.startContainer&&!o.startContainer.equals(t.editable())?o:null;h=f.getClientRect(),i<h.left?a.setStartAt(f,CKEDITOR.POSITION_AFTER_START):a.setStartAt(f,CKEDITOR.POSITION_BEFORE_END),a.collapse(!0)}}catch(e){return null}}return a},initDragDataTransfer:function(e,t){var n=e.data.$?e.data.$.dataTransfer:null,i=new this.dataTransfer(n,t);"dragstart"===e.name&&i.storeId(),n?this.dragData&&i.id==this.dragData.id?i=this.dragData:this.dragData=i:this.dragData?i=this.dragData:this.dragData=i,e.data.dataTransfer=i},resetDragDataTransfer:function(){this.dragData=null},initPasteDataTransfer:function(e,t){if(this.isCustomCopyCutSupported){if(e&&e.data&&e.data.$){var n=e.data.$.clipboardData,i=new this.dataTransfer(n,t);return"copy"!==e.name&&"cut"!==e.name||i.storeId(),this.copyCutData&&i.id==this.copyCutData.id?(i=this.copyCutData,i.$=n):this.copyCutData=i,i}return new this.dataTransfer(null,t)}return new this.dataTransfer(CKEDITOR.env.edge&&e&&e.data.$&&e.data.$.clipboardData||null,t)},preventDefaultDropOnElement:function(e){e&&e.on("dragover",s)}},d=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported?"cke/id":"Text",CKEDITOR.plugins.clipboard.dataTransfer=function(e,t){e&&(this.$=e),this._={metaRegExp:/^<meta.*?>/i,fragmentRegExp:/\s*\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e\s*/g,types:[],data:{},files:[],nativeHtmlCache:"",normalizeType:function(e){return e=e.toLowerCase(),"text"==e||"text/plain"==e?"Text":"url"==e?"URL":"files"===e?"Files":e}},this._.fallbackDataTransfer=new CKEDITOR.plugins.clipboard.fallbackDataTransfer(this),this.id=this.getData(d),this.id||(this.id="Text"==d?"":"cke-"+CKEDITOR.tools.getUniqueId()),t&&(this.sourceEditor=t,this.setData("text/html",t.getSelectedHtml(1)),"Text"==d||this.getData("text/plain")||this.setData("text/plain",t.getSelection().getSelectedText()))},CKEDITOR.DATA_TRANSFER_INTERNAL=1,CKEDITOR.DATA_TRANSFER_CROSS_EDITORS=2,CKEDITOR.DATA_TRANSFER_EXTERNAL=3,CKEDITOR.plugins.clipboard.dataTransfer.prototype={getData:function(e,t){e=this._.normalizeType(e);var n="text/html"==e&&t?this._.nativeHtmlCache:this._.data[e];if(void 0===n||null===n||""===n){if(this._.fallbackDataTransfer.isRequired())n=this._.fallbackDataTransfer.getData(e,t);else try{n=this.$.getData(e)||""}catch(e){n=""}"text/html"!=e||t||(n=this._stripHtml(n))}if("Text"==e&&CKEDITOR.env.gecko&&this.getFilesCount()&&"file://"==n.substring(0,7)&&(n=""),"string"==typeof n)var i=n.indexOf("</html>"),n=-1!==i?n.substring(0,i+7):n;return n},setData:function(e,t){if(e=this._.normalizeType(e),"text/html"==e?(this._.data[e]=this._stripHtml(t),this._.nativeHtmlCache=t):this._.data[e]=t,CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||"URL"==e||"Text"==e)if("Text"==d&&"Text"==e&&(this.id=t),this._.fallbackDataTransfer.isRequired())this._.fallbackDataTransfer.setData(e,t);else try{this.$.setData(e,t)}catch(e){}},storeId:function(){"Text"!==d&&this.setData(d,this.id)},getTransferType:function(e){return this.sourceEditor?this.sourceEditor==e?CKEDITOR.DATA_TRANSFER_INTERNAL:CKEDITOR.DATA_TRANSFER_CROSS_EDITORS:CKEDITOR.DATA_TRANSFER_EXTERNAL},cacheData:function(){function e(e){e=r._.normalizeType(e);var t=r.getData(e);"text/html"==e&&(r._.nativeHtmlCache=r.getData(e,!0),t=r._stripHtml(t)),t&&(r._.data[e]=t),r._.types.push(e)}if(this.$){var t,n,i,r=this;if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(t=0;t<this.$.types.length;t++)e(this.$.types[t])}else e("Text"),e("URL");if(n=this._getImageFromClipboard(),(i=this.$&&this.$.files||null)||n){if(this._.files=[],i&&i.length)for(t=0;t<i.length;t++)this._.files.push(i[t]);0===this._.files.length&&n&&this._.files.push(n)}}},getFilesCount:function(){if(this._.files.length)return this._.files.length;var e=this.$&&this.$.files||null;return e&&e.length?e.length:this._getImageFromClipboard()?1:0},getFile:function(e){if(this._.files.length)return this._.files[e];var t=this.$&&this.$.files||null;return t&&t.length?t[e]:0===e?this._getImageFromClipboard():void 0},isFileTransfer:function(){var e=this.getTypes(),e=CKEDITOR.tools.array.filter(e,function(e){return"application/x-moz-file"!==e});return 1===e.length&&"files"===e[0].toLowerCase()},isEmpty:function(){var e,t={};if(this.getFilesCount())return!1;if(CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(this._.data),function(e){t[e]=1}),this.$)if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(var n=0;n<this.$.types.length;n++)t[this.$.types[n]]=1}else t.Text=1,t.URL=1;"Text"!=d&&(t[d]=0);for(e in t)if(t[e]&&""!==this.getData(e))return!1;return!0},getTypes:function(){return 0<this._.types.length?this._.types:this.$&&this.$.types?[].slice.call(this.$.types):[]},_getImageFromClipboard:function(){var e;try{if(this.$&&this.$.items&&this.$.items[0]&&(e=this.$.items[0].getAsFile())&&e.type)return e}catch(e){}},_stripHtml:function(e){return e&&e.length&&(e=function(e){var t,n,i=new CKEDITOR.htmlParser;return i.onTagOpen=function(e){"body"===e&&(t=i._.htmlPartsRegex.lastIndex)},i.onTagClose=function(e){"body"===e&&(n=i._.htmlPartsRegex.lastIndex)},i.parse(e),"number"!=typeof t||"number"!=typeof n?e:e.substring(t,n).replace(/<\/body\s*>$/gi,"")}(e),e=e.replace(this._.metaRegExp,""),e=e.replace(this._.fragmentRegExp,"")),e}},CKEDITOR.plugins.clipboard.fallbackDataTransfer=function(e){this._dataTransfer=e,this._customDataFallbackType="text/html"},CKEDITOR.plugins.clipboard.fallbackDataTransfer._isCustomMimeTypeSupported=null,CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes=[],CKEDITOR.plugins.clipboard.fallbackDataTransfer.prototype={isRequired:function(){var e=CKEDITOR.plugins.clipboard.fallbackDataTransfer,t=this._dataTransfer.$;if(null===e._isCustomMimeTypeSupported){if(!t)return!1;if(e._isCustomMimeTypeSupported=!1,CKEDITOR.env.edge&&17<=CKEDITOR.env.version)return!0;try{t.setData("cke/mimetypetest","cke test value"),e._isCustomMimeTypeSupported="cke test value"===t.getData("cke/mimetypetest"),t.clearData("cke/mimetypetest")}catch(e){}}return!e._isCustomMimeTypeSupported},getData:function(e,t){var n=this._getData(this._customDataFallbackType,!0);if(t)return n;var n=this._extractDataComment(n),i=null,i=e===this._customDataFallbackType?n.content:n.data&&n.data[e]?n.data[e]:this._getData(e,!0);return null!==i?i:""},setData:function(e,t){var n=e===this._customDataFallbackType;n&&(t=this._applyDataComment(t,this._getFallbackTypeData()));var i=t,r=this._dataTransfer.$;try{r.setData(e,i),n&&(this._dataTransfer._.nativeHtmlCache=i)}catch(t){if(this._isUnsupportedMimeTypeError(t)){n=CKEDITOR.plugins.clipboard.fallbackDataTransfer,-1===CKEDITOR.tools.indexOf(n._customTypes,e)&&n._customTypes.push(e);var n=this._getFallbackTypeContent(),o=this._getFallbackTypeData();o[e]=i;try{i=this._applyDataComment(n,o),r.setData(this._customDataFallbackType,i),this._dataTransfer._.nativeHtmlCache=i}catch(e){i=""}}}return i},_getData:function(e,t){var n=this._dataTransfer._.data;if(!t&&n[e])return n[e];try{return this._dataTransfer.$.getData(e)}catch(e){return null}},_getFallbackTypeContent:function(){var e=this._dataTransfer._.data[this._customDataFallbackType];return e||(e=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).content),e},_getFallbackTypeData:function(){var e=CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes,t=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).data||{},n=this._dataTransfer._.data;return CKEDITOR.tools.array.forEach(e,function(e){void 0!==n[e]?t[e]=n[e]:void 0!==t[e]&&(t[e]=t[e])},this),t},_isUnsupportedMimeTypeError:function(e){return e.message&&-1!==e.message.search(/element not found/gi)},_extractDataComment:function(e){var t={data:null,content:e||""};if(e&&16<e.length){var n;(n=/\x3c!--cke-data:(.*?)--\x3e/g.exec(e))&&n[1]&&(t.data=JSON.parse(decodeURIComponent(n[1])),t.content=e.replace(n[0],""))}return t},_applyDataComment:function(e,t){var n="";return t&&CKEDITOR.tools.object.keys(t).length&&(n="\x3c!--cke-data:"+encodeURIComponent(JSON.stringify(t))+"--\x3e"),n+(e&&e.length?e:"")}}}(),CKEDITOR.config.clipboard_notificationDuration=1e4,CKEDITOR.config.clipboard_handleImages=!0,function(){function e(e){return!e||!(20<e.length)&&(!(e=e.replace(/[\n|\t]*/g,"").toLowerCase())||"<br>"==e||"<p>&nbsp;<br></p>"==e||"<p><br></p>"==e||"<div><br></div>"==e||"<p>&nbsp;</p>"==e||"&nbsp;"==e||" "==e||"&nbsp;<br>"==e||" <br>"==e)}function t(t){var n=t.editor;if(!n.readOnly){var i=n.editable(),r=t.listenerData;if(i){if("wysiwyg"==n.mode){if(CKEDITOR.dialog._.currentTop||!i)return;e(i.getHtml())&&(i.setHtml(r),i.addClass("placeholder"))}"source"==n.mode&&(o?"mode"==t.name&&i.setAttribute("placeholder",r):e(i.getValue())&&(i.setValue(r),i.addClass("placeholder")))}}}function n(e){e=e.editor;var t=e.editable();if(t){if("wysiwyg"==e.mode){if(!t.hasClass("placeholder"))return;if(t.removeClass("placeholder"),CKEDITOR.dtd[t.getName()].p){var n="";e.enterMode===CKEDITOR.ENTER_P?n="<p><br/></p>":e.enterMode===CKEDITOR.ENTER_DIV?n="<div><br/></div>":(n="<br/>",(CKEDITOR.env.gecko||CKEDITOR.env.ie)&&(n=" ")),t.setHtml(n),n=new CKEDITOR.dom.range(e.document),n.moveToElementEditablePosition(t.getFirst(),!0),e.getSelection().selectRanges([n])}else t.setHtml(" ")}"source"==e.mode&&t.hasClass("placeholder")&&(t.removeClass("placeholder"),t.setValue(""))}}function i(e){e.editor.readOnly?n(e):t(e)}function r(e){return e?e.getAttribute("lang")||r(e.getParent()):null}var o="placeholder"in document.createElement("textarea");CKEDITOR.plugins.add("confighelper",{getPlaceholderCss:function(){return".placeholder{ color: #999; }"},onLoad:function(){CKEDITOR.addCss(this.getPlaceholderCss())},init:function(a){function s(e){if(a==e.editor){var t=e.data.name;e=e.data.definition;var n,i,r,o,s;if("tableProperties"==t&&(t="table"),"removeDialogFields"in a._||!a.config.removeDialogFields||(a._.removeDialogFields=c(a.config.removeDialogFields)),a._.removeDialogFields&&(n=a._.removeDialogFields[t]))for(r in n)if(o=n[r],s=e.getContents(r))for(i=0;i<o.length;i++)s.remove(o[i]);if("hideDialogFields"in a._||!a.config.hideDialogFields||(a._.hideDialogFields=c(a.config.hideDialogFields)),a._.hideDialogFields&&(n=a._.hideDialogFields[t]))for(r in n)if(o=n[r],s=e.getContents(r))for(i=0;i<o.length;i++)s.get(o[i]).hidden=!0;if(a.config.dialogFieldsDefaultValues&&(n=a.config.dialogFieldsDefaultValues[t]))for(r in n)if(o=n[r],s=e.getContents(r))for(var l in o)(t=s.get(l))&&(t.default=o[l])}}a.on("mode",function(e){e.editor.focusManager.hasFocus=!1});var l=a.element.getAttribute("placeholder")||a.config.placeholder;if(l){var d=CKEDITOR.document.getHead().append("style");d.setAttribute("type","text/css"),CKEDITOR.env.ie&&11>CKEDITOR.env.version?d.$.styleSheet.cssText="textarea.placeholder { color: #999; font-style: italic; }":d.$.innerHTML="textarea.placeholder { color: #999; font-style: italic; }",a.on("getData",function(e){var t=a.editable();t&&t.hasClass("placeholder")&&(e.data.dataValue="")}),a.on("setData",function(n){if(!(CKEDITOR.dialog._.currentTop||"source"==a.mode&&o)){var i=a.editable();i&&(e(n.data.dataValue)?t(n):i.hasClass("placeholder")&&i.removeClass("placeholder"))}}),a.on("blur",t,null,l),a.on("mode",t,null,l),a.on("contentDom",t,null,l),a.on("focus",n),a.on("key",n),a.on("beforeModeUnload",n),a.on("readOnly",i,null,l)}if((l=a.config.contentsLanguage||r(a.element))&&a.plugins.scayt&&!a.config.scayt_sLang){try{localStorage&&localStorage.removeItem("scayt_0_lang")}catch(e){}a.config.scayt_sLang={en:"en_US","en-us":"en_US","en-gb":"en_GB","pt-br":"pt_BR",da:"da_DK","da-dk":"da_DK","nl-nl":"nl_NL","en-ca":"en_CA","fi-fi":"fi_FI",fr:"fr_FR","fr-fr":"fr_FR","fr-ca":"fr_CA",de:"de_DE","de-de":"de_DE","el-gr":"el_GR",it:"it_IT","it-it":"it_IT","nb-no":"nb_NO",pt:"pt_PT","pt-pt":"pt_PT",es:"es_ES","es-es":"es_ES","sv-se":"sv_SE"}[l.toLowerCase()]}var c=function(e){if("object"==typeof e)return e;e=e.split(";");var t,n={};for(t=0;t<e.length;t++){var i=e[t].split(":");if(3==i.length){var r=i[0],o=i[1],i=i[2];n[r]||(n[r]={}),n[r][o]||(n[r][o]=[]),n[r][o].push(i)}}return n};CKEDITOR.on("dialogDefinition",s),a.once("beforeDestroy",function(){CKEDITOR.removeListener("dialogDefinition",s)})}})}(),function(){function e(e,t){var n={},i=[],r={nbsp:"\xa0",shy:"\xad",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'};if(e=e.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,function(e,o){var a=t?"&"+o+";":r[o];return n[a]=t?r[o]:"&"+o+";",i.push(a),""}),e=e.replace(/,$/,""),!t&&e){e=e.split(",");var o,a=document.createElement("div");for(a.innerHTML="&"+e.join(";&")+";",o=a.innerHTML,a=null,a=0;a<o.length;a++){var s=o.charAt(a);n[s]="&"+e[a]+";",i.push(s)}}return n.regex=i.join(t?"|":""),n}CKEDITOR.plugins.add("entities",{afterInit:function(t){function n(e){return l[e]}function i(e){return"force"!=r.entities_processNumerical&&a[e]?a[e]:"&#"+(CKEDITOR.env.ie?e.charCodeAt(0):e.codePointAt(0))+";"}var r=t.config;if(t=(t=t.dataProcessor)&&t.htmlFilter){var o=[];!1!==r.basicEntities&&o.push("nbsp,gt,lt,amp"),r.entities&&(o.length&&o.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),r.entities_latin&&o.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),r.entities_greek&&o.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),r.entities_additional&&o.push(r.entities_additional));var a=e(o.join(",")),s=a.regex?"["+a.regex+"]":"a^";delete a.regex,r.entities&&r.entities_processNumerical&&(s="[^ -~]|"+s);var s=new RegExp(s,CKEDITOR.env.ie?"g":"gu"),l=e("nbsp,gt,lt,amp,shy",!0),d=new RegExp(l.regex,"g");t.addRules({text:function(e){return e.replace(d,n).replace(s,i)}},{applyToAll:!0,excludeNestedEditable:!0})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",function(){function e(e,t){return CKEDITOR.tools.array.reduce(t,function(e,t){return t(e)},e)}var t=[CKEDITOR.CTRL+90,CKEDITOR.CTRL+89,CKEDITOR.CTRL+CKEDITOR.SHIFT+90],n={8:1,46:1};CKEDITOR.plugins.add("undo",{init:function(e){function n(e){o.enabled&&!1!==e.data.command.canUndo&&o.save()}function r(){o.enabled=!e.readOnly&&"wysiwyg"==e.mode,o.onChange()}var o=e.undoManager=new i(e),s=o.editingHandler=new a(o),l=e.addCommand("undo",{exec:function(){o.undo()&&(e.selectionChange(),this.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),d=e.addCommand("redo",{exec:function(){o.redo()&&(e.selectionChange(),this.fire("afterRedo"))},startDisabled:!0,canUndo:!1});e.setKeystroke([[t[0],"undo"],[t[1],"redo"],[t[2],"redo"]]),o.onChange=function(){l.setState(o.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),d.setState(o.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},e.on("beforeCommandExec",n),e.on("afterCommandExec",n),e.on("saveSnapshot",function(e){o.save(e.data&&e.data.contentOnly)}),e.on("contentDom",s.attachListeners,s),e.on("instanceReady",function(){e.fire("saveSnapshot")}),e.on("beforeModeUnload",function(){"wysiwyg"==e.mode&&o.save(!0)}),e.on("mode",r),e.on("readOnly",r),e.ui.addButton&&(e.ui.addButton("Undo",{label:e.lang.undo.undo,command:"undo",toolbar:"undo,10"}),e.ui.addButton("Redo",{label:e.lang.undo.redo,command:"redo",toolbar:"undo,20"})),e.resetUndo=function(){o.reset(),e.fire("saveSnapshot")},e.on("updateSnapshot",function(){o.currentImage&&o.update()}),e.on("lockSnapshot",function(e){e=e.data,o.lock(e&&e.dontUpdate,e&&e.forceUpdate)}),e.on("unlockSnapshot",o.unlock,o)}}),CKEDITOR.plugins.undo={};var i=CKEDITOR.plugins.undo.UndoManager=function(e){this.strokesRecorded=[0,0],this.locked=null,this.previousKeyGroup=-1,this.limit=e.config.undoStackSize||20,this.strokesLimit=25,this._filterRules=[],this.editor=e,this.reset(),CKEDITOR.env.ie&&this.addFilterRule(function(e){return e.replace(/\s+data-cke-expando=".*?"/g,"")})};i.prototype={type:function(e,t){var n=i.getKeyGroup(e),r=this.strokesRecorded[n]+1;t=t||r>=this.strokesLimit,this.typing||(this.hasUndo=this.typing=!0,this.hasRedo=!1,this.onChange()),t?(r=0,this.editor.fire("saveSnapshot")):this.editor.fire("change"),this.strokesRecorded[n]=r,this.previousKeyGroup=n},keyGroupChanged:function(e){return i.getKeyGroup(e)!=this.previousKeyGroup},reset:function(){this.snapshots=[],this.index=-1,this.currentImage=null,this.hasRedo=this.hasUndo=!1,this.locked=null,this.resetType()},resetType:function(){this.strokesRecorded=[0,0],this.typing=!1,this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(!0),this.hasRedo=!!this.getNextImage(!1),this.resetType(),this.onChange()},save:function(e,t,n){var i=this.editor;if(this.locked||"ready"!=i.status||"wysiwyg"!=i.mode)return!1;var o=i.editable();if(!o||"ready"!=o.status)return!1;if(o=this.snapshots,t||(t=new r(i)),!1===t.contents)return!1;if(this.currentImage)if(t.equalsContent(this.currentImage)){if(e||t.equalsSelection(this.currentImage))return!1}else!1!==n&&i.fire("change");return o.splice(this.index+1,o.length-this.index-1),o.length==this.limit&&o.shift(),this.index=o.push(t)-1,this.currentImage=t,!1!==n&&this.refreshState(),!0},restoreImage:function(e){var t,n=this.editor;e.bookmarks&&(n.focus(),t=n.getSelection()),this.locked={level:999},this.editor.loadSnapshot(e.contents),e.bookmarks?t.selectBookmarks(e.bookmarks):CKEDITOR.env.ie&&(t=this.editor.document.getBody().$.createTextRange(),t.collapse(!0),t.select()),this.locked=null,this.index=e.index,this.currentImage=this.snapshots[this.index],this.update(),this.refreshState(),n.fire("change")},getNextImage:function(e){var t,n=this.snapshots,i=this.currentImage;if(i)if(e){for(t=this.index-1;0<=t;t--)if(e=n[t],!i.equalsContent(e))return e.index=t,e}else for(t=this.index+1;t<n.length;t++)if(e=n[t],!i.equalsContent(e))return e.index=t,e;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var e=this.getNextImage(!0);if(e)return this.restoreImage(e),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),this.redoable())){var e=this.getNextImage(!1);if(e)return this.restoreImage(e),!0}return!1},update:function(e){if(!this.locked){e||(e=new r(this.editor));for(var t=this.index,n=this.snapshots;0<t&&this.currentImage.equalsContent(n[t-1]);)--t;n.splice(t,this.index-t+1,e),this.index=t,this.currentImage=e}},updateSelection:function(e){if(!this.snapshots.length)return!1;var t=this.snapshots,n=t[t.length-1];return!(!n.equalsContent(e)||n.equalsSelection(e))&&(this.currentImage=t[t.length-1]=e,!0)},lock:function(e,t){if(this.locked)this.locked.level++;else if(e)this.locked={level:1};else{var n=null;if(t)n=!0;else{var i=new r(this.editor,!0);this.currentImage&&this.currentImage.equalsContent(i)&&(n=i)}this.locked={update:n,level:1}}},unlock:function(){if(this.locked&&!--this.locked.level){var e=this.locked.update;if(this.locked=null,!0===e)this.update();else if(e){var t=new r(this.editor,!0);e.equalsContent(t)||this.update()}}},addFilterRule:function(e){this._filterRules.push(e)}},i.navigationKeyCodes={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1},i.keyGroups={PRINTABLE:0,FUNCTIONAL:1},i.isNavigationKey=function(e){return!!i.navigationKeyCodes[e]},i.getKeyGroup=function(e){var t=i.keyGroups;return n[e]?t.FUNCTIONAL:t.PRINTABLE},i.getOppositeKeyGroup=function(e){var t=i.keyGroups;return e==t.FUNCTIONAL?t.PRINTABLE:t.FUNCTIONAL},i.ieFunctionalKeysBug=function(e){return CKEDITOR.env.ie&&i.getKeyGroup(e)==i.keyGroups.FUNCTIONAL};var r=CKEDITOR.plugins.undo.Image=function(t,n){this.editor=t,t.fire("beforeUndoImage");var i=t.getSnapshot();i&&(this.contents=e(i,t.undoManager._filterRules)),n||(this.bookmarks=(i=i&&t.getSelection())&&i.createBookmarks2(!0)),t.fire("afterUndoImage")},o=/\b(?:href|src|name)="[^"]*?"/gi;r.prototype={equalsContent:function(e){var t=this.contents;return e=e.contents,CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)&&(t=t.replace(o,""),e=e.replace(o,"")),t==e},equalsSelection:function(e){var t=this.bookmarks;if(e=e.bookmarks,t||e){if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++){var i=t[n],r=e[n];if(i.startOffset!=r.startOffset||i.endOffset!=r.endOffset||!CKEDITOR.tools.arrayCompare(i.start,r.start)||!CKEDITOR.tools.arrayCompare(i.end,r.end))return!1}}return!0}};var a=CKEDITOR.plugins.undo.NativeEditingHandler=function(e){this.undoManager=e,this.ignoreInputEvent=!1,this.keyEventsStack=new s,this.lastKeydownImage=null};a.prototype={onKeydown:function(e){var n=e.data.getKey();229!==n&&(-1<CKEDITOR.tools.indexOf(t,e.data.getKeystroke())?e.data.preventDefault():(this.keyEventsStack.cleanUp(e),e=this.undoManager,this.keyEventsStack.getLast(n)||this.keyEventsStack.push(n),this.lastKeydownImage=new r(e.editor),(i.isNavigationKey(n)||this.undoManager.keyGroupChanged(n))&&(e.strokesRecorded[0]||e.strokesRecorded[1])&&(e.save(!1,this.lastKeydownImage,!1),e.resetType())))},onInput:function(){
if(this.ignoreInputEvent)this.ignoreInputEvent=!1;else{var e=this.keyEventsStack.getLast();e||(e=this.keyEventsStack.push(0)),this.keyEventsStack.increment(e.keyCode),this.keyEventsStack.getTotalInputs()>=this.undoManager.strokesLimit&&(this.undoManager.type(e.keyCode,!0),this.keyEventsStack.resetInputs())}},onKeyup:function(e){var t=this.undoManager;e=e.data.getKey();var n=this.keyEventsStack.getTotalInputs();this.keyEventsStack.remove(e),i.ieFunctionalKeysBug(e)&&this.lastKeydownImage&&this.lastKeydownImage.equalsContent(new r(t.editor,!0))||(0<n?t.type(e):i.isNavigationKey(e)&&this.onNavigationKey(!0))},onNavigationKey:function(e){var t=this.undoManager;!e&&t.save(!0,null,!1)||t.updateSelection(new r(t.editor)),t.resetType()},ignoreInputEventListener:function(){this.ignoreInputEvent=!0},activateInputEventListener:function(){this.ignoreInputEvent=!1},attachListeners:function(){var e=this.undoManager.editor,t=e.editable(),n=this;t.attachListener(t,"keydown",function(e){n.onKeydown(e),i.ieFunctionalKeysBug(e.data.getKey())&&n.onInput()},null,null,999),t.attachListener(t,CKEDITOR.env.ie?"keypress":"input",n.onInput,n,null,999),t.attachListener(t,"keyup",n.onKeyup,n,null,999),t.attachListener(t,"paste",n.ignoreInputEventListener,n,null,999),t.attachListener(t,"drop",n.ignoreInputEventListener,n,null,999),e.on("afterPaste",n.activateInputEventListener,n,null,999),t.attachListener(t.isInline()?t:e.document.getDocumentElement(),"click",function(){n.onNavigationKey()},null,null,999),t.attachListener(this.undoManager.editor,"blur",function(){n.keyEventsStack.remove(9)},null,null,999)}};var s=CKEDITOR.plugins.undo.KeyEventsStack=function(){this.stack=[]};s.prototype={push:function(e){return e=this.stack.push({keyCode:e,inputs:0}),this.stack[e-1]},getLastIndex:function(e){if("number"!=typeof e)return this.stack.length-1;for(var t=this.stack.length;t--;)if(this.stack[t].keyCode==e)return t;return-1},getLast:function(e){return e=this.getLastIndex(e),-1!=e?this.stack[e]:null},increment:function(e){this.getLast(e).inputs++},remove:function(e){-1!=(e=this.getLastIndex(e))&&this.stack.splice(e,1)},resetInputs:function(e){if("number"==typeof e)this.getLast(e).inputs=0;else for(e=this.stack.length;e--;)this.stack[e].inputs=0},getTotalInputs:function(){for(var e=this.stack.length,t=0;e--;)t+=this.stack[e].inputs;return t},cleanUp:function(e){e=e.data.$,e.ctrlKey||e.metaKey||this.remove(17),e.shiftKey||this.remove(16),e.altKey||this.remove(18)}}}(),function(){function e(e,t){CKEDITOR.tools.extend(this,{editor:e,editable:e.editable(),doc:e.document,win:e.window},t,!0),this.inline=this.editable.isInline(),this.inline||(this.frame=this.win.getFrame()),this.target=this[this.inline?"editable":"doc"]}function t(e,t){CKEDITOR.tools.extend(this,t,{editor:e},!0)}function n(e,t){var n=e.editable();CKEDITOR.tools.extend(this,{editor:e,editable:n,inline:n.isInline(),doc:e.document,win:e.window,container:CKEDITOR.document.getBody(),winTop:CKEDITOR.document.getWindow()},t,!0),this.hidden={},this.visible={},this.inline||(this.frame=this.win.getFrame()),this.queryViewport();var i=CKEDITOR.tools.bind(this.queryViewport,this),a=CKEDITOR.tools.bind(this.hideVisible,this),s=CKEDITOR.tools.bind(this.removeAll,this);n.attachListener(this.winTop,"resize",i),n.attachListener(this.winTop,"scroll",i),n.attachListener(this.winTop,"resize",a),n.attachListener(this.win,"scroll",a),n.attachListener(this.inline?n:this.frame,"mouseout",function(e){var t=e.data.$.clientX;e=e.data.$.clientY,this.queryViewport(),(t<=this.rect.left||t>=this.rect.right||e<=this.rect.top||e>=this.rect.bottom)&&this.hideVisible(),(0>=t||t>=this.winTopPane.width||0>=e||e>=this.winTopPane.height)&&this.hideVisible()},this),n.attachListener(e,"resize",i),n.attachListener(e,"mode",s),e.on("destroy",s),this.lineTpl=new CKEDITOR.template('<div data-cke-lineutils-line="1" class="cke_reset_all" style="{lineStyle}"><span style="{tipLeftStyle}">&nbsp;</span><span style="{tipRightStyle}">&nbsp;</span></div>').output({lineStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},o,this.lineStyle,!0)),tipLeftStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},r,{left:"0px","border-left-color":"red","border-width":"6px 0 6px 6px"},this.tipCss,this.tipLeftStyle,!0)),tipRightStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},r,{right:"0px","border-right-color":"red","border-width":"6px 6px 6px 0"},this.tipCss,this.tipRightStyle,!0))})}function i(e){var t;return(t=e&&e.type==CKEDITOR.NODE_ELEMENT)&&(t=!(a[e.getComputedStyle("float")]||a[e.getAttribute("align")])),t&&!s[e.getComputedStyle("position")]}CKEDITOR.plugins.add("lineutils"),CKEDITOR.LINEUTILS_BEFORE=1,CKEDITOR.LINEUTILS_AFTER=2,CKEDITOR.LINEUTILS_INSIDE=4,e.prototype={start:function(e){var t,n,i,r,o=this,a=this.editor,s=this.doc,l=CKEDITOR.tools.eventsBuffer(50,function(){a.readOnly||"wysiwyg"!=a.mode||(o.relations={},(n=s.$.elementFromPoint(i,r))&&n.nodeType&&(t=new CKEDITOR.dom.element(n),o.traverseSearch(t),isNaN(i+r)||o.pixelSearch(t,i,r),e&&e(o.relations,i,r)))});this.listener=this.editable.attachListener(this.target,"mousemove",function(e){i=e.data.$.clientX,r=e.data.$.clientY,l.input()}),this.editable.attachListener(this.inline?this.editable:this.frame,"mouseout",function(){l.reset()})},stop:function(){this.listener&&this.listener.removeListener()},getRange:function(){var e={};return e[CKEDITOR.LINEUTILS_BEFORE]=CKEDITOR.POSITION_BEFORE_START,e[CKEDITOR.LINEUTILS_AFTER]=CKEDITOR.POSITION_AFTER_END,e[CKEDITOR.LINEUTILS_INSIDE]=CKEDITOR.POSITION_AFTER_START,function(t){var n=this.editor.createRange();return n.moveToPosition(this.relations[t.uid].element,e[t.type]),n}}(),store:function(){function e(e,t,n){var i=e.getUniqueId();i in n?n[i].type|=t:n[i]={element:e,type:t}}return function(t,n){var r;n&CKEDITOR.LINEUTILS_AFTER&&i(r=t.getNext())&&r.isVisible()&&(e(r,CKEDITOR.LINEUTILS_BEFORE,this.relations),n^=CKEDITOR.LINEUTILS_AFTER),n&CKEDITOR.LINEUTILS_INSIDE&&i(r=t.getFirst())&&r.isVisible()&&(e(r,CKEDITOR.LINEUTILS_BEFORE,this.relations),n^=CKEDITOR.LINEUTILS_INSIDE),e(t,n,this.relations)}}(),traverseSearch:function(e){var t,n,r;do{if(!((r=e.$["data-cke-expando"])&&r in this.relations)){if(e.equals(this.editable))break;if(i(e))for(t in this.lookups)(n=this.lookups[t](e))&&this.store(e,n)}}while((!e||e.type!=CKEDITOR.NODE_ELEMENT||"true"!=e.getAttribute("contenteditable"))&&(e=e.getParent()))},pixelSearch:function(){function e(e,n,r,o,a){for(var s,l=0;a(r)&&(r+=o,25!=++l);)if(s=this.doc.$.elementFromPoint(n,r))if(s==e)l=0;else if(t(e,s)&&(l=0,i(s=new CKEDITOR.dom.element(s))))return s}var t=CKEDITOR.env.ie||CKEDITOR.env.webkit?function(e,t){return e.contains(t)}:function(e,t){return!!(16&e.compareDocumentPosition(t))};return function(t,n,r){var o=this.win.getViewPaneSize().height,a=e.call(this,t.$,n,r,-1,function(e){return 0<e});if(n=e.call(this,t.$,n,r,1,function(e){return e<o}),a)for(this.traverseSearch(a);!a.getParent().equals(t);)a=a.getParent();if(n)for(this.traverseSearch(n);!n.getParent().equals(t);)n=n.getParent();for(;(a||n)&&(a&&(a=a.getNext(i)),a&&!a.equals(n))&&(this.traverseSearch(a),n&&(n=n.getPrevious(i)),n&&!n.equals(a));)this.traverseSearch(n)}}(),greedySearch:function(){this.relations={};for(var e,t,n,r=this.editable.getElementsByTag("*"),o=0;e=r.getItem(o++);)if(!e.equals(this.editable)&&e.type==CKEDITOR.NODE_ELEMENT&&(e.hasAttribute("contenteditable")||!e.isReadOnly())&&i(e)&&e.isVisible())for(n in this.lookups)(t=this.lookups[n](e))&&this.store(e,t);return this.relations}},t.prototype={locate:function(){function e(e,t){var n=e.element[t===CKEDITOR.LINEUTILS_BEFORE?"getPrevious":"getNext"]();return n&&i(n)?(e.siblingRect=n.getClientRect(),t==CKEDITOR.LINEUTILS_BEFORE?(e.siblingRect.bottom+e.elementRect.top)/2:(e.elementRect.bottom+e.siblingRect.top)/2):t==CKEDITOR.LINEUTILS_BEFORE?e.elementRect.top:e.elementRect.bottom}return function(t){var n;this.locations={};for(var i in t)n=t[i],n.elementRect=n.element.getClientRect(),n.type&CKEDITOR.LINEUTILS_BEFORE&&this.store(i,CKEDITOR.LINEUTILS_BEFORE,e(n,CKEDITOR.LINEUTILS_BEFORE)),n.type&CKEDITOR.LINEUTILS_AFTER&&this.store(i,CKEDITOR.LINEUTILS_AFTER,e(n,CKEDITOR.LINEUTILS_AFTER)),n.type&CKEDITOR.LINEUTILS_INSIDE&&this.store(i,CKEDITOR.LINEUTILS_INSIDE,(n.elementRect.top+n.elementRect.bottom)/2);return this.locations}}(),sort:function(){var e,t,n,i;return function(r,o){e=this.locations,t=[];for(var a in e)for(var s in e[a])if(n=Math.abs(r-e[a][s]),t.length){for(i=0;i<t.length;i++)if(n<t[i].dist){t.splice(i,0,{uid:+a,type:s,dist:n});break}i==t.length&&t.push({uid:+a,type:s,dist:n})}else t.push({uid:+a,type:s,dist:n});return void 0!==o?t.slice(0,o):t}}(),store:function(e,t,n){this.locations[e]||(this.locations[e]={}),this.locations[e][t]=n}};var r={display:"block",width:"0px",height:"0px","border-color":"transparent","border-style":"solid",position:"absolute",top:"-6px"},o={height:"0px","border-top":"1px dashed red",position:"absolute","z-index":9999};n.prototype={removeAll:function(){for(var e in this.hidden)this.hidden[e].remove(),delete this.hidden[e];for(e in this.visible)this.visible[e].remove(),delete this.visible[e]},hideLine:function(e){var t=e.getUniqueId();e.hide(),this.hidden[t]=e,delete this.visible[t]},showLine:function(e){var t=e.getUniqueId();e.show(),this.visible[t]=e,delete this.hidden[t]},hideVisible:function(){for(var e in this.visible)this.hideLine(this.visible[e])},placeLine:function(e,t){var n,i,r;if(n=this.getStyle(e.uid,e.type)){for(r in this.visible)if(this.visible[r].getCustomData("hash")!==this.hash){i=this.visible[r];break}if(!i)for(r in this.hidden)if(this.hidden[r].getCustomData("hash")!==this.hash){this.showLine(i=this.hidden[r]);break}i||this.showLine(i=this.addLine()),i.setCustomData("hash",this.hash),this.visible[i.getUniqueId()]=i,i.setStyles(n),t&&t(i)}},getStyle:function(e,t){var n=this.relations[e],i=this.locations[e][t],r={};if(r.width=n.siblingRect?Math.max(n.siblingRect.width,n.elementRect.width):n.elementRect.width,r.top=this.inline?i+this.winTopScroll.y-this.rect.relativeY:this.rect.top+this.winTopScroll.y+i,r.top-this.winTopScroll.y<this.rect.top||r.top-this.winTopScroll.y>this.rect.bottom)return!1;this.inline?r.left=n.elementRect.left-this.rect.relativeX:(0<n.elementRect.left?r.left=this.rect.left+n.elementRect.left:(r.width+=n.elementRect.left,r.left=this.rect.left),0<(n=r.left+r.width-(this.rect.left+this.winPane.width))&&(r.width-=n)),r.left+=this.winTopScroll.x;for(var o in r)r[o]=CKEDITOR.tools.cssLength(r[o]);return r},addLine:function(){var e=CKEDITOR.dom.element.createFromHtml(this.lineTpl);return e.appendTo(this.container),e},prepare:function(e,t){this.relations=e,this.locations=t,this.hash=Math.random()},cleanup:function(){var e,t;for(t in this.visible)e=this.visible[t],e.getCustomData("hash")!==this.hash&&this.hideLine(e)},queryViewport:function(){this.winPane=this.win.getViewPaneSize(),this.winTopScroll=this.winTop.getScrollPosition(),this.winTopPane=this.winTop.getViewPaneSize(),this.rect=this.getClientRect(this.inline?this.editable:this.frame)},getClientRect:function(e){e=e.getClientRect();var t=this.container.getDocumentPosition(),n=this.container.getComputedStyle("position");return e.relativeX=e.relativeY=0,"static"!=n&&(e.relativeY=t.y,e.relativeX=t.x,e.top-=e.relativeY,e.bottom-=e.relativeY,e.left-=e.relativeX,e.right-=e.relativeX),e}};var a={left:1,right:1,center:1},s={absolute:1,fixed:1};CKEDITOR.plugins.lineutils={finder:e,locator:t,liner:n}}(),function(){function e(e){return e.getName&&!e.hasAttribute("data-cke-temp")}CKEDITOR.plugins.add("widgetselection",{init:function(e){if(CKEDITOR.env.webkit){var t=CKEDITOR.plugins.widgetselection;e.on("contentDom",function(e){e=e.editor;var n=e.editable();n.attachListener(n,"keydown",function(e){e.data.getKeystroke()==CKEDITOR.CTRL+65&&CKEDITOR.tools.setTimeout(function(){t.addFillers(n)||t.removeFillers(n)},0)},null,null,-1),e.on("selectionCheck",function(e){t.removeFillers(e.editor.editable())}),e.on("paste",function(e){e.data.dataValue=t.cleanPasteData(e.data.dataValue)}),"selectall"in e.plugins&&t.addSelectAllIntegration(e)})}}}),CKEDITOR.plugins.widgetselection={startFiller:null,endFiller:null,fillerAttribute:"data-cke-filler-webkit",fillerContent:"&nbsp;",fillerTagName:"div",addFillers:function(t){var n=t.editor;if(!this.isWholeContentSelected(t)&&0<t.getChildCount()){var i=t.getFirst(e),r=t.getLast(e);if(i&&i.type==CKEDITOR.NODE_ELEMENT&&!i.isEditable()&&(this.startFiller=this.createFiller(),t.append(this.startFiller,1)),r&&r.type==CKEDITOR.NODE_ELEMENT&&!r.isEditable()&&(this.endFiller=this.createFiller(!0),t.append(this.endFiller,0)),this.hasFiller(t))return n=n.createRange(),n.selectNodeContents(t),n.select(),!0}return!1},removeFillers:function(e){if(this.hasFiller(e)&&!this.isWholeContentSelected(e)){var t=e.findOne(this.fillerTagName+"["+this.fillerAttribute+"=start]"),n=e.findOne(this.fillerTagName+"["+this.fillerAttribute+"=end]");this.startFiller&&t&&this.startFiller.equals(t)?this.removeFiller(this.startFiller,e):this.startFiller=t,this.endFiller&&n&&this.endFiller.equals(n)?this.removeFiller(this.endFiller,e):this.endFiller=n}},cleanPasteData:function(e){return e&&e.length&&(e=e.replace(this.createFillerRegex(),"").replace(this.createFillerRegex(!0),"")),e},isWholeContentSelected:function(e){var t=e.editor.getSelection().getRanges()[0];return!(!t||t&&t.collapsed)&&(t=t.clone(),t.enlarge(CKEDITOR.ENLARGE_ELEMENT),!!(t&&e&&t.startContainer&&t.endContainer&&0===t.startOffset&&t.endOffset===e.getChildCount()&&t.startContainer.equals(e)&&t.endContainer.equals(e)))},hasFiller:function(e){return 0<e.find(this.fillerTagName+"["+this.fillerAttribute+"]").count()},createFiller:function(e){var t=new CKEDITOR.dom.element(this.fillerTagName);return t.setHtml(this.fillerContent),t.setAttribute(this.fillerAttribute,e?"end":"start"),t.setAttribute("data-cke-temp",1),t.setStyles({display:"block",width:0,height:0,padding:0,border:0,margin:0,position:"absolute",top:0,left:"-9999px",opacity:0,overflow:"hidden"}),t},removeFiller:function(e,t){if(e){var n,i,r=t.editor,o=t.editor.getSelection().getRanges()[0].startPath(),a=r.createRange();o.contains(e)&&(n=e.getHtml(),i=!0),o="start"==e.getAttribute(this.fillerAttribute),e.remove(),n&&0<n.length&&n!=this.fillerContent?(t.insertHtmlIntoRange(n,r.getSelection().getRanges()[0]),a.setStartAt(t.getChild(t.getChildCount()-1),CKEDITOR.POSITION_BEFORE_END),r.getSelection().selectRanges([a])):i&&(o?a.setStartAt(t.getFirst().getNext(),CKEDITOR.POSITION_AFTER_START):a.setEndAt(t.getLast().getPrevious(),CKEDITOR.POSITION_BEFORE_END),t.editor.getSelection().selectRanges([a]))}},createFillerRegex:function(e){var t=this.createFiller(e).getOuterHtml().replace(/style="[^"]*"/gi,'style="[^"]*"').replace(/>[^<]*</gi,">[^<]*<");return new RegExp((e?"":"^")+t+(e?"$":""))},addSelectAllIntegration:function(e){var t=this;e.editable().attachListener(e,"beforeCommandExec",function(n){var i=e.editable();"selectAll"==n.data.name&&i&&t.addFillers(i)},null,null,9999)}}}(),function(){function e(e){this.editor=e,this.registered={},this.instances={},this.selected=[],this.widgetHoldingFocusedEditable=this.focused=null,this._={nextId:0,upcasts:[],upcastCallbacks:[],filters:{}},R(this),D(this),this.on("checkWidgets",a),this.editor.on("contentDomInvalidated",this.checkWidgets,this),I(this),C(this),v(this),T(this),O(this)}function t(e,n,i,r,o){var a=e.editor;CKEDITOR.tools.extend(this,r,{editor:a,id:n,inline:"span"==i.getParent().getName(),element:i,data:CKEDITOR.tools.extend({},"function"==typeof r.defaults?r.defaults():r.defaults),dataReady:!1,inited:!1,ready:!1,edit:t.prototype.edit,focusedEditable:null,definition:r,repository:e,draggable:!1!==r.draggable,_:{downcastFn:r.downcast&&"string"==typeof r.downcast?r.downcasts[r.downcast]:r.downcast}},!0),e.fire("instanceCreated",this),P(this,r),this.init&&this.init(),this.inited=!0,(e=this.element.data("cke-widget-data"))&&this.setData(JSON.parse(decodeURIComponent(e))),o&&this.setData(o),this.data.classes||this.setData("classes",this.getClasses()),this.dataReady=!0,W(this),this.fire("data",this.data),this.isInited()&&a.editable().contains(this.wrapper)&&(this.ready=!0,this.fire("ready"))}function n(e,t,n){CKEDITOR.dom.element.call(this,t.$),this.editor=e,this._={},t=this.filter=n.filter,CKEDITOR.dtd[this.getName()].p?(this.enterMode=t?t.getAllowedEnterMode(e.enterMode):e.enterMode,this.shiftEnterMode=t?t.getAllowedEnterMode(e.shiftEnterMode,!0):e.shiftEnterMode):this.enterMode=this.shiftEnterMode=CKEDITOR.ENTER_BR}function i(e,t){e.addCommand(t.name,{exec:function(e,n){function i(){e.widgets.finalizeCreation(s)}var r=e.widgets.focused;if(r&&r.name==t.name)r.edit();else if(t.insert)t.insert({editor:e,commandData:n});else if(t.template){var o,r="function"==typeof t.defaults?t.defaults():t.defaults,r=CKEDITOR.tools.object.merge(r||{},n&&n.startupData||{}),r=CKEDITOR.dom.element.createFromHtml(t.template.output(r),e.document),a=e.widgets.wrapElement(r,t.name),s=new CKEDITOR.dom.documentFragment(a.getDocument());s.append(a),(o=e.widgets.initOn(r,t,n&&n.startupData))?(r=o.once("edit",function(t){t.data.dialog?o.once("dialog",function(t){t=t.data;var n,r;n=t.once("ok",i,null,null,20),r=t.once("cancel",function(t){t.data&&!1===t.data.hide||e.widgets.destroy(o,!0)}),t.once("hide",function(){n.removeListener(),r.removeListener()})}):i()},null,null,999),o.edit(),r.removeListener()):i()}},allowedContent:t.allowedContent,requiredContent:t.requiredContent,contentForms:t.contentForms,contentTransformations:t.contentTransformations})}function r(e,t){function n(e,n){var i,r,o=t.upcast.split(",");for(r=0;r<o.length;r++)if((i=o[r])===e.name)return t.upcasts[i].call(this,e,n);return!1}function i(t,n,i){var r=CKEDITOR.tools.getIndex(e._.upcasts,function(e){return e[2]>i});0>r&&(r=e._.upcasts.length),e._.upcasts.splice(r,0,[CKEDITOR.tools.bind(t,n),n.name,i])}var r=t.upcast,o=t.upcastPriority||10;r&&("string"==typeof r?i(n,t,o):i(r,t,o))}function o(e,t){if(e.focused=null,t.isInited()){var n=t.editor.checkDirty();e.fire("widgetBlurred",{widget:t}),t.setFocused(!1),!n&&t.editor.resetDirty()}}function a(e){if(e=e.data,"wysiwyg"==this.editor.mode){var n,i,r,o,a=this.editor.editable(),s=this.instances;if(a){for(n in s)s[n].isReady()&&!a.contains(s[n].wrapper)&&this.destroy(s[n],!0);if(e&&e.initOnlyNew)s=this.initOnAll();else{var l=a.find(".cke_widget_wrapper"),s=[];for(n=0,i=l.count();n<i;n++){if(r=l.getItem(n),o=!this.getByElement(r,!0)){e:{o=p;for(var d=r;d=d.getParent();)if(o(d)){o=!0;break e}o=!1}o=!o}o&&a.contains(r)&&(r.addClass("cke_widget_new"),s.push(this.initOn(r.getFirst(t.isDomWidgetElement))))}}e&&e.focusInited&&1==s.length&&s[0].focus()}}}function s(e){if(void 0!==e.attributes&&e.attributes["data-widget"]){var t=l(e),n=d(e),i=!1;t&&t.value&&t.value.match(/^\s/g)&&(t.parent.attributes["data-cke-white-space-first"]=1,t.value=t.value.replace(/^\s/g,"&nbsp;"),i=!0),n&&n.value&&n.value.match(/\s$/g)&&(n.parent.attributes["data-cke-white-space-last"]=1,n.value=n.value.replace(/\s$/g,"&nbsp;"),i=!0),i&&(e.attributes["data-cke-widget-white-space"]=1)}}function l(e){return e.find(function(e){return 3===e.type},!0).shift()}function d(e){return e.find(function(e){return 3===e.type},!0).pop()}function c(e,t,n){if(!n.allowedContent&&!n.disallowedContent)return null;var i=this._.filters[e];return i||(this._.filters[e]=i={}),e=i[t],e||(e=n.allowedContent?new CKEDITOR.filter(n.allowedContent):this.editor.filter.clone(),i[t]=e,n.disallowedContent&&e.disallow(n.disallowedContent)),e}function h(e){var n=[],i=e._.upcasts,r=e._.upcastCallbacks;return{toBeWrapped:n,iterator:function(e){var o,a,s,l,d;if("data-cke-widget-wrapper"in e.attributes)return(e=e.getFirst(t.isParserWidgetElement))&&n.push([e]),!1;if("data-widget"in e.attributes)return n.push([e]),!1;if(d=i.length){if(e.attributes["data-cke-widget-upcasted"])return!1;for(l=0,o=r.length;l<o;++l)if(!1===r[l](e))return;for(l=0;l<d;++l)if(o=i[l],s={},a=o[0](e,s))return a instanceof CKEDITOR.htmlParser.element&&(e=a),e.attributes["data-cke-widget-data"]=encodeURIComponent(JSON.stringify(s)),e.attributes["data-cke-widget-upcasted"]=1,n.push([e,o[1]]),!1}}}}function u(e,t){return{tabindex:-1,contenteditable:"false","data-cke-widget-wrapper":1,"data-cke-filter":"off",class:"cke_widget_wrapper cke_widget_new cke_widget_"+(e?"inline":"block")+(t?" cke_widget_"+t:"")}}function f(e,t,n){if(e.type==CKEDITOR.NODE_ELEMENT){var i=CKEDITOR.dtd[e.name];if(i&&!i[n.name]){var i=e.split(t),r=e.parent;return t=i.getIndex(),e.children.length||(--t,e.remove()),i.children.length||i.remove(),f(r,t,n)}}e.add(n,t)}function g(e,t){return"boolean"==typeof e.inline?e.inline:!!CKEDITOR.dtd.$inline[t]}function p(e){return e.hasAttribute("data-cke-temp")}function m(e,t,n,i){var r=e.editor;r.fire("lockSnapshot"),n?(i=n.data("cke-widget-editable"),i=t.editables[i],e.widgetHoldingFocusedEditable=t,t.focusedEditable=i,n.addClass("cke_widget_editable_focused"),i.filter&&r.setActiveFilter(i.filter),r.setActiveEnterMode(i.enterMode,i.shiftEnterMode)):(i||t.focusedEditable.removeClass("cke_widget_editable_focused"),t.focusedEditable=null,e.widgetHoldingFocusedEditable=null,r.setActiveFilter(null),r.setActiveEnterMode(null,null)),r.fire("unlockSnapshot")}function E(e){e.contextMenu&&e.contextMenu.addListener(function(t){if(t=e.widgets.getByElement(t,!0))return t.fire("contextMenu",{})})}function _(e,t){return CKEDITOR.tools.trim(t)}function T(e){var n=e.editor,i=CKEDITOR.plugins.lineutils;n.on("dragstart",function(i){var r=i.data.target;t.isDomDragHandler(r)&&(r=e.getByElement(r),i.data.dataTransfer.setData("cke/widget-id",r.id),n.focus(),r.focus())}),n.on("drop",function(t){var i=t.data.dataTransfer,r=i.getData("cke/widget-id"),o=i.getTransferType(n),i=n.createRange(),a=function(e){return e=e.getBoundaryNodes().startNode,e.type!==CKEDITOR.NODE_ELEMENT&&(e=e.getParent()),n.widgets.getByElement(e)}(t.data.dropRange);""!==r&&o===CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?t.cancel():o==CKEDITOR.DATA_TRANSFER_INTERNAL&&(""===r&&0<n.widgets.selected.length?t.data.dataTransfer.setData("text/html",L(n)):(r=e.instances[r])&&(!function(e,t){return!(!e||!t)&&(e.wrapper.equals(t.wrapper)||e.wrapper.contains(t.wrapper))}(r,a)?(i.setStartBefore(r.wrapper),i.setEndAfter(r.wrapper),t.data.dragRange=i,delete CKEDITOR.plugins.clipboard.dragStartContainerChildCount,delete CKEDITOR.plugins.clipboard.dragEndContainerChildCount,t.data.dataTransfer.setData("text/html",r.getClipboardHtml()),n.widgets.destroy(r,!0)):t.cancel()))}),n.on("contentDom",function(){var r=n.editable();CKEDITOR.tools.extend(e,{finder:new i.finder(n,{lookups:{default:function(n){if(!n.is(CKEDITOR.dtd.$listItem)&&n.is(CKEDITOR.dtd.$block)&&!t.isDomNestedEditable(n)&&!e._.draggedWidget.wrapper.contains(n)){var i=t.getNestedEditable(r,n);if(i){if(n=e._.draggedWidget,e.getByElement(i)==n)return;if(i=CKEDITOR.filter.instances[i.data("cke-filter")],n=n.requiredContent,i&&n&&!i.check(n))return}return CKEDITOR.LINEUTILS_BEFORE|CKEDITOR.LINEUTILS_AFTER}}}}),locator:new i.locator(n),liner:new i.liner(n,{lineStyle:{cursor:"move !important","border-top-color":"#666"},tipLeftStyle:{"border-left-color":"#666"},tipRightStyle:{"border-right-color":"#666"}})},!0)})}function C(e){var n=e.editor;n.on("contentDom",function(){var i,r,o=n.editable(),a=o.isInline()?o:n.document;o.attachListener(a,"mousedown",function(o){var a=o.data.getTarget();i=a instanceof CKEDITOR.dom.element?e.getByElement(a):null,r=0,i&&(i.inline&&a.type==CKEDITOR.NODE_ELEMENT&&a.hasAttribute("data-cke-widget-drag-handler")?(r=1,e.focused!=i&&n.getSelection().removeAllRanges()):t.getNestedEditable(i.wrapper,a)?i=null:(o.data.preventDefault(),CKEDITOR.env.ie||i.focus()))}),o.attachListener(a,"mouseup",function(){r&&i&&i.wrapper&&(r=0,i.focus())}),CKEDITOR.env.ie&&o.attachListener(a,"mouseup",function(){setTimeout(function(){i&&i.wrapper&&o.contains(i.wrapper)&&(i.focus(),i=null)})})}),n.on("doubleclick",function(n){var i=e.getByElement(n.data.element);if(i&&!t.getNestedEditable(i.wrapper,n.data.element))return i.fire("doubleclick",{element:n.data.element})},null,null,1)}function v(e){e.editor.on("key",function(t){var n,i=e.focused,r=e.widgetHoldingFocusedEditable;return i?n=i.fire("key",{keyCode:t.data.keyCode}):r&&(i=t.data.keyCode,t=r.focusedEditable,i==CKEDITOR.CTRL+65?(i=t.getBogus(),r=r.editor.createRange(),r.selectNodeContents(t),i&&r.setEndAt(i,CKEDITOR.POSITION_BEFORE_START),r.select(),n=!1):8==i||46==i?(n=r.editor.getSelection().getRanges(),r=n[0],n=!(1==n.length&&r.collapsed&&r.checkBoundaryOfElement(t,CKEDITOR[8==i?"START":"END"]))):n=void 0),n},null,null,1)}function O(e){function t(t){1>e.selected.length||N(n,"cut"===t.name)}var n=e.editor;n.on("contentDom",function(){var e=n.editable();e.attachListener(e,"copy",t),e.attachListener(e,"cut",t)})}function I(e){function n(){var e=a.getSelection();if(e&&(e=e.getRanges()[0])&&!e.collapsed){var t=i(e.startContainer),n=i(e.endContainer);!t&&n?(e.setEndBefore(n.wrapper),e.select()):t&&!n&&(e.setStartAfter(t.wrapper),e.select())}}function i(e){return e?e.type==CKEDITOR.NODE_TEXT?i(e.getParent()):a.widgets.getByElement(e):null}function r(){e.fire("checkSelection")}var a=e.editor;a.on("selectionCheck",r),a.on("contentDom",function(){a.editable().attachListener(a,"key",function(){setTimeout(r,10)})}),CKEDITOR.env.ie||e.on("checkSelection",n),e.on("checkSelection",e.checkSelection,e),a.on("selectionChange",function(n){var i=(n=t.getNestedEditable(a.editable(),n.data.selection.getStartElement()))&&e.getByElement(n),r=e.widgetHoldingFocusedEditable;r?r===i&&r.focusedEditable.equals(n)||(m(e,r,null),i&&n&&m(e,i,n)):i&&n&&m(e,i,n)}),a.on("dataReady",function(){b(e).commit()}),a.on("blur",function(){var t;(t=e.focused)&&o(e,t),(t=e.widgetHoldingFocusedEditable)&&m(e,t,null)})}function D(e){var n=e.editor,i={};n.on("toDataFormat",function(n){var r=CKEDITOR.tools.getNextNumber(),o=[];n.data.downcastingSessionId=r,i[r]=o,n.data.dataValue.forEach(function(n){var i,r=n.attributes;if("data-cke-widget-white-space"in r){i=l(n);var a=d(n);i.parent.attributes["data-cke-white-space-first"]&&(i.value=i.value.replace(/^&nbsp;/g," ")),a.parent.attributes["data-cke-white-space-last"]&&(a.value=a.value.replace(/&nbsp;$/g," "))}if("data-cke-widget-id"in r)(r=e.instances[r["data-cke-widget-id"]])&&(i=n.getFirst(t.isParserWidgetElement),o.push({wrapper:n,element:i,widget:r,editables:{}}),i&&"1"!=i.attributes["data-cke-widget-keep-attr"]&&delete i.attributes["data-widget"]);else if("data-cke-widget-editable"in r)return 0<o.length&&(o[o.length-1].editables[r["data-cke-widget-editable"]]=n),!1},CKEDITOR.NODE_ELEMENT,!0)},null,null,8),n.on("toDataFormat",function(e){if(e.data.downcastingSessionId)for(var t,n,r,o,a,s,l=i[e.data.downcastingSessionId];t=l.shift();){n=t.widget,r=t.element,o=n._.downcastFn&&n._.downcastFn.call(n,r),e.data.widgetsCopy&&n.getClipboardHtml&&(o=CKEDITOR.htmlParser.fragment.fromHtml(n.getClipboardHtml()),o=o.children[0]);for(s in t.editables)a=t.editables[s],delete a.attributes.contenteditable,a.setHtml(n.editables[s].getData());o||(o=r),o?t.wrapper.replaceWith(o):t.wrapper.remove()}},null,null,13),n.on("contentDomUnload",function(){e.destroyAll(!0)})}function R(e){var n,i,r=e.editor;r.on("toHtml",function(i){var r,o=h(e);for(i.data.dataValue.forEach(o.iterator,CKEDITOR.NODE_ELEMENT,!0);r=o.toBeWrapped.pop();){var a=r[0],s=a.parent;s.type==CKEDITOR.NODE_ELEMENT&&s.attributes["data-cke-widget-wrapper"]&&s.replaceWith(a),e.wrapElement(r[0],r[1])}n=i.data.protectedWhitespaces?3==i.data.dataValue.children.length&&t.isParserWidgetWrapper(i.data.dataValue.children[1]):1==i.data.dataValue.children.length&&t.isParserWidgetWrapper(i.data.dataValue.children[0])},null,null,8),r.on("dataReady",function(){if(i)for(var n,o,a=r.editable().find(".cke_widget_wrapper"),s=0,l=a.count();s<l;++s)n=a.getItem(s),o=n.getFirst(t.isDomWidgetElement),o.type==CKEDITOR.NODE_ELEMENT&&o.data("widget")?(o.replace(n),e.wrapElement(o)):n.remove();i=0,e.destroyAll(!0),e.initOnAll()}),r.on("loadSnapshot",function(t){/data-cke-widget/.test(t.data)&&(i=1),e.destroyAll(!0)},null,null,9),r.on("paste",function(e){e=e.data,e.dataValue=e.dataValue.replace(X,_),e.range&&(e=t.getNestedEditable(r.editable(),e.range.startContainer))&&(e=CKEDITOR.filter.instances[e.data("cke-filter")])&&r.setActiveFilter(e)}),r.on("afterInsertHtml",function(t){t.data.intoRange?e.checkWidgets({initOnlyNew:!0}):(r.fire("lockSnapshot"),e.checkWidgets({initOnlyNew:!0,focusInited:n}),r.fire("unlockSnapshot"))})}function b(e){var t=e.selected,n=[],i=t.slice(0),r=null;return{select:function(e){return 0>CKEDITOR.tools.indexOf(t,e)&&n.push(e),e=CKEDITOR.tools.indexOf(i,e),0<=e&&i.splice(e,1),this},focus:function(e){return r=e,this},commit:function(){var a,s,l=e.focused!==r;for(e.editor.fire("lockSnapshot"),l&&(a=e.focused)&&o(e,a);a=i.pop();)t.splice(CKEDITOR.tools.indexOf(t,a),1),a.isInited()&&(s=a.editor.checkDirty(),a.setSelected(!1),!s&&a.editor.resetDirty());for(l&&r&&(s=e.editor.checkDirty(),e.focused=r,e.fire("widgetFocused",{widget:r}),r.setFocused(!0),!s&&e.editor.resetDirty());a=n.pop();)t.push(a),a.setSelected(!0);e.editor.fire("unlockSnapshot")}}}function y(e){e&&e.addFilterRule(function(e){return e.replace(/\s*cke_widget_selected/g,"").replace(/\s*cke_widget_focused/g,"")})}function K(e,t,n){var i=0;t=x(t);var r,o=e.data.classes||{};if(t){for(o=CKEDITOR.tools.clone(o);r=t.pop();)n?o[r]||(i=o[r]=1):o[r]&&(delete o[r],i=1);i&&e.setData("classes",o)}}function k(e){e.cancel()}function w(e,t){var n=function(e){return e==CKEDITOR.ENTER_BR?"br":e==CKEDITOR.ENTER_DIV?"div":"p"}(e.editor.config.enterMode),i=new CKEDITOR.dom.element(n);"br"!==n&&i.appendBogus(),"after"===t?i.insertAfter(e.wrapper):i.insertBefore(e.wrapper),function(t){var n=e.editor.createRange();n.setStart(t,0),e.editor.getSelection().selectRanges([n])}(i)}function N(e,t){var n,i,r,o=e.widgets.focused;J.hasCopyBin(e)||(i=new J(e,{beforeDestroy:function(){!t&&o&&o.focus(),r&&e.getSelection().selectBookmarks(r),n&&CKEDITOR.plugins.widgetselection.addFillers(e.editable())},afterDestroy:function(){t&&!e.readOnly&&(o?e.widgets.del(o):e.extractSelectedHtml(),e.fire("saveSnapshot"))}}),o||(n=CKEDITOR.env.webkit&&CKEDITOR.plugins.widgetselection.isWholeContentSelected(e.editable()),r=e.getSelection().createBookmarks(!0)),i.handle(L(e)))}function x(e){return(e=(e=e.getDefinition().attributes)&&e.class)?e.split(/\s+/):null}function S(){var e=CKEDITOR.document.getActive(),t=this.editor,n=t.editable();(n.isInline()?n:t.document.getWindow().getFrame()).equals(e)&&t.focusManager.focus(n)}function A(){CKEDITOR.env.gecko&&this.editor.unlockSelection(),CKEDITOR.env.webkit||(this.editor.forceNextSelectionCheck(),this.editor.selectionChange(1))}function L(e){var t=e.getSelectedHtml(!0);return e.widgets.focused?e.widgets.focused.getClipboardHtml():(e.once("toDataFormat",function(e){e.data.widgetsCopy=!0},null,null,-1),e.dataProcessor.toDataFormat(t))}function P(e,n){var i=e.editor.config.widget_keystrokeInsertLineBefore,r=e.editor.config.widget_keystrokeInsertLineAfter;F(e),j(e),B(e),$(e),q(e),V(e),z(e),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&e.wrapper.on("dragstart",function(n){var i=n.data.getTarget();t.getNestedEditable(e,i)||e.inline&&t.isDomDragHandler(i)||n.data.preventDefault()}),e.wrapper.removeClass("cke_widget_new"),e.element.addClass("cke_widget_element"),e.on("key",function(t){if((t=t.data.keyCode)==i)w(e,"before"),e.editor.fire("saveSnapshot");else if(t==r)w(e,"after"),e.editor.fire("saveSnapshot");else if(13==t)e.edit();else{if(t==CKEDITOR.CTRL+67||t==CKEDITOR.CTRL+88)return void N(e.editor,t==CKEDITOR.CTRL+88);if(t in Y||CKEDITOR.CTRL&t||CKEDITOR.ALT&t)return}return!1},null,null,999),e.on("doubleclick",function(t){e.edit()&&t.cancel()}),n.data&&e.on("data",n.data),n.edit&&e.on("edit",n.edit)}function F(e){(e.wrapper=e.element.getParent()).setAttribute("data-cke-widget-id",e.id)}function j(e,t){if(e.partSelectors||(e.partSelectors=e.parts),e.parts){
var n,i,r={};for(i in e.partSelectors)t||!e.parts[i]||"string"==typeof e.parts[i]?(n=e.wrapper.findOne(e.partSelectors[i]),r[i]=n):r[i]=e.parts[i];e.parts=r}}function B(e){var t,n,i=e.editables;if(e.editables={},e.editables)for(t in i)n=i[t],e.initEditable(t,"string"==typeof n?{selector:n}:n)}function $(e){if(!0===e.mask)M(e);else if(e.mask){var t,n,i=new CKEDITOR.tools.buffers.throttle(250,H,e),r=CKEDITOR.env.gecko?300:0;if(e.on("focus",function(){i.input(),t=e.editor.on("change",i.input),n=e.on("blur",function(){t.removeListener(),n.removeListener()})}),e.editor.on("instanceReady",function(){setTimeout(function(){i.input()},r)}),e.editor.on("mode",function(){setTimeout(function(){i.input()},r)}),CKEDITOR.env.gecko){var o=e.element.find("img");CKEDITOR.tools.array.forEach(o.toArray(),function(e){e.on("load",function(){i.input()})})}for(var a in e.editables)e.editables[a].on("focus",function(){e.editor.on("change",i.input),n&&n.removeListener()}),e.editables[a].on("blur",function(){e.editor.removeListener("change",i.input)});i.input()}}function M(e){var t=e.wrapper.findOne(".cke_widget_mask");t||(t=new CKEDITOR.dom.element("img",e.editor.document),t.setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_mask"}),e.wrapper.append(t)),e.mask=t}function H(){if(this.wrapper){this.maskPart=this.maskPart||this.mask;var e,t=this.parts[this.maskPart];if(t&&"string"!=typeof t){e=this.wrapper.findOne(".cke_widget_partial_mask"),e||(e=new CKEDITOR.dom.element("img",this.editor.document),e.setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_partial_mask"}),this.wrapper.append(e)),this.mask=e;var n=e.$,i=t.$,r=!(n.offsetTop==i.offsetTop&&n.offsetLeft==i.offsetLeft);(n.offsetWidth!=i.offsetWidth||n.offsetHeight!=i.offsetHeight||r)&&(n=t.getParent(),i=CKEDITOR.plugins.widget.isDomWidget(n),e.setStyles({top:t.$.offsetTop+(i?0:n.$.offsetTop)+"px",left:t.$.offsetLeft+(i?0:n.$.offsetLeft)+"px",width:t.$.offsetWidth+"px",height:t.$.offsetHeight+"px"}))}}}function q(e){if(e.draggable){var n,i=e.editor,r=e.wrapper.getLast(t.isDomDragHandlerContainer);r?n=r.findOne("img"):(r=new CKEDITOR.dom.element("span",i.document),r.setAttributes({class:"cke_reset cke_widget_drag_handler_container",style:"background:rgba(220,220,220,0.5);background-image:url("+i.plugins.widget.path+"images/handle.png);display:none;"}),n=new CKEDITOR.dom.element("img",i.document),n.setAttributes({class:"cke_reset cke_widget_drag_handler","data-cke-widget-drag-handler":"1",src:CKEDITOR.tools.transparentImageData,width:15,title:i.lang.widget.move,height:15,role:"presentation"}),e.inline&&n.setAttribute("draggable","true"),r.append(n),e.wrapper.append(r)),e.wrapper.on("dragover",function(e){e.data.preventDefault()}),e.wrapper.on("mouseenter",e.updateDragHandlerPosition,e),setTimeout(function(){e.on("data",e.updateDragHandlerPosition,e)},50),!e.inline&&(n.on("mousedown",U,e),CKEDITOR.env.ie&&9>CKEDITOR.env.version)&&n.on("dragstart",function(e){e.data.preventDefault(!0)}),e.dragHandlerContainer=r}}function U(e){function t(){var t;for(u.reset();t=d.pop();)t.removeListener();var n=c;t=e.sender;var i=this.repository.finder,r=this.repository.liner,o=this.editor,a=this.editor.editable();CKEDITOR.tools.isEmpty(r.visible)||(n=i.getRange(n[0]),this.focus(),o.fire("drop",{dropRange:n,target:n.startContainer})),a.removeClass("cke_widget_dragging"),r.hideVisible(),o.fire("dragend",{target:t})}if(CKEDITOR.tools.getMouseButton(e)===CKEDITOR.MOUSE_BUTTON_LEFT){var n,i,r=this.repository.finder,o=this.repository.locator,a=this.repository.liner,s=this.editor,l=s.editable(),d=[],c=[];this.repository._.draggedWidget=this;var h=r.greedySearch(),u=CKEDITOR.tools.eventsBuffer(50,function(){n=o.locate(h),c=o.sort(i,1),c.length&&(a.prepare(h,n),a.placeLine(c[0]),a.cleanup())});l.addClass("cke_widget_dragging"),d.push(l.on("mousemove",function(e){i=e.data.$.clientY,u.input()})),s.fire("dragstart",{target:e.sender}),d.push(s.document.once("mouseup",t,this)),l.isInline()||d.push(CKEDITOR.document.once("mouseup",t,this))}}function V(e){var t=null;e.on("data",function(){var e,n=this.data.classes;if(t!=n){for(e in t)n&&n[e]||this.removeClass(e);for(e in n)this.addClass(e);t=n}})}function z(e){e.on("data",function(){if(e.wrapper){var t=this.getLabel?this.getLabel():this.editor.lang.widget.label.replace(/%1/,this.pathName||this.element.getName());e.wrapper.setAttribute("role","region"),e.wrapper.setAttribute("aria-label",t)}},null,null,9999)}function W(e){e.element.data("cke-widget-data",encodeURIComponent(JSON.stringify(e.data)))}function G(){function e(){}function n(e,t,n){return!(!n||!this.checkElement(e))&&((e=n.widgets.getByElement(e,!0))&&e.checkStyleActive(this))}function i(e){var t,n=e.widget;r[n]||(r[n]={});for(var i=0,o=e.group.length;i<o;i++)t=e.group[i],r[n][t]||(r[n][t]=[]),t=r[n][t],function(e,t,n){for(var i=e.length,r=0;r<i;){if(t.call(n,e[r],r,e))return e[r];r++}}(t,function(e){function t(e,n){var i=CKEDITOR.tools.object.keys(e),r=CKEDITOR.tools.object.keys(n);if(i.length!==r.length)return!1;for(var o in e)if(("object"!=typeof e[o]||"object"!=typeof n[o]||!t(e[o],n[o]))&&e[o]!==n[o])return!1;return!0}return function(n){return t(e.getDefinition(),n.getDefinition())}}(e))||t.push(e)}var r={};CKEDITOR.style.addCustomHandler({type:"widget",setup:function(e){this.widget=e.widget,(this.group="string"==typeof e.group?[e.group]:e.group)&&i(this)},apply:function(e){var t;e instanceof CKEDITOR.editor&&this.checkApplicable(e.elementPath(),e)&&(t=e.widgets.focused,this.group&&this.removeStylesFromSameGroup(e),t.applyStyle(this))},remove:function(e){e instanceof CKEDITOR.editor&&this.checkApplicable(e.elementPath(),e)&&e.widgets.focused.removeStyle(this)},removeStylesFromSameGroup:function(e){var t,n,i=!1;if(!(e instanceof CKEDITOR.editor))return!1;if(n=e.elementPath(),this.checkApplicable(n,e))for(var o=0,a=this.group.length;o<a;o++){t=r[this.widget][this.group[o]];for(var s=0;s<t.length;s++)t[s]!==this&&t[s].checkActive(n,e)&&(e.widgets.focused.removeStyle(t[s]),i=!0)}return i},checkActive:function(e,t){return this.checkElementMatch(e.lastElement,0,t)},checkApplicable:function(e,t){return t instanceof CKEDITOR.editor&&this.checkElement(e.lastElement)},checkElementMatch:n,checkElementRemovable:n,checkElement:function(e){return!!t.isDomWidgetWrapper(e)&&((e=e.getFirst(t.isDomWidgetElement))&&e.data("widget")==this.widget)},buildPreview:function(e){return e||this._.definition.name},toAllowedContentRules:function(e){if(!e)return null;e=e.widgets.registered[this.widget];var t,n={};return e?e.styleableElements?(t=this.getClassesArray())?(n[e.styleableElements]={classes:t,propertiesOnly:!0},n):null:e.styleToAllowedContentRules?e.styleToAllowedContentRules(this):null:null},getClassesArray:function(){var e=this._.definition.attributes&&this._.definition.attributes.class;return e?CKEDITOR.tools.trim(e).split(/\s+/):null},applyToRange:e,removeFromRange:e,applyToObject:e})}CKEDITOR.plugins.add("widget",{requires:"lineutils,clipboard,widgetselection",onLoad:function(){void 0!==CKEDITOR.document.$.querySelectorAll&&(CKEDITOR.addCss('.cke_widget_wrapper{position:relative;outline:none}.cke_widget_inline{display:inline-block}.cke_widget_wrapper:hover>.cke_widget_element{outline:2px solid #ffd25c;cursor:default}.cke_widget_wrapper:hover .cke_widget_editable{outline:2px solid #ffd25c}.cke_widget_wrapper.cke_widget_focused>.cke_widget_element,.cke_widget_wrapper .cke_widget_editable.cke_widget_editable_focused{outline:2px solid #47a4f5}.cke_widget_editable{cursor:text}.cke_widget_drag_handler_container{position:absolute;width:15px;height:0;display:block;opacity:0.75;transition:height 0s 0.2s;line-height:0}.cke_widget_wrapper:hover>.cke_widget_drag_handler_container{height:15px;transition:none}.cke_widget_drag_handler_container:hover{opacity:1}.cke_editable[contenteditable="false"] .cke_widget_drag_handler_container{display:none;}img.cke_widget_drag_handler{cursor:move;width:15px;height:15px;display:inline-block}.cke_widget_mask{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.cke_widget_partial_mask{position:absolute;display:block}.cke_editable.cke_widget_dragging, .cke_editable.cke_widget_dragging *{cursor:move !important}'),G())},beforeInit:function(t){void 0!==CKEDITOR.document.$.querySelectorAll&&(t.widgets=new e(t))},afterInit:function(e){if(void 0!==CKEDITOR.document.$.querySelectorAll){var t,n,i,r=e.widgets.registered;for(n in r)t=r[n],(i=t.button)&&e.ui.addButton&&e.ui.addButton(CKEDITOR.tools.capitalize(t.name,!0),{label:i,command:t.name,toolbar:"insert,10"});E(e),y(e.undoManager)}}}),e.prototype={MIN_SELECTION_CHECK_INTERVAL:500,add:function(e,t){var n=this.editor;if(t=CKEDITOR.tools.prototypedCopy(t),t.name=e,t._=t._||{},n.fire("widgetDefinition",t),t.template&&(t.template=new CKEDITOR.template(t.template)),i(n,t),r(this,t),this.registered[e]=t,t.dialog&&n.plugins.dialog)var o=CKEDITOR.on("dialogDefinition",function(e){e=e.data.definition;var i=e.dialog;e.getMode||i.getName()!==t.dialog||(e.getMode=function(){var e=i.getModel(n);return e&&e instanceof CKEDITOR.plugins.widget&&e.ready?CKEDITOR.dialog.EDITING_MODE:CKEDITOR.dialog.CREATION_MODE}),o.removeListener()});return t},addUpcastCallback:function(e){this._.upcastCallbacks.push(e)},checkSelection:function(){if(this.editor.getSelection()){var e,n=this.editor.getSelection(),i=n.getSelectedElement(),r=b(this);if(i&&(e=this.getByElement(i,!0)))return r.focus(e).select(e).commit();if(!(n=n.getRanges()[0])||n.collapsed)return r.commit();for(n=new CKEDITOR.dom.walker(n),n.evaluator=t.isDomWidgetWrapper;i=n.next();)r.select(this.getByElement(i));r.commit()}},checkWidgets:function(e){this.fire("checkWidgets",CKEDITOR.tools.copy(e||{}))},del:function(e){if(this.focused===e){var t,n=e.editor,i=n.createRange();(t=i.moveToClosestEditablePosition(e.wrapper,!0))||(t=i.moveToClosestEditablePosition(e.wrapper,!1)),t&&n.getSelection().selectRanges([i])}e.wrapper.remove(),this.destroy(e,!0)},destroy:function(e,t){this.widgetHoldingFocusedEditable===e&&m(this,e,null,t),e.destroy(t),delete this.instances[e.id],this.fire("instanceDestroyed",e)},destroyAll:function(e,t){var n,i,r=this.instances;if(t&&!e){i=t.find(".cke_widget_wrapper");for(var r=i.count(),o=0;o<r;++o)(n=this.getByElement(i.getItem(o),!0))&&this.destroy(n)}else for(i in r)n=r[i],this.destroy(n,e)},finalizeCreation:function(e){(e=e.getFirst())&&t.isDomWidgetWrapper(e)&&(this.editor.insertElement(e),e=this.getByElement(e),e.ready=!0,e.fire("ready"),e.focus())},getByElement:function(){function e(e){return e.is(t)&&e.data("cke-widget-id")}var t={div:1,span:1};return function(t,n){if(!t)return null;var i=e(t);if(!n&&!i){var r=this.editor.editable();do{t=t.getParent()}while(t&&!t.equals(r)&&!(i=e(t)))}return this.instances[i]||null}}(),initOn:function(e,n,i){if(n?"string"==typeof n&&(n=this.registered[n]):n=this.registered[e.data("widget")],!n)return null;var r=this.wrapElement(e,n.name);return r?r.hasClass("cke_widget_new")?(e=new t(this,this._.nextId++,e,n,i),e.isInited()?this.instances[e.id]=e:null):this.getByElement(e):null},initOnAll:function(e){e=(e||this.editor.editable()).find(".cke_widget_new");for(var n,i=[],r=e.count();r--;)(n=this.initOn(e.getItem(r).getFirst(t.isDomWidgetElement)))&&i.push(n);return i},onWidget:function(e){var t=Array.prototype.slice.call(arguments);t.shift();for(var n in this.instances){var i=this.instances[n];i.name==e&&i.on.apply(i,t)}this.on("instanceCreated",function(n){n=n.data,n.name==e&&n.on.apply(n,t)})},parseElementClasses:function(e){if(!e)return null;e=CKEDITOR.tools.trim(e).split(/\s+/);for(var t,n={},i=0;t=e.pop();)-1==t.indexOf("cke_")&&(n[t]=i=1);return i?n:null},wrapElement:function(e,t){var n,i,r=null;if(e instanceof CKEDITOR.dom.element){if(t=t||e.data("widget"),!(n=this.registered[t]))return null;if((r=e.getParent())&&r.type==CKEDITOR.NODE_ELEMENT&&r.data("cke-widget-wrapper"))return r;e.hasAttribute("data-cke-widget-keep-attr")||e.data("cke-widget-keep-attr",e.data("widget")?1:0),e.data("widget",t),(i=g(n,e.getName()))&&s(e),r=new CKEDITOR.dom.element(i?"span":"div",e.getDocument()),r.setAttributes(u(i,t)),r.data("cke-display-name",n.pathName?n.pathName:e.getName()),e.getParent(!0)&&r.replace(e),e.appendTo(r)}else if(e instanceof CKEDITOR.htmlParser.element){if(t=t||e.attributes["data-widget"],!(n=this.registered[t]))return null;if((r=e.parent)&&r.type==CKEDITOR.NODE_ELEMENT&&r.attributes["data-cke-widget-wrapper"])return r;"data-cke-widget-keep-attr"in e.attributes||(e.attributes["data-cke-widget-keep-attr"]=e.attributes["data-widget"]?1:0),t&&(e.attributes["data-widget"]=t),(i=g(n,e.name))&&s(e),r=new CKEDITOR.htmlParser.element(i?"span":"div",u(i,t)),r.attributes["data-cke-display-name"]=n.pathName?n.pathName:e.name,n=e.parent;var o;n&&(o=e.getIndex(),e.remove()),r.add(e),n&&f(n,o,r)}return r},_tests_createEditableFilter:c},CKEDITOR.event.implementOn(e.prototype),t.prototype={addClass:function(e){this.element.addClass(e),this.wrapper.addClass(t.WRAPPER_CLASS_PREFIX+e)},applyStyle:function(e){K(this,e,1)},checkStyleActive:function(e){e=x(e);var t;if(!e)return!1;for(;t=e.pop();)if(!this.hasClass(t))return!1;return!0},destroy:function(e){if(this.fire("destroy"),this.editables)for(var t in this.editables)this.destroyEditable(t,e);e||("0"==this.element.data("cke-widget-keep-attr")&&this.element.removeAttribute("data-widget"),this.element.removeAttributes(["data-cke-widget-data","data-cke-widget-keep-attr"]),this.element.removeClass("cke_widget_element"),this.element.replace(this.wrapper)),this.wrapper=null},destroyEditable:function(e,t){var n=this.editables[e],i=!0;if(n.removeListener("focus",A),n.removeListener("blur",S),this.editor.focusManager.remove(n),n.filter){for(var r in this.repository.instances){var o=this.repository.instances[r];o.editables&&(o=o.editables[e])&&o!==n&&n.filter===o.filter&&(i=!1)}i&&(n.filter.destroy(),(i=this.repository._.filters[this.name])&&delete i[e])}t||(this.repository.destroyAll(!1,n),n.removeClass("cke_widget_editable"),n.removeClass("cke_widget_editable_focused"),n.removeAttributes(["contenteditable","data-cke-widget-editable","data-cke-enter-mode"])),delete this.editables[e]},edit:function(){var e={dialog:this.dialog},t=this;return!(!1===this.fire("edit",e)||!e.dialog)&&(this.editor.openDialog(e.dialog,function(e){var n,i;!1!==t.fire("dialog",e)&&(n=e.on("show",function(){e.setupContent(t)}),i=e.on("ok",function(){var n,i=t.on("data",function(e){n=1,e.cancel()},null,null,0);t.editor.fire("saveSnapshot"),e.commitContent(t),i.removeListener(),n&&(t.fire("data",t.data),t.editor.fire("saveSnapshot"))}),e.once("hide",function(){n.removeListener(),i.removeListener()}))},t),!0)},getClasses:function(){return this.repository.parseElementClasses(this.element.getAttribute("class"))},getClipboardHtml:function(){var e=this.editor.createRange();return e.setStartBefore(this.wrapper),e.setEndAfter(this.wrapper),this.editor.editable().getHtmlFromRange(e).getHtml()},hasClass:function(e){return this.element.hasClass(e)},initEditable:function(e,t){var i=this._findOneNotNested(t.selector);return!(!i||!i.is(CKEDITOR.dtd.$editable))&&(i=new n(this.editor,i,{filter:c.call(this.repository,this.name,e,t)}),this.editables[e]=i,i.setAttributes({contenteditable:"true","data-cke-widget-editable":e,"data-cke-enter-mode":i.enterMode}),i.filter&&i.data("cke-filter",i.filter.id),i.addClass("cke_widget_editable"),i.removeClass("cke_widget_editable_focused"),t.pathName&&i.data("cke-display-name",t.pathName),this.editor.focusManager.add(i),i.on("focus",A,this),CKEDITOR.env.ie&&i.on("blur",S,this),i._.initialSetData=!0,i.setData(i.getHtml()),!0)},_findOneNotNested:function(e){e=this.wrapper.find(e);for(var n,i,r=0;r<e.count();r++)if(n=e.getItem(r),i=n.getAscendant(t.isDomWidgetWrapper),this.wrapper.equals(i))return n;return null},isInited:function(){return!(!this.wrapper||!this.inited)},isReady:function(){return this.isInited()&&this.ready},focus:function(){var e=this.editor.getSelection();if(e){var t=this.editor.checkDirty();e.fake(this.wrapper),!t&&this.editor.resetDirty()}this.editor.focus()},refreshMask:function(){$(this)},refreshParts:function(e){j(this,void 0===e||e)},removeClass:function(e){this.element.removeClass(e),this.wrapper.removeClass(t.WRAPPER_CLASS_PREFIX+e)},removeStyle:function(e){K(this,e,0)},setData:function(e,t){var n=this.data,i=0;if("string"==typeof e)n[e]!==t&&(n[e]=t,i=1);else{var r=e;for(e in r)n[e]!==r[e]&&(i=1,n[e]=r[e])}return i&&this.dataReady&&(W(this),this.fire("data",n)),this},setFocused:function(e){return this.wrapper[e?"addClass":"removeClass"]("cke_widget_focused"),this.fire(e?"focus":"blur"),this},setSelected:function(e){return this.wrapper[e?"addClass":"removeClass"]("cke_widget_selected"),this.fire(e?"select":"deselect"),this},updateDragHandlerPosition:function(){var e=this.editor,t=this.element.$,n=this._.dragHandlerOffset,t={x:t.offsetLeft,y:t.offsetTop-15};n&&t.x==n.x&&t.y==n.y||(n=e.checkDirty(),e.fire("lockSnapshot"),this.dragHandlerContainer.setStyles({top:t.y+"px",left:t.x+"px"}),this.dragHandlerContainer.removeStyle("display"),e.fire("unlockSnapshot"),!n&&e.resetDirty(),this._.dragHandlerOffset=t)}},CKEDITOR.event.implementOn(t.prototype),t.getNestedEditable=function(e,n){return!n||n.equals(e)?null:t.isDomNestedEditable(n)?n:t.getNestedEditable(e,n.getParent())},t.isDomDragHandler=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-drag-handler")},t.isDomDragHandlerContainer=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_widget_drag_handler_container")},t.isDomNestedEditable=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-editable")},t.isDomWidgetElement=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-widget")},t.isDomWidgetWrapper=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-wrapper")},t.isDomWidget=function(e){return!!e&&(this.isDomWidgetWrapper(e)||this.isDomWidgetElement(e))},t.isParserWidgetElement=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&!!e.attributes["data-widget"]},t.isParserWidgetWrapper=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&!!e.attributes["data-cke-widget-wrapper"]},t.WRAPPER_CLASS_PREFIX="cke_widget_wrapper_",n.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.dom.element.prototype),{setData:function(e){this._.initialSetData||this.editor.widgets.destroyAll(!1,this),this._.initialSetData=!1,e=this.editor.dataProcessor.unprotectRealComments(e),e=this.editor.dataProcessor.unprotectSource(e),e=this.editor.dataProcessor.toHtml(e,{context:this.getName(),filter:this.filter,enterMode:this.enterMode}),this.setHtml(e),this.editor.widgets.initOnAll(this)},getData:function(){return this.editor.dataProcessor.toDataFormat(this.getHtml(),{context:this.getName(),filter:this.filter,enterMode:this.enterMode})}});var X=/^(?:<(?:div|span)(?: data-cke-temp="1")?(?: id="cke_copybin")?(?: data-cke-temp="1")?>)?(?:<(?:div|span)(?: style="[^"]+")?>)?<span [^>]*data-cke-copybin-start="1"[^>]*>.?<\/span>([\s\S]+)<span [^>]*data-cke-copybin-end="1"[^>]*>.?<\/span>(?:<\/(?:div|span)>)?(?:<\/(?:div|span)>)?$/i,Y={37:1,38:1,39:1,40:1,8:1,46:1};Y[CKEDITOR.SHIFT+121]=1;var J=CKEDITOR.tools.createClass({$:function(e,t){this._.createCopyBin(e,t),this._.createListeners(t)},_:{createCopyBin:function(e){var t=e.document,n=CKEDITOR.env.edge&&16<=CKEDITOR.env.version,i=!e.blockless&&!CKEDITOR.env.ie||n?"div":"span",n=t.createElement(i),t=t.createElement(i);t.setAttributes({id:"cke_copybin","data-cke-temp":"1"}),n.setStyles({position:"absolute",width:"1px",height:"1px",overflow:"hidden"}),n.setStyle("ltr"==e.config.contentsLangDirection?"left":"right","-5000px"),this.editor=e,this.copyBin=n,this.container=t},createListeners:function(e){e&&(e.beforeDestroy&&(this.beforeDestroy=e.beforeDestroy),e.afterDestroy&&(this.afterDestroy=e.afterDestroy))}},proto:{handle:function(e){var t,n,i,r=this.copyBin,o=this.editor,a=this.container,s=CKEDITOR.env.ie&&9>CKEDITOR.env.version,l=o.document.getDocumentElement().$,d=o.createRange(),c=this,h=CKEDITOR.env.mac&&CKEDITOR.env.webkit,u=h?100:0,f=window.requestAnimationFrame&&!h?requestAnimationFrame:setTimeout;return r.setHtml('<span data-cke-copybin-start="1">\u200b</span>'+e+'<span data-cke-copybin-end="1">\u200b</span>'),o.fire("lockSnapshot"),a.append(r),o.editable().append(a),t=o.on("selectionChange",k,null,null,0),n=o.widgets.on("checkSelection",k,null,null,0),s&&(i=l.scrollTop),d.selectNodeContents(r),d.select(),s&&(l.scrollTop=i),new CKEDITOR.tools.promise(function(e){f(function(){c.beforeDestroy&&c.beforeDestroy(),a.remove(),t.removeListener(),n.removeListener(),o.fire("unlockSnapshot"),c.afterDestroy&&c.afterDestroy(),e()},u)})}},statics:{hasCopyBin:function(e){return!!J.getCopyBin(e)},getCopyBin:function(e){return e.document.getById("cke_copybin")}}});CKEDITOR.plugins.widget=t,t.repository=e,t.nestedEditable=n}(),CKEDITOR.config.widget_keystrokeInsertLineBefore=CKEDITOR.SHIFT+CKEDITOR.ALT+13,CKEDITOR.config.widget_keystrokeInsertLineAfter=CKEDITOR.SHIFT+13,CKEDITOR.config.plugins="dialogui,dialog,notification,button,toolbar,clipboard,confighelper,entities,undo,lineutils,widgetselection,widget",CKEDITOR.config.skin="minimalist",function(){var e=function(e,t){var n=CKEDITOR.getUrl("plugins/"+t);e=e.split(",");for(var i=0;i<e.length;i++)CKEDITOR.skin.icons[e[i]]={path:n,offset:-e[++i],bgsize:e[++i]}};CKEDITOR.env.hidpi?e("about,0,,bold,24,,italic,48,,strike,72,,subscript,96,,superscript,120,,underline,144,,bidiltr,168,,bidirtl,192,,blockquote,216,,copy-rtl,240,,copy,264,,cut-rtl,288,,cut,312,,paste-rtl,336,,paste,360,,codesnippet,384,,bgcolor,408,,textcolor,432,,copyformatting,456,,creatediv,480,,docprops-rtl,504,,docprops,528,,easyimagealigncenter,552,,easyimagealignleft,576,,easyimagealignright,600,,easyimagealt,624,,easyimagefull,648,,easyimageside,672,,easyimageupload,696,,embed,720,,embedsemantic,744,,emojipanel,768,,find-rtl,792,,find,816,,replace,840,,button,864,,checkbox,888,,form,912,,hiddenfield,936,,imagebutton,960,,radio,984,,select-rtl,1008,,select,1032,,textarea-rtl,1056,,textarea,1080,,textfield-rtl,1104,,textfield,1128,,horizontalrule,1152,,iframe,1176,,image,1200,,indent-rtl,1224,,indent,1248,,outdent-rtl,1272,,outdent,1296,,justifyblock,1320,,justifycenter,1344,,justifyleft,1368,,justifyright,1392,,language,1416,,anchor-rtl,1440,,anchor,1464,,link,1488,,unlink,1512,,bulletedlist-rtl,1536,,bulletedlist,1560,,numberedlist-rtl,1584,,numberedlist,1608,,mathjax,1632,,maximize,1656,,newpage-rtl,1680,,newpage,1704,,pagebreak-rtl,1728,,pagebreak,1752,,pastefromword-rtl,1776,,pastefromword,1800,,pastetext-rtl,1824,,pastetext,1848,,placeholder,1872,,preview-rtl,1896,,preview,1920,,print,1944,,removeformat,1968,,save,1992,,selectall,2016,,showblocks-rtl,2040,,showblocks,2064,,smiley,2088,,source-rtl,2112,,source,2136,,sourcedialog-rtl,2160,,sourcedialog,2184,,specialchar,2208,,table,2232,,templates-rtl,2256,,templates,2280,,uicolor,2304,,redo-rtl,2328,,redo,2352,,undo-rtl,2376,,undo,2400,,simplebox,4848,auto","icons_hidpi.png"):e("about,0,auto,bold,24,auto,italic,48,auto,strike,72,auto,subscript,96,auto,superscript,120,auto,underline,144,auto,bidiltr,168,auto,bidirtl,192,auto,blockquote,216,auto,copy-rtl,240,auto,copy,264,auto,cut-rtl,288,auto,cut,312,auto,paste-rtl,336,auto,paste,360,auto,codesnippet,384,auto,bgcolor,408,auto,textcolor,432,auto,copyformatting,456,auto,creatediv,480,auto,docprops-rtl,504,auto,docprops,528,auto,easyimagealigncenter,552,auto,easyimagealignleft,576,auto,easyimagealignright,600,auto,easyimagealt,624,auto,easyimagefull,648,auto,easyimageside,672,auto,easyimageupload,696,auto,embed,720,auto,embedsemantic,744,auto,emojipanel,768,auto,find-rtl,792,auto,find,816,auto,replace,840,auto,button,864,auto,checkbox,888,auto,form,912,auto,hiddenfield,936,auto,imagebutton,960,auto,radio,984,auto,select-rtl,1008,auto,select,1032,auto,textarea-rtl,1056,auto,textarea,1080,auto,textfield-rtl,1104,auto,textfield,1128,auto,horizontalrule,1152,auto,iframe,1176,auto,image,1200,auto,indent-rtl,1224,auto,indent,1248,auto,outdent-rtl,1272,auto,outdent,1296,auto,justifyblock,1320,auto,justifycenter,1344,auto,justifyleft,1368,auto,justifyright,1392,auto,language,1416,auto,anchor-rtl,1440,auto,anchor,1464,auto,link,1488,auto,unlink,1512,auto,bulletedlist-rtl,1536,auto,bulletedlist,1560,auto,numberedlist-rtl,1584,auto,numberedlist,1608,auto,mathjax,1632,auto,maximize,1656,auto,newpage-rtl,1680,auto,newpage,1704,auto,pagebreak-rtl,1728,auto,pagebreak,1752,auto,pastefromword-rtl,1776,auto,pastefromword,1800,auto,pastetext-rtl,1824,auto,pastetext,1848,auto,placeholder,1872,auto,preview-rtl,1896,auto,preview,1920,auto,print,1944,auto,removeformat,1968,auto,save,1992,auto,selectall,2016,auto,showblocks-rtl,2040,auto,showblocks,2064,auto,smiley,2088,auto,source-rtl,2112,auto,source,2136,auto,sourcedialog-rtl,2160,auto,sourcedialog,2184,auto,specialchar,2208,auto,table,2232,auto,templates-rtl,2256,auto,templates,2280,auto,uicolor,2304,auto,redo-rtl,2328,auto,redo,2352,auto,undo-rtl,2376,auto,undo,2400,auto,simplebox,2424,auto","icons.png")}(),CKEDITOR.lang.languages={en:1})}(),define("ckeditor",function(e){return function(){return e.CKEDITOR}}(this)),function(e){if(void 0===e)throw Error("jQuery should be loaded before CKEditor jQuery adapter.");if("undefined"==typeof CKEDITOR)throw Error("CKEditor should be loaded before CKEditor jQuery adapter.");CKEDITOR.config.jqueryOverrideVal=void 0===CKEDITOR.config.jqueryOverrideVal||CKEDITOR.config.jqueryOverrideVal,e.extend(e.fn,{ckeditorGet:function(){var e=this.eq(0).data("ckeditorInstance");if(!e)throw"CKEditor is not initialized yet, use ckeditor() with a callback.";return e},ckeditor:function(t,n){if(!CKEDITOR.env.isCompatible)throw Error("The environment is incompatible.");if("function"!=typeof t){var i=n;n=t,t=i}var r=[];n=n||{},this.each(function(){var i=e(this),o=i.data("ckeditorInstance"),a=i.data("_ckeditorInstanceLock"),s=this,l=new e.Deferred;r.push(l.promise()),o&&!a?(t&&t.apply(o,[this]),l.resolve()):a?o.once("instanceReady",function(){setTimeout(function e(){o.element?(o.element.$==s&&t&&t.apply(o,[s]),l.resolve()):setTimeout(e,100)},0)},null,null,9999):((n.autoUpdateElement||void 0===n.autoUpdateElement&&CKEDITOR.config.autoUpdateElement)&&(n.autoUpdateElementJquery=!0),n.autoUpdateElement=!1,i.data("_ckeditorInstanceLock",!0),o=e(this).is("textarea")?CKEDITOR.replace(s,n):CKEDITOR.inline(s,n),i.data("ckeditorInstance",o),o.on("instanceReady",function(n){var r=n.editor;setTimeout(function o(){if(r.element){if(n.removeListener(),r.on("dataReady",function(){i.trigger("dataReady.ckeditor",[r])}),r.on("setData",function(e){i.trigger("setData.ckeditor",[r,e.data])}),r.on("getData",function(e){i.trigger("getData.ckeditor",[r,e.data])},999),r.on("destroy",function(){i.trigger("destroy.ckeditor",[r])}),r.on("save",function(){return e(s.form).trigger("submit"),!1},null,null,20),r.config.autoUpdateElementJquery&&i.is("textarea")&&e(s.form).length){var a=function(){i.ckeditor(function(){r.updateElement()})};e(s.form).on("submit",a),e(s.form).on("form-pre-serialize",a),i.on("destroy.ckeditor",function(){e(s.form).off("submit",a),e(s.form).off("form-pre-serialize",a)})}r.on("destroy",function(){i.removeData("ckeditorInstance")}),i.removeData("_ckeditorInstanceLock"),i.trigger("instanceReady.ckeditor",[r]),t&&t.apply(r,[s]),l.resolve()}else setTimeout(o,100)},0)},null,null,9999))});var o=new e.Deferred;return this.promise=o.promise(),e.when.apply(this,r).then(function(){o.resolve()}),this.editor=this.eq(0).data("ckeditorInstance"),this}}),CKEDITOR.config.jqueryOverrideVal&&(e.fn.val=CKEDITOR.tools.override(e.fn.val,function(t){return function(n){if(arguments.length){var i=this,r=[],o=this.each(function(){var i=e(this),o=i.data("ckeditorInstance");if(i.is("textarea")&&o){var a=new e.Deferred;return o.setData(n,function(){a.resolve()}),r.push(a.promise()),!0}return t.call(i,n)});if(r.length){var a=new e.Deferred;return e.when.apply(this,r).done(function(){a.resolveWith(i)}),a.promise()}return o}var o=e(this).eq(0),s=o.data("ckeditorInstance");return o.is("textarea")&&s?s.getData():t.call(o)}}))}(window.jQuery),define("ckeditor-jquery",["jquery","ckeditor"],function(e){return function(){return e.$.fn.ckeditor}}(this)),define("css/css!../node_modules/codemirror/lib/codemirror",[],function(){}),define("css/css!yui-combo",[],function(){}),define("css/css!../node_modules/at.js/dist/css/jquery.atwho",[],function(){}),define("local-deps",function(){});