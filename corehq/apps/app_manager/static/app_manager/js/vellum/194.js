"use strict";(self.webpackChunkvellum=self.webpackChunkvellum||[]).push([[194],{3809:(t,n,e)=>{e.d(n,{A:()=>i});var a=e(4523),r=/[\r\n\u2028\u2029"\t]/;function c(t){return t=null===t||a.Ay.isUndefined(t)?"":String(t),r.test(t)&&(t='"'+t.replace(/"/g,'""')+'"'),t}const i={escape:c,makeRowParser:function(t){var n=/(.*)(?:\n|\r\n|\r|\u2028|\u2029)/gm,e=/(.*?)(?:\t|(\n|\r\n|\r|\u2028|\u2029|$))/g,r=/^("(?:[^"]|"")*")(?:\t|(\n|\r\n|\r|\u2028|\u2029|$))/,c=/""/g,i=t.length,u=0;function b(t){if(t<=u)throw new Error("last index "+u+" -> "+t);u=t}return function(){if(u>=i)return null;n.lastIndex=u;var l=n.exec(t);return l&&-1===l[1].indexOf('"')?(b(n.lastIndex),l[1].split("\t")):function(){var n,l,s=[];e.lastIndex=u;do{'"'===(n=e.exec(t))[1][0]&&(l=r.exec(t.slice(u)))&&l[1]&&((n=l)[1]=n[1].slice(1,-1).replace(c,'"'),e.lastIndex=u+n[0].length),s.push(n[1]),b(e.lastIndex)}while(u<i&&a.Ay.isUndefined(n[2]));return s}()}},tabDelimit:function(t){return a.Ay.map(t,(function(t){return a.Ay.map(t,c).join("\t")})).join("\n")}}},4194:(t,n,e)=>{e.r(n);var a=e(8324),r=e.n(a),c=e(3809),i=r().assert;function u(t,n,e){var a=t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");i.deepEqual(function(t,n){for(var e=[],a=c.A.makeRowParser(t),r=a();r&&(e.push(r),!(n&&e.length>=n));)r=a();return e}(t,n.length+5),n,"parsed '"+a+"'"),e&&i.strictEqual(c.A.tabDelimit(n),t)}describe("The TSV parser",(function(){it("should parse empty string",(function(){u("",[],!0)})),it("should parse simple TSV",(function(){u("a\tb",[["a","b"]],!0),u("a\tb\r",[["a","b"]]),u("a\tb\n",[["a","b"]]),u("a\tb\u2028",[["a","b"]]),u("a\tb\u2029",[["a","b"]]),u("a\tb\r\n",[["a","b"]]),u("a\tb\n\r",[["a","b"],[""]])})),it("should parse simple mutli-line TSV",(function(){u("a\tb\nc",[["a","b"],["c"]],!0),u("a\tb\rc\r",[["a","b"],["c"]]),u("a\tb\nc\n",[["a","b"],["c"]]),u("a\tb\u2028c\u2028",[["a","b"],["c"]]),u("a\tb\u2029c\u2029",[["a","b"],["c"]]),u("a\tb\r\nc\r\n",[["a","b"],["c"]]),u("a\tb\n\rc\n",[["a","b"],[""],["c"]])})),it("should parse quoted field",(function(){u('a\t"b\tc"',[["a","b\tc"]],!0),u('"a"\t"b\tc"\r',[["a","b\tc"]]),u('"a"\t"b\tc"\n',[["a","b\tc"]]),u('"a"\t"b\tc"\u2028',[["a","b\tc"]]),u('"a"\t"b\tc"\u2029',[["a","b\tc"]]),u('"a"\t"b\tc"\r\n',[["a","b\tc"]]),u('"a"\t"b\tc"\n\r',[["a","b\tc"],[""]]),u('"a"\t"b\tc"\n"a"\t"b\tc"\n',[["a","b\tc"],["a","b\tc"]])})),it("should parse empty quoted field",(function(){u('""\t""\n',[["",""]])})),it("should parse quoted field with escaped quotes",(function(){u('"a""x"\t"b""\t""c"',[['a"x','b"\t"c']],!0),u('"a""x"\t"b""""""c"',[['a"x','b"""c']],!0),u('"a""x"\t"b""\t""c"\n"a""x"\t"b""\t""c"',[['a"x','b"\t"c'],['a"x','b"\t"c']],!0)})),it("should parse quoted multi-line field",(function(){u('"a""x"\t"b\nc\rd\r\ne"',[['a"x',"b\nc\rd\r\ne"]],!0),u('"a""x"\t"b\u2028c\u2029d"',[['a"x',"b\u2028c\u2029d"]],!0),u('"a""x"\t"b\nc\rd\r\ne"\n"a""x"\t"b\nc\rd\r\ne"',[['a"x',"b\nc\rd\r\ne"],['a"x',"b\nc\rd\r\ne"]],!0)})),it("should parse malformed quoted field",(function(){u('abc\t"def"ghi\t"jkl',[["abc",'"def"ghi','"jkl']]),u('abc\t"def"ghi"\t"jkl',[["abc",'"def"ghi"','"jkl']]),u('abc\t"def\t"ghi\t"jkl',[["abc",'"def','"ghi','"jkl']])}))})),describe("The TSV writer",(function(){it("should convert null to empty string",(function(){i.strictEqual(c.A.escape(null),"")})),it("should convert undefined to empty string",(function(){i.strictEqual(c.A.escape(void 0),"")})),it("should not convert zero to empty string",(function(){i.strictEqual(c.A.escape(0),"0")})),it("should escape special characters",(function(){var t=[['""',"\t\t\t","\n\n\n","\r\r\r",""],["  "]],n='""""""\t"\t\t\t"\t"\n\n\n"\t"\r\r\r"\t\n  ';i.strictEqual(c.A.tabDelimit(t),n),u(n,t,!0)}))}))}}]);