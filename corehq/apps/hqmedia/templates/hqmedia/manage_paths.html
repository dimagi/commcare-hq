{% extends "hqmedia/uploader_base.html" %}
{% load hq_shared_tags %}
{% load i18n %}

{% block js %}{{ block.super }}
    <script src="{% static 'hqmedia/js/manage_paths_main.js' %}"></script>
{% endblock js %}

{% block page_content %}
    {% registerurl 'validate_multimedia_paths' domain app_id %}
    {% registerurl 'upload_multimedia_paths' domain app_id %}

    <p class="lead">{{ current_page.page_name }}</p>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">{% trans "Download Paths" %}</h3>
        </div>
        <div class="panel-body">
            <div class="help-block">
                {% blocktrans %}
                    Download a file containing each unique multimedia path in this application
                    and the places where that path is referenced.
                {% endblocktrans %}
            </div>

            <a class="btn btn-primary" href="{% url 'download_multimedia_paths' domain app_id %}">
                <i class="fa fa-cloud-download"></i>
                {% trans "Download Paths" %}
            </a>
        </div>
    </div>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">{% trans "Upload Paths" %}</h3>
        </div>
        <div class="panel-body">
            <div class="help-block">
                {% blocktrans %}
                    Upload a file where the first column contains the existing <code>jr://...</code> path
                    and the second column contains the new path.
                {% endblocktrans %}
            </div>

            <form id="upload-paths" enctype="multipart/form-data" data-bind="submit: validate" class="ko-template">
                {% csrf_token %}
                <input name="file" type="file" />
                <br>
                <div class="btn-toolbar">
                    <button class="btn" type="submit" data-bind="css: {'btn-primary': !allowUpload(), 'btn-default': allowUpload()}">
                        <i class="fa fa-cloud-upload"></i>
                        {% trans "Upload & Validate" %}
                    </button>
                    <button class="btn" type="button"
                            data-bind="css: {'btn-primary': allowUpload(), 'btn-default': !allowUpload()}, enable: allowUpload(), click: upload">
                        <i class="fa fa-check"></i>
                        {% trans "Update Paths" %}
                    </button>
                </div>
                <br>
                <div class="alert alert-danger" data-bind="visible: error, text: error"></div>
            </form>
        </div>
    </div>

{% endblock %}
