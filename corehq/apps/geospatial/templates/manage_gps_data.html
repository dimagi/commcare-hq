{% extends "hqwebapp/bootstrap3/base_section.html" %}
{% load compress %}
{% load i18n %}
{% load hq_shared_tags %}

{% block page_title %}
    {{ current_page.page_name }}
{% endblock page_title %}

{% block js %}{{ block.super }}
    <!-- Scripts for mapbox -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js'></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.0/mapbox-gl-draw.js'></script>
    {% compress js %}
        <script src="{% static 'geospatial/js/gps_capture.js' %}"></script>
    {% endcompress %}
{% endblock %}

 {% block stylesheets %}
 {{ block.super }}
 <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css">
 <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.4.0/mapbox-gl-draw.css" type="text/css">
 {% endblock %}


{% block additional_initial_page_data %}{{ block.super }}
    {% initial_page_data "mapbox_access_token" mapbox_access_token %}
{% endblock %}

{% block page_content %}
{% initial_page_data 'data_type' data_type %}
{% registerurl 'get_paginated_cases_or_users_without_gps' domain %}
{% registerurl 'case_data' domain '---' %}
{% registerurl 'edit_commcare_user' domain '---' %}
{% registerurl 'gps_capture' domain %}

<ul class="nav nav-tabs">
  <li class="active"><a data-toggle="tab" href="#tabs-cases">{% trans 'Update Case Data' %}</a></li>
  <li><a data-toggle="tab" href="#tabs-users">{% trans 'Update Mobile Worker Data' %}</a></li>
</ul>

<div class="tab-content">
  <div class="tab-pane fade in active" id="tabs-cases">
    {% include 'gps_capture.html' with data_type='case' %}
  </div>

  <div class="tab-pane fade" id="tabs-users">
    {% include 'gps_capture.html' with data_type='user' %}
      <div class="module-banner alert alert-info">
        <span>
          {% blocktrans %}
            To create new Mobile Workers navigate to the Mobile Workers page under the Users tab.
          {% endblocktrans %}
          <a href="{% url 'mobile_workers' domain %}">
            {% blocktrans %}
            Navigate there.
            {% endblocktrans %}
          </a>
        </span>
      </div>
  </div>
</div>
<div id="geospatial-map" style="height: 500px"></div>
{% endblock %}
