{% extends "hqwebapp/bootstrap5/base_section.html" %}
{% load crispy_forms_tags %}
{% load hq_shared_tags %}
{% load i18n %}

{% js_entry 'domain/js/update_billing_contact_info' %}

{% block additional_initial_page_data %}{{ block.super }}
  {% initial_page_data "stripe_public_key" stripe_public_key %}
  {% registerurl "cards_view" domain %}
{% endblock additional_initial_page_data %}

{% block page_content %}
  <div id="billing-info" class="card card-with-form">
    <h5 class="card-header">
      {% trans "Billing Details" %}
    </h5>
    <div class="card-body">
      {% crispy billing_account_info_form %}
    </div>
  </div>
  <div class="mt-3 card" id="payment-methods">
    <h5 class="card-header">
      {% trans "Payment Methods" %}
    </h5>
    <div class="card-body card-with-form">
      <div
        id="manage-payment-methods-container"
        hx-get="{{ request.path_info }}"
        hq-hx-action="list_payment_methods"
        hx-trigger="load, refreshCards"
      >
        <div class="htmx-indicator mb-3 fs-4">
          <i class="fa-solid fa-spinner fa-spin"></i> {% trans "Loading payment methods, please wait..." %}
        </div>
      </div>
      {% include "domain/partials/new_stripe_card_alpinejs.html" with card_container_id="manage-payment-methods-container" %}
    </div>
  </div>
{% endblock page_content %}
