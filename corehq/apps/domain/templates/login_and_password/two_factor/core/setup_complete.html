{% extends "hqwebapp/base_section.html" %}
{% load i18n %}
{% load hq_shared_tags %}

{% block page_content %}
  <h1>{% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}</h1>

  <p>{% blocktrans %}Congratulations, you've successfully enabled two-factor
    authentication.{% endblocktrans %}

    {% if not phone_methods %}
      {% if request|toggle_enabled:"TWO_STAGE_USER_PROVISIONING" %}
        {% if request.couch_user.domain_memberships.0.role.default_landing_page == 'webapps' %}
          <a href="{% url 'homepage'%}"
           class="btn btn-primary">{% trans "Begin Using CommCare Now" %}</a>
        {% endif %}
      {% endif %}
      <p><a href="{% url 'two_factor:profile' %}"
            class="btn btn-block btn-default">{% trans "Back to Profile" %}</a></p>
    {% else %}
      <p>{% blocktrans %}To enable account recovery, generate backup tokens.{% endblocktrans %}</p>
      {% if request|toggle_enabled:"TWO_STAGE_USER_PROVISIONING" %}
        {% if request.couch_user.domain_memberships.0.role.default_landing_page == 'webapps' %}
          <a href="{% url 'homepage'%}"
           class="btn btn-primary">{% trans "Begin Using CommCare Now" %}</a>
        {% endif %}
      {% endif %}
      <p></p><a href="{% url 'two_factor:profile' %}"
         class="pull-right btn btn-link">{% trans "Back to Profile" %}</a></p>
      <p><a href="{% url 'two_factor:backup_tokens' %}"
            class="btn btn-default">{% trans "Generate Backup Tokens" %}</a></p>
    {% endif %}

{% endblock %}
