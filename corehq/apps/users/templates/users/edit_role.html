{% extends "hqwebapp/bootstrap5/base_section.html" %}
{% load hq_shared_tags %}
{% load i18n %}
{% js_entry "hqwebapp/js/htmx_and_alpine" %}
{% block page_content %}
<div class="container p-5">
  <!--<div>{{data}}</div>-->
  <form x-data="{{ data }}">
    <div class="row mb-4">
      <label class="col-sm-2 control-label" for="role-name">
        Role Name<span class="asteriskField">*</span>
      </label>
      <div class="col-sm-4 controls">
        <input
          x-model="name"
          type="text"
          id="role-name"
          class="form-control"
          pattern="\S.*"
          title='{% trans_html_attr "The name must start with a valid character." %}'
          required />
      </div>
    </div>

    <!-- Tab Navigation -->
    <ul class="nav nav-tabs mb-3" id="rolePermissionsTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button
          class="nav-link active"
          id="basic-tab"
          data-bs-toggle="tab"
          data-bs-target="#basic-permissions"
          type="button"
          role="tab"
          aria-controls="basic-permissions"
          aria-selected="true"
        >
          Basic
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button
          class="nav-link"
          id="enterprise-tab"
          data-bs-toggle="tab"
          data-bs-target="#enterprise-release-management"
          type="button"
          role="tab"
          aria-controls="enterprise-release-management"
          aria-selected="false"
        >
          Enterprise Release Management
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button
          class="nav-link"
          id="reports-tab"
          data-bs-toggle="tab"
          data-bs-target="#reports-permissions"
          type="button"
          role="tab"
          aria-controls="reports-permissions"
          aria-selected="false"
        >
          Reports
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button
          class="nav-link"
          id="web-apps-tab"
          data-bs-toggle="tab"
          data-bs-target="#web-apps-permissions"
          type="button"
          role="tab"
          aria-controls="web-apps-permissions"
          aria-selected="false"
        >
          Web Apps
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button
          class="nav-link"
          id="other-settings-tab"
          data-bs-toggle="tab"
          data-bs-target="#other-settings"
          type="button"
          role="tab"
          aria-controls="other-settings"
          aria-selected="false"
        >
          Other Settings
        </button>
      </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="rolePermissionsTabContent">
      <div
        class="tab-pane fade show active"
        id="basic-permissions"
        role="tabpanel"
        aria-labelledby="basic-tab"
      >
        <div class="row mb-2">
          <div class="col-sm-1"><strong>Can Edit</strong></div>
          <div class="col-sm-1"><strong>Can View</strong></div>
          <div class="col-sm-10"></div>
        </div>
        <template x-for="area in accessAreas">
          <div
            class="row mb-2"
            x-show="area.showOption"
          >
            <!-- edit checkbox or emdash -->
            <div class="col-sm-1 controls" x-show="area.showEditCheckbox">
              <div class="form-check">
                <input
                  type="checkbox"
                  :id="area.editCheckboxLabel"
                  x-model="area.editPermission"/>
                <label :for="area.editCheckboxLabel">
                  <span class="sr-only" x-text="area.screenReaderEditAndViewText">
                  </span>
                </label>
              </div>
            </div>
            <div class="col-sm-1 controls" x-show="!area.showEditCheckbox">
              <div class="form-check-placeholder">
                <label></label>
              </div>
            </div>

            <!-- view checkbox or emdash-->
            <div class="col-sm-1 controls" x-show="area.showViewCheckbox">
              {# PLACEHOLDER checkbox when editPermission() is true #}
              <div class="form-check" x-show="area.editPermission">
                <input type="checkbox" checked="checked" disabled="disabled" />
                <label>
                  <span class="sr-only" x-text="area.screenReaderViewOnlyText">
                  </span>
                </label>
              </div>
              {# end PLACEHOLDER #}
              {# REAL checkbox that controls viewPermission when editPermission() is false #}
              <div class="form-check" x-show="!area.editPermission">
                <input
                  type="checkbox"
                  :id="area.viewCheckboxLabel"
                  x-model="area.viewPermission"/>
                <label :for="area.viewCheckboxLabel">
                  <span class="sr-only" x-text="area.screenReaderViewOnlyText">
                  </span>
                </label>
              </div>
              {# END REAL checkbox #}
            </div>
            <div class="col-sm-1 controls " x-show="!area.showViewCheckbox">
              <div class="form-check-placeholder">
                <label></label>
              </div>
            </div>
            <div class="col-sm-10" >
              <div x-html="area.text"></div>
              {# PLACEHOLDER checkbox when edit_commcare_users and editPermission is true #}
              <div class="form-check" x-show="permissions.edit_commcare_users && area.editPermission && area.showAllowCheckbox">
                <input type="checkbox" checked="checked" disabled="disabled"/>
                <label x-text="area.allowCheckboxText"></label>
              </div>
              {# end PLACEHOLDER #}
              {# REAL checkbox for allowCheckboxPermission #}
              <div class="form-check" x-show="!permissions.edit_commcare_users && area.editPermission && area.showAllowCheckbox">
                <input type="checkbox"
                  :id="area.allowCheckboxId"
                  x-model="area.allowCheckboxPermission" />
                <label
                  :for="area.allowCheckboxId"
                  x-text="area.allowCheckboxText"></label>
              </div>
              {# end REAL #}
              {# PLACEHOLDER checkbox when showAllowCheckbox is false #}
              <div class="form-check"
                x-show="!area.editPermission && area.showAllowCheckbox">
                <input type="checkbox" disabled="disabled"/>
                <label x-text="area.allowCheckboxText"></label>
              </div>
              {# end PLACEHOLDER #}
            </div>
          </div>
        </template>
      </div>

      <div
        class="tab-pane fade"
        id="enterprise-release-management"
        role="tabpanel"
        aria-labelledby="enterprise-tab"
      >
      </div>

      <div
        class="tab-pane fade"
        id="reports-permissions"
        role="tabpanel"
        aria-labelledby="reports-tab"
      >
      </div>

      <div
        class="tab-pane fade"
        id="web-apps-permissions"
        role="tabpanel"
        aria-labelledby="web-apps-tab"
      >
      </div>

      <div
        class="tab-pane fade"
        id="other-settings"
        role="tabpanel"
        aria-labelledby="other-settings-tab"
      >
      </div>
    </div>

    <hr class="mt-0 mb-3">

    <button type="submit" class="btn btn-primary">Save Role</button>
  </form>
</div>
{% endblock %}
