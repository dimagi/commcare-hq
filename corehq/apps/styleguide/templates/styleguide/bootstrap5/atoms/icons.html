{% extends "styleguide/bootstrap5/base.html" %}
{% load hq_shared_tags %}

{% block intro %}
  <h1 class="sg-title mb-0" id="content">Icons</h1>
  <p class="sg-lead">
    Visual communication can be essential in scanning and understanding for populations whose first language
    may not be English.  Please be sympathetic with the goal of cohesion and don’t use an icon for a purpose it
    was not intended for.
  </p>
{% endblock intro %}

{% block toc %}
  <h5 class="my-2 ms-3">On this page</h5>
  <hr class="my-2 ms-3">
  <nav id="TableOfContents">
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#custom-icons">Custom Icons</a></li>
      <li>
        <a href="#creating-new-icons">Creating New Icons</a>
        <ul>
          <li><a href="#configuring-icomoon">Configuring New IcoMoon Account</a></li>
          <li><a href="#syncing-icomoon">Syncing IcoMoon Account</a></li>
          <li><a href="#adding-new-icon">Adding a New Icon</a></li>
          <li><a href="#deleting-icons">Deleting Unused Icons</a></li>
          <li><a href="#generating-font">Generating the Updated Font</a></li>
          <li><a href="#committing-changes">Committing Changes</a></li>
        </ul>
        </ul>
      </li>
    </ul>
  </nav>
{% endblock toc %}

{% block content %}
  <h2 id="overview">
    Overview
  </h2>
  <p>
    Consistent iconography in any user interface is critical to creating
    a product that is highly accessible across all different levels of
    literacy. Icons may need to be localized for different cultures and languages.
  </p>
  <p>
    Good icons use <strong>simple, graphic shapes</strong> so they can be understood even at a small size.
    They have little detail. They are as <strong>universal</strong> as possible, consistent with other
    platforms.
  </p>
  <h2 id="primary-vs-secondary" class="pt-4">
    Primary vs Secondary Icons
  </h2>
  <p>
    Primary icons are used for <strong>navigation</strong> or <strong>interaction</strong>.
    Primary icons are interactive, they change the surround environment or data. They likely don’t need to be coupled with text.
  </p>
  <p>
    Secondary icons <strong>provide clarity</strong>.
    Secondary icons are used <strong>before</strong> text to communicate topical information.
  </p>
  <p>
    Most of HQ's icons come from
    <a href="https://fontawesome.com/">FontAwesome</a>.
    All icons in FontAwesome are already built into HQ.
    Other icons have been custom created for HQ.
  </p>
  {% include "styleguide/bootstrap5/atoms/partials/icon_set.html" with icons=common_icons %}

  <h2 id="custom-icons" class="pt-4">
    Custom Icons
  </h2>
  <p>
    HQ has its own set of icons custom created to communicate HQ-specific concepts. The majority of these icons
    are found in App Builder and Form Designer.
  </p>
  {% include "styleguide/bootstrap5/atoms/partials/icon_set.html" with icons=custom_icons %}

  <h2 id="creating-new-icons" class="pt-4">
    Creating New Icons
  </h2>
  <p>
    If a suitable icon doesn't exist in FontAwesome or HQ's custom set, it might be necessary to create one and add it
    to our custom set of icons.
  </p>
  <p>
    The instructions below assume you:
  </p>
  <ul>
    <li>Are familiar with vector graphics editing. If you aren't find someone who is.</li>
    <li>Have created a (free) account on <a href="https://icomoon.io/" target="_blank">IcoMoon</a> and are logged in.</li>
  </ul>
  <p>
    These instructions are friendly for non-developer designers all the way until the end of the "Generating the Updated Font" step.
    At this step you will download two files that you can then hand off to a developer to commit the changes.
  </p>

  <h3 id="configuring-icomoon" class="pt-2">
    Configuring Your New IcoMoon Account
  </h3>
  <p>
    If this is the first time signing into your free IcoMoon account, start here. With the free account, the font configuration is
    stored client side, so you need to upload the configuration file from HQ each time you want to work on the font.
  </p>
  <p>
    You can find the configuration file at <code>/corehq/apps/hqwebapp/static/hqwebapp/font/CommCare HQ Font.json</code>.
  </p>
  <p>
    In IcoMoon, go to "IcoMoon App" in the top-level navigation.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-001.png" %}" width="600" />
    </div>
  </div>
  <p>
    In the IcoMoon App, click on "Untitled Project" in the right-hand top-level navigation to enter "Manage Projects".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-002.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then click on "Import Project".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-003.png" %}" width="600" />
    </div>
  </div>
  <p>
    Select the <code>CommCare HQ Font.json</code> config file found in <code>/corehq/apps/hqwebapp/static/hqwebapp/font/</code>, and click "Open".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-004.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then click on "Load" next to the "CommCare HQ Font" project to open the project.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-005.png" %}" width="600" />
    </div>
  </div>
  <p>
    Your IcoMoon App should now look something like the following:
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-006.png" %}" width="600" />
    </div>
  </div>
  <p>
    Note that the "IcoMoon - Free" icon set at the bottom is de-selected.
  </p>
  <p>
    You can now move on to the step "Adding a New Icon".
  </p>

  <h3 id="syncing-icomoon" class="pt-2">
    Syncing Your IcoMoon Account
  </h3>
  <p>
    If you already have your IcoMoon account set up, but someone else has edited the CommCare HQ Font since you last edited the font,
    please make sure you upload the latest <code>CommCare HQ Font.json</code> configuration to your IcoMoon app.
  </p>
  <p>
    On your navigation bar, visit "CommCare HQ Font" to Manage Projects.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-007.png" %}" width="600" />
    </div>
  </div>
  <p>
    Click "Delete" next to CommCare HQ Font.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-008.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then click on "Import Project".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-003.png" %}" width="600" />
    </div>
  </div>
  <p>
    Select the latest <code>CommCare HQ Font.json</code> config file found in <code>/corehq/apps/hqwebapp/static/hqwebapp/font/</code>, and click "Open".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-004.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then click on "Load" next to the "CommCare HQ Font" project to open the project.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-005.png" %}" width="600" />
    </div>
  </div>
  <p>
    Your project should now be ready for the next step, "Adding a New Icon".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-006.png" %}" width="600" />
    </div>
  </div>

  <h3 id="adding-new-icon" class="pt-2">
    Adding a New Icon
  </h3>
  <p>
    To add a new icon, first click on the "menu" icon for the CommCare HQ Font and select
    "Import to Set".
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-009.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then, choose your source SVG file to import.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-010.png" %}" width="600" />
    </div>
  </div>
  <p>
    Design Note: Your SVG should have an artboard / canvas size of <code>1024 px x 1024 px</code> to match the other icons.
  </p>
  <p>
    <a href="{% static "styleguide/images/font_docs/example-icon.svg" %}" target="_blank">Here is an example SVG</a>
    to use as a starting point. You can delete the CommCare flower from the SVG and paste your desired vector image.
  </p>
  <p>
    Once uploaded, your new icon will appear as the first icon in the list (before the CommCare "flower").
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-011.png" %}" width="600" />
    </div>
  </div>
  <p>
    Please select the "move" tool in the top menu bar.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-012.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then, click and drag the icon to the end of list (or different order, if needed).
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-013.png" %}" width="600" />
    </div>
  </div>
  <p>
    Edit the newly-added icon by selecting the "pencil" tool in the menu bar, and click on the icon
    to open the edit panel.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-014.png" %}" width="600" />
    </div>
  </div>
  <p>
    With the edit panel open, update the "Tags" and "Names" fields. The text in the "Names" field will
    be the final css class name, prefixed with <code>fcc-</code>. In the image below, this new icon
    can be used as <code>&lt;i class="fcc fcc-incomplete"&gt;&lt;/i&gt;</code>.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-015.png" %}" width="600" />
    </div>
  </div>
  <p>
    If you need to delete any icons as part of your update work, please proceed to the next step.
    Otherwise, proceed to "Generating the Updated Font".
  </p>

  <h3 id="deleting-icons" class="pt-2">
    Deleting Unused Icons
  </h3>
  <p>
    Sometimes it is necessary to remove unused icons. To do this, select the "delete" tool in the
    menu bar.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-016.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then, just click on the icons you would like to delete. In this example, we delete the old
    incomplete forms icon from Web Apps.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-017.png" %}" width="400" />
    </div>
  </div>
  <p>
    IMPORTANT: It is recommended that after you delete icons, go back to the menu bar and select
    the "selection" tool (or any other tool), so you don't accidentally click and delete another icon.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-018.png" %}" width="600" />
    </div>
  </div>

  <h3 id="generating-font" class="pt-2">
    Generating the Updated Font
  </h3>
  <p>
    To generate the updated font files needed to commit this change, first click on the "menu" icon
    next to CommCare HQ Font and select "Select All" to select all the icons.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-019.png" %}" width="600" />
    </div>
  </div>
  <p>
    All icons in the CommCare HQ Font section should then be selected.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-020.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then, click on "Generate Font" in the bottom menu bar.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-021.png" %}" width="600" />
    </div>
  </div>
  <p>
    This will take you to the next step where you can review all the icons that will be included in
    the font. You shouldn't need to touch anything here unless you are doing something very advanced.
    To proceed, click on "Font Download" in the bottom menu bar.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-022.png" %}" width="600" />
    </div>
  </div>
  <p>
    You will then download a <code>zip</code> file that looks something like <code>commcarehq-font-v1.0.zip</code>.
  </p>
  <p>
    After this, you need to download the updated config for your IcoMoon app. To do this, navigate to the "CommCare HQ Font" /
    "Manage Projects" option in the top menu bar.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-023.png" %}" width="600" />
    </div>
  </div>
  <p>
    You can then clock the "Download" option. This will download a file that looks something like
    <code>CommCare HQ Font.json</code>.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-024.png" %}" width="600" />
    </div>
  </div>
  <p>
    If you are a designer, please deliver the <code>.zip</code> and <code>.json</code> files you just downloaded
    to a developer to proceed with the final steps.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-025.png" %}" width="600" />
    </div>
  </div>

  <h3 id="committing-changes" class="pt-2">
    Committing Changes
  </h3>
  <p>
    By this point, you should have the newly-generated <code>.zip</code> and <code>.json</code> files
    from the previous section.
  </p>
  <p>
    You can begin by copying <code>CommCare HQ Font.json</code> to <code>corehq/apps/hqwebapp/static/hqwebapp/font/</code>,
    replacing the existing <code>.json</code> file there with the same name.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-026.png" %}" width="600" />
    </div>
  </div>
  <p>
    Next, unzip the <code>.zip</code> file and copy the font files shown below to the same directory,
    <code>corehq/apps/hqwebapp/static/hqwebapp/font/</code>.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-027.png" %}" width="600" />
    </div>
  </div>
  <p>
    Then, copy the two <code>scss</code> files shown below to the same directory,
    <code>corehq/apps/hqwebapp/static/hqwebapp/font/</code>. Please do not copy the CSS file. The only two
    files copied should be <code>style.scss</code> and <code>variables.scss</code>.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-028.png" %}" width="600" />
    </div>
  </div>
  <p>
    IcoMoon will insert a lot of trailing whitespaces in the scss, which your commit hook will likely yell about,
    so it's recommended to open each copied <code>scss</code> file into your IDE and select "format", or manually
    edit to remove those trailing whitespaces. The screenshots below show the workflow with VSCode.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-029.png" %}" width="300" />
      <img src="{% static "styleguide/images/font_docs/font-step-030.png" %}" width="300" />
    </div>
  </div>
  <p>
    Then, please make sure the change to the <code>$icomoon-font-path</code> in <code>variables.scss</code> is not committed.
    In the screenshot below, this change is discarded using the VSCode diff UI.
  </p>
  <div class="card text-bg-light mb-4">
    <div class="card-body text-center">
      <img src="{% static "styleguide/images/font_docs/font-step-031.png" %}" width="600" />
    </div>
  </div>
  <p>
    The font path should remain <code>/static/hqwebapp/font</code>, otherwise the commcare font will not load.
  </p>
  <p>
    Commit these changes, and you are ready to go with your new icons! Please make sure to document the newly added icons
    on this page, and check that all the existing icons are also loading properly.
  </p>
{% endblock content %}
