{% extends 'hqwebapp/bootstrap5/base_navigation.html' %}
{% load i18n %}
{% load hq_shared_tags %}

{% requirejs_main "styleguide/sketch/clean_data" %}

{% block content %}
{% registerurl "get_data_for_data_cleaning_prototype" %}
{% registerurl "get_all_data_for_data_cleaning_prototype" %}
{% registerurl "update_sprint_data" %}
<div id="clean-data-table-prototype" class="ko-template">

  <div class="d-flex align-items-center m-3">
    <h1 class="fs-3 py-3 pe-3 m-0">Cleaning Data for "child"</h1>
    <div>
      <button type="button"
              class="btn btn-outline-primary"
              data-bs-toggle="offcanvas"
              data-bs-target="#filterDataOffcanvas">
        <i class="fa-solid fa-filter"></i> Filter Data
      </button>
      <button type="button"
              class="btn btn-outline-primary"
              data-bs-toggle="offcanvas"
              data-bs-target="#configureColumnsOffcanvas">
        <i class="fa-solid fa-table-columns"></i> Configure Columns
      </button>
      <button type="button"
              class="btn btn-outline-primary"
              data-bind="disable: isCleanDataButtonDisabled"
              data-bs-toggle="offcanvas"
              data-bs-target="#editOffcanvas">
        <i class="fa-solid fa-shower"></i> Clean Data
      </button>
      <!-- ko if: isPreviewing -->
        <button type="button"
                data-bind="click: acceptChanges"
                class="btn btn-primary">
          <i class="fa-solid fa-check"></i> Accept Changes
        </button>
        <button type="button"
                data-bind="click: discardChanges"
                class="btn btn-outline-danger">
          <i class="fa-regular fa-trash-can"></i> Discard Changes
        </button>

      <!-- /ko -->
    </div>
  </div>
  <div class="mx-3" data-bind="visible: showSelectAllTheData">
    <div class="alert alert-primary alert-dismissible text-center fade show"
         data-bind="visible: showSelectAllTheData">
      <strong class="me-3 fs-5">(<!-- ko text: numRowsSelected --><!-- /ko --> Records Selected)</strong>
      <button type="button"
              data-bind="click: confirmSelectAllDataMatchingFilter"
              class="btn btn-outline-primary">Select All Data Matching Filter</button>
      <button type="button"
              class="btn-close"
              data-bind="click: closeSelectAllTheDataNotice"
              aria-label="Close"></button>
    </div>
  </div>
  <div class="mx-3" data-bind="visible: selectAllDataMatchingFilter">
    <div class="alert alert-primary text-center">
      <strong class="me-3 fs-5">
        All data matching the filter will be affected by changes.
        (<!-- ko text: totalItems --><!-- /ko --> Records Selected)
      </strong>
      <button type="button"
              data-bind="click: cancelSelectAllDataMatchingFilter"
              class="btn btn-outline-danger">
        Cancel Selection
      </button>
    </div>
  </div>

  <div class="mx-3">
    <table class="table table-striped table-hover">
      <thead>
      <tr>
        <th class="fs-3">
          <!-- ko ifnot: isPreviewing -->
          <div class="form-check">
            <input class="form-check-input"
                   data-bind="checked: selectAll"
                   type="checkbox"
                   id="selectAllCheckbox">
          </div>
          <!-- /ko -->
          <!-- ko if: isPreviewing -->
            <!-- ko if: selectAll -->
              <i class="fa-solid fa-check-circle text-primary"></i>
            <!-- /ko -->
            <!-- ko ifnot: selectAll -->
              <i class="fa-regular fa-circle text-primary"></i>
            <!-- /ko -->
          <!-- /ko -->
        </th>
        <!-- ko foreach: visibleColumns -->
          <th>
            <span data-bind="text: name"></span>
          </th>
        <!-- /ko -->
      </tr>
      </thead>
      <tbody>
      <!-- ko foreach: rows -->
      <tr data-bind="css: {'table-primary': isSelected}">
        <td class="fs-5">
          <!-- ko ifnot: $parent.isPreviewing -->
          <div class="form-check">
            <input class="form-check-input"
                   data-bind="checked: isSelected"
                   type="checkbox"
                   id="flexCheckDefault">
          </div>
          <!-- /ko -->
          <!-- ko if: $parent.isPreviewing -->
            <!-- ko if: isSelected -->
              <i class="fa-solid fa-check-circle text-primary"></i>
            <!-- /ko -->
            <!-- ko ifnot: isSelected -->
              <i class="fa-regular fa-circle text-primary"></i>
            <!-- /ko -->
          <!-- /ko -->
        </td>
        <!-- ko foreach: $data.visibleData -->
        <td>
          <!-- ko ifnot: $data.isEdited -->
            <span data-bind="html: $data.originalValue"></span>
          <!-- /ko -->
          <!-- ko if: $data.isEdited -->
            <span class="badge text-bg-primary" data-bind="html: $data.editedValue"></span>
          <!-- /ko -->
        </td>
        <!-- /ko -->
      </tr>
      <!-- /ko -->
      </tbody>
    </table>
    <pagination data-apply-bindings="false"
                params="goToPage: goToPage,
                      slug: 'style-guide',
                      perPage: itemsPerPage,
                      onLoad: onPaginationLoad,
                      totalItems: totalItems"></pagination>
  </div>
  {% include "styleguide/sketch/include/offcanvas.html" %}
</div>


{% endblock %}

