!function(e){if("function"==typeof bootstrap)bootstrap("leafletimage",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeLeafletImage=e}else"undefined"!=typeof window?window.leafletImage=e():global.leafletImage=e()}(function(){return function e(n,t,o){function i(a,f){if(!t[a]){if(!n[a]){var l="function"==typeof require&&require;if(!f&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=t[a]={exports:{}};n[a][0].call(c.exports,function(e){var t=n[a][1][e];return i(t?t:e)},c,c.exports,e,n,t,o)}return t[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,n){var t=e("./queue");n.exports=function(e,n){function o(e){e instanceof L.TileLayer?d.defer(f,e):e._heat&&d.defer(l,e._canvas)}function i(e){e instanceof L.Marker&&e.options.icon instanceof L.Icon&&d.defer(c,e)}function r(){n(null,g)}function a(e,n){if(e)throw e;n.forEach(function(e){e&&e.canvas&&m.drawImage(e.canvas,0,0)}),r()}function f(n,o){function i(e,n,t,o){o(null,{img:e,pos:n,size:t})}function r(e,t,o,i){var r=new Image;r.crossOrigin="",r.onload=function(){i(null,{img:this,pos:t,size:o})},r.onerror=function(e){""!=n.options.errorTileUrl&&void 0===e.target.errorCheck?(e.target.errorCheck=!0,e.target.src=n.options.errorTileUrl):i(null,{img:p,pos:t,size:o})},r.src=e}function a(e,n){n.forEach(f),o(null,{canvas:c})}function f(e){d.drawImage(e.img,Math.floor(e.pos.x),Math.floor(e.pos.y),e.size,e.size)}var l=n instanceof L.TileLayer.Canvas,c=document.createElement("canvas");c.width=s.x,c.height=s.y;var d=c.getContext("2d"),g=e.getPixelBounds(),m=e.getPixelOrigin(),h=e.getZoom(),v=n.options.tileSize;if(h>n.options.maxZoom||h<n.options.minZoom||n.options.format&&!n.options.tiles)return o();var x,y,w=(new L.Point((m.x/v-Math.floor(m.x/v))*v,(m.y/v-Math.floor(m.y/v))*v),L.bounds(g.min.divideBy(v)._floor(),g.max.divideBy(v)._floor())),P=[],_=(w.getCenter(),new t(1));for(x=w.min.y;x<=w.max.y;x++)for(y=w.min.x;y<=w.max.x;y++)P.push(new L.Point(y,x));P.forEach(function(e){var t=e.clone();n._adjustTilePoint&&n._adjustTilePoint(e);var o=n._getTilePos(t).subtract(g.min).add(m);if(e.y>=0)if(l){var a=n._tiles[e.x+":"+e.y];_.defer(i,a,o,v)}else{var f=u(n.getTileUrl(e));_.defer(r,f,o,v)}}),_.awaitAll(a)}function l(n,t){var o=e.getPixelBounds(),i=e.getPixelOrigin(),r=document.createElement("canvas");r.width=s.x,r.height=s.y;var a=r.getContext("2d"),f=L.DomUtil.getPosition(n).subtract(o.min).add(i);a.drawImage(n,f.x,f.y),t(null,{canvas:r})}function c(n,t){var o=document.createElement("canvas"),i=o.getContext("2d"),r=e.getPixelBounds(),a=new L.Point(r.min.x,r.min.y),f=e.project(n.getLatLng()),l=u(n._icon.src),c=new Image,d=n.options.icon.options,g=d.iconSize,m=f.subtract(a),p=L.point(d.iconAnchor||g&&g.divideBy(2,!0)),h=m.x-g[0]+p.x,v=m.y-p.y;o.width=s.x,o.height=s.y,c.crossOrigin="",c.onload=function(){i.drawImage(this,h,v,g[0],g[1]),t(null,{canvas:o})},c.src=l}function u(e){return/^data\:/.test(e)?e:e+(e.match(/\?/)?"&":"?")+"cache="+ +new Date}var s=e.getSize(),d=new t(1),g=document.createElement("canvas");g.width=s.x,g.height=s.y;var m=g.getContext("2d"),p=document.createElement("canvas");p.width=1,p.height=1;var h=p.getContext("2d");h.fillStyle="rgba(0,0,0,0)",h.fillRect(0,0,1,1),e.eachLayer(o),e._pathRoot?d.defer(l,e._pathRoot):e._panes&&e._panes.overlayPane.firstChild&&d.defer(l,e._panes.overlayPane.firstChild),e.eachLayer(i),d.awaitAll(a)}},{"./queue":2}],2:[function(e,n){!function(){function e(e){function n(){for(;f=u<c.length&&e>s;){var n=u++,t=c[n],r=o.call(t,1);r.push(i(n)),++s,t[0].apply(null,r)}}function i(e){return function(t,o){--s,null==g&&(null!=t?(g=t,u=d=0/0,r()):(c[e]=o,--d?f||n():r()))}}function r(){null!=g?m(g):l?m(g,c):m.apply(null,[g].concat(c))}var a,f,l,c=[],u=0,s=0,d=0,g=null,m=t;return e||(e=1/0),a={defer:function(){return g||(c.push(arguments),++d,n()),a},await:function(e){return m=e,l=!1,d||r(),a},awaitAll:function(e){return m=e,l=!0,d||r(),a}}}function t(){}"undefined"==typeof n?self.queue=e:n.exports=e,e.version="1.0.4";var o=[].slice}()},{}]},{},[1])(1)});