import json
from datetime import date, datetime

import mock
from django.core.serializers.json import DjangoJSONEncoder
from django.test.testcases import TestCase


from custom.icds_reports.const import (
    THR_REPORT_CONSOLIDATED,
    THR_REPORT_BENEFICIARY_TYPE,
    THR_REPORT_DAY_BENEFICIARY_TYPE
)
from custom.icds_reports.reports.incentive import IncentiveReport
from custom.icds_reports.reports.service_delivery_report import ServiceDeliveryReport
from custom.icds_reports.reports.take_home_ration import TakeHomeRationExport
from custom.icds_reports.sqldata.exports.awc_infrastructure import AWCInfrastructureExport
from custom.icds_reports.sqldata.exports.aww_activity_report import AwwActivityExport
from custom.icds_reports.sqldata.exports.beneficiary import BeneficiaryExport
from custom.icds_reports.sqldata.exports.children import ChildrenExport
from custom.icds_reports.sqldata.exports.demographics import DemographicsExport
from custom.icds_reports.sqldata.exports.growth_tracker_report import GrowthTrackerExport
from custom.icds_reports.sqldata.exports.lady_supervisor import LadySupervisorExport
from custom.icds_reports.sqldata.exports.poshan_progress_report import PoshanProgressReport
from custom.icds_reports.sqldata.exports.pregnant_women import PregnantWomenExport
from custom.icds_reports.sqldata.exports.system_usage import SystemUsageExport
from custom.icds_reports.tasks import _aggregate_inactive_aww_agg


class TestExportData(TestCase):
    maxDiff = None

    @classmethod
    def setUpClass(cls):
        super(TestExportData, cls).setUpClass()
        cls.now = '16:21:11 15 November 2017'
        cls.india_now_mock_gtr = mock.patch(
            'custom.icds_reports.sqldata.exports.growth_tracker_report.india_now',
            new=mock.Mock(return_value=cls.now)
        )
        cls.india_now_mock_gtr.start()
        cls.india_now_mock_ppr = mock.patch(
            'custom.icds_reports.sqldata.exports.poshan_progress_report.india_now',
            new=mock.Mock(return_value=cls.now)
        )
        cls.india_now_mock_ppr.start()
        cls.india_now_mock_aww_activity = mock.patch(
            'custom.icds_reports.sqldata.exports.aww_activity_report.india_now',
            new=mock.Mock(return_value=cls.now)
        )
        cls.india_now_mock_aww_activity.start()
        cls.india_now_mock_thr = mock.patch(
            'custom.icds_reports.reports.take_home_ration.india_now',
            new=mock.Mock(return_value=cls.now)
        )
        cls.india_now_mock_thr.start()
        cls.other_india_now_mock = mock.patch(
            'custom.icds_reports.utils.mixins.india_now',
            new=mock.Mock(return_value=cls.now)
        )
        cls.other_india_now_mock.start()
        cls.india_now_mock_sdr = mock.patch(
            'custom.icds_reports.reports.service_delivery_report.india_now',
            new=mock.Mock(return_value=cls.now)
        )
        cls.india_now_mock_sdr.start()

    @classmethod
    def tearDownClass(cls):
        cls.india_now_mock_gtr.stop()
        cls.india_now_mock_ppr.stop()
        cls.india_now_mock_aww_activity.stop()
        cls.india_now_mock_thr.stop()
        cls.india_now_mock_sdr.stop()
        cls.other_india_now_mock.stop()
        super(TestExportData, cls).tearDownClass()

    def test_children_export(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            },
        ).get_excel_data('b1')[0][0]
        self.assertEqual(data, "Children")

    def test_thr_report_with_feature_flag(self):
        location = 'b1'
        data = TakeHomeRationExport(
            location=location,
            month=date(2017, 5, 1),
            loc_level=3,
            report_type=THR_REPORT_CONSOLIDATED,
            beta=True
        ).get_excel_data()
        self.assertListEqual(
            data,
            [['Take Home Ration', [['State', 'District', 'Block', 'Sector', 'Awc Name', 'AWW Name',
                                    'AWW Phone No.', 'Total No. of Beneficiaries eligible for THR',
                                    'Total No. of beneficiaries received THR in given month',
                                    'Total No of Pictures taken by AWW'],
                                   ['st1', 'd1', 'b1', 's1', 'a1', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a17', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a25', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a33', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered',
                                    'Data Not Entered', 2, 0, 0],
                                   ['st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered', 'Data Not Entered',
                                    11, 0, 0],
                                   ['st1', 'd1', 'b1', 's1', 'a9', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered', 'Data Not Entered',
                                    10, 0, 0],
                                   ['st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered', 'Data Not Entered',
                                    15, 1, 4],
                                   ['st1', 'd1', 'b1', 's2', 'a2', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a26', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered', 'Data Not Entered',
                                    7, 0, 0],
                                   ['st1', 'd1', 'b1', 's2', 'a42', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a50', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched']]],
             ['Export Info', [
                 ['Generated at', self.now],
                 ['State', 'st1'],
                 ['District', 'd1'],
                 ['Block', 'b1'],
                 ['Month', 'May'],
                 ['Year', 2017]]
              ]

             ]
        )

    def test_thr_report_beneficiary_wise(self):
        location = 'b1'
        data = TakeHomeRationExport(
            location=location,
            month=date(2017, 5, 1),
            loc_level=3,
            report_type=THR_REPORT_BENEFICIARY_TYPE,
            beta=True
        ).get_excel_data()
        self.assertListEqual(
            data,
            [[
                'Take Home Ration',
                [
                    [
                        'State', 'District', 'Block', 'Sector', 'Awc Name', 'AWW Name', 'AWW Phone No.',
                        'Total No. of PW eligible for THR', 'Total No. of LW eligible for THR',
                        'Total No. of Children(6-36 months) eligible for THR',
                        'Total No. of PW received THR>=21 days in given month',
                        'Total No. of LW received THR>=21 days in given month',
                        'Total No. of Children(6-36 months) received THR>=21 days in given month',
                        'Total No of Pictures taken by AWW'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a1', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a17', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a25', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a33', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered', 'Data Not Entered', 2,
                        0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered', 'Data Not Entered', 3,
                        5, 3, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a9', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered', 'Data Not Entered', 0,
                        2, 8, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered', 'Data Not Entered', 5,
                        6, 4, 1, 0, 0, 4
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a2', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a26', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered', 'Data Not Entered', 4,
                        3, 'Data Not Entered', 0, 0, 'Data Not Entered', 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a42', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a50', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                        'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'
                    ]]
            ],
                ['Export Info',
                 [
                     ['Generated at', self.now],
                     ['State', 'st1'],
                     ['District', 'd1'],
                     ['Block', 'b1'],
                     ['Month', 'May'],
                     ['Year', 2017]
                 ]
                 ]]
        )

    def test_thr_report_days_beneficiary_wise(self):
        location = 'b1'
        data = TakeHomeRationExport(
            location=location,
            month=date(2017, 5, 1),
            loc_level=3,
            report_type=THR_REPORT_DAY_BENEFICIARY_TYPE,
            beta=True
        ).get_excel_data()
        self.assertListEqual(
            data,
            [['Take Home Ration', [['State', 'District', 'Block', 'Sector', 'Awc Name', 'AWW Name',
                                    'AWW Phone No.',
                                    'Total No. of PW eligible for THR', 'Total No. of LW eligible for THR',
                                    'Total No. of Children (0-3 years) eligible for THR',
                                    'Total No. of PW did not received THR in given month',
                                    'Total No. of LW did not received THR in given month',
                                    'Total No. of Children (0-3 years) did not received THR in given month',
                                    'Total No. of PW received THR for 1-7 days in given month',
                                    'Total No. of LW received THR for 1-7 days in given month',
                                    'Total No. of Children (0-3 years) received THR for 1-7 days in given month',
                                    'Total No. of PW received THR for 8-14 days in given month',
                                    'Total No. of LW received THR for 8-14 days in given month',
                                    'Total No. of Children (0-3 years) received THR for 8-14 days in given month',
                                    'Total No. of PW received THR for 15-20 days in given month',
                                    'Total No. of LW received THR for 15-20 days in given month',
                                    'Total No. of Children (0-3 years) received THR for 15-20 days in given month',
                                    'Total No. of PW received THR for 21-24 days in given month',
                                    'Total No. of LW received THR for 21-24 days in given month',
                                    'Total No. of Children (0-3 years) received THR for 21-24 days in given month',
                                    'Total No. of PW received THR>=25 days in given month',
                                    'Total No. of LW received THR>=25 days in given month',
                                    'Total No. of Children(0-3 years) received THR>=25 days in given month',
                                    'Total No of Pictures taken by AWW'],
                                   ['st1', 'd1', 'b1', 's1', 'a1', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a17', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a25', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a33', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered', 'Data Not Entered',
                                    2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                   ['st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered', 'Data Not Entered',
                                    3, 5, 3, 0, 1, 0, 0, 2, 1, 3, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                   ['st1', 'd1', 'b1', 's1', 'a9', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered', 'Data Not Entered',
                                    0, 2, 8, 0, 0, 1, 0, 1, 6, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                   ['st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered', 'Data Not Entered',
                                    5, 6, 4, 0, 0, 0, 0, 1, 0, 1, 0, 1, 3, 5, 3, 0, 0, 0, 1, 0, 0, 4],
                                   ['st1', 'd1', 'b1', 's2', 'a2', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a26', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered', 'Data Not Entered', 4, 3,
                                    'Data Not Entered', 0, 0, 'Data Not Entered', 2, 3, 'Data Not Entered', 2, 0,
                                    'Data Not Entered', 0, 0, 'Data Not Entered', 0, 0, 'Data Not Entered', 0, 0,
                                    'Data Not Entered', 0],
                                   ['st1', 'd1', 'b1', 's2', 'a42', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a50', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched']]],
             ['Export Info', [
                 ['Generated at', self.now],
                 ['State', 'st1'],
                 ['District', 'd1'],
                 ['Block', 'b1'],
                 ['Month', 'May'],
                 ['Year', 2017]
             ]]]
        )

    def test_children_export_info(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            },
        ).get_excel_data('b1')[1]
        self.assertListEqual(
            data,
            [
                "Export Info",
                [
                    [
                        "Generated at",
                        self.now
                    ],
                    [
                        'State',
                        'st1'],
                    [
                        'District',
                        'd1'],
                    [
                        "Block",
                        "b1"
                    ]
                ]
            ]
        )

    def test_children_export_data_length(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            },
        ).get_excel_data('b1')[0][1]
        self.assertEqual(len(data), 36)

    def test_children_export_headers(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            },
        ).get_excel_data('b1')[0][1][0]
        self.assertListEqual(
            data,
            ['State',
             'Total no. of children weighed',
             'Total no. of children eligible to be weighed',
             'Weighing efficiency (in month)',
             'Total no. of children whose height was measured',
             'Total no. of children  eligible for measuring height',
             'Height measurement efficiency (in month)',
             'Total number of unweighed children (0-5 Years)',
             'No. of severely underweight children',
             'Total No. of children weighed',
             'Percentage of severely underweight children',
             'No. of moderately underweight children ',
             'Total No. of children weighed',
             'Percentage of moderately underweight children',
             'No. of  children with normal weight for age',
             'Total No. of children weighed',
             'Percentage of normal weight-for-age children',
             'No. of Children with severe wasting',
             'Total number of children whose height and weight is measured',
             'Percentage of children with severe wasting',
             'No. of moderately wasted children',
             'Total number of children whose height and weight is measured',
             'Percentage of children with moderate wasting',
             'No. of children with normal weight-for-height',
             'Total no. of children  whose height and weight is measured',
             'Percentage of children with normal weight-for-height',
             'No. of severely stunted children',
             'Total no. of children whose height has been measured',
             'Percentage of children with severe stunting',
             'No. of moderately stunted children',
             'Total no. of children whose height has been measured',
             'Percentage of children with moderate stunting',
             'No. of children with normal height for age',
             'Total no. of children whose height has been measured',
             'Percentage of children with normal height-for-age',
             'No. of newborns with low birth weight',
             'Total no. of children born and weighed in the current month',
             'Percent of newborns with low birth weight',
             'No. of children completed 1 year immunization',
             'Total no. of children from age >12 months',
             'Percentage of children with completed 1 year immunizations',
             'No. of children breastfed at birth',
             'Total no. of children enrolled in ICDS-CAS system and born in last month',
             'Percentage of children breastfed at birth',
             'No. of children exclusively breastfed',
             'Total number of children (0-6 months) of age enrolled in ICDS-CAS system',
             'Percentage of children exclusively breastfeeding',
             'No. of children initiated complementary feeding (in the past 30 days)',
             'Total no. of children (6-8 ) months of age enrolled with ICDS-CAS',
             'Percentage of children initiated complementary feeding (in the past 30 days)',
             'No. of children initiated appropriate complementary feeding',
             'No.of children (6-24) months of age enrolled with ICDS-CAS',
             'Percentage of children initiated appropriate complementary feeding',
             'No.of children receiving complementary feeding with adequate diet diversity',
             'Total number of children (6 months - 2 yrs) of age enrolled with ICDS-CAS',
             'Percentage of children receiving complementary feeding with adequate diet diversity',
             'No. of children initiated complementary feeding with adequate diet quantity',
             'No.of children (6-24) months of age enrolled with ICDS-CAS',
             'Percentage of children receiving complementary feeding with adequate diet quantity',
             'Total Number of children receiving complementary feeding with appropriate handwashing before feeding',
             'No.of children (6-24) months of age enrolled with ICDS-CAS',
             'Percentage of children receiving complementary feeding with appropriate handwashing before feeding']
        )

    def test_children_export_child_one(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][1]
        self.assertListEqual(
            data,
            [
                'st1',
                655, 972, '67.39 %',
                14, 972, '1.44 %',
                317,
                17, 655, '2.60 %',
                152, 655, '23.21 %',
                486, 655, '74.20 %',
                1, 14, '7.14 %',
                5, 14, '35.71 %',
                7, 14, '50.00 %',
                5, 14, '35.71 %',
                6, 14, '42.86 %',
                2, 14, '14.29 %',
                1, 2, '50.00 %',
                162, 1127, '14.37%',
                1, 5, '20.00 %',
                28, 56, '50.00 %',
                21, 32, '65.62 %',
                76, 142, '53.52 %',
                49, 142, '34.51 %',
                56, 142, '39.44 %',
                68, 142, '47.89 %'
            ]
        )

    def test_children_export_child_two(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][2]
        self.assertListEqual(
            data,
            [
                'st1',
                655, 972, '67.39 %',
                14, 972, '1.44 %',
                317,
                17, 655, '2.60 %',
                152, 655, '23.21 %',
                486, 655, '74.20 %',
                1, 14, '7.14 %',
                5, 14, '35.71 %',
                7, 14, '50.00 %',
                5, 14, '35.71 %',
                6, 14, '42.86 %',
                2, 14, '14.29 %',
                1, 2, '50.00 %',
                162, 1127, '14.37%',
                1, 5, '20.00 %',
                28, 56, '50.00 %',
                21, 32, '65.62 %',
                76, 142, '53.52 %',
                49, 142, '34.51 %',
                56, 142, '39.44 %',
                68, 142, '47.89 %']
        )

    def test_children_export_child_three(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][3]
        self.assertListEqual(
            data,
            [
                'st1',
                655, 972, '67.39 %',
                14, 972, '1.44 %',
                317,
                17, 655, '2.60 %',
                152, 655, '23.21 %',
                486, 655, '74.20 %',
                1, 14, '7.14 %',
                5, 14, '35.71 %',
                7, 14, '50.00 %',
                5, 14, '35.71 %',
                6, 14, '42.86 %',
                2, 14, '14.29 %',
                1, 2, '50.00 %',
                162, 1127, '14.37%',
                1, 5, '20.00 %',
                28, 56, '50.00 %',
                21, 32, '65.62 %',
                76, 142, '53.52 %',
                49, 142, '34.51 %',
                56, 142, '39.44 %',
                68, 142, '47.89 %'
            ]
        )

    def test_children_export_child_four(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            },
            beta=True
        ).get_excel_data('b1')[0][1][4]
        self.assertListEqual(
            data,
            [
                'st1',
                655, 972, '67.39 %',
                14, 972, '1.44 %',
                317,
                17, 655, '2.60 %',
                152, 655, '23.21 %',
                486, 655, '74.20 %',
                1, 14, '7.14 %',
                5, 14, '35.71 %',
                7, 14, '50.00 %',
                5, 14, '35.71 %',
                6, 14, '42.86 %',
                2, 14, '14.29 %',
                1, 2, '50.00 %',
                162, 1127, '14.37%',
                1, 5, '20.00 %',
                28, 56, '50.00 %',
                21, 32, '65.62 %',
                76, 142, '53.52 %',
                49, 142, '34.51 %',
                56, 142, '39.44 %',
                68, 142, '47.89 %']
        )

    def test_children_export_child_five(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][5]
        self.assertListEqual(
            data,
            [
                'st1',
                655, 972, '67.39 %',
                14, 972, '1.44 %',
                317,
                17, 655, '2.60 %',
                152, 655, '23.21 %',
                486, 655, '74.20 %',
                1, 14, '7.14 %',
                5, 14, '35.71 %',
                7, 14, '50.00 %',
                5, 14, '35.71 %',
                6, 14, '42.86 %',
                2, 14, '14.29 %',
                1, 2, '50.00 %',
                162, 1127, '14.37%',
                1, 5, '20.00 %',
                28, 56, '50.00 %',
                21, 32, '65.62 %',
                76, 142, '53.52 %',
                49, 142, '34.51 %',
                56, 142, '39.44 %',
                68, 142, '47.89 %']
        )

    def test_children_export_child_six(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][6]
        self.assertListEqual(
            data,
            [
                'st2',
                730, 1037, '70.40 %',
                30, 1037, '2.89 %',
                307,
                18, 730, '2.47 %',
                136, 730, '18.63 %',
                576, 730, '78.90 %',
                1, 29, '3.45 %',
                4, 29, '13.79 %',
                18, 29, '62.07 %',
                11, 30, '36.67 %',
                6, 30, '20.00 %',
                15, 30, '50.00 %',
                0, 4, '0.00 %',
                88, 1217, '7.23%',
                3, 6, '50.00 %',
                13, 52, '25.00 %',
                24, 40, '60.00 %',
                94, 185, '50.81 %',
                87, 185, '47.03 %',
                62, 185, '33.51 %',
                88, 185, '47.57 %']
        )

    def test_children_export_child_seven(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][7]
        self.assertListEqual(
            data,
            [
                'st2',
                730, 1037, '70.40 %',
                30, 1037, '2.89 %',
                307,
                18, 730, '2.47 %',
                136, 730, '18.63 %',
                576, 730, '78.90 %',
                1, 29, '3.45 %',
                4, 29, '13.79 %',
                18, 29, '62.07 %',
                11, 30, '36.67 %',
                6, 30, '20.00 %',
                15, 30, '50.00 %',
                0, 4, '0.00 %',
                88, 1217, '7.23%',
                3, 6, '50.00 %',
                13, 52, '25.00 %',
                24, 40, '60.00 %',
                94, 185, '50.81 %',
                87, 185, '47.03 %',
                62, 185, '33.51 %',
                88, 185, '47.57 %']
        )

    def test_children_export_child_eight(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][8]
        self.assertListEqual(
            data,
            [
                'st2',
                730, 1037, '70.40 %',
                30, 1037, '2.89 %',
                307,
                18, 730, '2.47 %',
                136, 730, '18.63 %',
                576, 730, '78.90 %',
                1, 29, '3.45 %',
                4, 29, '13.79 %',
                18, 29, '62.07 %',
                11, 30, '36.67 %',
                6, 30, '20.00 %',
                15, 30, '50.00 %',
                0, 4, '0.00 %',
                88, 1217, '7.23%',
                3, 6, '50.00 %',
                13, 52, '25.00 %',
                24, 40, '60.00 %',
                94, 185, '50.81 %',
                87, 185, '47.03 %',
                62, 185, '33.51 %',
                88, 185, '47.57 %']
        )

    def test_children_export_child_nine(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][9]
        self.assertListEqual(
            data,
            [
                'st2',
                730, 1037, '70.40 %',
                30, 1037, '2.89 %',
                307,
                18, 730, '2.47 %',
                136, 730, '18.63 %',
                576, 730, '78.90 %',
                1, 29, '3.45 %',
                4, 29, '13.79 %',
                18, 29, '62.07 %',
                11, 30, '36.67 %',
                6, 30, '20.00 %',
                15, 30, '50.00 %',
                0, 4, '0.00 %',
                88, 1217, '7.23%',
                3, 6, '50.00 %',
                13, 52, '25.00 %',
                24, 40, '60.00 %',
                94, 185, '50.81 %',
                87, 185, '47.03 %',
                62, 185, '33.51 %',
                88, 185, '47.57 %']
        )

    def test_children_export_child_ten(self):
        data = ChildrenExport(
            config={
                'domain': 'icds-cas'
            }
        ).get_excel_data('b1')[0][1][10]
        self.assertListEqual(
            data,
            [
                'st2',
                730, 1037, '70.40 %',
                30, 1037, '2.89 %',
                307,
                18, 730, '2.47 %',
                136, 730, '18.63 %',
                576, 730, '78.90 %',
                1, 29, '3.45 %',
                4, 29, '13.79 %',
                18, 29, '62.07 %',
                11, 30, '36.67 %',
                6, 30, '20.00 %',
                15, 30, '50.00 %',
                0, 4, '0.00 %',
                88, 1217, '7.23%',
                3, 6, '50.00 %',
                13, 52, '25.00 %',
                24, 40, '60.00 %',
                94, 185, '50.81 %',
                87, 185, '47.03 %',
                62, 185, '33.51 %',
                88, 185, '47.57 %']
        )

    def test_pregnant_women_export(self):
        self.assertListEqual(
            PregnantWomenExport(
                config={
                    'domain': 'icds-cas'
                }
            ).get_excel_data('b1'),
            [['Pregnant Women', [
                [
                    'State', 'Number of lactating women', 'Number of pregnant women',
                    'Number of postnatal women', 'Percentage Anemia', 'Percentage Tetanus Completed',
                    'Percent women had at least 1 ANC visit by delivery',
                    'Percent women had at least 2 ANC visit by delivery',
                    'Percent women had at least 3 ANC visit by delivery',
                    'Percent women had at least 4 ANC visit by delivery',
                    'Percentage of women resting during pregnancy',
                    'Percentage of women eating extra meal during pregnancy',
                    'Percentage of trimester 3 women counselled on immediate breastfeeding'
                ],
                ['st1', 171, 120, 31, '20.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.00 %',
                 '75.83 %', '60.32 %'],
                ['st1', 171, 120, 31, '20.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.00 %',
                 '75.83 %', '60.32 %'],
                ['st1', 171, 120, 31, '20.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.00 %',
                 '75.83 %', '60.32 %'],
                ['st1', 171, 120, 31, '20.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.00 %',
                 '75.83 %', '60.32 %'],
                ['st1', 171, 120, 31, '20.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.00 %',
                 '75.83 %', '60.32 %'],
                ['st2', 154, 139, 30, '20.14%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.54 %',
                 '74.82 %', '57.97 %'],
                ['st2', 154, 139, 30, '20.14%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.54 %',
                 '74.82 %', '57.97 %'],
                ['st2', 154, 139, 30, '20.14%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.54 %',
                 '74.82 %', '57.97 %'],
                ['st2', 154, 139, 30, '20.14%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.54 %',
                 '74.82 %', '57.97 %'],
                ['st2', 154, 139, 30, '20.14%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '75.54 %',
                 '74.82 %', '57.97 %'],
                ['st3', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st3', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st3', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st3', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st3', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st4', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st4', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st4', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st4', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st4', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st5', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st5', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st5', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st5', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st5', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st6', 0, 0, 0, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st6', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st6', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st6', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st6', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st7', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st7', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st7', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st7', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %'],
                ['st7', 2, 0, 1, '0.00%', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %', '0.00 %',
                 '0.00 %']
            ]],
             [
                 'Export Info',
                 [
                     ['Generated at', self.now],
                     ['State', 'st1'],
                     ['District', 'd1'],
                     ['Block', 'b1']
                 ]
             ]
             ]
        )

    def test_demographics_export(self):
        self.assertListEqual(
            DemographicsExport(
                config={
                    'domain': 'icds-cas'
                }
            ).get_excel_data('st1'),
            [
                [
                    'Demographics',
                    [
                        [
                            'State',
                            'Number of households',
                            'Total number of household members',
                            'Total number of beneficiaries (Children under 6 years old, pregnant women and lactating women, alive and seeking services) who have an Aadhaar ID',
                            'Total number of beneficiaries (Children under 6 years old, pregnant women and lactating women, alive and seeking services)',
                            'Percent Aadhaar-seeded beneficiaries', 'Number of pregnant women',
                            'Number of pregnant women enrolled for services', 'Number of lactating women',
                            'Number of lactating women enrolled for services', 'Number of children 0-6 years old',
                            'Number of children 0-6 years old enrolled for services',
                            'Number of children 0-6 months old enrolled for services',
                            'Number of children 6 months to 3 years old enrolled for services',
                            'Number of children 3 to 6 years old enrolled for services',
                            'Number of adolescent girls (11-14 years)',
                            'Number of out of school adolescent girls (11-14 years)',
                            'Number of adolescent girls 15 to 18 years old'],
                        ['st1', 2637, 858, 369, 1517, '24.32 %', 120, 120, 171, 171, 1226, 1226, 56, 244, 926, 26,
                         0, 10],
                        ['st1', 2637, 858, 369, 1517, '24.32 %', 120, 120, 171, 171, 1226, 1226, 56, 244, 926, 26,
                         0, 10],
                        ['st1', 2637, 858, 369, 1517, '24.32 %', 120, 120, 171, 171, 1226, 1226, 56, 244, 926, 26,
                         0, 10],
                        ['st1', 2637, 858, 369, 1517, '24.32 %', 120, 120, 171, 171, 1226, 1226, 56, 244, 926, 26,
                         0, 10],
                        ['st1', 2637, 858, 369, 1517, '24.32 %', 120, 120, 171, 171, 1226, 1226, 56, 244, 926, 26,
                         0, 10],
                        ['st2', 2952, 1058, 275, 1614, '17.04 %', 139, 139, 154, 154, 1321, 1321, 52, 301, 968, 25,
                         0, 20],
                        ['st2', 2952, 1058, 275, 1614, '17.04 %', 139, 139, 154, 154, 1321, 1321, 52, 301, 968, 25,
                         0, 20],
                        ['st2', 2952, 1058, 275, 1614, '17.04 %', 139, 139, 154, 154, 1321, 1321, 52, 301, 968, 25,
                         0, 20],
                        ['st2', 2952, 1058, 275, 1614, '17.04 %', 139, 139, 154, 154, 1321, 1321, 52, 301, 968, 25,
                         0, 20],
                        ['st2', 2952, 1058, 275, 1614, '17.04 %', 139, 139, 154, 154, 1321, 1321, 52, 301, 968, 25,
                         0, 20],
                        ['st3', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st3', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st3', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st3', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st3', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st4', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st4', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st4', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st4', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st4', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st5', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st5', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st5', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st5', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st5', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st6', 0, 0, 0, 0, '0.00 %', 0, 0, 0, 0, 0, 0, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st6', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st6', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st6', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st6', 2, 0, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered',
                         'Data Not Entered', 0, 0, 0],
                        ['st7', 2, 8, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered', 1,
                         6, 4, 0],
                        ['st7', 2, 8, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered', 1,
                         6, 4, 0],
                        ['st7', 2, 8, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered', 1,
                         6, 4, 0],
                        ['st7', 2, 8, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered', 1,
                         6, 4, 0],
                        ['st7', 2, 8, 0, 3, '0.00 %', 0, 0, 2, 2, 1, 1, 'Data Not Entered', 'Data Not Entered', 1,
                         6, 4, 0]]],
                [
                    'Export Info',
                    [
                        [
                            'Generated at', self.now
                        ],
                        [
                            'State', 'st1'
                        ]
                    ]
                ]
            ]
        )

    def test_system_usage_export(self):
        self.assertListEqual(
            SystemUsageExport(
                config={
                    'domain': 'icds-cas',
                    'month': date(2017, 5, 1)
                }
            ).get_excel_data('b1', False, True),
            [
                ['System Usage', [
                    [
                        'State',
                        'Number of days AWC was open in the given month',
                        'Number of launched AWCs (ever submitted at least one HH reg form)',
                        'Number of household registration forms', 'Number of add pregnancy forms',
                        'Number of birth preparedness forms', 'Number of delivery forms',
                        'Number of PNC forms', 'Number of exclusive breastfeeding forms',
                        'Number of complementary feeding forms', 'Number of growth monitoring forms',
                        'Number of take home rations forms', 'Number of due list forms'
                    ],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                ]],
                ['Export Info', [
                    ['Generated at', self.now],
                    ['State', 'st1'],
                    ['District', 'd1'],
                    ['Block', 'b1'],
                    ['Month', 'May'],
                    ['Year', 2017]
                ]]
            ]
        )

    def test_system_usage_export_for_awc_level(self):
        self.assertListEqual(
            SystemUsageExport(
                config={
                    'domain': 'icds-cas',
                    'block_id': 'b1',
                    'aggregation_level': 5,
                    'month': date(2017, 5, 1)
                },
                loc_level=5,
            ).get_excel_data('b1', system_usage_num_launched_awcs_formatting_at_awc_level=True),
            [
                ['System Usage', [
                    [
                        'State',
                        'District',
                        'Block',
                        'Supervisor',
                        'AWC',
                        'AWW Phone Number',
                        'Number of days AWC was open in the given month',
                        'Number of launched AWCs (ever submitted at least one HH reg form)',
                        'Number of household registration forms', 'Number of add pregnancy forms',
                        'Number of birth preparedness forms', 'Number of delivery forms',
                        'Number of PNC forms', 'Number of exclusive breastfeeding forms',
                        'Number of complementary feeding forms', 'Number of growth monitoring forms',
                        'Number of take home rations forms', 'Number of due list forms'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a1', '+91555555',
                        18, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a17', 'Data Not Entered',
                        11, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a25', 'Data Not Entered',
                        13, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a33', 'Data Not Entered',
                        12, 'Not Launched', 0, 0, 0, 1, 0, 0, 0, 0, 0, 1
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered',
                        16, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 2
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered',
                        14, 'Launched', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a9', 'Data Not Entered',
                        18, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered',
                        8, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered',
                        17, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a2', 'Data Not Entered',
                        10, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a26', 'Data Not Entered',
                        12, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered',
                        4, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a42', 'Data Not Entered',
                        7, 'Not Launched', 0, 0, 1, 0, 0, 0, 1, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a50', 'Data Not Entered',
                        19, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ]
                ]],
                ['Export Info', [
                    ['Generated at', self.now],
                    ['State', 'st1'],
                    ['District', 'd1'],
                    ['Block', 'b1'],
                    ['Grouped By', 'AWC'],
                    ['Month', 'May'],
                    ['Year', 2017]
                ]],
            ]
        )

    def test_system_usage_export_with_beta_before_jan_2020(self):
        self.assertListEqual(
            SystemUsageExport(
                config={
                    'domain': 'icds-cas',
                    'month': date(2017, 5, 1)
                }, beta=True
            ).get_excel_data('b1', False, True),
            [
                ['System Usage', [
                    [
                        'State',
                        'Number of days AWC was open in the given month',
                        'Number of launched AWCs (ever submitted at least one HH reg form)',
                        'Number of household registration forms', 'Number of add pregnancy forms',
                        'Number of birth preparedness forms', 'Number of delivery forms',
                        'Number of PNC forms', 'Number of exclusive breastfeeding forms',
                        'Number of complementary feeding forms', 'Number of growth monitoring forms',
                        'Number of take home rations forms', 'Number of due list forms'
                    ],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st1', 'Applicable at only AWC level', 10, 0, 1, 4, 1, 0, 5, 12, 3, 46, 5],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st2', 'Applicable at only AWC level', 11, 0, 4, 4, 1, 1, 4, 4, 20, 65, 17],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st3', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st4', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st5', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 'Data Not Entered', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st6', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ['st7', 'Applicable at only AWC level', 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                ]],
                ['Export Info', [
                    ['Generated at', self.now],
                    ['State', 'st1'],
                    ['District', 'd1'],
                    ['Block', 'b1'],
                    ['Month', 'May'],
                    ['Year', 2017]
                ]]
            ]
        )

    def test_system_usage_export_for_awc_level_with_beta_before_jan_2020(self):
        self.assertListEqual(
            SystemUsageExport(
                config={
                    'domain': 'icds-cas',
                    'block_id': 'b1',
                    'aggregation_level': 5,
                    'month': date(2017, 5, 1)
                },
                loc_level=5, beta=True
            ).get_excel_data('b1', system_usage_num_launched_awcs_formatting_at_awc_level=True),
            [
                ['System Usage', [
                    [
                        'State',
                        'District',
                        'Block',
                        'Supervisor',
                        'AWC',
                        'AWW Phone Number',
                        'Number of days AWC was open in the given month',
                        'Number of launched AWCs (ever submitted at least one HH reg form)',
                        'Number of household registration forms', 'Number of add pregnancy forms',
                        'Number of birth preparedness forms', 'Number of delivery forms',
                        'Number of PNC forms', 'Number of exclusive breastfeeding forms',
                        'Number of complementary feeding forms', 'Number of growth monitoring forms',
                        'Number of take home rations forms', 'Number of due list forms'
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a1', '+91555555',
                        18, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a17', 'Data Not Entered',
                        11, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a25', 'Data Not Entered',
                        13, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a33', 'Data Not Entered',
                        12, 'Not Launched', 0, 0, 0, 1, 0, 0, 0, 0, 0, 1
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered',
                        16, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 2
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered',
                        14, 'Launched', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's1', 'a9', 'Data Not Entered',
                        18, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered',
                        8, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered',
                        17, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a2', 'Data Not Entered',
                        10, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a26', 'Data Not Entered',
                        12, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered',
                        4, 'Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a42', 'Data Not Entered',
                        7, 'Not Launched', 0, 0, 1, 0, 0, 0, 1, 0, 0, 0
                    ],
                    [
                        'st1', 'd1', 'b1', 's2', 'a50', 'Data Not Entered',
                        19, 'Not Launched', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    ]
                ]],
                ['Export Info', [
                    ['Generated at', self.now],
                    ['State', 'st1'],
                    ['District', 'd1'],
                    ['Block', 'b1'],
                    ['Grouped By', 'AWC'],
                    ['Month', 'May'],
                    ['Year', 2017]
                ]],
            ]
        )

    def test_system_usage_export_with_beta_after_jan_2020(self):
        self.assertListEqual(
            SystemUsageExport(
                config={
                    'domain': 'icds-cas',
                    'month': date(2020, 1, 1)
                }, beta=True
            ).get_excel_data('b1', False, True),
            [
                ['System Usage', [
                    [
                        'State',
                        'Number of days AWC was open in the given month',
                        'Number of launched AWCs (ever submitted at least one HH reg form)',
                        'Number of household registration forms', 'Number of add pregnancy forms',
                        'Number of birth preparedness forms', 'Number of delivery forms',
                        'Number of PNC forms', 'Number of exclusive breastfeeding forms',
                        'Number of complementary feeding forms', 'Number of growth monitoring forms',
                        'Number of take home rations forms', 'Number of due list forms',
                        'Number of launched LSs'
                    ]
                ]],
                ['Export Info', [
                    ['Generated at', self.now],
                    ['State', 'st1'],
                    ['District', 'd1'],
                    ['Block', 'b1'],
                    ['Month', 'January'],
                    ['Year', 2020]
                ]]
            ]
        )

    def test_awc_infrastructure_export(self):
        self.assertListEqual(
            AWCInfrastructureExport(
                config={
                    'domain': 'icds-cas'
                }
            ).get_excel_data(location='b1'),
            [
                [
                    'AWC Infrastructure',
                    [
                        [
                            'State',
                            'Percentage AWCs reported clean drinking water',
                            'Percentage AWCs reported functional toilet',
                            'Percentage AWCs reported medicine kit',
                            'Percentage AWCs reported weighing scale: infants',
                            'Percentage AWCs reported weighing scale: mother and child',
                            'Percentage AWCs reported Infantometer',
                            'Percentage AWCs reported Stadiometer'
                        ],
                        [
                            'st1',
                            '100.00 %',
                            '50.00 %',
                            '61.54 %',
                            '76.92 %',
                            '26.92 %',
                            '7.69 %',
                            '3.85 %'
                        ],
                        [
                            'st1',
                            '100.00 %',
                            '50.00 %',
                            '61.54 %',
                            '76.92 %',
                            '26.92 %',
                            '7.69 %',
                            '3.85 %'
                        ],
                        [
                            'st1',
                            '100.00 %',
                            '50.00 %',
                            '61.54 %',
                            '76.92 %',
                            '26.92 %',
                            '7.69 %',
                            '3.85 %'
                        ],
                        [
                            'st1',
                            '100.00 %',
                            '50.00 %',
                            '61.54 %',
                            '76.92 %',
                            '26.92 %',
                            '7.69 %',
                            '3.85 %'
                        ],
                        [
                            'st1',
                            '100.00 %',
                            '50.00 %',
                            '61.54 %',
                            '76.92 %',
                            '26.92 %',
                            '7.69 %',
                            '3.85 %'
                        ],
                        [
                            'st2',
                            '94.44 %',
                            '55.56 %',
                            '83.33 %',
                            '77.78 %',
                            '27.78 %',
                            '0.00 %',
                            '0.00 %'
                        ],
                        [
                            'st2',
                            '94.44 %',
                            '55.56 %',
                            '83.33 %',
                            '77.78 %',
                            '27.78 %',
                            '0.00 %',
                            '0.00 %'
                        ],
                        [
                            'st2',
                            '94.44 %',
                            '55.56 %',
                            '83.33 %',
                            '77.78 %',
                            '27.78 %',
                            '0.00 %',
                            '0.00 %'
                        ],
                        [
                            'st2',
                            '94.44 %',
                            '55.56 %',
                            '83.33 %',
                            '77.78 %',
                            '27.78 %',
                            '0.00 %',
                            '0.00 %'
                        ],
                        [
                            'st2',
                            '94.44 %',
                            '55.56 %',
                            '83.33 %',
                            '77.78 %',
                            '27.78 %',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st3',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st3',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st3',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st3',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st3',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st4',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st4',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st4',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st4',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st4',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st5',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st5',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st5',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st5',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st5',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st6',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st6',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st6',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st6',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st6',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st7',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st7',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st7',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st7',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ],
                        [
                            'st7',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered',
                            'Data Not Entered'
                        ]
                    ]
                ],
                [
                    'Export Info',
                    [
                        [
                            'Generated at',
                            self.now
                        ],
                        [
                            'State',
                            'st1'
                        ],
                        [
                            'District',
                            'd1'
                        ],
                        [
                            'Block',
                            'b1'
                        ]
                    ]
                ]
            ]
        )

    def test_beneficiary_export(self):
        self.assertJSONEqual(
            json.dumps(
                BeneficiaryExport(
                    config={
                        'domain': 'icds-cas',
                        'month': date(2017, 5, 1),
                        'awc_id': 'a7'
                    },
                    loc_level=5
                ).get_excel_data('a7'),
                cls=DjangoJSONEncoder
            ),
            json.dumps([
                [
                    "Child Beneficiary",
                    [
                        [
                            "AWC Name",
                            "AWC Site Code",
                            "Supervisor Name",
                            "Block Name",
                            "AWW Phone Number",
                            "Mother name",
                            "Mother Phone Number",
                            "Child Name",
                            "Date of Birth",
                            "Current Age (as of 2017-05-01)",
                            "Sex ",
                            "1 Year Immunizations Complete",
                            "Month for data shown",
                            "Weight Recorded (in Month)",
                            "Height Recorded (in Month)",
                            "Weight-for-Age Status (in Month)",
                            "Weight-for-Height Status (in Month)",
                            "Height-for-Age status (in Month)",
                            "Days attended PSE (as of 2017-05-01)"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0938\u0902\u0924\u094b\u0937',
                            "Data Not Entered",
                            "Name 1788",
                            "2012-12-03",
                            "4 years 5 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "12.10",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            19
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0935\u093f\u0937\u094d\u0923\u0941',
                            "Data Not Entered",
                            "Name 1790",
                            "2012-12-15",
                            "4 years 5 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "13.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            20
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Pavan Bai Ramdaya',
                            "Data Not Entered",
                            "Name 1795",
                            "2014-01-20",
                            "3 years 4 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "11.30",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            17
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0930\u093e\u0927\u093e \u0930\u093e\u091c\u0947\u0936',
                            "Data Not Entered",
                            "Name 1797",
                            "2012-05-12",
                            "5 years ",
                            "M",
                            "No",
                            "2017-05-01",
                            "15.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            23
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Bindu',
                            "Data Not Entered",
                            "Name 1832",
                            "2015-09-14",
                            "1 year 8 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "10.60",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0930\u0947\u0916\u093e',
                            "Data Not Entered",
                            "Name 1876",
                            "2016-01-11",
                            "1 year 4 months ",
                            "M",
                            "Yes",
                            "2017-05-01",
                            "8.80",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0917\u0941\u0902\u091c\u0928',
                            "Data Not Entered",
                            "Name 2027",
                            "2016-12-15",
                            "5 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0930\u0947\u0916\u093e',
                            "Data Not Entered",
                            "Name 2054",
                            "2016-05-26",
                            "1 year ",
                            "M",
                            "No",
                            "2017-05-01",
                            "8.60",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0905\u0928\u094d\u0924\u0940\u092e\u092c\u093e\u0932\u093e',
                            "Data Not Entered",
                            "Name 2056",
                            "2014-11-29",
                            "2 years 6 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "11.40",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0938\u0902\u0924\u094b\u0937',
                            "Data Not Entered",
                            "Name 2060",
                            "2015-10-10",
                            "1 year 7 months ",
                            "M",
                            "Yes",
                            "2017-05-01",
                            "8.80",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0927\u093e\u092a\u0941',
                            "Data Not Entered",
                            "Name 2073",
                            "2015-08-10",
                            "1 year 9 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "9.50",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0906\u0930\u0924\u0940',
                            "Data Not Entered",
                            "Name 2094",
                            "2014-12-04",
                            "2 years 5 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "10.50",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u092a\u094d\u0930\u0924\u093f\u092e\u093e',
                            "Data Not Entered",
                            "Name 2117",
                            "2015-11-18",
                            "1 year 6 months ",
                            "M",
                            "Yes",
                            "2017-05-01",
                            "9.80",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0930\u092e\u093e',
                            "Data Not Entered",
                            "Name 2134",
                            "2015-12-12",
                            "1 year 5 months ",
                            "M",
                            "Yes",
                            "2017-05-01",
                            "7.90",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u090f\u0915\u0924\u094d\u0924\u093e',
                            "Data Not Entered",
                            "Name 2141",
                            "2015-03-05",
                            "2 years 2 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "10.00",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u092c\u092c\u094d\u092c\u0940\u0924\u093e',
                            "Data Not Entered",
                            "Name 2171",
                            "2016-08-27",
                            "9 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "7.50",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u091a\u0947\u0924\u0928\u093e',
                            "Data Not Entered",
                            "Name 2173",
                            "2015-05-24",
                            "2 years ",
                            "M",
                            "No",
                            "2017-05-01",
                            "9.40",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0936\u0940\u0924\u0932',
                            "Data Not Entered",
                            "Name 2182",
                            "2014-12-12",
                            "2 years 5 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "11.50",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0935\u0930\u094d\u0937\u093e',
                            "Data Not Entered",
                            "Name 2188",
                            "2014-08-16",
                            "2 years 9 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "11.40",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u091c\u094d\u092f\u094b\u0924\u093f',
                            "Data Not Entered",
                            "Name 2192",
                            "2015-10-07",
                            "1 year 7 months ",
                            "F",
                            "Yes",
                            "2017-05-01",
                            "8.00",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u091c\u094d\u092f\u094b\u0924\u093f',
                            "Data Not Entered",
                            "Name 2207",
                            "2016-01-21",
                            "1 year 4 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "8.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u091c\u094d\u092f\u094b\u0924\u093f',
                            "Data Not Entered",
                            "Name 2210",
                            "2015-05-18",
                            "2 years ",
                            "M",
                            "No",
                            "2017-05-01",
                            "9.60",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0935\u093f\u0937\u094d\u0923\u0941\u092c\u093e\u0908',
                            "Data Not Entered",
                            "Name 2241",
                            "2012-10-14",
                            "4 years 7 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "13.00",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            21
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u092a\u0941\u0937\u094d\u092a\u093e',
                            "Data Not Entered",
                            "Name 2250",
                            "2014-06-10",
                            "2 years 11 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "11.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0917\u093e\u092f\u0924\u094d\u0930\u0940',
                            "Data Not Entered",
                            "Name 2254",
                            "2013-01-28",
                            "4 years 4 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "14.00",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            18
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0916\u0941\u0936\u092c\u0942 \u0917\u094b\u0930\u094d\u0935\u0927\u0928',
                            "Data Not Entered",
                            "Name 2263",
                            "2016-09-08",
                            "8 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "8.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0905\u0930\u0941\u0923\u093e',
                            "Data Not Entered",
                            "Name 2265",
                            "2014-02-16",
                            "3 years 3 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "11.80",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            18
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Shyama',
                            "Data Not Entered",
                            "Name 2266",
                            "2014-03-13",
                            "3 years 2 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "11.60",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            22
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Bindu',
                            "Data Not Entered",
                            "Name 2267",
                            "2012-12-25",
                            "4 years 5 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "13.60",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            20
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0938\u0941\u0928\u0940\u0924\u093e.',
                            "Data Not Entered",
                            "Name 2271",
                            "2013-05-13",
                            "4 years ",
                            "F",
                            "No",
                            "2017-05-01",
                            "12.20",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            24
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0938\u0902\u0917\u0940\u0924\u093e',
                            "Data Not Entered",
                            "Name 2276",
                            "2012-07-22",
                            "4 years 10 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "13.80",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            22
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Shantabai Kamlesh',
                            "Data Not Entered",
                            "Name 2330",
                            "2013-06-29",
                            "3 years 11 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "13.50",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            21
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u091c\u094d\u092f\u094b\u0924\u093f',
                            "Data Not Entered",
                            "Name 2331",
                            "2013-05-09",
                            "4 years ",
                            "F",
                            "No",
                            "2017-05-01",
                            "12.40",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            19
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0905\u0928\u094d\u0924\u0940\u092e\u092c\u093e\u0932\u093e',
                            "Data Not Entered",
                            "Name 2333",
                            "2014-06-05",
                            "2 years 11 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "10.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            "Data Not Entered"
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0926\u0941\u0930\u094d\u0917\u093e',
                            "Data Not Entered",
                            "Name 2335",
                            "2013-10-14",
                            "3 years 7 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "11.90",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            20
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0909\u092e\u093e',
                            "Data Not Entered",
                            "Name 2337",
                            "2013-12-04",
                            "3 years 5 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "12.60",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            26
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Sarita Gopal',
                            "Data Not Entered",
                            "Name 2338",
                            "2013-07-03",
                            "3 years 10 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "14.20",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            24
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u092a\u094d\u0930\u0924\u093f\u092e\u093e',
                            "Data Not Entered",
                            "Name 2339",
                            "2013-11-29",
                            "3 years 6 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "12.90",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            27
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0936\u094b\u092d\u093e',
                            "Data Not Entered",
                            "Name 2340",
                            "2013-07-25",
                            "3 years 10 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "13.10",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            17
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0930\u0947\u0916\u093e',
                            "Data Not Entered",
                            "Name 2341",
                            "2012-08-07",
                            "4 years 9 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "14.20",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            24
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0930\u0940\u0928\u093e',
                            "Data Not Entered",
                            "Name 2342",
                            "2013-09-24",
                            "3 years 8 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "11.00",
                            "Data Not Entered",
                            "Moderately underweight",
                            "Data Not Entered",
                            "Data Not Entered",
                            24
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            '\u0928\u093f\u0930\u094d\u092e\u0932\u093e',
                            "Data Not Entered",
                            "Name 2344",
                            "2013-03-09",
                            "4 years 2 months ",
                            "M",
                            "No",
                            "2017-05-01",
                            "13.40",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            22
                        ],
                        [
                            "a7",
                            "a7",
                            "s7",
                            "b4",
                            "Data Not Entered",
                            'Pavan Bai Ramdaya',
                            "Data Not Entered",
                            "Name 2346",
                            "2014-01-20",
                            "3 years 4 months ",
                            "F",
                            "No",
                            "2017-05-01",
                            "12.70",
                            "Data Not Entered",
                            "Normal weight for age",
                            "Data Not Entered",
                            "Data Not Entered",
                            16
                        ]
                    ]
                ],
                [
                    "Export Info",
                    [
                        [
                            "Generated at",
                            self.now
                        ],
                        [
                            'State',
                            'st1'
                        ],
                        [
                            'District',
                            'd1'
                        ],
                        [
                            'Block',
                            'b1'
                        ],
                        [
                            'Supervisor',
                            's1'
                        ],
                        [
                            "Awc",
                            "a7"
                        ],
                        [
                            "Month",
                            "May"
                        ],
                        [
                            "Year",
                            2017
                        ]
                    ]
                ]
            ])
        )

    def test_growth_tracker_export(self):
        self.assertJSONEqual(
            json.dumps(
                GrowthTrackerExport(
                    config={
                        'domain': 'icds-cas',
                        'month': date(2017, 5, 1),
                        'awc_id': 'a7'
                    },
                    loc_level=5
                ).get_excel_data('a7'),
                cls=DjangoJSONEncoder
            ),
            json.dumps([
                [
                    'Child Growth Tracking',
                    [['State',
                      'District',
                      'Block',
                      'Sector',
                      'Awc Name',
                      'Child',
                      'Age',
                      'Mother Name',
                      'Mother Phone Number',
                      'PSE_March 2017',
                      'PSE_April 2017',
                      'PSE_May 2017',
                      'SN_March 2017',
                      'SN_April 2017',
                      'SN_May 2017',
                      'Stunting_March 2017',
                      'Stunting_April 2017',
                      'Stunting_May 2017',
                      'Wasting_March 2017',
                      'Wasting_April 2017',
                      'Wasting_May 2017',
                      'underweight_March 2017',
                      'underweight_April 2017',
                      'underweight_May 2017'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1788',
                      '4 years 5 months ',
                      '',
                      None,
                      'N/A',
                      11,
                      19,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1790',
                      '4 years 5 months ',
                      '',
                      None,
                      'N/A',
                      18,
                      20,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1794',
                      '5 years 1 month ',
                      '',
                      None,
                      'N/A',
                      19,
                      25,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1795',
                      '3 years 4 months ',
                      'Pavan Bai Ramdaya',
                      None,
                      'N/A',
                      23,
                      17,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1797',
                      '5 years ',
                      ' ',
                      None,
                      'N/A',
                      19,
                      23,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1801',
                      '5 years 5 months ',
                      None,
                      None,
                      'N/A',
                      17,
                      19,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1807',
                      '5 years 7 months ',
                      '',
                      None,
                      'N/A',
                      18,
                      23,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1811',
                      '5 years 6 months ',
                      '',
                      None,
                      'N/A',
                      19,
                      21,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1812',
                      '5 years 3 months ',
                      '',
                      None,
                      'N/A',
                      17,
                      17,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1832',
                      '1 year 8 months ',
                      'Bindu',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 1876',
                      '1 year 4 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2027',
                      '5 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2054',
                      '1 year ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2056',
                      '2 years 6 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2060',
                      '1 year 7 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2073',
                      '1 year 9 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2094',
                      '2 years 5 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2117',
                      '1 year 6 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2134',
                      '1 year 5 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2141',
                      '2 years 2 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2171',
                      '9 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2173',
                      '2 years ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2182',
                      '2 years 5 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2188',
                      '2 years 9 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2192',
                      '1 year 7 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2207',
                      '1 year 4 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2210',
                      '2 years ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2241',
                      '4 years 7 months ',
                      '',
                      None,
                      'N/A',
                      23,
                      21,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2250',
                      '2 years 11 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2254',
                      '4 years 4 months ',
                      '',
                      None,
                      'N/A',
                      15,
                      18,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2263',
                      '8 months ',
                      ' ',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2265',
                      '3 years 3 months ',
                      '',
                      None,
                      'N/A',
                      20,
                      18,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2266',
                      '3 years 2 months ',
                      'Shyama',
                      None,
                      'N/A',
                      22,
                      22,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2267',
                      '4 years 5 months ',
                      'Bindu',
                      None,
                      'N/A',
                      13,
                      20,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2271',
                      '4 years ',
                      '.',
                      None,
                      'N/A',
                      20,
                      24,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2275',
                      '5 years 8 months ',
                      '',
                      None,
                      'N/A',
                      22,
                      22,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2276',
                      '4 years 10 months ',
                      '',
                      None,
                      'N/A',
                      17,
                      22,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2330',
                      '3 years 11 months ',
                      'Shantabai Kamlesh',
                      None,
                      'N/A',
                      18,
                      21,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2331',
                      '4 years ',
                      '',
                      None,
                      'N/A',
                      18,
                      19,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2332',
                      '5 years 3 months ',
                      '',
                      None,
                      'N/A',
                      19,
                      25,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2333',
                      '2 years 11 months ',
                      '',
                      None,
                      'N/A',
                      None,
                      None,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2335',
                      '3 years 7 months ',
                      '',
                      None,
                      'N/A',
                      21,
                      20,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2337',
                      '3 years 5 months ',
                      '',
                      None,
                      'N/A',
                      23,
                      26,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2338',
                      '3 years 10 months ',
                      'Sarita Gopal',
                      None,
                      'N/A',
                      20,
                      24,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2339',
                      '3 years 6 months ',
                      '',
                      None,
                      'N/A',
                      23,
                      27,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2340',
                      '3 years 10 months ',
                      '',
                      None,
                      'N/A',
                      10,
                      17,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2341',
                      '4 years 9 months ',
                      '',
                      None,
                      'N/A',
                      22,
                      24,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2342',
                      '3 years 8 months ',
                      '',
                      None,
                      'N/A',
                      21,
                      24,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Moderately underweight',
                      'Moderately underweight'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2343',
                      '5 years 10 months ',
                      'Sarita Gopal',
                      None,
                      'N/A',
                      20,
                      23,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2344',
                      '4 years 2 months ',
                      '',
                      None,
                      'N/A',
                      20,
                      22,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2345',
                      '5 years 9 months ',
                      '',
                      None,
                      'N/A',
                      14,
                      17,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2346',
                      '3 years 4 months ',
                      'Pavan Bai Ramdaya',
                      None,
                      'N/A',
                      19,
                      16,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Normal weight for age',
                      'Normal weight for age'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2347',
                      '5 years 6 months ',
                      'Bharati Dharmendr',
                      None,
                      'N/A',
                      23,
                      25,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2531',
                      '5 years 7 months ',
                      '',
                      None,
                      'N/A',
                      19,
                      19,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 2534',
                      '5 years 7 months ',
                      ' ',
                      None,
                      'N/A',
                      21,
                      22,
                      'N/A',
                      0,
                      22,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered'],
                     ['st2',
                      'd3',
                      'b4',
                      's7',
                      'a7',
                      'Name 4377',
                      '5 years 11 months ',
                      '',
                      None,
                      'N/A',
                      20,
                      18,
                      'N/A',
                      0,
                      0,
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered',
                      'Data Not Entered']]

                ],
                [
                    'Export Info',
                    [
                        ['Generated at', self.now],
                        ['State', 'st1'],
                        ['District', 'd1'],
                        ['Block', 'b1'],
                        ['Supervisor', 's1'],
                        ['Awc', 'a7'],
                        ['Month', 'May'],
                        ['Year', 2017]
                    ]
                ]
            ])
        )

    def test_aww_activity_export(self):
        _aggregate_inactive_aww_agg()
        self.assertJSONEqual(
            json.dumps(
                AwwActivityExport(
                    config={
                        'domain': 'icds-cas',
                        'beta': False
                    },
                    loc_level=1
                ).get_excel_data('st1'),
                cls=DjangoJSONEncoder
            ),
            json.dumps([
                [
                    "AWW Activity Report", [
                    [
                        "State", "District", "Block", "Supervisor name", "Awc Name", "AWC site code",
                        "AWC launch date", "Last submission date", "Days since start", "Days inactive"
                    ],
                    ['st1', 'd1', 'b1', 's1', 'a1', 'awca1', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's1', 'a17', 'awca17', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's1', 'a25', 'awca25', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's1', 'a33', 'awca33', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's1', 'a41', 'awca41', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's1', 'a49', 'awca49', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's1', 'a9', 'awca9', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a10', 'awca10', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a18', 'awca18', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a2', 'awca2', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a26', 'awca26', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a34', 'awca34', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a42', 'awca42', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b1', 's2', 'a50', 'awca50', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's3', 'a11', 'awca11', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's3', 'a19', 'awca19', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's3', 'a27', 'awca27', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's3', 'a3', 'awca3', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's3', 'a35', 'awca35', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's3', 'a43', 'awca43', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's4', 'a12', 'awca12', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's4', 'a20', 'awca20', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's4', 'a28', 'awca28', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's4', 'a36', 'awca36', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's4', 'a4', 'awca4', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered'],
                    ['st1', 'd1', 'b2', 's4', 'a44', 'awca44', 'Data Not Entered', 'Data Not Entered',
                     'Data Not Entered', 'Data Not Entered']
                ]
                ],
                ["Export Info",
                 [
                     ["Generated at", self.now],
                     ["State", "st1"]
                 ]
                 ]
            ])
        )

    def test_lady_supervisor_export(self):
        data = LadySupervisorExport(
            config={
                'domain': 'icds-cas',
                'aggregation_level': 4,
                'month': date(2017, 5, 1),
                'state_id': 'st1',
            },
            loc_level=1,
        ).get_excel_data('st1')
        expected = [
            [
                'Lady Supervisor',
                [
                    [
                        'State',
                        'District',
                        'Block',
                        'Sector Name',
                        'Lady Supervisor User ID',
                        'Total No. of AWCs visited',
                        'Total No. of Beneficiaries Visited',
                        'Total No. of VHSNDs observed'
                    ],
                    [
                        'st1',
                        'd1',
                        'b1',
                        's1',
                        's1',
                        1,
                        2,
                        'Data Not Entered'
                    ],
                    [
                        'st1',
                        'd1',
                        'b1',
                        's2',
                        's2',
                        1,
                        1,
                        2
                    ],
                    [
                        'st1',
                        'd1',
                        'b2',
                        's3',
                        's3',
                        'Data Not Entered',
                        2,
                        'Data Not Entered'
                    ],
                    [
                        'st1',
                        'd1',
                        'b2',
                        's4',
                        's4',
                        'Data Not Entered',
                        'Data Not Entered',
                        1
                    ],
                ]
            ],
            [
                'Export Info',
                [
                    [
                        'Generated at',
                        self.now
                    ],
                    [
                        'State',
                        'st1'
                    ],
                    [
                        'Grouped By',
                        'Supervisor'
                    ],
                    [
                        'Month',
                        'May'
                    ],
                    [
                        'Year',
                        2017
                    ]
                ]
            ]
        ]
        self.assertListEqual(
            expected,
            data
        )

    def test_aww_performance_export(self):
        data = IncentiveReport(
            location='b2',
            month=datetime(2017, 5, 1),
            aggregation_level=3
        ).get_excel_data()

        expected = [
            ['AWW Performance Report',
             [['State', 'District', 'Block', 'Supervisor', 'AWC', 'AWW Name', 'AWW Contact Number',
               'Home Visits Conducted', 'Weighing Efficiency', 'AWW Eligible for Incentive',
               'Number of Days AWC was Open', 'AWH Eligible for Incentive'],
              ['st1', 'd1', 'b2', 's4', 'a12', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's4', 'a20', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's4', 'a28', 'Data Not Entered', 'Data Not Entered', '0.00%', '0.00%',
               'No', 5, 'No'],
              ['st1', 'd1', 'b2', 's4', 'a36', 'Data Not Entered', 'Data Not Entered', '0.00%', '14.29%',
               'No', 17, 'No'],
              ['st1', 'd1', 'b2', 's4', 'a4', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's4', 'a44', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's3', 'a11', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's3', 'a19', 'Data Not Entered', 'Data Not Entered', '0.00%', '50.00%',
               'No', 16, 'No'],
              ['st1', 'd1', 'b2', 's3', 'a27', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's3', 'a3', 'AWC not launched', 'AWC not launched', 'AWC not launched',
               'AWC not launched', 'AWC not launched', 'AWC not launched', 'AWC not launched'],
              ['st1', 'd1', 'b2', 's3', 'a35', 'Data Not Entered', 'Data Not Entered', '0.00%',
               'No expected weight measurement',
               'No', 12, 'No'],
              ['st1', 'd1', 'b2', 's3', 'a43', 'Data Not Entered', 'Data Not Entered', '0.00%', '100.00%',
               'No', 13, 'No']]],
            ['Export Info',
             [
                 ['Grouped By', 'AWC'],
                 ['Month', 5],
                 ['Year', 2017],
                 ['Disclaimer',
                  'The information in the report is based on the self-reported '
                  'data entered by the Anganwadi Worker in ICDS-CAS mobile application'
                  ' and is subject to timely data submissions.']
             ]
             ]
        ]
        self.assertListEqual(
            data,
            expected
        )

    def test_thr_report(self):
        location = 'b1'

        data = TakeHomeRationExport(
            location=location,
            month=date(2017, 5, 1),
            loc_level=3
        ).get_excel_data()
        self.assertListEqual(
            data,
            [['Take Home Ration', [['State', 'District', 'Block', 'Sector', 'Awc Name', 'AWW Name',
                                    'AWW Phone No.', 'Total No. of Beneficiaries eligible for THR',
                                    'Total No. of beneficiaries received THR in given month',
                                    'Total No of Pictures taken by AWW'],
                                   ['st1', 'd1', 'b1', 's1', 'a1', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a17', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a25', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a33', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered',
                                    'Data Not Entered', 2, 0, 0],
                                   ['st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered', 'Data Not Entered',
                                    11, 0, 0],
                                   ['st1', 'd1', 'b1', 's1', 'a9', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered', 'Data Not Entered',
                                    10, 0, 0],
                                   ['st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered', 'Data Not Entered',
                                    15, 1, 4],
                                   ['st1', 'd1', 'b1', 's2', 'a2', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a26', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered', 'Data Not Entered',
                                    7, 0, 0],
                                   ['st1', 'd1', 'b1', 's2', 'a42', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched'],
                                   ['st1', 'd1', 'b1', 's2', 'a50', 'AWC Not Launched', 'AWC Not Launched',
                                    'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched']]],
             ['Export Info', [
                 ['Generated at', self.now],
                 ['State', 'st1'],
                 ['District', 'd1'],
                 ['Block', 'b1'],
                 ['Month', 'May'],
                 ['Year', 2017]]
              ]

             ]
        )

    def test_thr_report_export_info_national_level(self):
        location = ''
        data = TakeHomeRationExport(
            location=location,
            month=date(2017, 5, 1),
            loc_level=0
        ).get_excel_data()

        self.assertListEqual(
            data,
            [['Take Home Ration', [
                ['State', 'District', 'Block', 'Sector', 'Awc Name', 'AWW Name', 'AWW Phone No.',
                 'Total No. of Beneficiaries eligible for THR',
                 'Total No. of beneficiaries received THR in given month',
                 'Total No of Pictures taken by AWW'],
                ['st1', 'd1', 'b1', 's1', 'a1', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's1', 'a17', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's1', 'a25', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's1', 'a33', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's1', 'a41', 'Data Not Entered', 'Data Not Entered', 2, 0, 0],
                ['st1', 'd1', 'b1', 's1', 'a49', 'Data Not Entered', 'Data Not Entered', 11, 0, 0],
                ['st1', 'd1', 'b1', 's1', 'a9', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's2', 'a10', 'Data Not Entered', 'Data Not Entered', 10, 0, 0],
                ['st1', 'd1', 'b1', 's2', 'a18', 'Data Not Entered', 'Data Not Entered', 15, 1, 4],
                ['st1', 'd1', 'b1', 's2', 'a2', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's2', 'a26', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's2', 'a34', 'Data Not Entered', 'Data Not Entered', 7, 0, 0],
                ['st1', 'd1', 'b1', 's2', 'a42', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b1', 's2', 'a50', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's3', 'a11', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's3', 'a19', 'Data Not Entered', 'Data Not Entered', 11, 8, 0],
                ['st1', 'd1', 'b2', 's3', 'a27', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's3', 'a3', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's3', 'a35', 'Data Not Entered', 'Data Not Entered', 2, 0, 0],
                ['st1', 'd1', 'b2', 's3', 'a43', 'Data Not Entered', 'Data Not Entered', 10, 0, 0],
                ['st1', 'd1', 'b2', 's4', 'a12', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's4', 'a20', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's4', 'a28', 'Data Not Entered', 'Data Not Entered', 5, 0, 0],
                ['st1', 'd1', 'b2', 's4', 'a36', 'Data Not Entered', 'Data Not Entered', 20, 0, 0],
                ['st1', 'd1', 'b2', 's4', 'a4', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st1', 'd1', 'b2', 's4', 'a44', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd2', 'b3', 's5', 'a13', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd2', 'b3', 's5', 'a21', 'Data Not Entered', 'Data Not Entered', 14, 13, 0],
                ['st2', 'd2', 'b3', 's5', 'a29', 'Data Not Entered', 'Data Not Entered', 2, 1, 0],
                ['st2', 'd2', 'b3', 's5', 'a37', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd2', 'b3', 's5', 'a45', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd2', 'b3', 's5', 'a5', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd2', 'b3', 's6', 'a14', 'Data Not Entered', 'Data Not Entered', 8, 0, 0],
                ['st2', 'd2', 'b3', 's6', 'a22', 'Data Not Entered', 'Data Not Entered', 16, 3, 0],
                ['st2', 'd2', 'b3', 's6', 'a30', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd2', 'b3', 's6', 'a38', 'Data Not Entered', 'Data Not Entered', 6, 2, 0],
                ['st2', 'd2', 'b3', 's6', 'a46', 'Data Not Entered', 'Data Not Entered', 67, 58, 0],
                ['st2', 'd2', 'b3', 's6', 'a6', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's7', 'a15', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's7', 'a23', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's7', 'a31', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's7', 'a39', 'Data Not Entered', 'Data Not Entered', 9, 0, 0],
                ['st2', 'd3', 'b4', 's7', 'a47', 'Data Not Entered', 'Data Not Entered', 8, 1, 0],
                ['st2', 'd3', 'b4', 's7', 'a7', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's8', 'a16', 'Data Not Entered', 'Data Not Entered', 7, 0, 0],
                ['st2', 'd3', 'b4', 's8', 'a24', 'Data Not Entered', 'Data Not Entered', 14, 12, 0],
                ['st2', 'd3', 'b4', 's8', 'a32', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's8', 'a40', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st2', 'd3', 'b4', 's8', 'a48', 'aww_name48', '91552222', 22, 9, 0],
                ['st2', 'd3', 'b4', 's8', 'a8', 'AWC Not Launched', 'AWC Not Launched', 'AWC Not Launched',
                 'AWC Not Launched', 'AWC Not Launched'],
                ['st3', 'd4', 'b5', 's20', 'a101', 'Data Not Entered', 'Data Not Entered', 1, 0, 0],
                ['st4', 'd5', 'b6', 's21', 'a102', 'Data Not Entered', 'Data Not Entered', 1, 0, 0],
                ['st5', 'd6', 'b7', 's22', 'a103', 'Data Not Entered', 'Data Not Entered', 1, 0, 0],
                ['st6', 'd7', 'b8', 's23', 'a104', 'Data Not Entered', 'Data Not Entered', 1, 0, 0],
                ['st7', 'd8', 'b9', 's24', 'a105', 'Data Not Entered', 'Data Not Entered', 1, 0, 0]]],
             ['Export Info', [
                 ['Generated at', self.now],
                 ['Location', 'National'],
                 ['Month', 'May'],
                 ['Year', 2017]]
              ]
             ]
        )

    def test_ppr_comprehensive_month(self):
        location = ''
        data = PoshanProgressReport(
            config={
                'domain': 'icds-cas',
                'month': date(2017, 5, 1),
                'report_layout': 'comprehensive',
                'data_period': 'month'
            },
            loc_level=1
        ).get_excel_data(location)

        self.assertListEqual(
            data,
            [['Poshan Progress Report', [
                ['State Name', 'Number of Districts Covered', 'Number of Blocks Covered',
                 'Number of AWCs Launched',
                 '% Number of Days AWC Were opened', 'Expected Home Visits', 'Actual Home Visits',
                 '% of Home Visits',
                 'Total Number of Children (3-6 yrs)',
                 'No. of children between 3-6 years provided PSE for atleast 21+ days',
                 '% of children between 3-6 years provided PSE for atleast 21+ days',
                 'Children Eligible to have their weight Measured',
                 'Total number of children that were weighed in the month',
                 'Weighing efficiency', 'Number of women in third trimester',
                 'Number of trimester three women counselled on immediate and EBF',
                 '% of trimester three women counselled on immediate and EBF',
                 'Children Eligible to have their height Measured',
                 'Total number of children that had their height measured in the month',
                 'Height Measurement Efficiency',
                 'Number of children between 6 months -3 years, P&LW',
                 'No of children between 6 months -3 years, P&LW provided THR for atleast ' '21+ days',
                 '% of children between 6 months -3 years, P&LW provided THR for atleast ' '21+ days',
                 'No. of children between 3-6 years ',
                 'No of children between 3-6 years provided SNP for atleast 21+ days',
                 '% of children between 3-6 years provided SNP for atleast 21+ days'],
                ['st1', 1, 2, 10, '142.40%', 185, 3, '1.62%', 483, 7, '1.45%', 475, 317, '66.74%', 37, 27,
                 '72.97%', 475, 7,
                 '1.47%', 122, 43, '35.25%', 483, 4, '0.83%'],
                ['st2', 2, 2, 11, '106.91%', 193, 0, '0.00%', 507, 59, '11.64%', 513, 378, '73.68%', 42, 30,
                 '71.43%', 513, 25,
                 '4.87%', 154, 103, '66.88%', 507, 12, '2.37%'],
                ['st3', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0,
                 '0.00%', 0, 0,
                 '0.00%', 0, 0, '0.00%'],
                ['st4', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0,
                 '0.00%', 0, 0,
                 '0.00%', 0, 0, '0.00%'],
                ['st5', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0,
                 '0.00%', 0, 0,
                 '0.00%', 0, 0, '0.00%'],
                ['st6', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0,
                 '0.00%', 0, 0,
                 '0.00%', 0, 0, '0.00%'],
                ['st7', 1, 1, 1, '0.00%', 1, 0, '0.00%', 1, 0, '0.00%', 1, 0, '0.00%', 0, 0, '0.00%', 1, 0,
                 '0.00%', 0, 0,
                 '0.00%', 1, 0, '0.00%'],
                ['Total', 4, 5, 22, '118.18%', 379, 3, '0.79%', 991, 66, '6.66%', 989, 695, '70.27%', 79, 57,
                 '72.15%', 989, 32, '3.24%', 276, 146,
                 '52.90%', 991, 16, '1.61%']]], ['Export Info', [['Generated at', self.now],
                                                             ['Report Layout', 'Comprehensive'],
                                                             ['Data Period', 'Month']]]]
        )

    def test_ppr_summary_month(self):
        location = ''
        data = PoshanProgressReport(
            config={
                'domain': 'icds-cas',
                'month': date(2017, 5, 1),
                'report_layout': 'summary',
                'data_period': 'month'
            },
            loc_level=1
        ).get_excel_data(location)
        self.assertListEqual(
            data,
            [['Poshan Progress Report', [
                ['State Name', 'Number of Districts Covered', 'Number of Blocks Covered',
                 'Number of AWCs Launched',
                 '% Number of Days AWC Were opened', '% of Home Visits',
                 '% of children between 3-6 years provided PSE for atleast 21+ days', 'Weighing efficiency',
                 '% of trimester three women counselled on immediate and EBF', 'Height Measurement Efficiency',
                 '% of children between 6 months -3 years, P&LW provided THR for atleast ' '21+ days',
                 '% of children between 3-6 years provided SNP for atleast 21+ days'],
                ['st1', 1, 2, 10, '142.40%', '1.62%', '1.45%', '66.74%', '72.97%', '1.47%', '35.25%', '0.83%'],
                ['st2', 2, 2, 11, '106.91%', '0.00%', '11.64%', '73.68%', '71.43%', '4.87%', '66.88%', '2.37%'],
                ['st3', 0, 0, 0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st4', 0, 0, 0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st5', 0, 0, 0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st6', 0, 0, 0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st7', 1, 1, 1, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['Total', 4, 5, 22, '118.18%', '0.79%', '6.66%', '70.27%', '72.15%', '3.24%', '52.90%', '1.61%']]],
             ['Export Info', [
                 ['Generated at', self.now], ['Report Layout', 'Summary'], ['Data Period', 'Month']]]]

        )

    def test_ppr_comprehensive_quarter(self):
        location = 'st2'
        data = PoshanProgressReport(
            config={
                'domain': 'icds-cas',
                'month': date(2017, 5, 1),
                'report_layout': 'comprehensive',
                'data_period': 'quarter',
                'quarter': 2,
                'year': 2017
            },
            loc_level=2
        ).get_excel_data(location)
        self.assertListEqual(
            data,
            [['Poshan Progress Report', [
                ['State Name', 'District Name', 'Number of Districts Covered', 'Number of Blocks Covered',
                 'Number of AWCs Launched', '% Number of Days AWC Were opened', 'Expected Home Visits',
                 'Actual Home Visits',
                 '% of Home Visits', 'Total Number of Children (3-6 yrs)',
                 'No. of children between 3-6 years provided PSE for atleast 21+ days',
                 '% of children between 3-6 years provided PSE for atleast 21+ days',
                 'Children Eligible to have their weight Measured',
                 'Total number of children that were weighed in the month',
                 'Weighing efficiency', 'Number of women in third trimester',
                 'Number of trimester three women counselled on immediate and EBF',
                 '% of trimester three women counselled on immediate and EBF',
                 'Children Eligible to have their height Measured',
                 'Total number of children that had their height measured in the month',
                 'Height Measurement Efficiency',
                 'Number of children between 6 months -3 years, P&LW',
                 'No of children between 6 months -3 years, P&LW provided THR for atleast ' '21+ days',
                 '% of children between 6 months -3 years, P&LW provided THR for atleast ' '21+ days',
                 'No. of children between 3-6 years ',
                 'No of children between 3-6 years provided SNP for atleast 21+ days',
                 '% of children between 3-6 years provided SNP for atleast 21+ days'],
                ['st2', 'd2', 0.67, 0.67, 4.0, '78.00%', 89.0, 0.0, '0.00%', 133.67, 17.67, '13.22%', 168.33,
                 123.67, '73.47%',
                 11.0, 6.67, '60.64%', 168.33, 4.0, '2.38%', 69.0, 32.0, '46.38%', 133.67, 1.0, '0.75%'],
                ['st2', 'd3', 0.67, 0.67, 3.33, '64.06%', 66.67, 0.0, '0.00%', 199.33, 10.33, '5.18%', 177.33,
                 119.67,
                 '67.48%', 12.0, 6.67, '55.58%', 177.33, 6.0, '3.38%', 36.67, 8.0, '21.82%', 199.33, 3.0, '1.51%'],
                ['Total', 'Total', 4, 4, 22, '71.64%', 467, 0, '0.00%', 999, 84, '8.41%', 1037, 730, '70.40%', 69,
                 40,
                 '57.97%', 1037, 30, '2.89%', 317, 120, '37.85%', 999, 12, '1.20%']]], ['Export Info', [
                ['Generated at', self.now], ['State', 'st2'], ['Report Layout', 'Comprehensive'],
                ['Data Period', 'Quarter']]]]
        )

    def test_ppr_summary_quarter(self):
        location = ''
        data = PoshanProgressReport(
            config={
                'domain': 'icds-cas',
                'month': date(2017, 5, 1),
                'report_layout': 'summary',
                'data_period': 'quarter',
                'quarter': 2,
                'year': 2017
            },
            loc_level=1
        ).get_excel_data(location)
        self.assertListEqual(
            data,
            [['Poshan Progress Report', [
                ['State Name', 'Number of Districts Covered', 'Number of Blocks Covered',
                 'Number of AWCs Launched',
                 '% Number of Days AWC Were opened', '% of Home Visits',
                 '% of children between 3-6 years provided PSE for atleast 21+ days', 'Weighing efficiency',
                 '% of trimester three women counselled on immediate and EBF', 'Height Measurement Efficiency',
                 '% of children between 6 months -3 years, P&LW provided THR for atleast ' '21+ days',
                 '% of children between 3-6 years provided SNP for atleast 21+ days'],
                ['st1', 0.67, 1.33, 6.67, '97.15%', '0.66%', '2.52%', '67.39%', '60.33%', '1.44%', '16.73%',
                 '1.16%'],
                ['st2', 1.33, 1.33, 7.33, '71.67%', '0.00%', '8.41%', '70.39%', '57.96%', '2.89%', '37.85%',
                 '1.20%'],
                ['st3', 0.0, 0.0, 0.0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st4', 0.0, 0.0, 0.0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st5', 0.0, 0.0, 0.0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st6', 0.0, 0.0, 0.0, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['st7', 0.67, 0.67, 0.67, '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%', '0.00%'],
                ['Total', 8, 10, 44, '80.00%', '0.32%', '5.53%', '68.91%', '59.09%', '2.19%', '28.40%', '1.18%']]],
             ['Export Info',
              [['Generated at', self.now], ['Report Layout', 'Summary'], ['Data Period', 'Quarter']]]]
        )

    def test_sdr_report_pw_lw_children(self):
        data = ServiceDeliveryReport(
            config={
                'domain': 'icds-cas',
                'aggregation_level': 1,
                'month': date(2017, 5, 1),
                'beneficiary_category': 'pw_lw_children'
            },
            location='',
            beta=True
        ).get_excel_data()
        self.assertListEqual(
            data,
            [['SDR - PW,LM & Children (0-3 years)',
              [[
                  'State', 'Number of AWCs launched', 'Number of home visits conducted by AWW',
                  'Number of expected home visits to be conducted by the AWW',
                  'Percentage of home visits conducted by the AWW',
                  'Number of children (0-3 years) enrolled for Anganwadi services who were weighed',
                  'Total children (0-3 years) enrolled for Anganwadi services',
                  'Percentage of children (0-3 years) enrolled for Anganwadi services who were weighed',
                  'Number of Anganwadi centers who have conducted at least 2 CBE',
                  'Total number of launched Anganwadi centers',
                  'Percentage of Anganwadi centers who have conducted at least 2 CBE',
                  'Number of anganwadi centers who have conducted at least 1 VHSND',
                  'Number of beneficiaries to whom THR was not provided',
                  'Number of beneficiaries enrolled for Anganwadi services',
                  'Percentage of beneficiaries to whom THR was not provided',
                  'Number of beneficiaries to whom THR was provided for 1-7 days',
                  'Number of beneficiaries enrolled for Anganwadi services',
                  'Percentage of beneficiaries to whom THR was provided for 1-7 days',
                  'Number of beneficiaries to whom THR was provided for 8-14 days',
                  'Number of beneficiaries enrolled for Anganwadi services',
                  'Percentage of beneficiaries to whom THR was provided for 8-14 days',
                  'Number of beneficiaries to whom THR was provided for 15-20 days',
                  'Number of beneficiaries enrolled for Anganwadi services',
                  'Percentage of beneficiaries to whom THR was provided for 15-20 days',
                  'Number of beneficiaries to whom THR was provided for 21-24 days',
                  'Number of beneficiaries enrolled for Anganwadi services',
                  'Percentage of beneficiaries to whom THR was provided for 21-24 days',
                  'Number of beneficiaries to whom THR was provided for at least 25 days',
                  'Number of beneficiaries enrolled for Anganwadi services',
                  'Percentage of beneficiaries to whom THR was provided for at least 25 days'],
                  ['st1', 10, 3, 185, '1.62%', 83, 143, '58.04%', 0, 10, '0.00%', 2, 50, 279, '17.92%',
                   62, 279, '22.22%',
                   35, 279, '12.54%', 52, 279, '18.64%', 56, 279, '20.07%', 24, 279, '8.60%'],
                  ['st2', 11, 0, 193, '0.00%', 139, 171, '81.29%', 1, 11, '9.09%', 6, 34, 318, '10.69%',
                   29, 318, '9.12%',
                   23, 318, '7.23%', 51, 318, '16.04%', 25, 318, '7.86%', 156, 318, '49.06%'],
                  ['st3', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, 0, '0.00%',
                   0, 0, '0.00%',
                   0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%'],
                  ['st4', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, 0, '0.00%',
                   0, 0, '0.00%',
                   0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%'],
                  ['st5', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, 0, '0.00%',
                   0, 0, '0.00%',
                   0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%'],
                  ['st6', 0, 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, 0, '0.00%',
                   0, 0, '0.00%',
                   0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%', 0, 0, '0.00%'],
                  ['st7', 1, 0, 1, '0.00%', 0, 0, '0.00%', 0, 1, '0.00%', 0, 1, 1, '100.00%', 0, 1, '0.00%',
                   0, 1,
                   '0.00%', 0, 1, '0.00%', 0, 1, '0.00%', 0, 1, '0.00%'],
                  ['Grand Total', 22, 3, 379, '0.79%', 222, 314, '70.70%', 1, 22, '4.55%', 8, 85, 598,
                   '14.21%', 91, 598,
                   '15.22%', 58, 598, '9.70%', 103, 598, '17.22%', 81, 598, '13.55%', 180, 598, '30.10%']]],
             ['Export Info',
              [[
                  'Generated at', self.now
              ],
                  ['Location', 'National'],
                  ['Month', 'May'],
                  ['Year', 2017]]]]
        )

    def test_sdr_report_children_3_6(self):
        data = ServiceDeliveryReport(
            config={
                'aggregation_level': 1,
                'domain': 'icds-cas',
                'month': date(2017, 5, 1),
                'state_id': 'st1',
                'beneficiary_category': 'children_3_6'
            },
            location='st1',
            beta=True
        ).get_excel_data()
        self.assertListEqual(
            data,
            [['SDR - Children (3-6 years)', [
                ['State', 'Number of beneficiaries to whom hot cooked meal was not provided',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries to whom hot cooked meal was not provided',
                 'Number of beneficiaries to whom hot cooked meal was provided for 1-7 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries to whom hot cooked meal was provided for 1-7 days',
                 'Number of beneficiaries to whom hot cooked meal was provided for 8-14 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries to whom hot cooked meal was provided for 8-14 days',
                 'Number of beneficiaries to whom hot cooked meal was provided for 15-20 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries to whom hot cooked meal was provided for 15-20 days',
                 'Number of beneficiaries to whom hot cooked meal was provided for at 21-24 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries to whom hot cooked meal was provided for 21-24 days',
                 'Number of beneficiaries to whom hot cooked meal was provided for at least 25 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries to whom hot cooked meal was provided for at least 25 days',
                 'Number of beneficiaries who did not attend pre-school education',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries who did not attend pre-school education',
                 'Number of beneficiaries who attended pre-school education for 1-7 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries who attended pre-school education for 1-7 days',
                 'Number of beneficiaries who attended pre-school education for 8-14 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries who attended pre-school education for 8-14 days',
                 'Number of beneficiaries who attended pre-school education for 15-20 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries who attended pre-school education for 15-20 days',
                 'Number of beneficiaries who attended pre-school education for 21-24 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries who attended pre-school education for 21-24 days',
                 'Number of beneficiaries who attended pre-school education for at least 25 days',
                 'Number of beneficiaries enrolled for Anganwadi services',
                 'Percentage of beneficiaries who attended pre-school education for at least 25 days',
                 'Number of children who were weighed', 'Total children enrolled for Anganwadi services',
                 'Percentage of children who were weighed'],
                ['st1', 477, 483, '98.76%', 1, 483, '0.21%', 1, 483, '0.21%', 0, 483, '0.00%', 4, 483,
                 '0.83%', 0, 483,
                 '0.00%', 38, 483, '7.87%', 168, 483, '34.78%', 191, 483, '39.54%', 79, 483, '16.36%',
                 7, 483, '1.45%',
                 0, 483, '0.00%', 234, 332, '70.48%'],
                ['Grand Total', 477, 483, '98.76%', 1, 483, '0.21%', 1, 483, '0.21%', 0, 483, '0.00%',
                 4, 483, '0.83%',
                 0, 483, '0.00%', 38, 483, '7.87%', 168, 483, '34.78%', 191, 483, '39.54%', 79, 483,
                 '16.36%', 7, 483,
                 '1.45%', 0, 483, '0.00%', 234, 332, '70.48%']]],
             ['Export Info',
              [['Generated at', self.now],
               ['State', 'st1'],
               ['Month', 'May'],
               ['Year', 2017]]]]
        )
